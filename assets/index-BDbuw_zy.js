(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))o(u);new MutationObserver(u=>{for(const l of u)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function a(u){const l={};return u.integrity&&(l.integrity=u.integrity),u.referrerPolicy&&(l.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?l.credentials="include":u.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(u){if(u.ep)return;u.ep=!0;const l=a(u);fetch(u.href,l)}})();const Fn=new Set,nr=new Map;let qt,Bn="ltr",jn="en";const to=typeof MutationObserver<"u"&&typeof document<"u"&&typeof document.documentElement<"u";if(to){const i=new MutationObserver(no);Bn=document.documentElement.dir||"ltr",jn=document.documentElement.lang||navigator.language,i.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]})}function ro(...i){i.map(r=>{const a=r.$code.toLowerCase();nr.has(a)?nr.set(a,Object.assign(Object.assign({},nr.get(a)),r)):nr.set(a,r),qt||(qt=r)}),no()}function no(){to&&(Bn=document.documentElement.dir||"ltr",jn=document.documentElement.lang||navigator.language),[...Fn.keys()].map(i=>{typeof i.requestUpdate=="function"&&i.requestUpdate()})}let ms=class{constructor(r){this.host=r,this.host.addController(this)}hostConnected(){Fn.add(this.host)}hostDisconnected(){Fn.delete(this.host)}dir(){return`${this.host.dir||Bn}`.toLowerCase()}lang(){return`${this.host.lang||jn}`.toLowerCase()}getTranslationData(r){var a,o;const u=new Intl.Locale(r.replace(/_/g,"-")),l=u?.language.toLowerCase(),h=(o=(a=u?.region)===null||a===void 0?void 0:a.toLowerCase())!==null&&o!==void 0?o:"",_=nr.get(`${l}-${h}`),y=nr.get(l);return{locale:u,language:l,region:h,primary:_,secondary:y}}exists(r,a){var o;const{primary:u,secondary:l}=this.getTranslationData((o=a.lang)!==null&&o!==void 0?o:this.lang());return a=Object.assign({includeFallback:!1},a),!!(u&&u[r]||l&&l[r]||a.includeFallback&&qt&&qt[r])}term(r,...a){const{primary:o,secondary:u}=this.getTranslationData(this.lang());let l;if(o&&o[r])l=o[r];else if(u&&u[r])l=u[r];else if(qt&&qt[r])l=qt[r];else return console.error(`No translation found for: ${String(r)}`),String(r);return typeof l=="function"?l(...a):l}date(r,a){return r=new Date(r),new Intl.DateTimeFormat(this.lang(),a).format(r)}number(r,a){return r=Number(r),isNaN(r)?"":new Intl.NumberFormat(this.lang(),a).format(r)}relativeTime(r,a,o){return new Intl.RelativeTimeFormat(this.lang(),o).format(r,a)}};var io={$code:"en",$name:"English",$dir:"ltr",carousel:"Carousel",clearEntry:"Clear entry",close:"Close",copied:"Copied",copy:"Copy",currentValue:"Current value",error:"Error",goToSlide:(i,r)=>`Go to slide ${i} of ${r}`,hidePassword:"Hide password",loading:"Loading",nextSlide:"Next slide",numOptionsSelected:i=>i===0?"No options selected":i===1?"1 option selected":`${i} options selected`,pauseAnimation:"Pause animation",playAnimation:"Play animation",previousSlide:"Previous slide",progress:"Progress",remove:"Remove",resize:"Resize",scrollableRegion:"Scrollable region",scrollToEnd:"Scroll to end",scrollToStart:"Scroll to start",selectAColorFromTheScreen:"Select a color from the screen",showPassword:"Show password",slideNum:i=>`Slide ${i}`,toggleColorFormat:"Toggle color format",zoomIn:"Zoom in",zoomOut:"Zoom out"};ro(io);var vs=io;var Kn=class extends ms{};ro(vs);var ys=Object.defineProperty,ws=Object.getOwnPropertyDescriptor,oo=i=>{throw TypeError(i)},he=(i,r,a,o)=>{for(var u=o>1?void 0:o?ws(r,a):r,l=i.length-1,h;l>=0;l--)(h=i[l])&&(u=(o?h(r,a,u):h(u))||u);return o&&u&&ys(r,a,u),u},so=(i,r,a)=>r.has(i)||oo("Cannot "+a),bs=(i,r,a)=>(so(i,r,"read from private field"),r.get(i)),_s=(i,r,a)=>r.has(i)?oo("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(i):r.set(i,a),Ss=(i,r,a,o)=>(so(i,r,"write to private field"),r.set(i,a),a);const Mr=globalThis,$n=Mr.ShadowRoot&&(Mr.ShadyCSS===void 0||Mr.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Vn=Symbol(),yi=new WeakMap;let ao=class{constructor(r,a,o){if(this._$cssResult$=!0,o!==Vn)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=r,this.t=a}get styleSheet(){let r=this.o;const a=this.t;if($n&&r===void 0){const o=a!==void 0&&a.length===1;o&&(r=yi.get(a)),r===void 0&&((this.o=r=new CSSStyleSheet).replaceSync(this.cssText),o&&yi.set(a,r))}return r}toString(){return this.cssText}};const uo=i=>new ao(typeof i=="string"?i:i+"",void 0,Vn),Gr=(i,...r)=>{const a=i.length===1?i[0]:r.reduce(((o,u,l)=>o+(h=>{if(h._$cssResult$===!0)return h.cssText;if(typeof h=="number")return h;throw Error("Value passed to 'css' function must be a 'css' function result: "+h+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(u)+i[l+1]),i[0]);return new ao(a,i,Vn)},Es=(i,r)=>{if($n)i.adoptedStyleSheets=r.map((a=>a instanceof CSSStyleSheet?a:a.styleSheet));else for(const a of r){const o=document.createElement("style"),u=Mr.litNonce;u!==void 0&&o.setAttribute("nonce",u),o.textContent=a.cssText,i.appendChild(o)}},wi=$n?i=>i:i=>i instanceof CSSStyleSheet?(r=>{let a="";for(const o of r.cssRules)a+=o.cssText;return uo(a)})(i):i;const{is:Fs,defineProperty:As,getOwnPropertyDescriptor:xs,getOwnPropertyNames:ks,getOwnPropertySymbols:Cs,getPrototypeOf:Ps}=Object,Yr=globalThis,bi=Yr.trustedTypes,Ts=bi?bi.emptyScript:"",Is=Yr.reactiveElementPolyfillSupport,br=(i,r)=>i,$r={toAttribute(i,r){switch(r){case Boolean:i=i?Ts:null;break;case Object:case Array:i=i==null?i:JSON.stringify(i)}return i},fromAttribute(i,r){let a=i;switch(r){case Boolean:a=i!==null;break;case Number:a=i===null?null:Number(i);break;case Object:case Array:try{a=JSON.parse(i)}catch{a=null}}return a}},qn=(i,r)=>!Fs(i,r),_i={attribute:!0,type:String,converter:$r,reflect:!1,useDefault:!1,hasChanged:qn};Symbol.metadata??=Symbol("metadata"),Yr.litPropertyMetadata??=new WeakMap;let tr=class extends HTMLElement{static addInitializer(r){this._$Ei(),(this.l??=[]).push(r)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(r,a=_i){if(a.state&&(a.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(r)&&((a=Object.create(a)).wrapped=!0),this.elementProperties.set(r,a),!a.noAccessor){const o=Symbol(),u=this.getPropertyDescriptor(r,o,a);u!==void 0&&As(this.prototype,r,u)}}static getPropertyDescriptor(r,a,o){const{get:u,set:l}=xs(this.prototype,r)??{get(){return this[a]},set(h){this[a]=h}};return{get:u,set(h){const _=u?.call(this);l?.call(this,h),this.requestUpdate(r,_,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(r){return this.elementProperties.get(r)??_i}static _$Ei(){if(this.hasOwnProperty(br("elementProperties")))return;const r=Ps(this);r.finalize(),r.l!==void 0&&(this.l=[...r.l]),this.elementProperties=new Map(r.elementProperties)}static finalize(){if(this.hasOwnProperty(br("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(br("properties"))){const a=this.properties,o=[...ks(a),...Cs(a)];for(const u of o)this.createProperty(u,a[u])}const r=this[Symbol.metadata];if(r!==null){const a=litPropertyMetadata.get(r);if(a!==void 0)for(const[o,u]of a)this.elementProperties.set(o,u)}this._$Eh=new Map;for(const[a,o]of this.elementProperties){const u=this._$Eu(a,o);u!==void 0&&this._$Eh.set(u,a)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(r){const a=[];if(Array.isArray(r)){const o=new Set(r.flat(1/0).reverse());for(const u of o)a.unshift(wi(u))}else r!==void 0&&a.push(wi(r));return a}static _$Eu(r,a){const o=a.attribute;return o===!1?void 0:typeof o=="string"?o:typeof r=="string"?r.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((r=>this.enableUpdating=r)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((r=>r(this)))}addController(r){(this._$EO??=new Set).add(r),this.renderRoot!==void 0&&this.isConnected&&r.hostConnected?.()}removeController(r){this._$EO?.delete(r)}_$E_(){const r=new Map,a=this.constructor.elementProperties;for(const o of a.keys())this.hasOwnProperty(o)&&(r.set(o,this[o]),delete this[o]);r.size>0&&(this._$Ep=r)}createRenderRoot(){const r=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Es(r,this.constructor.elementStyles),r}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((r=>r.hostConnected?.()))}enableUpdating(r){}disconnectedCallback(){this._$EO?.forEach((r=>r.hostDisconnected?.()))}attributeChangedCallback(r,a,o){this._$AK(r,o)}_$ET(r,a){const o=this.constructor.elementProperties.get(r),u=this.constructor._$Eu(r,o);if(u!==void 0&&o.reflect===!0){const l=(o.converter?.toAttribute!==void 0?o.converter:$r).toAttribute(a,o.type);this._$Em=r,l==null?this.removeAttribute(u):this.setAttribute(u,l),this._$Em=null}}_$AK(r,a){const o=this.constructor,u=o._$Eh.get(r);if(u!==void 0&&this._$Em!==u){const l=o.getPropertyOptions(u),h=typeof l.converter=="function"?{fromAttribute:l.converter}:l.converter?.fromAttribute!==void 0?l.converter:$r;this._$Em=u;const _=h.fromAttribute(a,l.type);this[u]=_??this._$Ej?.get(u)??_,this._$Em=null}}requestUpdate(r,a,o){if(r!==void 0){const u=this.constructor,l=this[r];if(o??=u.getPropertyOptions(r),!((o.hasChanged??qn)(l,a)||o.useDefault&&o.reflect&&l===this._$Ej?.get(r)&&!this.hasAttribute(u._$Eu(r,o))))return;this.C(r,a,o)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(r,a,{useDefault:o,reflect:u,wrapped:l},h){o&&!(this._$Ej??=new Map).has(r)&&(this._$Ej.set(r,h??a??this[r]),l!==!0||h!==void 0)||(this._$AL.has(r)||(this.hasUpdated||o||(a=void 0),this._$AL.set(r,a)),u===!0&&this._$Em!==r&&(this._$Eq??=new Set).add(r))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(a){Promise.reject(a)}const r=this.scheduleUpdate();return r!=null&&await r,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[u,l]of this._$Ep)this[u]=l;this._$Ep=void 0}const o=this.constructor.elementProperties;if(o.size>0)for(const[u,l]of o){const{wrapped:h}=l,_=this[u];h!==!0||this._$AL.has(u)||_===void 0||this.C(u,void 0,l,_)}}let r=!1;const a=this._$AL;try{r=this.shouldUpdate(a),r?(this.willUpdate(a),this._$EO?.forEach((o=>o.hostUpdate?.())),this.update(a)):this._$EM()}catch(o){throw r=!1,this._$EM(),o}r&&this._$AE(a)}willUpdate(r){}_$AE(r){this._$EO?.forEach((a=>a.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(r)),this.updated(r)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(r){return!0}update(r){this._$Eq&&=this._$Eq.forEach((a=>this._$ET(a,this[a]))),this._$EM()}updated(r){}firstUpdated(r){}};tr.elementStyles=[],tr.shadowRootOptions={mode:"open"},tr[br("elementProperties")]=new Map,tr[br("finalized")]=new Map,Is?.({ReactiveElement:tr}),(Yr.reactiveElementVersions??=[]).push("2.1.1");const Wn=globalThis,Vr=Wn.trustedTypes,Si=Vr?Vr.createPolicy("lit-html",{createHTML:i=>i}):void 0,co="$lit$",Ht=`lit$${Math.random().toFixed(9).slice(2)}$`,lo="?"+Ht,Rs=`<${lo}>`,zt=document,Sr=()=>zt.createComment(""),Er=i=>i===null||typeof i!="object"&&typeof i!="function",Jn=Array.isArray,Ls=i=>Jn(i)||typeof i?.[Symbol.iterator]=="function",ln=`[ 	
\f\r]`,mr=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ei=/-->/g,Fi=/>/g,$t=RegExp(`>|${ln}(?:([^\\s"'>=/]+)(${ln}*=${ln}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Ai=/'/g,xi=/"/g,ho=/^(?:script|style|textarea|title)$/i,Us=i=>(r,...a)=>({_$litType$:i,strings:r,values:a}),Me=Us(1),Mt=Symbol.for("lit-noChange"),Oe=Symbol.for("lit-nothing"),ki=new WeakMap,Wt=zt.createTreeWalker(zt,129);function fo(i,r){if(!Jn(i)||!i.hasOwnProperty("raw"))throw Error("invalid template strings array");return Si!==void 0?Si.createHTML(r):r}const Ds=(i,r)=>{const a=i.length-1,o=[];let u,l=r===2?"<svg>":r===3?"<math>":"",h=mr;for(let _=0;_<a;_++){const y=i[_];let f,p,d=-1,S=0;for(;S<y.length&&(h.lastIndex=S,p=h.exec(y),p!==null);)S=h.lastIndex,h===mr?p[1]==="!--"?h=Ei:p[1]!==void 0?h=Fi:p[2]!==void 0?(ho.test(p[2])&&(u=RegExp("</"+p[2],"g")),h=$t):p[3]!==void 0&&(h=$t):h===$t?p[0]===">"?(h=u??mr,d=-1):p[1]===void 0?d=-2:(d=h.lastIndex-p[2].length,f=p[1],h=p[3]===void 0?$t:p[3]==='"'?xi:Ai):h===xi||h===Ai?h=$t:h===Ei||h===Fi?h=mr:(h=$t,u=void 0);const P=h===$t&&i[_+1].startsWith("/>")?" ":"";l+=h===mr?y+Rs:d>=0?(o.push(f),y.slice(0,d)+co+y.slice(d)+Ht+P):y+Ht+(d===-2?_:P)}return[fo(i,l+(i[a]||"<?>")+(r===2?"</svg>":r===3?"</math>":"")),o]};class Fr{constructor({strings:r,_$litType$:a},o){let u;this.parts=[];let l=0,h=0;const _=r.length-1,y=this.parts,[f,p]=Ds(r,a);if(this.el=Fr.createElement(f,o),Wt.currentNode=this.el.content,a===2||a===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(u=Wt.nextNode())!==null&&y.length<_;){if(u.nodeType===1){if(u.hasAttributes())for(const d of u.getAttributeNames())if(d.endsWith(co)){const S=p[h++],P=u.getAttribute(d).split(Ht),x=/([.?@])?(.*)/.exec(S);y.push({type:1,index:l,name:x[2],strings:P,ctor:x[1]==="."?Ns:x[1]==="?"?Hs:x[1]==="@"?Ms:Xr}),u.removeAttribute(d)}else d.startsWith(Ht)&&(y.push({type:6,index:l}),u.removeAttribute(d));if(ho.test(u.tagName)){const d=u.textContent.split(Ht),S=d.length-1;if(S>0){u.textContent=Vr?Vr.emptyScript:"";for(let P=0;P<S;P++)u.append(d[P],Sr()),Wt.nextNode(),y.push({type:2,index:++l});u.append(d[S],Sr())}}}else if(u.nodeType===8)if(u.data===lo)y.push({type:2,index:l});else{let d=-1;for(;(d=u.data.indexOf(Ht,d+1))!==-1;)y.push({type:7,index:l}),d+=Ht.length-1}l++}}static createElement(r,a){const o=zt.createElement("template");return o.innerHTML=r,o}}function ir(i,r,a=i,o){if(r===Mt)return r;let u=o!==void 0?a._$Co?.[o]:a._$Cl;const l=Er(r)?void 0:r._$litDirective$;return u?.constructor!==l&&(u?._$AO?.(!1),l===void 0?u=void 0:(u=new l(i),u._$AT(i,a,o)),o!==void 0?(a._$Co??=[])[o]=u:a._$Cl=u),u!==void 0&&(r=ir(i,u._$AS(i,r.values),u,o)),r}class Os{constructor(r,a){this._$AV=[],this._$AN=void 0,this._$AD=r,this._$AM=a}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(r){const{el:{content:a},parts:o}=this._$AD,u=(r?.creationScope??zt).importNode(a,!0);Wt.currentNode=u;let l=Wt.nextNode(),h=0,_=0,y=o[0];for(;y!==void 0;){if(h===y.index){let f;y.type===2?f=new Cr(l,l.nextSibling,this,r):y.type===1?f=new y.ctor(l,y.name,y.strings,this,r):y.type===6&&(f=new Bs(l,this,r)),this._$AV.push(f),y=o[++_]}h!==y?.index&&(l=Wt.nextNode(),h++)}return Wt.currentNode=zt,u}p(r){let a=0;for(const o of this._$AV)o!==void 0&&(o.strings!==void 0?(o._$AI(r,o,a),a+=o.strings.length-2):o._$AI(r[a])),a++}}class Cr{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(r,a,o,u){this.type=2,this._$AH=Oe,this._$AN=void 0,this._$AA=r,this._$AB=a,this._$AM=o,this.options=u,this._$Cv=u?.isConnected??!0}get parentNode(){let r=this._$AA.parentNode;const a=this._$AM;return a!==void 0&&r?.nodeType===11&&(r=a.parentNode),r}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(r,a=this){r=ir(this,r,a),Er(r)?r===Oe||r==null||r===""?(this._$AH!==Oe&&this._$AR(),this._$AH=Oe):r!==this._$AH&&r!==Mt&&this._(r):r._$litType$!==void 0?this.$(r):r.nodeType!==void 0?this.T(r):Ls(r)?this.k(r):this._(r)}O(r){return this._$AA.parentNode.insertBefore(r,this._$AB)}T(r){this._$AH!==r&&(this._$AR(),this._$AH=this.O(r))}_(r){this._$AH!==Oe&&Er(this._$AH)?this._$AA.nextSibling.data=r:this.T(zt.createTextNode(r)),this._$AH=r}$(r){const{values:a,_$litType$:o}=r,u=typeof o=="number"?this._$AC(r):(o.el===void 0&&(o.el=Fr.createElement(fo(o.h,o.h[0]),this.options)),o);if(this._$AH?._$AD===u)this._$AH.p(a);else{const l=new Os(u,this),h=l.u(this.options);l.p(a),this.T(h),this._$AH=l}}_$AC(r){let a=ki.get(r.strings);return a===void 0&&ki.set(r.strings,a=new Fr(r)),a}k(r){Jn(this._$AH)||(this._$AH=[],this._$AR());const a=this._$AH;let o,u=0;for(const l of r)u===a.length?a.push(o=new Cr(this.O(Sr()),this.O(Sr()),this,this.options)):o=a[u],o._$AI(l),u++;u<a.length&&(this._$AR(o&&o._$AB.nextSibling,u),a.length=u)}_$AR(r=this._$AA.nextSibling,a){for(this._$AP?.(!1,!0,a);r!==this._$AB;){const o=r.nextSibling;r.remove(),r=o}}setConnected(r){this._$AM===void 0&&(this._$Cv=r,this._$AP?.(r))}}class Xr{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(r,a,o,u,l){this.type=1,this._$AH=Oe,this._$AN=void 0,this.element=r,this.name=a,this._$AM=u,this.options=l,o.length>2||o[0]!==""||o[1]!==""?(this._$AH=Array(o.length-1).fill(new String),this.strings=o):this._$AH=Oe}_$AI(r,a=this,o,u){const l=this.strings;let h=!1;if(l===void 0)r=ir(this,r,a,0),h=!Er(r)||r!==this._$AH&&r!==Mt,h&&(this._$AH=r);else{const _=r;let y,f;for(r=l[0],y=0;y<l.length-1;y++)f=ir(this,_[o+y],a,y),f===Mt&&(f=this._$AH[y]),h||=!Er(f)||f!==this._$AH[y],f===Oe?r=Oe:r!==Oe&&(r+=(f??"")+l[y+1]),this._$AH[y]=f}h&&!u&&this.j(r)}j(r){r===Oe?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,r??"")}}class Ns extends Xr{constructor(){super(...arguments),this.type=3}j(r){this.element[this.name]=r===Oe?void 0:r}}class Hs extends Xr{constructor(){super(...arguments),this.type=4}j(r){this.element.toggleAttribute(this.name,!!r&&r!==Oe)}}class Ms extends Xr{constructor(r,a,o,u,l){super(r,a,o,u,l),this.type=5}_$AI(r,a=this){if((r=ir(this,r,a,0)??Oe)===Mt)return;const o=this._$AH,u=r===Oe&&o!==Oe||r.capture!==o.capture||r.once!==o.once||r.passive!==o.passive,l=r!==Oe&&(o===Oe||u);u&&this.element.removeEventListener(this.name,this,o),l&&this.element.addEventListener(this.name,this,r),this._$AH=r}handleEvent(r){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,r):this._$AH.handleEvent(r)}}class Bs{constructor(r,a,o){this.element=r,this.type=6,this._$AN=void 0,this._$AM=a,this.options=o}get _$AU(){return this._$AM._$AU}_$AI(r){ir(this,r)}}const js=Wn.litHtmlPolyfillSupport;js?.(Fr,Cr),(Wn.litHtmlVersions??=[]).push("3.3.1");const Ks=(i,r,a)=>{const o=a?.renderBefore??r;let u=o._$litPart$;if(u===void 0){const l=a?.renderBefore??null;o._$litPart$=u=new Cr(r.insertBefore(Sr(),l),l,void 0,a??{})}return u._$AI(i),u};const zn=globalThis;let vt=class extends tr{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const r=super.createRenderRoot();return this.renderOptions.renderBefore??=r.firstChild,r}update(r){const a=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(r),this._$Do=Ks(a,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Mt}};vt._$litElement$=!0,vt.finalized=!0,zn.litElementHydrateSupport?.({LitElement:vt});const $s=zn.litElementPolyfillSupport;$s?.({LitElement:vt});(zn.litElementVersions??=[]).push("4.2.1");const Et=i=>(r,a)=>{a!==void 0?a.addInitializer((()=>{customElements.define(i,r)})):customElements.define(i,r)};const Vs={attribute:!0,type:String,converter:$r,reflect:!1,hasChanged:qn},qs=(i=Vs,r,a)=>{const{kind:o,metadata:u}=a;let l=globalThis.litPropertyMetadata.get(u);if(l===void 0&&globalThis.litPropertyMetadata.set(u,l=new Map),o==="setter"&&((i=Object.create(i)).wrapped=!0),l.set(a.name,i),o==="accessor"){const{name:h}=a;return{set(_){const y=r.get.call(this);r.set.call(this,_),this.requestUpdate(h,y,i)},init(_){return _!==void 0&&this.C(h,void 0,i,_),_}}}if(o==="setter"){const{name:h}=a;return function(_){const y=this[h];r.call(this,_),this.requestUpdate(h,y,i)}}throw Error("Unsupported decorator location: "+o)};function pe(i){return(r,a)=>typeof a=="object"?qs(i,r,a):((o,u,l)=>{const h=u.hasOwnProperty(l);return u.constructor.createProperty(l,o),h?Object.getOwnPropertyDescriptor(u,l):void 0})(i,r,a)}function Qr(i){return pe({...i,state:!0,attribute:!1})}const Ws=(i,r,a)=>(a.configurable=!0,a.enumerable=!0,Reflect.decorate&&typeof r!="object"&&Object.defineProperty(i,r,a),a);function Zr(i,r){return(a,o,u)=>{const l=h=>h.renderRoot?.querySelector(i)??null;return Ws(a,o,{get(){return l(this)}})}}var Js=`:host {
  box-sizing: border-box !important;
}

:host *,
:host *::before,
:host *::after {
  box-sizing: inherit !important;
}

[hidden] {
  display: none !important;
}
`,Br,Gt=class extends vt{constructor(){super(),_s(this,Br,!1),this.initialReflectedProperties=new Map,this.didSSR=!!this.shadowRoot,this.customStates={set:(r,a)=>{if(this.internals?.states)try{a?this.internals.states.add(r):this.internals.states.delete(r)}catch(o){if(String(o).includes("must start with '--'"))console.error("Your browser implements an outdated version of CustomStateSet. Consider using a polyfill");else throw o}},has:r=>{if(!this.internals?.states)return!1;try{return this.internals.states.has(r)}catch{return!1}}};try{this.internals=this.attachInternals()}catch{console.error("Element internals are not supported in your browser. Consider using a polyfill")}this.customStates.set("wa-defined",!0);let i=this.constructor;for(let[r,a]of i.elementProperties)a.default==="inherit"&&a.initial!==void 0&&typeof r=="string"&&this.customStates.set(`initial-${r}-${a.initial}`,!0)}static get styles(){const i=Array.isArray(this.css)?this.css:this.css?[this.css]:[];return[Js,...i].map(r=>typeof r=="string"?uo(r):r)}attributeChangedCallback(i,r,a){bs(this,Br)||(this.constructor.elementProperties.forEach((o,u)=>{o.reflect&&this[u]!=null&&this.initialReflectedProperties.set(u,this[u])}),Ss(this,Br,!0)),super.attributeChangedCallback(i,r,a)}willUpdate(i){super.willUpdate(i),this.initialReflectedProperties.forEach((r,a)=>{i.has(a)&&this[a]==null&&(this[a]=r)})}firstUpdated(i){super.firstUpdated(i),this.didSSR&&this.shadowRoot?.querySelectorAll("slot").forEach(r=>{r.dispatchEvent(new Event("slotchange",{bubbles:!0,composed:!1,cancelable:!1}))})}update(i){try{super.update(i)}catch(r){if(this.didSSR&&!this.hasUpdated){const a=new Event("lit-hydration-error",{bubbles:!0,composed:!0,cancelable:!1});a.error=r,this.dispatchEvent(a)}throw r}}relayNativeEvent(i,r){i.stopImmediatePropagation(),this.dispatchEvent(new i.constructor(i.type,{...i,...r}))}};Br=new WeakMap;he([pe()],Gt.prototype,"dir",2);he([pe()],Gt.prototype,"lang",2);he([pe({type:Boolean,reflect:!0,attribute:"did-ssr"})],Gt.prototype,"didSSR",2);var zs=`:host {
  --track-width: 2px;
  --track-color: var(--wa-color-neutral-fill-normal);
  --indicator-color: var(--wa-color-brand-fill-loud);
  --speed: 2s;

  /* Resizing a spinner element using anything but font-size will break the animation because the animation uses em units.
   Therefore, if a spinner is used in a flex container without \`flex: none\` applied, the spinner can grow/shrink and
   break the animation. The use of \`flex: none\` on the host element prevents this by always having the spinner sized
   according to its actual dimensions.
  */
  flex: none;
  display: inline-flex;
  width: 1em;
  height: 1em;
}

svg {
  width: 100%;
  height: 100%;
  aspect-ratio: 1;
  animation: spin var(--speed) linear infinite;
}

.track {
  stroke: var(--track-color);
}

.indicator {
  stroke: var(--indicator-color);
  stroke-dasharray: 75, 100;
  stroke-dashoffset: -5;
  animation: dash 1.5s ease-in-out infinite;
  stroke-linecap: round;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

@keyframes dash {
  0% {
    stroke-dasharray: 1, 150;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -35;
  }
  100% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -124;
  }
}
`,An=class extends Gt{constructor(){super(...arguments),this.localize=new Kn(this)}render(){return Me`
      <svg
        part="base"
        role="progressbar"
        aria-label=${this.localize.term("loading")}
        fill="none"
        viewBox="0 0 50 50"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle class="track" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
        <circle class="indicator" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
      </svg>
    `}};An.css=zs;An=he([Et("wa-spinner")],An);const sr=crypto,Gn=i=>i instanceof CryptoKey,Ct=new TextEncoder,or=new TextDecoder;function po(...i){const r=i.reduce((u,{length:l})=>u+l,0),a=new Uint8Array(r);let o=0;for(const u of i)a.set(u,o),o+=u.length;return a}const Gs=i=>{let r=i;typeof r=="string"&&(r=Ct.encode(r));const a=32768,o=[];for(let u=0;u<r.length;u+=a)o.push(String.fromCharCode.apply(null,r.subarray(u,u+a)));return btoa(o.join(""))},jr=i=>Gs(i).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),Ys=i=>{const r=atob(i),a=new Uint8Array(r.length);for(let o=0;o<r.length;o++)a[o]=r.charCodeAt(o);return a},Jt=i=>{let r=i;r instanceof Uint8Array&&(r=or.decode(r)),r=r.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return Ys(r)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}};class Xe extends Error{constructor(r,a){super(r,a),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}Xe.code="ERR_JOSE_GENERIC";class St extends Xe{constructor(r,a,o="unspecified",u="unspecified"){super(r,{cause:{claim:o,reason:u,payload:a}}),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=o,this.reason=u,this.payload=a}}St.code="ERR_JWT_CLAIM_VALIDATION_FAILED";class xn extends Xe{constructor(r,a,o="unspecified",u="unspecified"){super(r,{cause:{claim:o,reason:u,payload:a}}),this.code="ERR_JWT_EXPIRED",this.claim=o,this.reason=u,this.payload=a}}xn.code="ERR_JWT_EXPIRED";class go extends Xe{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}}go.code="ERR_JOSE_ALG_NOT_ALLOWED";class ht extends Xe{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}}ht.code="ERR_JOSE_NOT_SUPPORTED";class Xs extends Xe{constructor(r="decryption operation failed",a){super(r,a),this.code="ERR_JWE_DECRYPTION_FAILED"}}Xs.code="ERR_JWE_DECRYPTION_FAILED";class Qs extends Xe{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}}Qs.code="ERR_JWE_INVALID";class Re extends Xe{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}}Re.code="ERR_JWS_INVALID";class en extends Xe{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}}en.code="ERR_JWT_INVALID";class Zs extends Xe{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}}Zs.code="ERR_JWK_INVALID";class Yn extends Xe{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}}Yn.code="ERR_JWKS_INVALID";class Xn extends Xe{constructor(r="no applicable key found in the JSON Web Key Set",a){super(r,a),this.code="ERR_JWKS_NO_MATCHING_KEY"}}Xn.code="ERR_JWKS_NO_MATCHING_KEY";class mo extends Xe{constructor(r="multiple matching keys found in the JSON Web Key Set",a){super(r,a),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS"}}mo.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";class vo extends Xe{constructor(r="request timed out",a){super(r,a),this.code="ERR_JWKS_TIMEOUT"}}vo.code="ERR_JWKS_TIMEOUT";class yo extends Xe{constructor(r="signature verification failed",a){super(r,a),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}yo.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";function xt(i,r="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${r} must be ${i}`)}function vr(i,r){return i.name===r}function hn(i){return parseInt(i.name.slice(4),10)}function ea(i){switch(i){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function ta(i,r){if(r.length&&!r.some(a=>i.usages.includes(a))){let a="CryptoKey does not support this operation, its usages must include ";if(r.length>2){const o=r.pop();a+=`one of ${r.join(", ")}, or ${o}.`}else r.length===2?a+=`one of ${r[0]} or ${r[1]}.`:a+=`${r[0]}.`;throw new TypeError(a)}}function ra(i,r,...a){switch(r){case"HS256":case"HS384":case"HS512":{if(!vr(i.algorithm,"HMAC"))throw xt("HMAC");const o=parseInt(r.slice(2),10);if(hn(i.algorithm.hash)!==o)throw xt(`SHA-${o}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!vr(i.algorithm,"RSASSA-PKCS1-v1_5"))throw xt("RSASSA-PKCS1-v1_5");const o=parseInt(r.slice(2),10);if(hn(i.algorithm.hash)!==o)throw xt(`SHA-${o}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!vr(i.algorithm,"RSA-PSS"))throw xt("RSA-PSS");const o=parseInt(r.slice(2),10);if(hn(i.algorithm.hash)!==o)throw xt(`SHA-${o}`,"algorithm.hash");break}case"EdDSA":{if(i.algorithm.name!=="Ed25519"&&i.algorithm.name!=="Ed448")throw xt("Ed25519 or Ed448");break}case"Ed25519":{if(!vr(i.algorithm,"Ed25519"))throw xt("Ed25519");break}case"ES256":case"ES384":case"ES512":{if(!vr(i.algorithm,"ECDSA"))throw xt("ECDSA");const o=ea(r);if(i.algorithm.namedCurve!==o)throw xt(o,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}ta(i,a)}function wo(i,r,...a){if(a=a.filter(Boolean),a.length>2){const o=a.pop();i+=`one of type ${a.join(", ")}, or ${o}.`}else a.length===2?i+=`one of type ${a[0]} or ${a[1]}.`:i+=`of type ${a[0]}.`;return r==null?i+=` Received ${r}`:typeof r=="function"&&r.name?i+=` Received function ${r.name}`:typeof r=="object"&&r!=null&&r.constructor?.name&&(i+=` Received an instance of ${r.constructor.name}`),i}const kn=(i,...r)=>wo("Key must be ",i,...r);function bo(i,r,...a){return wo(`Key for the ${i} algorithm must be `,r,...a)}const _o=i=>Gn(i)?!0:i?.[Symbol.toStringTag]==="KeyObject",Ar=["CryptoKey"],So=(...i)=>{const r=i.filter(Boolean);if(r.length===0||r.length===1)return!0;let a;for(const o of r){const u=Object.keys(o);if(!a||a.size===0){a=new Set(u);continue}for(const l of u){if(a.has(l))return!1;a.add(l)}}return!0};function na(i){return typeof i=="object"&&i!==null}function Ut(i){if(!na(i)||Object.prototype.toString.call(i)!=="[object Object]")return!1;if(Object.getPrototypeOf(i)===null)return!0;let r=i;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(i)===r}const Eo=(i,r)=>{if(i.startsWith("RS")||i.startsWith("PS")){const{modulusLength:a}=r.algorithm;if(typeof a!="number"||a<2048)throw new TypeError(`${i} requires key modulusLength to be 2048 bits or larger`)}};function ar(i){return Ut(i)&&typeof i.kty=="string"}function ia(i){return i.kty!=="oct"&&typeof i.d=="string"}function oa(i){return i.kty!=="oct"&&typeof i.d>"u"}function sa(i){return ar(i)&&i.kty==="oct"&&typeof i.k=="string"}function aa(i){let r,a;switch(i.kty){case"RSA":{switch(i.alg){case"PS256":case"PS384":case"PS512":r={name:"RSA-PSS",hash:`SHA-${i.alg.slice(-3)}`},a=i.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":r={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${i.alg.slice(-3)}`},a=i.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":r={name:"RSA-OAEP",hash:`SHA-${parseInt(i.alg.slice(-3),10)||1}`},a=i.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new ht('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(i.alg){case"ES256":r={name:"ECDSA",namedCurve:"P-256"},a=i.d?["sign"]:["verify"];break;case"ES384":r={name:"ECDSA",namedCurve:"P-384"},a=i.d?["sign"]:["verify"];break;case"ES512":r={name:"ECDSA",namedCurve:"P-521"},a=i.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":r={name:"ECDH",namedCurve:i.crv},a=i.d?["deriveBits"]:[];break;default:throw new ht('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(i.alg){case"Ed25519":r={name:"Ed25519"},a=i.d?["sign"]:["verify"];break;case"EdDSA":r={name:i.crv},a=i.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":r={name:i.crv},a=i.d?["deriveBits"]:[];break;default:throw new ht('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new ht('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:r,keyUsages:a}}const Fo=async i=>{if(!i.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');const{algorithm:r,keyUsages:a}=aa(i),o=[r,i.ext??!1,i.key_ops??a],u={...i};return delete u.alg,delete u.use,sr.subtle.importKey("jwk",u,...o)},Ao=i=>Jt(i);let Zt,er;const xo=i=>i?.[Symbol.toStringTag]==="KeyObject",qr=async(i,r,a,o,u=!1)=>{let l=i.get(r);if(l?.[o])return l[o];const h=await Fo({...a,alg:o});return u&&Object.freeze(r),l?l[o]=h:i.set(r,{[o]:h}),h},ua=(i,r)=>{if(xo(i)){let a=i.export({format:"jwk"});return delete a.d,delete a.dp,delete a.dq,delete a.p,delete a.q,delete a.qi,a.k?Ao(a.k):(er||(er=new WeakMap),qr(er,i,a,r))}return ar(i)?i.k?Jt(i.k):(er||(er=new WeakMap),qr(er,i,i,r,!0)):i},ca=(i,r)=>{if(xo(i)){let a=i.export({format:"jwk"});return a.k?Ao(a.k):(Zt||(Zt=new WeakMap),qr(Zt,i,a,r))}return ar(i)?i.k?Jt(i.k):(Zt||(Zt=new WeakMap),qr(Zt,i,i,r,!0)):i},Ci={normalizePublicKey:ua,normalizePrivateKey:ca};async function ko(i,r){if(!Ut(i))throw new TypeError("JWK must be an object");switch(r||(r=i.alg),i.kty){case"oct":if(typeof i.k!="string"||!i.k)throw new TypeError('missing "k" (Key Value) Parameter value');return Jt(i.k);case"RSA":if("oth"in i&&i.oth!==void 0)throw new ht('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return Fo({...i,alg:r});default:throw new ht('Unsupported "kty" (Key Type) Parameter value')}}const rr=i=>i?.[Symbol.toStringTag],Cn=(i,r,a)=>{if(r.use!==void 0&&r.use!=="sig")throw new TypeError("Invalid key for this operation, when present its use must be sig");if(r.key_ops!==void 0&&r.key_ops.includes?.(a)!==!0)throw new TypeError(`Invalid key for this operation, when present its key_ops must include ${a}`);if(r.alg!==void 0&&r.alg!==i)throw new TypeError(`Invalid key for this operation, when present its alg must be ${i}`);return!0},la=(i,r,a,o)=>{if(!(r instanceof Uint8Array)){if(o&&ar(r)){if(sa(r)&&Cn(i,r,a))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!_o(r))throw new TypeError(bo(i,r,...Ar,"Uint8Array",o?"JSON Web Key":null));if(r.type!=="secret")throw new TypeError(`${rr(r)} instances for symmetric algorithms must be of type "secret"`)}},ha=(i,r,a,o)=>{if(o&&ar(r))switch(a){case"sign":if(ia(r)&&Cn(i,r,a))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(oa(r)&&Cn(i,r,a))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!_o(r))throw new TypeError(bo(i,r,...Ar,o?"JSON Web Key":null));if(r.type==="secret")throw new TypeError(`${rr(r)} instances for asymmetric algorithms must not be of type "secret"`);if(a==="sign"&&r.type==="public")throw new TypeError(`${rr(r)} instances for asymmetric algorithm signing must be of type "private"`);if(a==="decrypt"&&r.type==="public")throw new TypeError(`${rr(r)} instances for asymmetric algorithm decryption must be of type "private"`);if(r.algorithm&&a==="verify"&&r.type==="private")throw new TypeError(`${rr(r)} instances for asymmetric algorithm verifying must be of type "public"`);if(r.algorithm&&a==="encrypt"&&r.type==="private")throw new TypeError(`${rr(r)} instances for asymmetric algorithm encryption must be of type "public"`)};function Co(i,r,a,o){r.startsWith("HS")||r==="dir"||r.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(r)?la(r,a,o,i):ha(r,a,o,i)}Co.bind(void 0,!1);const Pn=Co.bind(void 0,!0);function Po(i,r,a,o,u){if(u.crit!==void 0&&o?.crit===void 0)throw new i('"crit" (Critical) Header Parameter MUST be integrity protected');if(!o||o.crit===void 0)return new Set;if(!Array.isArray(o.crit)||o.crit.length===0||o.crit.some(h=>typeof h!="string"||h.length===0))throw new i('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let l;a!==void 0?l=new Map([...Object.entries(a),...r.entries()]):l=r;for(const h of o.crit){if(!l.has(h))throw new ht(`Extension Header Parameter "${h}" is not recognized`);if(u[h]===void 0)throw new i(`Extension Header Parameter "${h}" is missing`);if(l.get(h)&&o[h]===void 0)throw new i(`Extension Header Parameter "${h}" MUST be integrity protected`)}return new Set(o.crit)}const da=(i,r)=>{if(r!==void 0&&(!Array.isArray(r)||r.some(a=>typeof a!="string")))throw new TypeError(`"${i}" option must be an array of strings`);if(r)return new Set(r)},fa=async i=>{if(i instanceof Uint8Array)return{kty:"oct",k:jr(i)};if(!Gn(i))throw new TypeError(kn(i,...Ar,"Uint8Array"));if(!i.extractable)throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");const{ext:r,key_ops:a,alg:o,use:u,...l}=await sr.subtle.exportKey("jwk",i);return l};async function pa(i){return fa(i)}function To(i,r){const a=`SHA-${i.slice(-3)}`;switch(i){case"HS256":case"HS384":case"HS512":return{hash:a,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:a,name:"RSA-PSS",saltLength:i.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:a,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:a,name:"ECDSA",namedCurve:r.namedCurve};case"Ed25519":return{name:"Ed25519"};case"EdDSA":return{name:r.name};default:throw new ht(`alg ${i} is not supported either by JOSE or your javascript runtime`)}}async function Io(i,r,a){if(a==="sign"&&(r=await Ci.normalizePrivateKey(r,i)),a==="verify"&&(r=await Ci.normalizePublicKey(r,i)),Gn(r))return ra(r,i,a),r;if(r instanceof Uint8Array){if(!i.startsWith("HS"))throw new TypeError(kn(r,...Ar));return sr.subtle.importKey("raw",r,{hash:`SHA-${i.slice(-3)}`,name:"HMAC"},!1,[a])}throw new TypeError(kn(r,...Ar,"Uint8Array","JSON Web Key"))}const ga=async(i,r,a,o)=>{const u=await Io(i,r,"verify");Eo(i,u);const l=To(i,u.algorithm);try{return await sr.subtle.verify(l,u,a,o)}catch{return!1}};async function ma(i,r,a){if(!Ut(i))throw new Re("Flattened JWS must be an object");if(i.protected===void 0&&i.header===void 0)throw new Re('Flattened JWS must have either of the "protected" or "header" members');if(i.protected!==void 0&&typeof i.protected!="string")throw new Re("JWS Protected Header incorrect type");if(i.payload===void 0)throw new Re("JWS Payload missing");if(typeof i.signature!="string")throw new Re("JWS Signature missing or incorrect type");if(i.header!==void 0&&!Ut(i.header))throw new Re("JWS Unprotected Header incorrect type");let o={};if(i.protected)try{const q=Jt(i.protected);o=JSON.parse(or.decode(q))}catch{throw new Re("JWS Protected Header is invalid")}if(!So(o,i.header))throw new Re("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const u={...o,...i.header},l=Po(Re,new Map([["b64",!0]]),a?.crit,o,u);let h=!0;if(l.has("b64")&&(h=o.b64,typeof h!="boolean"))throw new Re('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:_}=u;if(typeof _!="string"||!_)throw new Re('JWS "alg" (Algorithm) Header Parameter missing or invalid');const y=a&&da("algorithms",a.algorithms);if(y&&!y.has(_))throw new go('"alg" (Algorithm) Header Parameter value not allowed');if(h){if(typeof i.payload!="string")throw new Re("JWS Payload must be a string")}else if(typeof i.payload!="string"&&!(i.payload instanceof Uint8Array))throw new Re("JWS Payload must be a string or an Uint8Array instance");let f=!1;typeof r=="function"?(r=await r(o,i),f=!0,Pn(_,r,"verify"),ar(r)&&(r=await ko(r,_))):Pn(_,r,"verify");const p=po(Ct.encode(i.protected??""),Ct.encode("."),typeof i.payload=="string"?Ct.encode(i.payload):i.payload);let d;try{d=Jt(i.signature)}catch{throw new Re("Failed to base64url decode the signature")}if(!await ga(_,r,d,p))throw new yo;let P;if(h)try{P=Jt(i.payload)}catch{throw new Re("Failed to base64url decode the payload")}else typeof i.payload=="string"?P=Ct.encode(i.payload):P=i.payload;const x={payload:P};return i.protected!==void 0&&(x.protectedHeader=o),i.header!==void 0&&(x.unprotectedHeader=i.header),f?{...x,key:r}:x}async function va(i,r,a){if(i instanceof Uint8Array&&(i=or.decode(i)),typeof i!="string")throw new Re("Compact JWS must be a string or Uint8Array");const{0:o,1:u,2:l,length:h}=i.split(".");if(h!==3)throw new Re("Invalid Compact JWS");const _=await ma({payload:u,protected:o,signature:l},r,a),y={payload:_.payload,protectedHeader:_.protectedHeader};return typeof r=="function"?{...y,key:_.key}:y}const Nt=i=>Math.floor(i.getTime()/1e3),Ro=60,Lo=Ro*60,Qn=Lo*24,ya=Qn*7,wa=Qn*365.25,ba=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,_r=i=>{const r=ba.exec(i);if(!r||r[4]&&r[1])throw new TypeError("Invalid time period format");const a=parseFloat(r[2]),o=r[3].toLowerCase();let u;switch(o){case"sec":case"secs":case"second":case"seconds":case"s":u=Math.round(a);break;case"minute":case"minutes":case"min":case"mins":case"m":u=Math.round(a*Ro);break;case"hour":case"hours":case"hr":case"hrs":case"h":u=Math.round(a*Lo);break;case"day":case"days":case"d":u=Math.round(a*Qn);break;case"week":case"weeks":case"w":u=Math.round(a*ya);break;default:u=Math.round(a*wa);break}return r[1]==="-"||r[4]==="ago"?-u:u},Pi=i=>i.toLowerCase().replace(/^application\//,""),_a=(i,r)=>typeof i=="string"?r.includes(i):Array.isArray(i)?r.some(Set.prototype.has.bind(new Set(i))):!1,Sa=(i,r,a={})=>{let o;try{o=JSON.parse(or.decode(r))}catch{}if(!Ut(o))throw new en("JWT Claims Set must be a top-level JSON object");const{typ:u}=a;if(u&&(typeof i.typ!="string"||Pi(i.typ)!==Pi(u)))throw new St('unexpected "typ" JWT header value',o,"typ","check_failed");const{requiredClaims:l=[],issuer:h,subject:_,audience:y,maxTokenAge:f}=a,p=[...l];f!==void 0&&p.push("iat"),y!==void 0&&p.push("aud"),_!==void 0&&p.push("sub"),h!==void 0&&p.push("iss");for(const x of new Set(p.reverse()))if(!(x in o))throw new St(`missing required "${x}" claim`,o,x,"missing");if(h&&!(Array.isArray(h)?h:[h]).includes(o.iss))throw new St('unexpected "iss" claim value',o,"iss","check_failed");if(_&&o.sub!==_)throw new St('unexpected "sub" claim value',o,"sub","check_failed");if(y&&!_a(o.aud,typeof y=="string"?[y]:y))throw new St('unexpected "aud" claim value',o,"aud","check_failed");let d;switch(typeof a.clockTolerance){case"string":d=_r(a.clockTolerance);break;case"number":d=a.clockTolerance;break;case"undefined":d=0;break;default:throw new TypeError("Invalid clockTolerance option type")}const{currentDate:S}=a,P=Nt(S||new Date);if((o.iat!==void 0||f)&&typeof o.iat!="number")throw new St('"iat" claim must be a number',o,"iat","invalid");if(o.nbf!==void 0){if(typeof o.nbf!="number")throw new St('"nbf" claim must be a number',o,"nbf","invalid");if(o.nbf>P+d)throw new St('"nbf" claim timestamp check failed',o,"nbf","check_failed")}if(o.exp!==void 0){if(typeof o.exp!="number")throw new St('"exp" claim must be a number',o,"exp","invalid");if(o.exp<=P-d)throw new xn('"exp" claim timestamp check failed',o,"exp","check_failed")}if(f){const x=P-o.iat,q=typeof f=="number"?f:_r(f);if(x-d>q)throw new xn('"iat" claim timestamp check failed (too far in the past)',o,"iat","check_failed");if(x<0-d)throw new St('"iat" claim timestamp check failed (it should be in the past)',o,"iat","check_failed")}return o};async function Ea(i,r,a){const o=await va(i,r,a);if(o.protectedHeader.crit?.includes("b64")&&o.protectedHeader.b64===!1)throw new en("JWTs MUST NOT use unencoded payload");const l={payload:Sa(o.protectedHeader,o.payload,a),protectedHeader:o.protectedHeader};return typeof r=="function"?{...l,key:o.key}:l}const Fa=async(i,r,a)=>{const o=await Io(i,r,"sign");Eo(i,o);const u=await sr.subtle.sign(To(i,o.algorithm),o,a);return new Uint8Array(u)};class Aa{constructor(r){if(!(r instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=r}setProtectedHeader(r){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=r,this}setUnprotectedHeader(r){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=r,this}async sign(r,a){if(!this._protectedHeader&&!this._unprotectedHeader)throw new Re("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!So(this._protectedHeader,this._unprotectedHeader))throw new Re("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const o={...this._protectedHeader,...this._unprotectedHeader},u=Po(Re,new Map([["b64",!0]]),a?.crit,this._protectedHeader,o);let l=!0;if(u.has("b64")&&(l=this._protectedHeader.b64,typeof l!="boolean"))throw new Re('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:h}=o;if(typeof h!="string"||!h)throw new Re('JWS "alg" (Algorithm) Header Parameter missing or invalid');Pn(h,r,"sign");let _=this._payload;l&&(_=Ct.encode(jr(_)));let y;this._protectedHeader?y=Ct.encode(jr(JSON.stringify(this._protectedHeader))):y=Ct.encode("");const f=po(y,Ct.encode("."),_),p=await Fa(h,r,f),d={signature:jr(p),payload:""};return l&&(d.payload=or.decode(_)),this._unprotectedHeader&&(d.header=this._unprotectedHeader),this._protectedHeader&&(d.protected=or.decode(y)),d}}class xa{constructor(r){this._flattened=new Aa(r)}setProtectedHeader(r){return this._flattened.setProtectedHeader(r),this}async sign(r,a){const o=await this._flattened.sign(r,a);if(o.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${o.protected}.${o.payload}.${o.signature}`}}function Vt(i,r){if(!Number.isFinite(r))throw new TypeError(`Invalid ${i} input`);return r}class ka{constructor(r={}){if(!Ut(r))throw new TypeError("JWT Claims Set MUST be an object");this._payload=r}setIssuer(r){return this._payload={...this._payload,iss:r},this}setSubject(r){return this._payload={...this._payload,sub:r},this}setAudience(r){return this._payload={...this._payload,aud:r},this}setJti(r){return this._payload={...this._payload,jti:r},this}setNotBefore(r){return typeof r=="number"?this._payload={...this._payload,nbf:Vt("setNotBefore",r)}:r instanceof Date?this._payload={...this._payload,nbf:Vt("setNotBefore",Nt(r))}:this._payload={...this._payload,nbf:Nt(new Date)+_r(r)},this}setExpirationTime(r){return typeof r=="number"?this._payload={...this._payload,exp:Vt("setExpirationTime",r)}:r instanceof Date?this._payload={...this._payload,exp:Vt("setExpirationTime",Nt(r))}:this._payload={...this._payload,exp:Nt(new Date)+_r(r)},this}setIssuedAt(r){return typeof r>"u"?this._payload={...this._payload,iat:Nt(new Date)}:r instanceof Date?this._payload={...this._payload,iat:Vt("setIssuedAt",Nt(r))}:typeof r=="string"?this._payload={...this._payload,iat:Vt("setIssuedAt",Nt(new Date)+_r(r))}:this._payload={...this._payload,iat:Vt("setIssuedAt",r)},this}}class Ca extends ka{setProtectedHeader(r){return this._protectedHeader=r,this}async sign(r,a){const o=new xa(Ct.encode(JSON.stringify(this._payload)));if(o.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new en("JWTs MUST NOT use unencoded payload");return o.sign(r,a)}}function Pa(i){switch(typeof i=="string"&&i.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new ht('Unsupported "alg" value for a JSON Web Key Set')}}function Ta(i){return i&&typeof i=="object"&&Array.isArray(i.keys)&&i.keys.every(Ia)}function Ia(i){return Ut(i)}function Uo(i){return typeof structuredClone=="function"?structuredClone(i):JSON.parse(JSON.stringify(i))}class Ra{constructor(r){if(this._cached=new WeakMap,!Ta(r))throw new Yn("JSON Web Key Set malformed");this._jwks=Uo(r)}async getKey(r,a){const{alg:o,kid:u}={...r,...a?.header},l=Pa(o),h=this._jwks.keys.filter(f=>{let p=l===f.kty;if(p&&typeof u=="string"&&(p=u===f.kid),p&&typeof f.alg=="string"&&(p=o===f.alg),p&&typeof f.use=="string"&&(p=f.use==="sig"),p&&Array.isArray(f.key_ops)&&(p=f.key_ops.includes("verify")),p)switch(o){case"ES256":p=f.crv==="P-256";break;case"ES256K":p=f.crv==="secp256k1";break;case"ES384":p=f.crv==="P-384";break;case"ES512":p=f.crv==="P-521";break;case"Ed25519":p=f.crv==="Ed25519";break;case"EdDSA":p=f.crv==="Ed25519"||f.crv==="Ed448";break}return p}),{0:_,length:y}=h;if(y===0)throw new Xn;if(y!==1){const f=new mo,{_cached:p}=this;throw f[Symbol.asyncIterator]=async function*(){for(const d of h)try{yield await Ti(p,d,o)}catch{}},f}return Ti(this._cached,_,o)}}async function Ti(i,r,a){const o=i.get(r)||i.set(r,{}).get(r);if(o[a]===void 0){const u=await ko({...r,ext:!0},a);if(u instanceof Uint8Array||u.type!=="public")throw new Yn("JSON Web Key Set members must be public keys");o[a]=u}return o[a]}function Ii(i){const r=new Ra(i),a=async(o,u)=>r.getKey(o,u);return Object.defineProperties(a,{jwks:{value:()=>Uo(r._jwks),enumerable:!0,configurable:!1,writable:!1}}),a}const La=async(i,r,a)=>{let o,u,l=!1;typeof AbortController=="function"&&(o=new AbortController,u=setTimeout(()=>{l=!0,o.abort()},r));const h=await fetch(i.href,{signal:o?o.signal:void 0,redirect:"manual",headers:a.headers}).catch(_=>{throw l?new vo:_});if(u!==void 0&&clearTimeout(u),h.status!==200)throw new Xe("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await h.json()}catch{throw new Xe("Failed to parse the JSON Web Key Set HTTP response as JSON")}};function Ua(){return typeof WebSocketPair<"u"||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"||typeof EdgeRuntime<"u"&&EdgeRuntime==="vercel"}let Tn;(typeof navigator>"u"||!navigator.userAgent?.startsWith?.("Mozilla/5.0 "))&&(Tn="jose/v5.10.0");const dn=Symbol();function Da(i,r){return!(typeof i!="object"||i===null||!("uat"in i)||typeof i.uat!="number"||Date.now()-i.uat>=r||!("jwks"in i)||!Ut(i.jwks)||!Array.isArray(i.jwks.keys)||!Array.prototype.every.call(i.jwks.keys,Ut))}class Oa{constructor(r,a){if(!(r instanceof URL))throw new TypeError("url must be an instance of URL");this._url=new URL(r.href),this._options={agent:a?.agent,headers:a?.headers},this._timeoutDuration=typeof a?.timeoutDuration=="number"?a?.timeoutDuration:5e3,this._cooldownDuration=typeof a?.cooldownDuration=="number"?a?.cooldownDuration:3e4,this._cacheMaxAge=typeof a?.cacheMaxAge=="number"?a?.cacheMaxAge:6e5,a?.[dn]!==void 0&&(this._cache=a?.[dn],Da(a?.[dn],this._cacheMaxAge)&&(this._jwksTimestamp=this._cache.uat,this._local=Ii(this._cache.jwks)))}coolingDown(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cooldownDuration:!1}fresh(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cacheMaxAge:!1}async getKey(r,a){(!this._local||!this.fresh())&&await this.reload();try{return await this._local(r,a)}catch(o){if(o instanceof Xn&&this.coolingDown()===!1)return await this.reload(),this._local(r,a);throw o}}async reload(){this._pendingFetch&&Ua()&&(this._pendingFetch=void 0);const r=new Headers(this._options.headers);Tn&&!r.has("User-Agent")&&(r.set("User-Agent",Tn),this._options.headers=Object.fromEntries(r.entries())),this._pendingFetch||(this._pendingFetch=La(this._url,this._timeoutDuration,this._options).then(a=>{this._local=Ii(a),this._cache&&(this._cache.uat=Date.now(),this._cache.jwks=a),this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(a=>{throw this._pendingFetch=void 0,a})),await this._pendingFetch}}function Na(i,r){const a=new Oa(i,r),o=async(u,l)=>a.getKey(u,l);return Object.defineProperties(o,{coolingDown:{get:()=>a.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>a.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>a.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>!!a._pendingFetch,enumerable:!0,configurable:!1},jwks:{value:()=>a._local?.jwks(),enumerable:!0,configurable:!1,writable:!1}}),o}function fn(i){const r=i?.modulusLength??2048;if(typeof r!="number"||r<2048)throw new ht("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return r}async function Ha(i,r){let a,o;switch(i){case"PS256":case"PS384":case"PS512":a={name:"RSA-PSS",hash:`SHA-${i.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:fn(r)},o=["sign","verify"];break;case"RS256":case"RS384":case"RS512":a={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${i.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:fn(r)},o=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":a={name:"RSA-OAEP",hash:`SHA-${parseInt(i.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:fn(r)},o=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":a={name:"ECDSA",namedCurve:"P-256"},o=["sign","verify"];break;case"ES384":a={name:"ECDSA",namedCurve:"P-384"},o=["sign","verify"];break;case"ES512":a={name:"ECDSA",namedCurve:"P-521"},o=["sign","verify"];break;case"Ed25519":a={name:"Ed25519"},o=["sign","verify"];break;case"EdDSA":{o=["sign","verify"];const u="Ed25519";switch(u){case"Ed25519":case"Ed448":a={name:u};break;default:throw new ht("Invalid or unsupported crv option provided")}break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{o=["deriveKey","deriveBits"];const u="P-256";switch(u){case"P-256":case"P-384":case"P-521":{a={name:"ECDH",namedCurve:u};break}case"X25519":case"X448":a={name:u};break;default:throw new ht("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}break}default:throw new ht('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return sr.subtle.generateKey(a,!1,o)}async function Ma(i,r){return Ha(i,r)}const Ye=[];for(let i=0;i<256;++i)Ye.push((i+256).toString(16).slice(1));function Ba(i,r=0){return(Ye[i[r+0]]+Ye[i[r+1]]+Ye[i[r+2]]+Ye[i[r+3]]+"-"+Ye[i[r+4]]+Ye[i[r+5]]+"-"+Ye[i[r+6]]+Ye[i[r+7]]+"-"+Ye[i[r+8]]+Ye[i[r+9]]+"-"+Ye[i[r+10]]+Ye[i[r+11]]+Ye[i[r+12]]+Ye[i[r+13]]+Ye[i[r+14]]+Ye[i[r+15]]).toLowerCase()}let pn;const ja=new Uint8Array(16);function Ka(){if(!pn){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");pn=crypto.getRandomValues.bind(crypto)}return pn(ja)}const $a=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ri={randomUUID:$a};function Zn(i,r,a){if(Ri.randomUUID&&!i)return Ri.randomUUID();i=i||{};const o=i.random??i.rng?.()??Ka();if(o.length<16)throw new Error("Random bytes length must be >= 16");return o[6]=o[6]&15|64,o[8]=o[8]&63|128,Ba(o)}const Do="solidClientAuthn:",Wr=["ES256","RS256"],He={ERROR:"error",LOGIN:"login",LOGOUT:"logout",NEW_REFRESH_TOKEN:"newRefreshToken",NEW_TOKENS:"newTokens",AUTHORIZATION_REQUEST:"authorizationRequest",SESSION_EXPIRED:"sessionExpired",SESSION_EXTENDED:"sessionExtended",SESSION_RESTORED:"sessionRestore",TIMEOUT_SET:"timeoutSet"},Li=5,Va="openid",qa="offline_access",Wa="webid",Ui=[Va,qa,Wa];class Ja{handleables;constructor(r){this.handleables=r,this.handleables=r}async getProperHandler(r){const a=await Promise.all(this.handleables.map(o=>o.canHandle(...r)));for(let o=0;o<a.length;o+=1)if(a[o])return this.handleables[o];return null}async canHandle(...r){return await this.getProperHandler(r)!==null}async handle(...r){const a=await this.getProperHandler(r);if(a)return a.handle(...r);throw new Error(`[${this.constructor.name}] cannot find a suitable handler for: ${r.map(o=>{try{return JSON.stringify(o)}catch{return o.toString()}}).join(", ")}`)}}async function Oo(i,r,a,o){let u,l;try{const{payload:h}=await Ea(i,Na(new URL(r)),{issuer:a,audience:o});u=h}catch(h){throw new Error(`Token verification failed: ${h.stack}`)}if(typeof u.azp=="string"&&(l=u.azp),typeof u.webid=="string")return{webId:u.webid,clientId:l};if(typeof u.sub!="string")throw new Error(`The token ${JSON.stringify(u)} is invalid: it has no 'webid' claim and no 'sub' claim.`);try{return new URL(u.sub),{webId:u.sub,clientId:l}}catch(h){throw new Error(`The token has no 'webid' claim, and its 'sub' claim of [${u.sub}] is invalid as a URL - error [${h}].`)}}function za(i){return Array.isArray(i)?Array.from(new Set([...Ui,...i.filter(r=>typeof r=="string"&&!r.includes(" "))])):Ui}function No(i){try{const r=new URL(i),a=!r.searchParams.has("code")&&!r.searchParams.has("state"),o=r.hash==="";return a&&o}catch{return!1}}function Ho(i){const r=new URL(i);return r.searchParams.delete("state"),r.searchParams.delete("code"),r.searchParams.delete("error"),r.searchParams.delete("error_description"),r.searchParams.delete("iss"),r}function Ga(i,r){return typeof i=="boolean"?!!i:!!r}class Ya{storageUtility;redirector;constructor(r,a){this.storageUtility=r,this.redirector=a,this.storageUtility=r,this.redirector=a}parametersGuard=r=>r.issuerConfiguration.grantTypesSupported!==void 0&&r.issuerConfiguration.grantTypesSupported.indexOf("authorization_code")>-1&&r.redirectUrl!==void 0;async canHandle(r){return this.parametersGuard(r)}async setupRedirectHandler({oidcLoginOptions:r,state:a,codeVerifier:o,targetUrl:u}){if(!this.parametersGuard(r))throw new Error("The authorization code grant requires a redirectUrl.");await Promise.all([this.storageUtility.setForUser(a,{sessionId:r.sessionId}),this.storageUtility.setForUser(r.sessionId,{codeVerifier:o,issuer:r.issuer.toString(),redirectUrl:r.redirectUrl,dpop:(!!r.dpop).toString(),keepAlive:Ga(r.keepAlive,!0).toString()})]),this.redirector.redirect(u,{handleRedirect:r.handleRedirect})}}class Xa{sessionInfoManager;constructor(r){this.sessionInfoManager=r,this.sessionInfoManager=r}async canHandle(){return!0}async handle(r){await this.sessionInfoManager.clear(r)}}class Qa{redirector;constructor(r){this.redirector=r,this.redirector=r}async canHandle(r,a){return a?.logoutType==="idp"}async handle(r,a){if(a?.logoutType!=="idp")throw new Error("Attempting to call idp logout handler to perform app logout");if(a.toLogoutUrl===void 0)throw new Error("Cannot perform IDP logout. Did you log in using the OIDC authentication flow?");this.redirector.redirect(a.toLogoutUrl(a),{handleRedirect:a.handleRedirect})}}class Za{handlers;constructor(r,a){this.handlers=[new Xa(r),new Qa(a)]}async canHandle(){return!0}async handle(r,a){for(const o of this.handlers)await o.canHandle(r,a)&&await o.handle(r,a)}}function Mo(){return{isLoggedIn:!1,sessionId:Zn(),fetch:(...i)=>fetch(...i)}}async function Bo(i,r){await Promise.all([r.deleteAllUserData(i,{secure:!1}),r.deleteAllUserData(i,{secure:!0})])}class eu{storageUtility;constructor(r){this.storageUtility=r,this.storageUtility=r}update(r,a){throw new Error("Not Implemented")}set(r,a){throw new Error("Not Implemented")}get(r){throw new Error("Not implemented")}async getAll(){throw new Error("Not implemented")}async clear(r){return Bo(r,this.storageUtility)}async register(r){throw new Error("Not implemented")}async getRegisteredSessionIdAll(){throw new Error("Not implemented")}async clearAll(){throw new Error("Not implemented")}async setOidcContext(r,a){throw new Error("Not implemented")}}function tu({endSessionEndpoint:i,idTokenHint:r,postLogoutRedirectUri:a,state:o}){const u=new URL(i);return r!==void 0&&u.searchParams.append("id_token_hint",r),a!==void 0&&(u.searchParams.append("post_logout_redirect_uri",a),o!==void 0&&u.searchParams.append("state",o)),u.toString()}function ru({endSessionEndpoint:i,idTokenHint:r}){if(i!==void 0)return function({state:o,postLogoutUrl:u}){return tu({endSessionEndpoint:i,idTokenHint:r,state:o,postLogoutRedirectUri:u})}}function nu(i){return typeof i=="string"&&["DPoP","Bearer"].includes(i)}function jo(i){try{return new URL(i),!0}catch{return!1}}function iu(i,r){return r.find(a=>i.includes(a))??null}function ou(i){return i.clientId!==void 0&&!jo(i.clientId)}function su(i,r){return r.scopesSupported.includes("webid")&&i.clientId!==void 0&&jo(i.clientId)}function au(i){return typeof i=="string"&&["dynamic","static","solid-oidc"].includes(i)}async function uu(i,r,a,o){let u;if(su(i,r))u={clientId:i.clientId,clientName:i.clientName,clientType:"solid-oidc"};else if(ou(i))u={clientId:i.clientId,clientSecret:i.clientSecret,clientName:i.clientName,clientType:"static"};else return o.getClient({sessionId:i.sessionId,clientName:i.clientName,redirectUrl:i.redirectUrl},r);const l={clientId:u.clientId,clientType:u.clientType};return u.clientType==="static"&&(l.clientSecret=u.clientSecret),u.clientName&&(l.clientName=u.clientName),await a.setForUser(i.sessionId,l),u}const Di=(i,r)=>fetch(i,r);let cu=class{loginHandler;redirectHandler;logoutHandler;sessionInfoManager;issuerConfigFetcher;boundLogout;constructor(r,a,o,u,l){this.loginHandler=r,this.redirectHandler=a,this.logoutHandler=o,this.sessionInfoManager=u,this.issuerConfigFetcher=l,this.loginHandler=r,this.redirectHandler=a,this.logoutHandler=o,this.sessionInfoManager=u,this.issuerConfigFetcher=l}fetch=Di;logout=async(r,a)=>{await this.logoutHandler.handle(r,a?.logoutType==="idp"?{...a,toLogoutUrl:this.boundLogout}:a),this.fetch=Di,delete this.boundLogout};getSessionInfo=async r=>this.sessionInfoManager.get(r);getAllSessionInfo=async()=>this.sessionInfoManager.getAll()};async function Ko(i,r,a){try{const[o,u,l,h,_]=await Promise.all([r.getForUser(i,"issuer",{errorIfNull:!0}),r.getForUser(i,"codeVerifier"),r.getForUser(i,"redirectUrl"),r.getForUser(i,"dpop",{errorIfNull:!0}),r.getForUser(i,"keepAlive")]);await r.deleteForUser(i,"codeVerifier");const y=await a.fetchConfig(o);return{codeVerifier:u,redirectUrl:l,issuerConfig:y,dpop:h==="true",keepAlive:typeof _=="string"?_==="true":!0}}catch(o){throw new Error(`Failed to retrieve OIDC context from storage associated with session [${i}]: ${o}`)}}async function lu(i,r,a,o,u,l,h,_){a!==void 0&&await i.setForUser(r,{webId:a},{secure:h}),o!==void 0&&await i.setForUser(r,{clientId:o},{secure:h}),await i.setForUser(r,{isLoggedIn:u},{secure:h})}class hu{secureStorage;insecureStorage;constructor(r,a){this.secureStorage=r,this.insecureStorage=a,this.secureStorage=r,this.insecureStorage=a}getKey(r){return`solidClientAuthenticationUser:${r}`}async getUserData(r,a){const o=await(a?this.secureStorage:this.insecureStorage).get(this.getKey(r));if(o===void 0)return{};try{return JSON.parse(o)}catch{throw new Error(`Data for user [${r}] in [${a?"secure":"unsecure"}] storage is corrupted - expected valid JSON, but got: ${o}`)}}async setUserData(r,a,o){await(o?this.secureStorage:this.insecureStorage).set(this.getKey(r),JSON.stringify(a))}async get(r,a){const o=await(a?.secure?this.secureStorage:this.insecureStorage).get(r);if(o===void 0&&a?.errorIfNull)throw new Error(`[${r}] is not stored`);return o}async set(r,a,o){return(o?.secure?this.secureStorage:this.insecureStorage).set(r,a)}async delete(r,a){return(a?.secure?this.secureStorage:this.insecureStorage).delete(r)}async getForUser(r,a,o){const u=await this.getUserData(r,o?.secure);let l;if((!u||!u[a])&&(l=void 0),l=u[a],l===void 0&&o?.errorIfNull)throw new Error(`Field [${a}] for user [${r}] is not stored`);return l||void 0}async setForUser(r,a,o){let u;try{u=await this.getUserData(r,o?.secure)}catch{u={}}await this.setUserData(r,{...u,...a},o?.secure)}async deleteForUser(r,a,o){const u=await this.getUserData(r,o?.secure);delete u[a],await this.setUserData(r,u,o?.secure)}async deleteAllUserData(r,a){await(a?.secure?this.secureStorage:this.insecureStorage).delete(this.getKey(r))}}class du{map={};async get(r){return this.map[r]||void 0}async set(r,a){this.map[r]=a}async delete(r){delete this.map[r]}}class In extends Error{constructor(r){super(r)}}class wr extends Error{missingFields;constructor(r){super(`Invalid response from OIDC provider: missing fields ${r}`),this.missingFields=r}}class $o extends Error{error;errorDescription;constructor(r,a,o){super(r),this.error=a,this.errorDescription=o}}function fu(i){const r=new URL(i);return new URL(r.pathname,r.origin).toString()}async function ei(i,r,a){return new Ca({htu:fu(i),htm:r.toUpperCase(),jti:Zn()}).setProtectedHeader({alg:Wr[0],jwk:a.publicKey,typ:"dpop+jwt"}).setIssuedAt().sign(a.privateKey,{})}async function pu(){const{privateKey:i,publicKey:r}=await Ma(Wr[0]),a={privateKey:i,publicKey:await pa(r)};return[a.publicKey.alg]=Wr,a}const Vo=600;function gu(i){return[401,403].includes(i)}async function mu(i,r,a,o){const u=new Headers(o?.headers);return u.set("Authorization",`DPoP ${r}`),u.set("DPoP",await ei(i,o?.method??"get",a)),{...o,headers:u}}async function vu(i,r,a,o){if(a!==void 0)return mu(i,r,a,o);const u=new Headers(o?.headers);return u.set("Authorization",`Bearer ${r}`),{...o,headers:u}}async function Oi(i,r,a,o,u=fetch){return u(r,await vu(r.toString(),i,o,a))}async function yu(i,r,a){const o=await i.tokenRefresher.refresh(i.sessionId,i.refreshToken,r);return a?.emit(He.SESSION_EXTENDED,o.expiresIn??Vo),{accessToken:o.accessToken,refreshToken:o.refreshToken,expiresIn:o.expiresIn}}const gn=i=>i!==void 0?i-Li>0?i-Li:i:Vo;function wu(i,r){let a=i,o;const u=r?.refreshOptions;if(u!==void 0){const l=async()=>{try{const{accessToken:h,refreshToken:_,expiresIn:y}=await yu(u,r.dpopKey,r.eventEmitter);a=h,_!==void 0&&(u.refreshToken=_),clearTimeout(o),o=setTimeout(l,gn(y)*1e3),r.eventEmitter?.emit(He.TIMEOUT_SET,o)}catch(h){h instanceof $o&&(r?.eventEmitter?.emit(He.ERROR,h.error,h.errorDescription),r?.eventEmitter?.emit(He.SESSION_EXPIRED)),h instanceof wr&&h.missingFields.includes("access_token")&&r?.eventEmitter?.emit(He.SESSION_EXPIRED)}};o=setTimeout(l,gn(r.expiresIn)*1e3),r.eventEmitter?.emit(He.TIMEOUT_SET,o)}else if(r!==void 0&&r.eventEmitter!==void 0){const l=setTimeout(()=>{r.eventEmitter.emit(He.SESSION_EXPIRED)},gn(r.expiresIn)*1e3);r.eventEmitter.emit(He.TIMEOUT_SET,l)}return async(l,h)=>{let _=await Oi(a,l,h,r?.dpopKey,r?.fetch);const y=!_.ok&&!gu(_.status);return _.ok||y||_.url!==l&&r?.dpopKey!==void 0&&(_=await Oi(a,_.url,h,r.dpopKey,r.fetch)),_}}function qo(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Or={exports:{}},Ni;function bu(){if(Ni)return Or.exports;Ni=1;var i=typeof Reflect=="object"?Reflect:null,r=i&&typeof i.apply=="function"?i.apply:function(M,T,I){return Function.prototype.apply.call(M,T,I)},a;i&&typeof i.ownKeys=="function"?a=i.ownKeys:Object.getOwnPropertySymbols?a=function(M){return Object.getOwnPropertyNames(M).concat(Object.getOwnPropertySymbols(M))}:a=function(M){return Object.getOwnPropertyNames(M)};function o(A){console&&console.warn&&console.warn(A)}var u=Number.isNaN||function(M){return M!==M};function l(){l.init.call(this)}Or.exports=l,Or.exports.once=R,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var h=10;function _(A){if(typeof A!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof A)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return h},set:function(A){if(typeof A!="number"||A<0||u(A))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+A+".");h=A}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(M){if(typeof M!="number"||M<0||u(M))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+M+".");return this._maxListeners=M,this};function y(A){return A._maxListeners===void 0?l.defaultMaxListeners:A._maxListeners}l.prototype.getMaxListeners=function(){return y(this)},l.prototype.emit=function(M){for(var T=[],I=1;I<arguments.length;I++)T.push(arguments[I]);var Q=M==="error",ne=this._events;if(ne!==void 0)Q=Q&&ne.error===void 0;else if(!Q)return!1;if(Q){var O;if(T.length>0&&(O=T[0]),O instanceof Error)throw O;var ie=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw ie.context=O,ie}var ye=ne[M];if(ye===void 0)return!1;if(typeof ye=="function")r(ye,this,T);else for(var be=ye.length,We=x(ye,be),I=0;I<be;++I)r(We[I],this,T);return!0};function f(A,M,T,I){var Q,ne,O;if(_(T),ne=A._events,ne===void 0?(ne=A._events=Object.create(null),A._eventsCount=0):(ne.newListener!==void 0&&(A.emit("newListener",M,T.listener?T.listener:T),ne=A._events),O=ne[M]),O===void 0)O=ne[M]=T,++A._eventsCount;else if(typeof O=="function"?O=ne[M]=I?[T,O]:[O,T]:I?O.unshift(T):O.push(T),Q=y(A),Q>0&&O.length>Q&&!O.warned){O.warned=!0;var ie=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(M)+" listeners added. Use emitter.setMaxListeners() to increase limit");ie.name="MaxListenersExceededWarning",ie.emitter=A,ie.type=M,ie.count=O.length,o(ie)}return A}l.prototype.addListener=function(M,T){return f(this,M,T,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(M,T){return f(this,M,T,!0)};function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(A,M,T){var I={fired:!1,wrapFn:void 0,target:A,type:M,listener:T},Q=p.bind(I);return Q.listener=T,I.wrapFn=Q,Q}l.prototype.once=function(M,T){return _(T),this.on(M,d(this,M,T)),this},l.prototype.prependOnceListener=function(M,T){return _(T),this.prependListener(M,d(this,M,T)),this},l.prototype.removeListener=function(M,T){var I,Q,ne,O,ie;if(_(T),Q=this._events,Q===void 0)return this;if(I=Q[M],I===void 0)return this;if(I===T||I.listener===T)--this._eventsCount===0?this._events=Object.create(null):(delete Q[M],Q.removeListener&&this.emit("removeListener",M,I.listener||T));else if(typeof I!="function"){for(ne=-1,O=I.length-1;O>=0;O--)if(I[O]===T||I[O].listener===T){ie=I[O].listener,ne=O;break}if(ne<0)return this;ne===0?I.shift():q(I,ne),I.length===1&&(Q[M]=I[0]),Q.removeListener!==void 0&&this.emit("removeListener",M,ie||T)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(M){var T,I,Q;if(I=this._events,I===void 0)return this;if(I.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):I[M]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete I[M]),this;if(arguments.length===0){var ne=Object.keys(I),O;for(Q=0;Q<ne.length;++Q)O=ne[Q],O!=="removeListener"&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(T=I[M],typeof T=="function")this.removeListener(M,T);else if(T!==void 0)for(Q=T.length-1;Q>=0;Q--)this.removeListener(M,T[Q]);return this};function S(A,M,T){var I=A._events;if(I===void 0)return[];var Q=I[M];return Q===void 0?[]:typeof Q=="function"?T?[Q.listener||Q]:[Q]:T?H(Q):x(Q,Q.length)}l.prototype.listeners=function(M){return S(this,M,!0)},l.prototype.rawListeners=function(M){return S(this,M,!1)},l.listenerCount=function(A,M){return typeof A.listenerCount=="function"?A.listenerCount(M):P.call(A,M)},l.prototype.listenerCount=P;function P(A){var M=this._events;if(M!==void 0){var T=M[A];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]};function x(A,M){for(var T=new Array(M),I=0;I<M;++I)T[I]=A[I];return T}function q(A,M){for(;M+1<A.length;M++)A[M]=A[M+1];A.pop()}function H(A){for(var M=new Array(A.length),T=0;T<M.length;++T)M[T]=A[T].listener||A[T];return M}function R(A,M){return new Promise(function(T,I){function Q(O){A.removeListener(M,ne),I(O)}function ne(){typeof A.removeListener=="function"&&A.removeListener("error",Q),T([].slice.call(arguments))}V(A,M,ne,{once:!0}),M!=="error"&&L(A,Q,{once:!0})})}function L(A,M,T){typeof A.on=="function"&&V(A,"error",M,T)}function V(A,M,T,I){if(typeof A.on=="function")I.once?A.once(M,T):A.on(M,T);else if(typeof A.addEventListener=="function")A.addEventListener(M,function Q(ne){I.once&&A.removeEventListener(M,Q),T(ne)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof A)}return Or.exports}var _u=bu();const Su=qo(_u);var Kr={exports:{}},Eu=Kr.exports,Hi;function Fu(){return Hi||(Hi=1,(function(i,r){(function(o,u){i.exports=u()})(Eu,(function(){return(function(a){var o={};function u(l){if(o[l])return o[l].exports;var h=o[l]={i:l,l:!1,exports:{}};return a[l].call(h.exports,h,h.exports,u),h.l=!0,h.exports}return u.m=a,u.c=o,u.d=function(l,h,_){u.o(l,h)||Object.defineProperty(l,h,{enumerable:!0,get:_})},u.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},u.t=function(l,h){if(1&h&&(l=u(l)),8&h||4&h&&typeof l=="object"&&l&&l.__esModule)return l;var _=Object.create(null);if(u.r(_),Object.defineProperty(_,"default",{enumerable:!0,value:l}),2&h&&typeof l!="string")for(var y in l)u.d(_,y,(function(f){return l[f]}).bind(null,y));return _},u.n=function(l){var h=l&&l.__esModule?function(){return l.default}:function(){return l};return u.d(h,"a",h),h},u.o=function(l,h){return Object.prototype.hasOwnProperty.call(l,h)},u.p="",u(u.s=22)})([function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0});var l=(function(){function f(p,d){for(var S=0;S<d.length;S++){var P=d[S];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(p,P.key,P)}}return function(p,d,S){return d&&f(p.prototype,d),S&&f(p,S),p}})(),h={debug:function(){},info:function(){},warn:function(){},error:function(){}},_=void 0,y=void 0;(o.Log=(function(){function f(){(function(d,S){if(!(d instanceof S))throw new TypeError("Cannot call a class as a function")})(this,f)}return f.reset=function(){y=3,_=h},f.debug=function(){if(y>=4){for(var d=arguments.length,S=Array(d),P=0;P<d;P++)S[P]=arguments[P];_.debug.apply(_,Array.from(S))}},f.info=function(){if(y>=3){for(var d=arguments.length,S=Array(d),P=0;P<d;P++)S[P]=arguments[P];_.info.apply(_,Array.from(S))}},f.warn=function(){if(y>=2){for(var d=arguments.length,S=Array(d),P=0;P<d;P++)S[P]=arguments[P];_.warn.apply(_,Array.from(S))}},f.error=function(){if(y>=1){for(var d=arguments.length,S=Array(d),P=0;P<d;P++)S[P]=arguments[P];_.error.apply(_,Array.from(S))}},l(f,null,[{key:"NONE",get:function(){return 0}},{key:"ERROR",get:function(){return 1}},{key:"WARN",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"level",get:function(){return y},set:function(d){if(!(0<=d&&d<=4))throw new Error("Invalid log level");y=d}},{key:"logger",get:function(){return _},set:function(d){if(!d.debug&&d.info&&(d.debug=d.info),!(d.debug&&d.info&&d.warn&&d.error))throw new Error("Invalid logger");_=d}}]),f})()).reset()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0});var l=(function(){function f(p,d){for(var S=0;S<d.length;S++){var P=d[S];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(p,P.key,P)}}return function(p,d,S){return d&&f(p.prototype,d),S&&f(p,S),p}})(),h={setInterval:(function(f){function p(d,S){return f.apply(this,arguments)}return p.toString=function(){return f.toString()},p})((function(f,p){return setInterval(f,p)})),clearInterval:(function(f){function p(d){return f.apply(this,arguments)}return p.toString=function(){return f.toString()},p})((function(f){return clearInterval(f)}))},_=!1,y=null;o.Global=(function(){function f(){(function(d,S){if(!(d instanceof S))throw new TypeError("Cannot call a class as a function")})(this,f)}return f._testing=function(){_=!0},f.setXMLHttpRequest=function(d){y=d},l(f,null,[{key:"location",get:function(){if(!_)return location}},{key:"localStorage",get:function(){if(!_&&typeof window<"u")return localStorage}},{key:"sessionStorage",get:function(){if(!_&&typeof window<"u")return sessionStorage}},{key:"XMLHttpRequest",get:function(){if(!_&&typeof window<"u")return y||XMLHttpRequest}},{key:"timer",get:function(){if(!_)return h}}]),f})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.MetadataService=void 0;var l=(function(){function p(d,S){for(var P=0;P<S.length;P++){var x=S[P];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(d,x.key,x)}}return function(d,S,P){return S&&p(d.prototype,S),P&&p(d,P),d}})(),h=u(0),_=u(7);function y(p,d){if(!(p instanceof d))throw new TypeError("Cannot call a class as a function")}var f=".well-known/openid-configuration";o.MetadataService=(function(){function p(d){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.JsonService;if(y(this,p),!d)throw h.Log.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=d,this._jsonService=new S(["application/jwk-set+json"])}return p.prototype.resetSigningKeys=function(){this._settings=this._settings||{},this._settings.signingKeys=void 0},p.prototype.getMetadata=function(){var S=this;return this._settings.metadata?(h.Log.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(h.Log.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then((function(P){h.Log.debug("MetadataService.getMetadata: json received");var x=S._settings.metadataSeed||{};return S._settings.metadata=Object.assign({},x,P),S._settings.metadata}))):(h.Log.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))},p.prototype.getIssuer=function(){return this._getMetadataProperty("issuer")},p.prototype.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},p.prototype.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},p.prototype.getTokenEndpoint=function(){var S=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return this._getMetadataProperty("token_endpoint",S)},p.prototype.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},p.prototype.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},p.prototype.getRevocationEndpoint=function(){return this._getMetadataProperty("revocation_endpoint",!0)},p.prototype.getKeysEndpoint=function(){return this._getMetadataProperty("jwks_uri",!0)},p.prototype._getMetadataProperty=function(S){var P=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return h.Log.debug("MetadataService.getMetadataProperty for: "+S),this.getMetadata().then((function(x){if(h.Log.debug("MetadataService.getMetadataProperty: metadata recieved"),x[S]===void 0){if(P===!0)return void h.Log.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+S);throw h.Log.error("MetadataService.getMetadataProperty: Metadata does not contain property "+S),new Error("Metadata does not contain property "+S)}return x[S]}))},p.prototype.getSigningKeys=function(){var S=this;return this._settings.signingKeys?(h.Log.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then((function(P){return h.Log.debug("MetadataService.getSigningKeys: jwks_uri received",P),S._jsonService.getJson(P).then((function(x){if(h.Log.debug("MetadataService.getSigningKeys: key set received",x),!x.keys)throw h.Log.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return S._settings.signingKeys=x.keys,S._settings.signingKeys}))}))},l(p,[{key:"metadataUrl",get:function(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(f)<0&&(this._metadataUrl[this._metadataUrl.length-1]!=="/"&&(this._metadataUrl+="/"),this._metadataUrl+=f))),this._metadataUrl}}]),p})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.UrlUtility=void 0;var l=u(0),h=u(1);o.UrlUtility=(function(){function _(){(function(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")})(this,_)}return _.addQueryParam=function(f,p,d){return f.indexOf("?")<0&&(f+="?"),f[f.length-1]!=="?"&&(f+="&"),f+=encodeURIComponent(p),f+="=",f+=encodeURIComponent(d)},_.parseUrlFragment=function(f){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#",d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h.Global;typeof f!="string"&&(f=d.location.href);var S=f.lastIndexOf(p);S>=0&&(f=f.substr(S+1)),p==="?"&&(S=f.indexOf("#"))>=0&&(f=f.substr(0,S));for(var P,x={},q=/([^&=]+)=([^&]*)/g,H=0;P=q.exec(f);)if(x[decodeURIComponent(P[1])]=decodeURIComponent(P[2].replace(/\+/g," ")),H++>50)return l.Log.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",f),{error:"Response exceeded expected number of parameters"};for(var R in x)return x;return{}},_})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.JoseUtil=void 0;var l=u(26),h=(function(y){return y&&y.__esModule?y:{default:y}})(u(33));o.JoseUtil=(0,h.default)({jws:l.jws,KeyUtil:l.KeyUtil,X509:l.X509,crypto:l.crypto,hextob64u:l.hextob64u,b64tohex:l.b64tohex,AllowedSigningAlgs:l.AllowedSigningAlgs})},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.OidcClientSettings=void 0;var l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},h=(function(){function R(L,V){for(var A=0;A<V.length;A++){var M=V[A];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(L,M.key,M)}}return function(L,V,A){return V&&R(L.prototype,V),A&&R(L,A),L}})(),_=u(0),y=u(23),f=u(6),p=u(24),d=u(2);function S(R,L){if(!(R instanceof L))throw new TypeError("Cannot call a class as a function")}var P=".well-known/openid-configuration",x="id_token",q="openid",H="client_secret_post";o.OidcClientSettings=(function(){function R(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},V=L.authority,A=L.metadataUrl,M=L.metadata,T=L.signingKeys,I=L.metadataSeed,Q=L.client_id,ne=L.client_secret,O=L.response_type,ie=O===void 0?x:O,ye=L.scope,be=ye===void 0?q:ye,We=L.redirect_uri,Ue=L.post_logout_redirect_uri,Qe=L.client_authentication,Be=Qe===void 0?H:Qe,Ze=L.prompt,ge=L.display,we=L.max_age,ze=L.ui_locales,et=L.acr_values,ot=L.resource,st=L.response_mode,ft=L.filterProtocolClaims,Pt=ft===void 0||ft,tt=L.loadUserInfo,at=tt===void 0||tt,Je=L.staleStateAge,Ce=Je===void 0?900:Je,W=L.clockSkew,m=W===void 0?300:W,v=L.clockService,j=v===void 0?new y.ClockService:v,J=L.userInfoJwtIssuer,X=J===void 0?"OP":J,re=L.mergeClaims,ce=re!==void 0&&re,fe=L.stateStore,Se=fe===void 0?new f.WebStorageStateStore:fe,_e=L.ResponseValidatorCtor,Fe=_e===void 0?p.ResponseValidator:_e,ut=L.MetadataServiceCtor,yt=ut===void 0?d.MetadataService:ut,le=L.extraQueryParams,Ie=le===void 0?{}:le,ve=L.extraTokenParams,pt=ve===void 0?{}:ve;S(this,R),this._authority=V,this._metadataUrl=A,this._metadata=M,this._metadataSeed=I,this._signingKeys=T,this._client_id=Q,this._client_secret=ne,this._response_type=ie,this._scope=be,this._redirect_uri=We,this._post_logout_redirect_uri=Ue,this._client_authentication=Be,this._prompt=Ze,this._display=ge,this._max_age=we,this._ui_locales=ze,this._acr_values=et,this._resource=ot,this._response_mode=st,this._filterProtocolClaims=!!Pt,this._loadUserInfo=!!at,this._staleStateAge=Ce,this._clockSkew=m,this._clockService=j,this._userInfoJwtIssuer=X,this._mergeClaims=!!ce,this._stateStore=Se,this._validator=new Fe(this),this._metadataService=new yt(this),this._extraQueryParams=(Ie===void 0?"undefined":l(Ie))==="object"?Ie:{},this._extraTokenParams=(pt===void 0?"undefined":l(pt))==="object"?pt:{}}return R.prototype.getEpochTime=function(){return this._clockService.getEpochTime()},h(R,[{key:"client_id",get:function(){return this._client_id},set:function(V){if(this._client_id)throw _.Log.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=V}},{key:"client_secret",get:function(){return this._client_secret}},{key:"response_type",get:function(){return this._response_type}},{key:"scope",get:function(){return this._scope}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"post_logout_redirect_uri",get:function(){return this._post_logout_redirect_uri}},{key:"client_authentication",get:function(){return this._client_authentication}},{key:"prompt",get:function(){return this._prompt}},{key:"display",get:function(){return this._display}},{key:"max_age",get:function(){return this._max_age}},{key:"ui_locales",get:function(){return this._ui_locales}},{key:"acr_values",get:function(){return this._acr_values}},{key:"resource",get:function(){return this._resource}},{key:"response_mode",get:function(){return this._response_mode}},{key:"authority",get:function(){return this._authority},set:function(V){if(this._authority)throw _.Log.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=V}},{key:"metadataUrl",get:function(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(P)<0&&(this._metadataUrl[this._metadataUrl.length-1]!=="/"&&(this._metadataUrl+="/"),this._metadataUrl+=P)),this._metadataUrl}},{key:"metadata",get:function(){return this._metadata},set:function(V){this._metadata=V}},{key:"metadataSeed",get:function(){return this._metadataSeed},set:function(V){this._metadataSeed=V}},{key:"signingKeys",get:function(){return this._signingKeys},set:function(V){this._signingKeys=V}},{key:"filterProtocolClaims",get:function(){return this._filterProtocolClaims}},{key:"loadUserInfo",get:function(){return this._loadUserInfo}},{key:"staleStateAge",get:function(){return this._staleStateAge}},{key:"clockSkew",get:function(){return this._clockSkew}},{key:"userInfoJwtIssuer",get:function(){return this._userInfoJwtIssuer}},{key:"mergeClaims",get:function(){return this._mergeClaims}},{key:"stateStore",get:function(){return this._stateStore}},{key:"validator",get:function(){return this._validator}},{key:"metadataService",get:function(){return this._metadataService}},{key:"extraQueryParams",get:function(){return this._extraQueryParams},set:function(V){(V===void 0?"undefined":l(V))==="object"?this._extraQueryParams=V:this._extraQueryParams={}}},{key:"extraTokenParams",get:function(){return this._extraTokenParams},set:function(V){(V===void 0?"undefined":l(V))==="object"?this._extraTokenParams=V:this._extraTokenParams={}}}]),R})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.WebStorageStateStore=void 0;var l=u(0),h=u(1);function _(y,f){if(!(y instanceof f))throw new TypeError("Cannot call a class as a function")}o.WebStorageStateStore=(function(){function y(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},p=f.prefix,d=p===void 0?"oidc.":p,S=f.store,P=S===void 0?h.Global.localStorage:S;_(this,y),this._store=P,this._prefix=d}return y.prototype.set=function(p,d){return l.Log.debug("WebStorageStateStore.set",p),p=this._prefix+p,this._store.setItem(p,d),Promise.resolve()},y.prototype.get=function(p){l.Log.debug("WebStorageStateStore.get",p),p=this._prefix+p;var d=this._store.getItem(p);return Promise.resolve(d)},y.prototype.remove=function(p){l.Log.debug("WebStorageStateStore.remove",p),p=this._prefix+p;var d=this._store.getItem(p);return this._store.removeItem(p),Promise.resolve(d)},y.prototype.getAllKeys=function(){l.Log.debug("WebStorageStateStore.getAllKeys");for(var p=[],d=0;d<this._store.length;d++){var S=this._store.key(d);S.indexOf(this._prefix)===0&&p.push(S.substr(this._prefix.length))}return Promise.resolve(p)},y})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.JsonService=void 0;var l=u(0),h=u(1);function _(y,f){if(!(y instanceof f))throw new TypeError("Cannot call a class as a function")}o.JsonService=(function(){function y(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h.Global.XMLHttpRequest,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;_(this,y),f&&Array.isArray(f)?this._contentTypes=f.slice():this._contentTypes=[],this._contentTypes.push("application/json"),d&&this._contentTypes.push("application/jwt"),this._XMLHttpRequest=p,this._jwtHandler=d}return y.prototype.getJson=function(p,d){var S=this;if(!p)throw l.Log.error("JsonService.getJson: No url passed"),new Error("url");return l.Log.debug("JsonService.getJson, url: ",p),new Promise((function(P,x){var q=new S._XMLHttpRequest;q.open("GET",p);var H=S._contentTypes,R=S._jwtHandler;q.onload=function(){if(l.Log.debug("JsonService.getJson: HTTP response received, status",q.status),q.status===200){var L=q.getResponseHeader("Content-Type");if(L){var V=H.find((function(A){if(L.startsWith(A))return!0}));if(V=="application/jwt")return void R(q).then(P,x);if(V)try{return void P(JSON.parse(q.responseText))}catch(A){return l.Log.error("JsonService.getJson: Error parsing JSON response",A.message),void x(A)}}x(Error("Invalid response Content-Type: "+L+", from URL: "+p))}else x(Error(q.statusText+" ("+q.status+")"))},q.onerror=function(){l.Log.error("JsonService.getJson: network error"),x(Error("Network Error"))},d&&(l.Log.debug("JsonService.getJson: token passed, setting Authorization header"),q.setRequestHeader("Authorization","Bearer "+d)),q.send()}))},y.prototype.postForm=function(p,d,S){var P=this;if(!p)throw l.Log.error("JsonService.postForm: No url passed"),new Error("url");return l.Log.debug("JsonService.postForm, url: ",p),new Promise((function(x,q){var H=new P._XMLHttpRequest;H.open("POST",p);var R=P._contentTypes;H.onload=function(){if(l.Log.debug("JsonService.postForm: HTTP response received, status",H.status),H.status!==200){if(H.status===400&&(T=H.getResponseHeader("Content-Type"))&&R.find((function(I){if(T.startsWith(I))return!0})))try{var M=JSON.parse(H.responseText);if(M&&M.error)return l.Log.error("JsonService.postForm: Error from server: ",M.error),void q(new Error(M.error))}catch(I){return l.Log.error("JsonService.postForm: Error parsing JSON response",I.message),void q(I)}q(Error(H.statusText+" ("+H.status+")"))}else{var T;if((T=H.getResponseHeader("Content-Type"))&&R.find((function(I){if(T.startsWith(I))return!0})))try{return void x(JSON.parse(H.responseText))}catch(I){return l.Log.error("JsonService.postForm: Error parsing JSON response",I.message),void q(I)}q(Error("Invalid response Content-Type: "+T+", from URL: "+p))}},H.onerror=function(){l.Log.error("JsonService.postForm: network error"),q(Error("Network Error"))};var L="";for(var V in d){var A=d[V];A&&(L.length>0&&(L+="&"),L+=encodeURIComponent(V),L+="=",L+=encodeURIComponent(A))}H.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),S!==void 0&&H.setRequestHeader("Authorization","Basic "+btoa(S)),H.send(L)}))},y})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.SigninRequest=void 0;var l=u(0),h=u(3),_=u(13);o.SigninRequest=(function(){function y(f){var p=f.url,d=f.client_id,S=f.redirect_uri,P=f.response_type,x=f.scope,q=f.authority,H=f.data,R=f.prompt,L=f.display,V=f.max_age,A=f.ui_locales,M=f.id_token_hint,T=f.login_hint,I=f.acr_values,Q=f.resource,ne=f.response_mode,O=f.request,ie=f.request_uri,ye=f.extraQueryParams,be=f.request_type,We=f.client_secret,Ue=f.extraTokenParams,Qe=f.skipUserInfo;if((function(ot,st){if(!(ot instanceof st))throw new TypeError("Cannot call a class as a function")})(this,y),!p)throw l.Log.error("SigninRequest.ctor: No url passed"),new Error("url");if(!d)throw l.Log.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!S)throw l.Log.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!P)throw l.Log.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!x)throw l.Log.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!q)throw l.Log.error("SigninRequest.ctor: No authority passed"),new Error("authority");var Be=y.isOidc(P),Ze=y.isCode(P);ne||(ne=y.isCode(P)?"query":null),this.state=new _.SigninState({nonce:Be,data:H,client_id:d,authority:q,redirect_uri:S,code_verifier:Ze,request_type:be,response_mode:ne,client_secret:We,scope:x,extraTokenParams:Ue,skipUserInfo:Qe}),p=h.UrlUtility.addQueryParam(p,"client_id",d),p=h.UrlUtility.addQueryParam(p,"redirect_uri",S),p=h.UrlUtility.addQueryParam(p,"response_type",P),p=h.UrlUtility.addQueryParam(p,"scope",x),p=h.UrlUtility.addQueryParam(p,"state",this.state.id),Be&&(p=h.UrlUtility.addQueryParam(p,"nonce",this.state.nonce)),Ze&&(p=h.UrlUtility.addQueryParam(p,"code_challenge",this.state.code_challenge),p=h.UrlUtility.addQueryParam(p,"code_challenge_method","S256"));var ge={prompt:R,display:L,max_age:V,ui_locales:A,id_token_hint:M,login_hint:T,acr_values:I,resource:Q,request:O,request_uri:ie,response_mode:ne};for(var we in ge)ge[we]&&(p=h.UrlUtility.addQueryParam(p,we,ge[we]));for(var ze in ye)p=h.UrlUtility.addQueryParam(p,ze,ye[ze]);this.url=p}return y.isOidc=function(p){return!!p.split(/\s+/g).filter((function(d){return d==="id_token"}))[0]},y.isOAuth=function(p){return!!p.split(/\s+/g).filter((function(d){return d==="token"}))[0]},y.isCode=function(p){return!!p.split(/\s+/g).filter((function(d){return d==="code"}))[0]},y})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.State=void 0;var l=(function(){function f(p,d){for(var S=0;S<d.length;S++){var P=d[S];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(p,P.key,P)}}return function(p,d,S){return d&&f(p.prototype,d),S&&f(p,S),p}})(),h=u(0),_=(function(p){return p&&p.__esModule?p:{default:p}})(u(14));function y(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}o.State=(function(){function f(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=p.id,S=p.data,P=p.created,x=p.request_type;y(this,f),this._id=d||(0,_.default)(),this._data=S,this._created=typeof P=="number"&&P>0?P:parseInt(Date.now()/1e3),this._request_type=x}return f.prototype.toStorageString=function(){return h.Log.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})},f.fromStorageString=function(d){return h.Log.debug("State.fromStorageString"),new f(JSON.parse(d))},f.clearStaleState=function(d,S){var P=Date.now()/1e3-S;return d.getAllKeys().then((function(x){h.Log.debug("State.clearStaleState: got keys",x);for(var q=[],H=function(A){var M=x[A];L=d.get(M).then((function(T){var I=!1;if(T)try{var Q=f.fromStorageString(T);h.Log.debug("State.clearStaleState: got item from key: ",M,Q.created),Q.created<=P&&(I=!0)}catch(ne){h.Log.error("State.clearStaleState: Error parsing state for key",M,ne.message),I=!0}else h.Log.debug("State.clearStaleState: no item in storage for key: ",M),I=!0;if(I)return h.Log.debug("State.clearStaleState: removed item for key: ",M),d.remove(M)})),q.push(L)},R=0;R<x.length;R++){var L;H(R)}return h.Log.debug("State.clearStaleState: waiting on promise count:",q.length),Promise.all(q)}))},l(f,[{key:"id",get:function(){return this._id}},{key:"data",get:function(){return this._data}},{key:"created",get:function(){return this._created}},{key:"request_type",get:function(){return this._request_type}}]),f})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.OidcClient=void 0;var l=(function(){function H(R,L){for(var V=0;V<L.length;V++){var A=L[V];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(R,A.key,A)}}return function(R,L,V){return L&&H(R.prototype,L),V&&H(R,V),R}})(),h=u(0),_=u(5),y=u(12),f=u(8),p=u(34),d=u(35),S=u(36),P=u(13),x=u(9);function q(H,R){if(!(H instanceof R))throw new TypeError("Cannot call a class as a function")}o.OidcClient=(function(){function H(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};q(this,H),R instanceof _.OidcClientSettings?this._settings=R:this._settings=new _.OidcClientSettings(R)}return H.prototype.createSigninRequest=function(){var L=this,V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},A=V.response_type,M=V.scope,T=V.redirect_uri,I=V.data,Q=V.state,ne=V.prompt,O=V.display,ie=V.max_age,ye=V.ui_locales,be=V.id_token_hint,We=V.login_hint,Ue=V.acr_values,Qe=V.resource,Be=V.request,Ze=V.request_uri,ge=V.response_mode,we=V.extraQueryParams,ze=V.extraTokenParams,et=V.request_type,ot=V.skipUserInfo,st=arguments[1];h.Log.debug("OidcClient.createSigninRequest");var ft=this._settings.client_id;A=A||this._settings.response_type,M=M||this._settings.scope,T=T||this._settings.redirect_uri,ne=ne||this._settings.prompt,O=O||this._settings.display,ie=ie||this._settings.max_age,ye=ye||this._settings.ui_locales,Ue=Ue||this._settings.acr_values,Qe=Qe||this._settings.resource,ge=ge||this._settings.response_mode,we=we||this._settings.extraQueryParams,ze=ze||this._settings.extraTokenParams;var Pt=this._settings.authority;return f.SigninRequest.isCode(A)&&A!=="code"?Promise.reject(new Error("OpenID Connect hybrid flow is not supported")):this._metadataService.getAuthorizationEndpoint().then((function(tt){h.Log.debug("OidcClient.createSigninRequest: Received authorization endpoint",tt);var at=new f.SigninRequest({url:tt,client_id:ft,redirect_uri:T,response_type:A,scope:M,data:I||Q,authority:Pt,prompt:ne,display:O,max_age:ie,ui_locales:ye,id_token_hint:be,login_hint:We,acr_values:Ue,resource:Qe,request:Be,request_uri:Ze,extraQueryParams:we,extraTokenParams:ze,request_type:et,response_mode:ge,client_secret:L._settings.client_secret,skipUserInfo:ot}),Je=at.state;return(st=st||L._stateStore).set(Je.id,Je.toStorageString()).then((function(){return at}))}))},H.prototype.readSigninResponseState=function(L,V){var A=arguments.length>2&&arguments[2]!==void 0&&arguments[2];h.Log.debug("OidcClient.readSigninResponseState");var M=this._settings.response_mode==="query"||!this._settings.response_mode&&f.SigninRequest.isCode(this._settings.response_type),T=M?"?":"#",I=new p.SigninResponse(L,T);if(!I.state)return h.Log.error("OidcClient.readSigninResponseState: No state in response"),Promise.reject(new Error("No state in response"));V=V||this._stateStore;var Q=A?V.remove.bind(V):V.get.bind(V);return Q(I.state).then((function(ne){if(!ne)throw h.Log.error("OidcClient.readSigninResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:P.SigninState.fromStorageString(ne),response:I}}))},H.prototype.processSigninResponse=function(L,V){var A=this;return h.Log.debug("OidcClient.processSigninResponse"),this.readSigninResponseState(L,V,!0).then((function(M){var T=M.state,I=M.response;return h.Log.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),A._validator.validateSigninResponse(T,I)}))},H.prototype.createSignoutRequest=function(){var L=this,V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},A=V.id_token_hint,M=V.data,T=V.state,I=V.post_logout_redirect_uri,Q=V.extraQueryParams,ne=V.request_type,O=arguments[1];return h.Log.debug("OidcClient.createSignoutRequest"),I=I||this._settings.post_logout_redirect_uri,Q=Q||this._settings.extraQueryParams,this._metadataService.getEndSessionEndpoint().then((function(ie){if(!ie)throw h.Log.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");h.Log.debug("OidcClient.createSignoutRequest: Received end session endpoint",ie);var ye=new d.SignoutRequest({url:ie,id_token_hint:A,post_logout_redirect_uri:I,data:M||T,extraQueryParams:Q,request_type:ne}),be=ye.state;return be&&(h.Log.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),(O=O||L._stateStore).set(be.id,be.toStorageString())),ye}))},H.prototype.readSignoutResponseState=function(L,V){var A=arguments.length>2&&arguments[2]!==void 0&&arguments[2];h.Log.debug("OidcClient.readSignoutResponseState");var M=new S.SignoutResponse(L);if(!M.state)return h.Log.debug("OidcClient.readSignoutResponseState: No state in response"),M.error?(h.Log.warn("OidcClient.readSignoutResponseState: Response was error: ",M.error),Promise.reject(new y.ErrorResponse(M))):Promise.resolve({state:void 0,response:M});var T=M.state;V=V||this._stateStore;var I=A?V.remove.bind(V):V.get.bind(V);return I(T).then((function(Q){if(!Q)throw h.Log.error("OidcClient.readSignoutResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:x.State.fromStorageString(Q),response:M}}))},H.prototype.processSignoutResponse=function(L,V){var A=this;return h.Log.debug("OidcClient.processSignoutResponse"),this.readSignoutResponseState(L,V,!0).then((function(M){var T=M.state,I=M.response;return T?(h.Log.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),A._validator.validateSignoutResponse(T,I)):(h.Log.debug("OidcClient.processSignoutResponse: No state from storage; skipping validating response"),I)}))},H.prototype.clearStaleState=function(L){return h.Log.debug("OidcClient.clearStaleState"),L=L||this._stateStore,x.State.clearStaleState(L,this.settings.staleStateAge)},l(H,[{key:"_stateStore",get:function(){return this.settings.stateStore}},{key:"_validator",get:function(){return this.settings.validator}},{key:"_metadataService",get:function(){return this.settings.metadataService}},{key:"settings",get:function(){return this._settings}},{key:"metadataService",get:function(){return this._metadataService}}]),H})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.TokenClient=void 0;var l=u(7),h=u(2),_=u(0);function y(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}o.TokenClient=(function(){function f(p){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:l.JsonService,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h.MetadataService;if(y(this,f),!p)throw _.Log.error("TokenClient.ctor: No settings passed"),new Error("settings");this._settings=p,this._jsonService=new d,this._metadataService=new S(this._settings)}return f.prototype.exchangeCode=function(){var d=this,S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(S=Object.assign({},S)).grant_type=S.grant_type||"authorization_code",S.client_id=S.client_id||this._settings.client_id,S.client_secret=S.client_secret||this._settings.client_secret,S.redirect_uri=S.redirect_uri||this._settings.redirect_uri;var P=void 0,x=S._client_authentication||this._settings._client_authentication;return delete S._client_authentication,S.code?S.redirect_uri?S.code_verifier?S.client_id?S.client_secret||x!="client_secret_basic"?(x=="client_secret_basic"&&(P=S.client_id+":"+S.client_secret,delete S.client_id,delete S.client_secret),this._metadataService.getTokenEndpoint(!1).then((function(q){return _.Log.debug("TokenClient.exchangeCode: Received token endpoint"),d._jsonService.postForm(q,S,P).then((function(H){return _.Log.debug("TokenClient.exchangeCode: response received"),H}))}))):(_.Log.error("TokenClient.exchangeCode: No client_secret passed"),Promise.reject(new Error("A client_secret is required"))):(_.Log.error("TokenClient.exchangeCode: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(_.Log.error("TokenClient.exchangeCode: No code_verifier passed"),Promise.reject(new Error("A code_verifier is required"))):(_.Log.error("TokenClient.exchangeCode: No redirect_uri passed"),Promise.reject(new Error("A redirect_uri is required"))):(_.Log.error("TokenClient.exchangeCode: No code passed"),Promise.reject(new Error("A code is required")))},f.prototype.exchangeRefreshToken=function(){var d=this,S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(S=Object.assign({},S)).grant_type=S.grant_type||"refresh_token",S.client_id=S.client_id||this._settings.client_id,S.client_secret=S.client_secret||this._settings.client_secret;var P=void 0,x=S._client_authentication||this._settings._client_authentication;return delete S._client_authentication,S.refresh_token?S.client_id?(x=="client_secret_basic"&&(P=S.client_id+":"+S.client_secret,delete S.client_id,delete S.client_secret),this._metadataService.getTokenEndpoint(!1).then((function(q){return _.Log.debug("TokenClient.exchangeRefreshToken: Received token endpoint"),d._jsonService.postForm(q,S,P).then((function(H){return _.Log.debug("TokenClient.exchangeRefreshToken: response received"),H}))}))):(_.Log.error("TokenClient.exchangeRefreshToken: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(_.Log.error("TokenClient.exchangeRefreshToken: No refresh_token passed"),Promise.reject(new Error("A refresh_token is required")))},f})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.ErrorResponse=void 0;var l=u(0);function h(y,f){if(!(y instanceof f))throw new TypeError("Cannot call a class as a function")}function _(y,f){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!f||typeof f!="object"&&typeof f!="function"?y:f}o.ErrorResponse=(function(y){function f(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=p.error,S=p.error_description,P=p.error_uri,x=p.state,q=p.session_state;if(h(this,f),!d)throw l.Log.error("No error passed to ErrorResponse"),new Error("error");var H=_(this,y.call(this,S||d));return H.name="ErrorResponse",H.error=d,H.error_description=S,H.error_uri=P,H.state=x,H.session_state=q,H}return(function(d,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);d.prototype=Object.create(S&&S.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(d,S):d.__proto__=S)})(f,y),f})(Error)},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.SigninState=void 0;var l=(function(){function S(P,x){for(var q=0;q<x.length;q++){var H=x[q];H.enumerable=H.enumerable||!1,H.configurable=!0,"value"in H&&(H.writable=!0),Object.defineProperty(P,H.key,H)}}return function(P,x,q){return x&&S(P.prototype,x),q&&S(P,q),P}})(),h=u(0),_=u(9),y=u(4),f=(function(P){return P&&P.__esModule?P:{default:P}})(u(14));function p(S,P){if(!(S instanceof P))throw new TypeError("Cannot call a class as a function")}function d(S,P){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!P||typeof P!="object"&&typeof P!="function"?S:P}o.SigninState=(function(S){function P(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},q=x.nonce,H=x.authority,R=x.client_id,L=x.redirect_uri,V=x.code_verifier,A=x.response_mode,M=x.client_secret,T=x.scope,I=x.extraTokenParams,Q=x.skipUserInfo;p(this,P);var ne=d(this,S.call(this,arguments[0]));if(q===!0?ne._nonce=(0,f.default)():q&&(ne._nonce=q),V===!0?ne._code_verifier=(0,f.default)()+(0,f.default)()+(0,f.default)():V&&(ne._code_verifier=V),ne.code_verifier){var O=y.JoseUtil.hashString(ne.code_verifier,"SHA256");ne._code_challenge=y.JoseUtil.hexToBase64Url(O)}return ne._redirect_uri=L,ne._authority=H,ne._client_id=R,ne._response_mode=A,ne._client_secret=M,ne._scope=T,ne._extraTokenParams=I,ne._skipUserInfo=Q,ne}return(function(q,H){if(typeof H!="function"&&H!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof H);q.prototype=Object.create(H&&H.prototype,{constructor:{value:q,enumerable:!1,writable:!0,configurable:!0}}),H&&(Object.setPrototypeOf?Object.setPrototypeOf(q,H):q.__proto__=H)})(P,S),P.prototype.toStorageString=function(){return h.Log.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,nonce:this.nonce,code_verifier:this.code_verifier,redirect_uri:this.redirect_uri,authority:this.authority,client_id:this.client_id,response_mode:this.response_mode,client_secret:this.client_secret,scope:this.scope,extraTokenParams:this.extraTokenParams,skipUserInfo:this.skipUserInfo})},P.fromStorageString=function(q){return h.Log.debug("SigninState.fromStorageString"),new P(JSON.parse(q))},l(P,[{key:"nonce",get:function(){return this._nonce}},{key:"authority",get:function(){return this._authority}},{key:"client_id",get:function(){return this._client_id}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"code_verifier",get:function(){return this._code_verifier}},{key:"code_challenge",get:function(){return this._code_challenge}},{key:"response_mode",get:function(){return this._response_mode}},{key:"client_secret",get:function(){return this._client_secret}},{key:"scope",get:function(){return this._scope}},{key:"extraTokenParams",get:function(){return this._extraTokenParams}},{key:"skipUserInfo",get:function(){return this._skipUserInfo}}]),P})(_.State)},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){return(l!="undefined"&&l!==null&&l.getRandomValues!==void 0?h:_)().replace(/-/g,"")};var l=typeof window<"u"?window.crypto||window.msCrypto:null;function h(){return("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,(function(y){return(y^l.getRandomValues(new Uint8Array(1))[0]&15>>y/4).toString(16)}))}function _(){return("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,(function(y){return(y^16*Math.random()>>y/4).toString(16)}))}a.exports=o.default},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.User=void 0;var l=(function(){function _(y,f){for(var p=0;p<f.length;p++){var d=f[p];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(y,d.key,d)}}return function(y,f,p){return f&&_(y.prototype,f),p&&_(y,p),y}})(),h=u(0);o.User=(function(){function _(y){var f=y.id_token,p=y.session_state,d=y.access_token,S=y.refresh_token,P=y.token_type,x=y.scope,q=y.profile,H=y.expires_at,R=y.state;(function(V,A){if(!(V instanceof A))throw new TypeError("Cannot call a class as a function")})(this,_),this.id_token=f,this.session_state=p,this.access_token=d,this.refresh_token=S,this.token_type=P,this.scope=x,this.profile=q,this.expires_at=H,this.state=R}return _.prototype.toStorageString=function(){return h.Log.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},_.fromStorageString=function(f){return h.Log.debug("User.fromStorageString"),new _(JSON.parse(f))},l(_,[{key:"expires_in",get:function(){if(this.expires_at){var f=parseInt(Date.now()/1e3);return this.expires_at-f}},set:function(f){var p=parseInt(f);if(typeof p=="number"&&p>0){var d=parseInt(Date.now()/1e3);this.expires_at=d+p}}},{key:"expired",get:function(){var f=this.expires_in;if(f!==void 0)return f<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}}]),_})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.AccessTokenEvents=void 0;var l=u(0),h=u(46);function _(y,f){if(!(y instanceof f))throw new TypeError("Cannot call a class as a function")}o.AccessTokenEvents=(function(){function y(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},p=f.accessTokenExpiringNotificationTime,d=p===void 0?60:p,S=f.accessTokenExpiringTimer,P=S===void 0?new h.Timer("Access token expiring"):S,x=f.accessTokenExpiredTimer,q=x===void 0?new h.Timer("Access token expired"):x;_(this,y),this._accessTokenExpiringNotificationTime=d,this._accessTokenExpiring=P,this._accessTokenExpired=q}return y.prototype.load=function(p){if(p.access_token&&p.expires_in!==void 0){var d=p.expires_in;if(l.Log.debug("AccessTokenEvents.load: access token present, remaining duration:",d),d>0){var S=d-this._accessTokenExpiringNotificationTime;S<=0&&(S=1),l.Log.debug("AccessTokenEvents.load: registering expiring timer in:",S),this._accessTokenExpiring.init(S)}else l.Log.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();var P=d+1;l.Log.debug("AccessTokenEvents.load: registering expired timer in:",P),this._accessTokenExpired.init(P)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},y.prototype.unload=function(){l.Log.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},y.prototype.addAccessTokenExpiring=function(p){this._accessTokenExpiring.addHandler(p)},y.prototype.removeAccessTokenExpiring=function(p){this._accessTokenExpiring.removeHandler(p)},y.prototype.addAccessTokenExpired=function(p){this._accessTokenExpired.addHandler(p)},y.prototype.removeAccessTokenExpired=function(p){this._accessTokenExpired.removeHandler(p)},y})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.Event=void 0;var l=u(0);o.Event=(function(){function h(_){(function(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")})(this,h),this._name=_,this._callbacks=[]}return h.prototype.addHandler=function(y){this._callbacks.push(y)},h.prototype.removeHandler=function(y){var f=this._callbacks.findIndex((function(p){return p===y}));f>=0&&this._callbacks.splice(f,1)},h.prototype.raise=function(){l.Log.debug("Event: Raising event: "+this._name);for(var y=0;y<this._callbacks.length;y++){var f;(f=this._callbacks)[y].apply(f,arguments)}},h})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.SessionMonitor=void 0;var l=(function(){function p(d,S){for(var P=0;P<S.length;P++){var x=S[P];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(d,x.key,x)}}return function(d,S,P){return S&&p(d.prototype,S),P&&p(d,P),d}})(),h=u(0),_=u(19),y=u(1);function f(p,d){if(!(p instanceof d))throw new TypeError("Cannot call a class as a function")}o.SessionMonitor=(function(){function p(d){var S=this,P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.CheckSessionIFrame,x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:y.Global.timer;if(f(this,p),!d)throw h.Log.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=d,this._CheckSessionIFrameCtor=P,this._timer=x,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),Promise.resolve(this._userManager.getUser().then((function(q){q?S._start(q):S._settings.monitorAnonymousSession&&S._userManager.querySessionStatus().then((function(H){var R={session_state:H.session_state};H.sub&&H.sid&&(R.profile={sub:H.sub,sid:H.sid}),S._start(R)})).catch((function(H){h.Log.error("SessionMonitor ctor: error from querySessionStatus:",H.message)}))})).catch((function(q){h.Log.error("SessionMonitor ctor: error from getUser:",q.message)})))}return p.prototype._start=function(S){var P=this,x=S.session_state;x&&(S.profile?(this._sub=S.profile.sub,this._sid=S.profile.sid,h.Log.debug("SessionMonitor._start: session_state:",x,", sub:",this._sub)):(this._sub=void 0,this._sid=void 0,h.Log.debug("SessionMonitor._start: session_state:",x,", anonymous user")),this._checkSessionIFrame?this._checkSessionIFrame.start(x):this._metadataService.getCheckSessionIframe().then((function(q){if(q){h.Log.debug("SessionMonitor._start: Initializing check session iframe");var H=P._client_id,R=P._checkSessionInterval,L=P._stopCheckSessionOnError;P._checkSessionIFrame=new P._CheckSessionIFrameCtor(P._callback.bind(P),H,q,R,L),P._checkSessionIFrame.load().then((function(){P._checkSessionIFrame.start(x)}))}else h.Log.warn("SessionMonitor._start: No check session iframe found in the metadata")})).catch((function(q){h.Log.error("SessionMonitor._start: Error from getCheckSessionIframe:",q.message)})))},p.prototype._stop=function(){var S=this;if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&(h.Log.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop()),this._settings.monitorAnonymousSession)var P=this._timer.setInterval((function(){S._timer.clearInterval(P),S._userManager.querySessionStatus().then((function(x){var q={session_state:x.session_state};x.sub&&x.sid&&(q.profile={sub:x.sub,sid:x.sid}),S._start(q)})).catch((function(x){h.Log.error("SessionMonitor: error from querySessionStatus:",x.message)}))}),1e3)},p.prototype._callback=function(){var S=this;this._userManager.querySessionStatus().then((function(P){var x=!0;P?P.sub===S._sub?(x=!1,S._checkSessionIFrame.start(P.session_state),P.sid===S._sid?h.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",P.session_state):(h.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",P.session_state),S._userManager.events._raiseUserSessionChanged())):h.Log.debug("SessionMonitor._callback: Different subject signed into OP:",P.sub):h.Log.debug("SessionMonitor._callback: Subject no longer signed into OP"),x&&(S._sub?(h.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),S._userManager.events._raiseUserSignedOut()):(h.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed in event"),S._userManager.events._raiseUserSignedIn()))})).catch((function(P){S._sub&&(h.Log.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",P.message),S._userManager.events._raiseUserSignedOut())}))},l(p,[{key:"_settings",get:function(){return this._userManager.settings}},{key:"_metadataService",get:function(){return this._userManager.metadataService}},{key:"_client_id",get:function(){return this._settings.client_id}},{key:"_checkSessionInterval",get:function(){return this._settings.checkSessionInterval}},{key:"_stopCheckSessionOnError",get:function(){return this._settings.stopCheckSessionOnError}}]),p})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.CheckSessionIFrame=void 0;var l=u(0);function h(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}o.CheckSessionIFrame=(function(){function _(y,f,p,d){var S=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];h(this,_),this._callback=y,this._client_id=f,this._url=p,this._interval=d||2e3,this._stopOnError=S;var P=p.indexOf("/",p.indexOf("//")+2);this._frame_origin=p.substr(0,P),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.width=0,this._frame.height=0,this._frame.src=p}return _.prototype.load=function(){var f=this;return new Promise((function(p){f._frame.onload=function(){p()},window.document.body.appendChild(f._frame),f._boundMessageEvent=f._message.bind(f),window.addEventListener("message",f._boundMessageEvent,!1)}))},_.prototype._message=function(f){f.origin===this._frame_origin&&f.source===this._frame.contentWindow&&(f.data==="error"?(l.Log.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):f.data==="changed"?(l.Log.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):l.Log.debug("CheckSessionIFrame: "+f.data+" message from check session op iframe"))},_.prototype.start=function(f){var p=this;if(this._session_state!==f){l.Log.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=f;var d=function(){p._frame.contentWindow.postMessage(p._client_id+" "+p._session_state,p._frame_origin)};d(),this._timer=window.setInterval(d,this._interval)}},_.prototype.stop=function(){this._session_state=null,this._timer&&(l.Log.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)},_})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.TokenRevocationClient=void 0;var l=u(0),h=u(2),_=u(1);function y(d,S){if(!(d instanceof S))throw new TypeError("Cannot call a class as a function")}var f="access_token",p="refresh_token";o.TokenRevocationClient=(function(){function d(S){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.Global.XMLHttpRequest,x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h.MetadataService;if(y(this,d),!S)throw l.Log.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=S,this._XMLHttpRequestCtor=P,this._metadataService=new x(this._settings)}return d.prototype.revoke=function(P,x){var q=this,H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"access_token";if(!P)throw l.Log.error("TokenRevocationClient.revoke: No token provided"),new Error("No token provided.");if(H!==f&&H!=p)throw l.Log.error("TokenRevocationClient.revoke: Invalid token type"),new Error("Invalid token type.");return this._metadataService.getRevocationEndpoint().then((function(R){if(R){l.Log.debug("TokenRevocationClient.revoke: Revoking "+H);var L=q._settings.client_id,V=q._settings.client_secret;return q._revoke(R,L,V,P,H)}if(x)throw l.Log.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")}))},d.prototype._revoke=function(P,x,q,H,R){var L=this;return new Promise((function(V,A){var M=new L._XMLHttpRequestCtor;M.open("POST",P),M.onload=function(){l.Log.debug("TokenRevocationClient.revoke: HTTP response received, status",M.status),M.status===200?V():A(Error(M.statusText+" ("+M.status+")"))},M.onerror=function(){l.Log.debug("TokenRevocationClient.revoke: Network Error."),A("Network Error")};var T="client_id="+encodeURIComponent(x);q&&(T+="&client_secret="+encodeURIComponent(q)),T+="&token_type_hint="+encodeURIComponent(R),T+="&token="+encodeURIComponent(H),M.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),M.send(T)}))},d})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.CordovaPopupWindow=void 0;var l=(function(){function _(y,f){for(var p=0;p<f.length;p++){var d=f[p];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(y,d.key,d)}}return function(y,f,p){return f&&_(y.prototype,f),p&&_(y,p),y}})(),h=u(0);o.CordovaPopupWindow=(function(){function _(y){var f=this;(function(d,S){if(!(d instanceof S))throw new TypeError("Cannot call a class as a function")})(this,_),this._promise=new Promise((function(p,d){f._resolve=p,f._reject=d})),this.features=y.popupWindowFeatures||"location=no,toolbar=no,zoom=no",this.target=y.popupWindowTarget||"_blank",this.redirect_uri=y.startUrl,h.Log.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}return _.prototype._isInAppBrowserInstalled=function(f){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some((function(p){return f.hasOwnProperty(p)}))},_.prototype.navigate=function(f){if(f&&f.url){if(!window.cordova)return this._error("cordova is undefined");var p=window.cordova.require("cordova/plugin_list").metadata;if(this._isInAppBrowserInstalled(p)===!1)return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(f.url,this.target,this.features),this._popup?(h.Log.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise},_.prototype._loadStartCallback=function(f){f.url.indexOf(this.redirect_uri)===0&&this._success({url:f.url})},_.prototype._exitCallback=function(f){this._error(f)},_.prototype._success=function(f){this._cleanup(),h.Log.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(f)},_.prototype._error=function(f){this._cleanup(),h.Log.error(f),this._reject(new Error(f))},_.prototype.close=function(){this._cleanup()},_.prototype._cleanup=function(){this._popup&&(h.Log.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null},l(_,[{key:"promise",get:function(){return this._promise}}]),_})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0});var l=u(0),h=u(10),_=u(5),y=u(6),f=u(37),p=u(38),d=u(16),S=u(2),P=u(48),x=u(49),q=u(19),H=u(20),R=u(18),L=u(1),V=u(15),A=u(50);o.default={Version:A.Version,Log:l.Log,OidcClient:h.OidcClient,OidcClientSettings:_.OidcClientSettings,WebStorageStateStore:y.WebStorageStateStore,InMemoryWebStorage:f.InMemoryWebStorage,UserManager:p.UserManager,AccessTokenEvents:d.AccessTokenEvents,MetadataService:S.MetadataService,CordovaPopupNavigator:P.CordovaPopupNavigator,CordovaIFrameNavigator:x.CordovaIFrameNavigator,CheckSessionIFrame:q.CheckSessionIFrame,TokenRevocationClient:H.TokenRevocationClient,SessionMonitor:R.SessionMonitor,Global:L.Global,User:V.User},a.exports=o.default},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.ClockService=(function(){function l(){(function(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")})(this,l)}return l.prototype.getEpochTime=function(){return Promise.resolve(Date.now()/1e3|0)},l})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.ResponseValidator=void 0;var l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h=u(0),_=u(2),y=u(25),f=u(11),p=u(12),d=u(4);function S(x,q){if(!(x instanceof q))throw new TypeError("Cannot call a class as a function")}var P=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];o.ResponseValidator=(function(){function x(q){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.MetadataService,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:y.UserInfoService,L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:d.JoseUtil,V=arguments.length>4&&arguments[4]!==void 0?arguments[4]:f.TokenClient;if(S(this,x),!q)throw h.Log.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=q,this._metadataService=new H(this._settings),this._userInfoService=new R(this._settings),this._joseUtil=L,this._tokenClient=new V(this._settings)}return x.prototype.validateSigninResponse=function(H,R){var L=this;return h.Log.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(H,R).then((function(V){return h.Log.debug("ResponseValidator.validateSigninResponse: state processed"),L._validateTokens(H,V).then((function(A){return h.Log.debug("ResponseValidator.validateSigninResponse: tokens validated"),L._processClaims(H,A).then((function(M){return h.Log.debug("ResponseValidator.validateSigninResponse: claims processed"),M}))}))}))},x.prototype.validateSignoutResponse=function(H,R){return H.id!==R.state?(h.Log.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(h.Log.debug("ResponseValidator.validateSignoutResponse: state validated"),R.state=H.data,R.error?(h.Log.warn("ResponseValidator.validateSignoutResponse: Response was error",R.error),Promise.reject(new p.ErrorResponse(R))):Promise.resolve(R))},x.prototype._processSigninParams=function(H,R){if(H.id!==R.state)return h.Log.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!H.client_id)return h.Log.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!H.authority)return h.Log.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==H.authority)return h.Log.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=H.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==H.client_id)return h.Log.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=H.client_id;return h.Log.debug("ResponseValidator._processSigninParams: state validated"),R.state=H.data,R.error?(h.Log.warn("ResponseValidator._processSigninParams: Response was error",R.error),Promise.reject(new p.ErrorResponse(R))):H.nonce&&!R.id_token?(h.Log.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!H.nonce&&R.id_token?(h.Log.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):H.code_verifier&&!R.code?(h.Log.error("ResponseValidator._processSigninParams: Expecting code in response"),Promise.reject(new Error("No code in response"))):!H.code_verifier&&R.code?(h.Log.error("ResponseValidator._processSigninParams: Not expecting code in response"),Promise.reject(new Error("Unexpected code in response"))):(R.scope||(R.scope=H.scope),Promise.resolve(R))},x.prototype._processClaims=function(H,R){var L=this;if(R.isOpenIdConnect){if(h.Log.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),R.profile=this._filterProtocolClaims(R.profile),H.skipUserInfo!==!0&&this._settings.loadUserInfo&&R.access_token)return h.Log.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(R.access_token).then((function(V){return h.Log.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),V.sub!==R.profile.sub?(h.Log.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in id_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in id_token"))):(R.profile=L._mergeClaims(R.profile,V),h.Log.debug("ResponseValidator._processClaims: user info claims received, updated profile:",R.profile),R)}));h.Log.debug("ResponseValidator._processClaims: not loading user info")}else h.Log.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(R)},x.prototype._mergeClaims=function(H,R){var L=Object.assign({},H);for(var V in R){var A=R[V];Array.isArray(A)||(A=[A]);for(var M=0;M<A.length;M++){var T=A[M];L[V]?Array.isArray(L[V])?L[V].indexOf(T)<0&&L[V].push(T):L[V]!==T&&((T===void 0?"undefined":l(T))==="object"&&this._settings.mergeClaims?L[V]=this._mergeClaims(L[V],T):L[V]=[L[V],T]):L[V]=T}}return L},x.prototype._filterProtocolClaims=function(H){h.Log.debug("ResponseValidator._filterProtocolClaims, incoming claims:",H);var R=Object.assign({},H);return this._settings._filterProtocolClaims?(P.forEach((function(L){delete R[L]})),h.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",R)):h.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),R},x.prototype._validateTokens=function(H,R){return R.code?(h.Log.debug("ResponseValidator._validateTokens: Validating code"),this._processCode(H,R)):R.id_token?R.access_token?(h.Log.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(H,R)):(h.Log.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(H,R)):(h.Log.debug("ResponseValidator._validateTokens: No code to process or id_token to validate"),Promise.resolve(R))},x.prototype._processCode=function(H,R){var L=this,V={client_id:H.client_id,client_secret:H.client_secret,code:R.code,redirect_uri:H.redirect_uri,code_verifier:H.code_verifier};return H.extraTokenParams&&l(H.extraTokenParams)==="object"&&Object.assign(V,H.extraTokenParams),this._tokenClient.exchangeCode(V).then((function(A){for(var M in A)R[M]=A[M];return R.id_token?(h.Log.debug("ResponseValidator._processCode: token response successful, processing id_token"),L._validateIdTokenAttributes(H,R)):(h.Log.debug("ResponseValidator._processCode: token response successful, returning response"),R)}))},x.prototype._validateIdTokenAttributes=function(H,R){var L=this;return this._metadataService.getIssuer().then((function(V){var A=H.client_id,M=L._settings.clockSkew;return h.Log.debug("ResponseValidator._validateIdTokenAttributes: Validaing JWT attributes; using clock skew (in seconds) of: ",M),L._settings.getEpochTime().then((function(T){return L._joseUtil.validateJwtAttributes(R.id_token,V,A,M,T).then((function(I){return H.nonce&&H.nonce!==I.nonce?(h.Log.error("ResponseValidator._validateIdTokenAttributes: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):I.sub?(R.profile=I,R):(h.Log.error("ResponseValidator._validateIdTokenAttributes: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))}))},x.prototype._validateIdTokenAndAccessToken=function(H,R){var L=this;return this._validateIdToken(H,R).then((function(V){return L._validateAccessToken(V)}))},x.prototype._getSigningKeyForJwt=function(H){var R=this;return this._metadataService.getSigningKeys().then((function(L){var V=H.header.kid;if(!L)return h.Log.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));h.Log.debug("ResponseValidator._validateIdToken: Received signing keys");var A=void 0;if(V)A=L.filter((function(M){return M.kid===V}))[0];else{if((L=R._filterByAlg(L,H.header.alg)).length>1)return h.Log.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));A=L[0]}return Promise.resolve(A)}))},x.prototype._getSigningKeyForJwtWithSingleRetry=function(H){var R=this;return this._getSigningKeyForJwt(H).then((function(L){return L?Promise.resolve(L):(R._metadataService.resetSigningKeys(),R._getSigningKeyForJwt(H))}))},x.prototype._validateIdToken=function(H,R){var L=this;if(!H.nonce)return h.Log.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));var V=this._joseUtil.parseJwt(R.id_token);return V&&V.header&&V.payload?H.nonce!==V.payload.nonce?(h.Log.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):this._metadataService.getIssuer().then((function(A){return h.Log.debug("ResponseValidator._validateIdToken: Received issuer"),L._getSigningKeyForJwtWithSingleRetry(V).then((function(M){if(!M)return h.Log.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var T=H.client_id,I=L._settings.clockSkew;return h.Log.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",I),L._joseUtil.validateJwt(R.id_token,M,A,T,I).then((function(){return h.Log.debug("ResponseValidator._validateIdToken: JWT validation successful"),V.payload.sub?(R.profile=V.payload,R):(h.Log.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))})):(h.Log.error("ResponseValidator._validateIdToken: Failed to parse id_token",V),Promise.reject(new Error("Failed to parse id_token")))},x.prototype._filterByAlg=function(H,R){var L=null;if(R.startsWith("RS"))L="RSA";else if(R.startsWith("PS"))L="PS";else{if(!R.startsWith("ES"))return h.Log.debug("ResponseValidator._filterByAlg: alg not supported: ",R),[];L="EC"}return h.Log.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",L),H=H.filter((function(V){return V.kty===L})),h.Log.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",L,H.length),H},x.prototype._validateAccessToken=function(H){if(!H.profile)return h.Log.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!H.profile.at_hash)return h.Log.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!H.id_token)return h.Log.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));var R=this._joseUtil.parseJwt(H.id_token);if(!R||!R.header)return h.Log.error("ResponseValidator._validateAccessToken: Failed to parse id_token",R),Promise.reject(new Error("Failed to parse id_token"));var L=R.header.alg;if(!L||L.length!==5)return h.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",L),Promise.reject(new Error("Unsupported alg: "+L));var V=L.substr(2,3);if(!V)return h.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",L,V),Promise.reject(new Error("Unsupported alg: "+L));if((V=parseInt(V))!==256&&V!==384&&V!==512)return h.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",L,V),Promise.reject(new Error("Unsupported alg: "+L));var A="sha"+V,M=this._joseUtil.hashString(H.access_token,A);if(!M)return h.Log.error("ResponseValidator._validateAccessToken: access_token hash failed:",A),Promise.reject(new Error("Failed to validate at_hash"));var T=M.substr(0,M.length/2),I=this._joseUtil.hexToBase64Url(T);return I!==H.profile.at_hash?(h.Log.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",I,H.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(h.Log.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(H))},x})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.UserInfoService=void 0;var l=u(7),h=u(2),_=u(0),y=u(4);function f(p,d){if(!(p instanceof d))throw new TypeError("Cannot call a class as a function")}o.UserInfoService=(function(){function p(d){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:l.JsonService,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h.MetadataService,x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:y.JoseUtil;if(f(this,p),!d)throw _.Log.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=d,this._jsonService=new S(void 0,void 0,this._getClaimsFromJwt.bind(this)),this._metadataService=new P(this._settings),this._joseUtil=x}return p.prototype.getClaims=function(S){var P=this;return S?this._metadataService.getUserInfoEndpoint().then((function(x){return _.Log.debug("UserInfoService.getClaims: received userinfo url",x),P._jsonService.getJson(x,S).then((function(q){return _.Log.debug("UserInfoService.getClaims: claims received",q),q}))})):(_.Log.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))},p.prototype._getClaimsFromJwt=function(S){var P=this;try{var x=this._joseUtil.parseJwt(S.responseText);if(!x||!x.header||!x.payload)return _.Log.error("UserInfoService._getClaimsFromJwt: Failed to parse JWT",x),Promise.reject(new Error("Failed to parse id_token"));var q=x.header.kid,H=void 0;switch(this._settings.userInfoJwtIssuer){case"OP":H=this._metadataService.getIssuer();break;case"ANY":H=Promise.resolve(x.payload.iss);break;default:H=Promise.resolve(this._settings.userInfoJwtIssuer)}return H.then((function(R){return _.Log.debug("UserInfoService._getClaimsFromJwt: Received issuer:"+R),P._metadataService.getSigningKeys().then((function(L){if(!L)return _.Log.error("UserInfoService._getClaimsFromJwt: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));_.Log.debug("UserInfoService._getClaimsFromJwt: Received signing keys");var V=void 0;if(q)V=L.filter((function(T){return T.kid===q}))[0];else{if((L=P._filterByAlg(L,x.header.alg)).length>1)return _.Log.error("UserInfoService._getClaimsFromJwt: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));V=L[0]}if(!V)return _.Log.error("UserInfoService._getClaimsFromJwt: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var A=P._settings.client_id,M=P._settings.clockSkew;return _.Log.debug("UserInfoService._getClaimsFromJwt: Validaing JWT; using clock skew (in seconds) of: ",M),P._joseUtil.validateJwt(S.responseText,V,R,A,M,void 0,!0).then((function(){return _.Log.debug("UserInfoService._getClaimsFromJwt: JWT validation successful"),x.payload}))}))}))}catch(R){return _.Log.error("UserInfoService._getClaimsFromJwt: Error parsing JWT response",R.message),void reject(R)}},p.prototype._filterByAlg=function(S,P){var x=null;if(P.startsWith("RS"))x="RSA";else if(P.startsWith("PS"))x="PS";else{if(!P.startsWith("ES"))return _.Log.debug("UserInfoService._filterByAlg: alg not supported: ",P),[];x="EC"}return _.Log.debug("UserInfoService._filterByAlg: Looking for keys that match kty: ",x),S=S.filter((function(q){return q.kty===x})),_.Log.debug("UserInfoService._filterByAlg: Number of keys that match kty: ",x,S.length),S},p})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.AllowedSigningAlgs=o.b64tohex=o.hextob64u=o.crypto=o.X509=o.KeyUtil=o.jws=void 0;var l=u(27);o.jws=l.jws,o.KeyUtil=l.KEYUTIL,o.X509=l.X509,o.crypto=l.crypto,o.hextob64u=l.hextob64u,o.b64tohex=l.b64tohex,o.AllowedSigningAlgs=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"]},function(a,o,u){(function(l){Object.defineProperty(o,"__esModule",{value:!0});var h,_,y,f,p,d,S,P,x,q,H,R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L={},V={},A=A||(h=Math,y=(_={}).lib={},f=y.Base=(function(){function t(){}return{extend:function(n){t.prototype=this;var s=new t;return n&&s.mixIn(n),s.hasOwnProperty("init")||(s.init=function(){s.$super.init.apply(this,arguments)}),s.init.prototype=s,s.$super=this,s},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var s in n)n.hasOwnProperty(s)&&(this[s]=n[s]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),p=y.WordArray=f.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n??4*e.length},toString:function(e){return(e||S).stringify(this)},concat:function(e){var n=this.words,s=e.words,c=this.sigBytes,g=e.sigBytes;if(this.clamp(),c%4)for(var b=0;b<g;b++){var C=s[b>>>2]>>>24-b%4*8&255;n[c+b>>>2]|=C<<24-(c+b)%4*8}else for(b=0;b<g;b+=4)n[c+b>>>2]=s[b>>>2];return this.sigBytes+=g,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=h.ceil(n/4)},clone:function(){var e=f.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var n=[],s=0;s<e;s+=4)n.push(4294967296*h.random()|0);return new p.init(n,e)}}),d=_.enc={},S=d.Hex={stringify:function(e){for(var n=e.words,s=e.sigBytes,c=[],g=0;g<s;g++){var b=n[g>>>2]>>>24-g%4*8&255;c.push((b>>>4).toString(16)),c.push((15&b).toString(16))}return c.join("")},parse:function(e){for(var n=e.length,s=[],c=0;c<n;c+=2)s[c>>>3]|=parseInt(e.substr(c,2),16)<<24-c%8*4;return new p.init(s,n/2)}},P=d.Latin1={stringify:function(e){for(var n=e.words,s=e.sigBytes,c=[],g=0;g<s;g++){var b=n[g>>>2]>>>24-g%4*8&255;c.push(String.fromCharCode(b))}return c.join("")},parse:function(e){for(var n=e.length,s=[],c=0;c<n;c++)s[c>>>2]|=(255&e.charCodeAt(c))<<24-c%4*8;return new p.init(s,n)}},x=d.Utf8={stringify:function(e){try{return decodeURIComponent(escape(P.stringify(e)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(e){return P.parse(unescape(encodeURIComponent(e)))}},q=y.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new p.init,this._nDataBytes=0},_append:function(e){typeof e=="string"&&(e=x.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var n=this._data,s=n.words,c=n.sigBytes,g=this.blockSize,b=c/(4*g),C=(b=e?h.ceil(b):h.max((0|b)-this._minBufferSize,0))*g,F=h.min(4*C,c);if(C){for(var k=0;k<C;k+=g)this._doProcessBlock(s,k);var U=s.splice(0,C);n.sigBytes-=F}return new p.init(U,F)},clone:function(){var e=f.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),y.Hasher=q.extend({cfg:f.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){q.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(n,s){return new e.init(s).finalize(n)}},_createHmacHelper:function(e){return function(n,s){return new H.HMAC.init(e,s).finalize(n)}}}),H=_.algo={},_);(function(t){var e,n=(e=A).lib,s=n.Base,c=n.WordArray;(e=e.x64={}).Word=s.extend({init:function(b,C){this.high=b,this.low=C}}),e.WordArray=s.extend({init:function(b,C){b=this.words=b||[],this.sigBytes=C??8*b.length},toX32:function(){for(var b=this.words,C=b.length,F=[],k=0;k<C;k++){var U=b[k];F.push(U.high),F.push(U.low)}return c.create(F,this.sigBytes)},clone:function(){for(var b=s.clone.call(this),C=b.words=this.words.slice(0),F=C.length,k=0;k<F;k++)C[k]=C[k].clone();return b}})})(),(function(){var t=A,e=t.lib.WordArray;t.enc.Base64={stringify:function(s){var c=s.words,g=s.sigBytes,b=this._map;s.clamp(),s=[];for(var C=0;C<g;C+=3)for(var F=(c[C>>>2]>>>24-C%4*8&255)<<16|(c[C+1>>>2]>>>24-(C+1)%4*8&255)<<8|c[C+2>>>2]>>>24-(C+2)%4*8&255,k=0;4>k&&C+.75*k<g;k++)s.push(b.charAt(F>>>6*(3-k)&63));if(c=b.charAt(64))for(;s.length%4;)s.push(c);return s.join("")},parse:function(s){var c=s.length,g=this._map;(b=g.charAt(64))&&(b=s.indexOf(b))!=-1&&(c=b);for(var b=[],C=0,F=0;F<c;F++)if(F%4){var k=g.indexOf(s.charAt(F-1))<<F%4*2,U=g.indexOf(s.charAt(F))>>>6-F%4*2;b[C>>>2]|=(k|U)<<24-C%4*8,C++}return e.create(b,C)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})(),(function(t){for(var e=A,n=(c=e.lib).WordArray,s=c.Hasher,c=e.algo,g=[],b=[],C=function(Z){return 4294967296*(Z-(0|Z))|0},F=2,k=0;64>k;){var U;e:{U=F;for(var N=t.sqrt(U),$=2;$<=N;$++)if(!(U%$)){U=!1;break e}U=!0}U&&(8>k&&(g[k]=C(t.pow(F,.5))),b[k]=C(t.pow(F,1/3)),k++),F++}var z=[];c=c.SHA256=s.extend({_doReset:function(){this._hash=new n.init(g.slice(0))},_doProcessBlock:function(Z,ee){for(var w=this._hash.words,D=w[0],B=w[1],K=w[2],Y=w[3],te=w[4],ue=w[5],oe=w[6],me=w[7],ae=0;64>ae;ae++){if(16>ae)z[ae]=0|Z[ee+ae];else{var de=z[ae-15],Ae=z[ae-2];z[ae]=((de<<25|de>>>7)^(de<<14|de>>>18)^de>>>3)+z[ae-7]+((Ae<<15|Ae>>>17)^(Ae<<13|Ae>>>19)^Ae>>>10)+z[ae-16]}de=me+((te<<26|te>>>6)^(te<<21|te>>>11)^(te<<7|te>>>25))+(te&ue^~te&oe)+b[ae]+z[ae],Ae=((D<<30|D>>>2)^(D<<19|D>>>13)^(D<<10|D>>>22))+(D&B^D&K^B&K),me=oe,oe=ue,ue=te,te=Y+de|0,Y=K,K=B,B=D,D=de+Ae|0}w[0]=w[0]+D|0,w[1]=w[1]+B|0,w[2]=w[2]+K|0,w[3]=w[3]+Y|0,w[4]=w[4]+te|0,w[5]=w[5]+ue|0,w[6]=w[6]+oe|0,w[7]=w[7]+me|0},_doFinalize:function(){var Z=this._data,ee=Z.words,w=8*this._nDataBytes,D=8*Z.sigBytes;return ee[D>>>5]|=128<<24-D%32,ee[14+(D+64>>>9<<4)]=t.floor(w/4294967296),ee[15+(D+64>>>9<<4)]=w,Z.sigBytes=4*ee.length,this._process(),this._hash},clone:function(){var Z=s.clone.call(this);return Z._hash=this._hash.clone(),Z}}),e.SHA256=s._createHelper(c),e.HmacSHA256=s._createHmacHelper(c)})(Math),(function(){function t(){return s.create.apply(s,arguments)}for(var e=A,n=e.lib.Hasher,s=(g=e.x64).Word,c=g.WordArray,g=e.algo,b=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],C=[],F=0;80>F;F++)C[F]=t();g=g.SHA512=n.extend({_doReset:function(){this._hash=new c.init([new s.init(1779033703,4089235720),new s.init(3144134277,2227873595),new s.init(1013904242,4271175723),new s.init(2773480762,1595750129),new s.init(1359893119,2917565137),new s.init(2600822924,725511199),new s.init(528734635,4215389547),new s.init(1541459225,327033209)])},_doProcessBlock:function(U,N){for(var $=(B=this._hash.words)[0],z=B[1],G=B[2],Z=B[3],ee=B[4],w=B[5],D=B[6],B=B[7],K=$.high,Y=$.low,te=z.high,ue=z.low,oe=G.high,me=G.low,ae=Z.high,de=Z.low,Ae=ee.high,Pe=ee.low,ke=w.high,lt=w.low,rt=D.high,nt=D.low,De=B.high,Ve=B.low,Ge=K,it=Y,lr=te,Yt=ue,hr=oe,Xt=me,an=ae,dr=de,bt=Ae,mt=Pe,Ur=ke,fr=lt,Dr=rt,pr=nt,un=De,gr=Ve,_t=0;80>_t;_t++){var Bt=C[_t];if(16>_t)var It=Bt.high=0|U[N+2*_t],Te=Bt.low=0|U[N+2*_t+1];else{It=((Te=(It=C[_t-15]).high)>>>1|(Rt=It.low)<<31)^(Te>>>8|Rt<<24)^Te>>>7;var Rt=(Rt>>>1|Te<<31)^(Rt>>>8|Te<<24)^(Rt>>>7|Te<<25),Qt=((Te=(Qt=C[_t-2]).high)>>>19|(qe=Qt.low)<<13)^(Te<<3|qe>>>29)^Te>>>6,qe=(qe>>>19|Te<<13)^(qe<<3|Te>>>29)^(qe>>>6|Te<<26),cn=(Te=C[_t-7]).high,jt=(Kt=C[_t-16]).high,Kt=Kt.low;It=(It=(It=It+cn+((Te=Rt+Te.low)>>>0<Rt>>>0?1:0))+Qt+((Te=Te+qe)>>>0<qe>>>0?1:0))+jt+((Te=Te+Kt)>>>0<Kt>>>0?1:0),Bt.high=It,Bt.low=Te}cn=bt&Ur^~bt&Dr,Kt=mt&fr^~mt&pr,Bt=Ge&lr^Ge&hr^lr&hr;var ps=it&Yt^it&Xt^Yt&Xt,gs=(Rt=(Ge>>>28|it<<4)^(Ge<<30|it>>>2)^(Ge<<25|it>>>7),Qt=(it>>>28|Ge<<4)^(it<<30|Ge>>>2)^(it<<25|Ge>>>7),(qe=b[_t]).high),vi=qe.low;jt=un+((bt>>>14|mt<<18)^(bt>>>18|mt<<14)^(bt<<23|mt>>>9))+((qe=gr+((mt>>>14|bt<<18)^(mt>>>18|bt<<14)^(mt<<23|bt>>>9)))>>>0<gr>>>0?1:0),un=Dr,gr=pr,Dr=Ur,pr=fr,Ur=bt,fr=mt,bt=an+(jt=(jt=(jt=jt+cn+((qe=qe+Kt)>>>0<Kt>>>0?1:0))+gs+((qe=qe+vi)>>>0<vi>>>0?1:0))+It+((qe=qe+Te)>>>0<Te>>>0?1:0))+((mt=dr+qe|0)>>>0<dr>>>0?1:0)|0,an=hr,dr=Xt,hr=lr,Xt=Yt,lr=Ge,Yt=it,Ge=jt+(Bt=Rt+Bt+((Te=Qt+ps)>>>0<Qt>>>0?1:0))+((it=qe+Te|0)>>>0<qe>>>0?1:0)|0}Y=$.low=Y+it,$.high=K+Ge+(Y>>>0<it>>>0?1:0),ue=z.low=ue+Yt,z.high=te+lr+(ue>>>0<Yt>>>0?1:0),me=G.low=me+Xt,G.high=oe+hr+(me>>>0<Xt>>>0?1:0),de=Z.low=de+dr,Z.high=ae+an+(de>>>0<dr>>>0?1:0),Pe=ee.low=Pe+mt,ee.high=Ae+bt+(Pe>>>0<mt>>>0?1:0),lt=w.low=lt+fr,w.high=ke+Ur+(lt>>>0<fr>>>0?1:0),nt=D.low=nt+pr,D.high=rt+Dr+(nt>>>0<pr>>>0?1:0),Ve=B.low=Ve+gr,B.high=De+un+(Ve>>>0<gr>>>0?1:0)},_doFinalize:function(){var U=this._data,N=U.words,$=8*this._nDataBytes,z=8*U.sigBytes;return N[z>>>5]|=128<<24-z%32,N[30+(z+128>>>10<<5)]=Math.floor($/4294967296),N[31+(z+128>>>10<<5)]=$,U.sigBytes=4*N.length,this._process(),this._hash.toX32()},clone:function(){var U=n.clone.call(this);return U._hash=this._hash.clone(),U},blockSize:32}),e.SHA512=n._createHelper(g),e.HmacSHA512=n._createHmacHelper(g)})(),(function(){var t=A,e=(c=t.x64).Word,n=c.WordArray,s=(c=t.algo).SHA512,c=c.SHA384=s.extend({_doReset:function(){this._hash=new n.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var b=s._doFinalize.call(this);return b.sigBytes-=16,b}});t.SHA384=s._createHelper(c),t.HmacSHA384=s._createHmacHelper(c)})();var M,T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function I(t){var e,n,s="";for(e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),s+=T.charAt(n>>6)+T.charAt(63&n);for(e+1==t.length?(n=parseInt(t.substring(e,e+1),16),s+=T.charAt(n<<2)):e+2==t.length&&(n=parseInt(t.substring(e,e+2),16),s+=T.charAt(n>>2)+T.charAt((3&n)<<4)),"=";(3&s.length)>0;)s+="=";return s}function Q(t){var e,n,s,c="",g=0;for(e=0;e<t.length&&t.charAt(e)!="=";++e)(s=T.indexOf(t.charAt(e)))<0||(g==0?(c+=Ue(s>>2),n=3&s,g=1):g==1?(c+=Ue(n<<2|s>>4),n=15&s,g=2):g==2?(c+=Ue(n),c+=Ue(s>>2),n=3&s,g=3):(c+=Ue(n<<2|s>>4),c+=Ue(15&s),g=0));return g==1&&(c+=Ue(n<<2)),c}function ne(t){var e,n=Q(t),s=new Array;for(e=0;2*e<n.length;++e)s[e]=parseInt(n.substring(2*e,2*e+2),16);return s}function O(t,e,n){t!=null&&(typeof t=="number"?this.fromNumber(t,e,n):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}function ie(){return new O(null)}L.appName=="Microsoft Internet Explorer"?(O.prototype.am=function(e,n,s,c,g,b){for(var C=32767&n,F=n>>15;--b>=0;){var k=32767&this[e],U=this[e++]>>15,N=F*k+U*C;g=((k=C*k+((32767&N)<<15)+s[c]+(1073741823&g))>>>30)+(N>>>15)+F*U+(g>>>30),s[c++]=1073741823&k}return g},M=30):L.appName!="Netscape"?(O.prototype.am=function(e,n,s,c,g,b){for(;--b>=0;){var C=n*this[e++]+s[c]+g;g=Math.floor(C/67108864),s[c++]=67108863&C}return g},M=26):(O.prototype.am=function(e,n,s,c,g,b){for(var C=16383&n,F=n>>14;--b>=0;){var k=16383&this[e],U=this[e++]>>14,N=F*k+U*C;g=((k=C*k+((16383&N)<<14)+s[c]+g)>>28)+(N>>14)+F*U,s[c++]=268435455&k}return g},M=28),O.prototype.DB=M,O.prototype.DM=(1<<M)-1,O.prototype.DV=1<<M,O.prototype.FV=Math.pow(2,52),O.prototype.F1=52-M,O.prototype.F2=2*M-52;var ye,be,We=new Array;for(ye=48,be=0;be<=9;++be)We[ye++]=be;for(ye=97,be=10;be<36;++be)We[ye++]=be;for(ye=65,be=10;be<36;++be)We[ye++]=be;function Ue(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function Qe(t,e){var n=We[t.charCodeAt(e)];return n??-1}function Be(t){var e=ie();return e.fromInt(t),e}function Ze(t){var e,n=1;return(e=t>>>16)!=0&&(t=e,n+=16),(e=t>>8)!=0&&(t=e,n+=8),(e=t>>4)!=0&&(t=e,n+=4),(e=t>>2)!=0&&(t=e,n+=2),(e=t>>1)!=0&&(t=e,n+=1),n}function ge(t){this.m=t}function we(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function ze(t,e){return t&e}function et(t,e){return t|e}function ot(t,e){return t^e}function st(t,e){return t&~e}function ft(t){if(t==0)return-1;var e=0;return(65535&t)==0&&(t>>=16,e+=16),(255&t)==0&&(t>>=8,e+=8),(15&t)==0&&(t>>=4,e+=4),(3&t)==0&&(t>>=2,e+=2),(1&t)==0&&++e,e}function Pt(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function tt(){}function at(t){return t}function Je(t){this.r2=ie(),this.q3=ie(),O.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}ge.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},ge.prototype.revert=function(e){return e},ge.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},ge.prototype.mulTo=function(e,n,s){e.multiplyTo(n,s),this.reduce(s)},ge.prototype.sqrTo=function(e,n){e.squareTo(n),this.reduce(n)},we.prototype.convert=function(e){var n=ie();return e.abs().dlShiftTo(this.m.t,n),n.divRemTo(this.m,null,n),e.s<0&&n.compareTo(O.ZERO)>0&&this.m.subTo(n,n),n},we.prototype.revert=function(e){var n=ie();return e.copyTo(n),this.reduce(n),n},we.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var n=0;n<this.m.t;++n){var s=32767&e[n],c=s*this.mpl+((s*this.mph+(e[n]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[s=n+this.m.t]+=this.m.am(0,c,e,n,0,this.m.t);e[s]>=e.DV;)e[s]-=e.DV,e[++s]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},we.prototype.mulTo=function(e,n,s){e.multiplyTo(n,s),this.reduce(s)},we.prototype.sqrTo=function(e,n){e.squareTo(n),this.reduce(n)},O.prototype.copyTo=function(e){for(var n=this.t-1;n>=0;--n)e[n]=this[n];e.t=this.t,e.s=this.s},O.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},O.prototype.fromString=function(e,n){var s;if(n==16)s=4;else if(n==8)s=3;else if(n==256)s=8;else if(n==2)s=1;else if(n==32)s=5;else{if(n!=4)return void this.fromRadix(e,n);s=2}this.t=0,this.s=0;for(var c=e.length,g=!1,b=0;--c>=0;){var C=s==8?255&e[c]:Qe(e,c);C<0?e.charAt(c)=="-"&&(g=!0):(g=!1,b==0?this[this.t++]=C:b+s>this.DB?(this[this.t-1]|=(C&(1<<this.DB-b)-1)<<b,this[this.t++]=C>>this.DB-b):this[this.t-1]|=C<<b,(b+=s)>=this.DB&&(b-=this.DB))}s==8&&(128&e[0])!=0&&(this.s=-1,b>0&&(this[this.t-1]|=(1<<this.DB-b)-1<<b)),this.clamp(),g&&O.ZERO.subTo(this,this)},O.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},O.prototype.dlShiftTo=function(e,n){var s;for(s=this.t-1;s>=0;--s)n[s+e]=this[s];for(s=e-1;s>=0;--s)n[s]=0;n.t=this.t+e,n.s=this.s},O.prototype.drShiftTo=function(e,n){for(var s=e;s<this.t;++s)n[s-e]=this[s];n.t=Math.max(this.t-e,0),n.s=this.s},O.prototype.lShiftTo=function(e,n){var s,c=e%this.DB,g=this.DB-c,b=(1<<g)-1,C=Math.floor(e/this.DB),F=this.s<<c&this.DM;for(s=this.t-1;s>=0;--s)n[s+C+1]=this[s]>>g|F,F=(this[s]&b)<<c;for(s=C-1;s>=0;--s)n[s]=0;n[C]=F,n.t=this.t+C+1,n.s=this.s,n.clamp()},O.prototype.rShiftTo=function(e,n){n.s=this.s;var s=Math.floor(e/this.DB);if(s>=this.t)n.t=0;else{var c=e%this.DB,g=this.DB-c,b=(1<<c)-1;n[0]=this[s]>>c;for(var C=s+1;C<this.t;++C)n[C-s-1]|=(this[C]&b)<<g,n[C-s]=this[C]>>c;c>0&&(n[this.t-s-1]|=(this.s&b)<<g),n.t=this.t-s,n.clamp()}},O.prototype.subTo=function(e,n){for(var s=0,c=0,g=Math.min(e.t,this.t);s<g;)c+=this[s]-e[s],n[s++]=c&this.DM,c>>=this.DB;if(e.t<this.t){for(c-=e.s;s<this.t;)c+=this[s],n[s++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;s<e.t;)c-=e[s],n[s++]=c&this.DM,c>>=this.DB;c-=e.s}n.s=c<0?-1:0,c<-1?n[s++]=this.DV+c:c>0&&(n[s++]=c),n.t=s,n.clamp()},O.prototype.multiplyTo=function(e,n){var s=this.abs(),c=e.abs(),g=s.t;for(n.t=g+c.t;--g>=0;)n[g]=0;for(g=0;g<c.t;++g)n[g+s.t]=s.am(0,c[g],n,g,0,s.t);n.s=0,n.clamp(),this.s!=e.s&&O.ZERO.subTo(n,n)},O.prototype.squareTo=function(e){for(var n=this.abs(),s=e.t=2*n.t;--s>=0;)e[s]=0;for(s=0;s<n.t-1;++s){var c=n.am(s,n[s],e,2*s,0,1);(e[s+n.t]+=n.am(s+1,2*n[s],e,2*s+1,c,n.t-s-1))>=n.DV&&(e[s+n.t]-=n.DV,e[s+n.t+1]=1)}e.t>0&&(e[e.t-1]+=n.am(s,n[s],e,2*s,0,1)),e.s=0,e.clamp()},O.prototype.divRemTo=function(e,n,s){var c=e.abs();if(!(c.t<=0)){var g=this.abs();if(g.t<c.t)return n?.fromInt(0),void(s!=null&&this.copyTo(s));s==null&&(s=ie());var b=ie(),C=this.s,F=e.s,k=this.DB-Ze(c[c.t-1]);k>0?(c.lShiftTo(k,b),g.lShiftTo(k,s)):(c.copyTo(b),g.copyTo(s));var U=b.t,N=b[U-1];if(N!=0){var $=N*(1<<this.F1)+(U>1?b[U-2]>>this.F2:0),z=this.FV/$,G=(1<<this.F1)/$,Z=1<<this.F2,ee=s.t,w=ee-U,D=n??ie();for(b.dlShiftTo(w,D),s.compareTo(D)>=0&&(s[s.t++]=1,s.subTo(D,s)),O.ONE.dlShiftTo(U,D),D.subTo(b,b);b.t<U;)b[b.t++]=0;for(;--w>=0;){var B=s[--ee]==N?this.DM:Math.floor(s[ee]*z+(s[ee-1]+Z)*G);if((s[ee]+=b.am(0,B,s,w,0,U))<B)for(b.dlShiftTo(w,D),s.subTo(D,s);s[ee]<--B;)s.subTo(D,s)}n!=null&&(s.drShiftTo(U,n),C!=F&&O.ZERO.subTo(n,n)),s.t=U,s.clamp(),k>0&&s.rShiftTo(k,s),C<0&&O.ZERO.subTo(s,s)}}},O.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if((1&e)==0)return 0;var n=3&e;return(n=(n=(n=(n=n*(2-(15&e)*n)&15)*(2-(255&e)*n)&255)*(2-((65535&e)*n&65535))&65535)*(2-e*n%this.DV)%this.DV)>0?this.DV-n:-n},O.prototype.isEven=function(){return(this.t>0?1&this[0]:this.s)==0},O.prototype.exp=function(e,n){if(e>4294967295||e<1)return O.ONE;var s=ie(),c=ie(),g=n.convert(this),b=Ze(e)-1;for(g.copyTo(s);--b>=0;)if(n.sqrTo(s,c),(e&1<<b)>0)n.mulTo(c,g,s);else{var C=s;s=c,c=C}return n.revert(s)},O.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var n;if(e==16)n=4;else if(e==8)n=3;else if(e==2)n=1;else if(e==32)n=5;else{if(e!=4)return this.toRadix(e);n=2}var s,c=(1<<n)-1,g=!1,b="",C=this.t,F=this.DB-C*this.DB%n;if(C-- >0)for(F<this.DB&&(s=this[C]>>F)>0&&(g=!0,b=Ue(s));C>=0;)F<n?(s=(this[C]&(1<<F)-1)<<n-F,s|=this[--C]>>(F+=this.DB-n)):(s=this[C]>>(F-=n)&c,F<=0&&(F+=this.DB,--C)),s>0&&(g=!0),g&&(b+=Ue(s));return g?b:"0"},O.prototype.negate=function(){var e=ie();return O.ZERO.subTo(this,e),e},O.prototype.abs=function(){return this.s<0?this.negate():this},O.prototype.compareTo=function(e){var n=this.s-e.s;if(n!=0)return n;var s=this.t;if((n=s-e.t)!=0)return this.s<0?-n:n;for(;--s>=0;)if((n=this[s]-e[s])!=0)return n;return 0},O.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+Ze(this[this.t-1]^this.s&this.DM)},O.prototype.mod=function(e){var n=ie();return this.abs().divRemTo(e,null,n),this.s<0&&n.compareTo(O.ZERO)>0&&e.subTo(n,n),n},O.prototype.modPowInt=function(e,n){var s;return s=e<256||n.isEven()?new ge(n):new we(n),this.exp(e,s)},O.ZERO=Be(0),O.ONE=Be(1),tt.prototype.convert=at,tt.prototype.revert=at,tt.prototype.mulTo=function(e,n,s){e.multiplyTo(n,s)},tt.prototype.sqrTo=function(e,n){e.squareTo(n)},Je.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var n=ie();return e.copyTo(n),this.reduce(n),n},Je.prototype.revert=function(e){return e},Je.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},Je.prototype.mulTo=function(e,n,s){e.multiplyTo(n,s),this.reduce(s)},Je.prototype.sqrTo=function(e,n){e.squareTo(n),this.reduce(n)};var Ce=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],W=(1<<26)/Ce[Ce.length-1];function m(){this.i=0,this.j=0,this.S=new Array}O.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},O.prototype.toRadix=function(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var n=this.chunkSize(e),s=Math.pow(e,n),c=Be(s),g=ie(),b=ie(),C="";for(this.divRemTo(c,g,b);g.signum()>0;)C=(s+b.intValue()).toString(e).substr(1)+C,g.divRemTo(c,g,b);return b.intValue().toString(e)+C},O.prototype.fromRadix=function(e,n){this.fromInt(0),n==null&&(n=10);for(var s=this.chunkSize(n),c=Math.pow(n,s),g=!1,b=0,C=0,F=0;F<e.length;++F){var k=Qe(e,F);k<0?e.charAt(F)=="-"&&this.signum()==0&&(g=!0):(C=n*C+k,++b>=s&&(this.dMultiply(c),this.dAddOffset(C,0),b=0,C=0))}b>0&&(this.dMultiply(Math.pow(n,b)),this.dAddOffset(C,0)),g&&O.ZERO.subTo(this,this)},O.prototype.fromNumber=function(e,n,s){if(typeof n=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,s),this.testBit(e-1)||this.bitwiseTo(O.ONE.shiftLeft(e-1),et,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(n);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(O.ONE.shiftLeft(e-1),this);else{var c=new Array,g=7&e;c.length=1+(e>>3),n.nextBytes(c),g>0?c[0]&=(1<<g)-1:c[0]=0,this.fromString(c,256)}},O.prototype.bitwiseTo=function(e,n,s){var c,g,b=Math.min(e.t,this.t);for(c=0;c<b;++c)s[c]=n(this[c],e[c]);if(e.t<this.t){for(g=e.s&this.DM,c=b;c<this.t;++c)s[c]=n(this[c],g);s.t=this.t}else{for(g=this.s&this.DM,c=b;c<e.t;++c)s[c]=n(g,e[c]);s.t=e.t}s.s=n(this.s,e.s),s.clamp()},O.prototype.changeBit=function(e,n){var s=O.ONE.shiftLeft(e);return this.bitwiseTo(s,n,s),s},O.prototype.addTo=function(e,n){for(var s=0,c=0,g=Math.min(e.t,this.t);s<g;)c+=this[s]+e[s],n[s++]=c&this.DM,c>>=this.DB;if(e.t<this.t){for(c+=e.s;s<this.t;)c+=this[s],n[s++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;s<e.t;)c+=e[s],n[s++]=c&this.DM,c>>=this.DB;c+=e.s}n.s=c<0?-1:0,c>0?n[s++]=c:c<-1&&(n[s++]=this.DV+c),n.t=s,n.clamp()},O.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},O.prototype.dAddOffset=function(e,n){if(e!=0){for(;this.t<=n;)this[this.t++]=0;for(this[n]+=e;this[n]>=this.DV;)this[n]-=this.DV,++n>=this.t&&(this[this.t++]=0),++this[n]}},O.prototype.multiplyLowerTo=function(e,n,s){var c,g=Math.min(this.t+e.t,n);for(s.s=0,s.t=g;g>0;)s[--g]=0;for(c=s.t-this.t;g<c;++g)s[g+this.t]=this.am(0,e[g],s,g,0,this.t);for(c=Math.min(e.t,n);g<c;++g)this.am(0,e[g],s,g,0,n-g);s.clamp()},O.prototype.multiplyUpperTo=function(e,n,s){--n;var c=s.t=this.t+e.t-n;for(s.s=0;--c>=0;)s[c]=0;for(c=Math.max(n-this.t,0);c<e.t;++c)s[this.t+c-n]=this.am(n-c,e[c],s,0,0,this.t+c-n);s.clamp(),s.drShiftTo(1,s)},O.prototype.modInt=function(e){if(e<=0)return 0;var n=this.DV%e,s=this.s<0?e-1:0;if(this.t>0)if(n==0)s=this[0]%e;else for(var c=this.t-1;c>=0;--c)s=(n*s+this[c])%e;return s},O.prototype.millerRabin=function(e){var n=this.subtract(O.ONE),s=n.getLowestSetBit();if(s<=0)return!1;var c=n.shiftRight(s);(e=e+1>>1)>Ce.length&&(e=Ce.length);for(var g=ie(),b=0;b<e;++b){g.fromInt(Ce[Math.floor(Math.random()*Ce.length)]);var C=g.modPow(c,this);if(C.compareTo(O.ONE)!=0&&C.compareTo(n)!=0){for(var F=1;F++<s&&C.compareTo(n)!=0;)if((C=C.modPowInt(2,this)).compareTo(O.ONE)==0)return!1;if(C.compareTo(n)!=0)return!1}}return!0},O.prototype.clone=function(){var e=ie();return this.copyTo(e),e},O.prototype.intValue=function(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},O.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24},O.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16},O.prototype.signum=function(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1},O.prototype.toByteArray=function(){var e=this.t,n=new Array;n[0]=this.s;var s,c=this.DB-e*this.DB%8,g=0;if(e-- >0)for(c<this.DB&&(s=this[e]>>c)!=(this.s&this.DM)>>c&&(n[g++]=s|this.s<<this.DB-c);e>=0;)c<8?(s=(this[e]&(1<<c)-1)<<8-c,s|=this[--e]>>(c+=this.DB-8)):(s=this[e]>>(c-=8)&255,c<=0&&(c+=this.DB,--e)),(128&s)!=0&&(s|=-256),g==0&&(128&this.s)!=(128&s)&&++g,(g>0||s!=this.s)&&(n[g++]=s);return n},O.prototype.equals=function(e){return this.compareTo(e)==0},O.prototype.min=function(e){return this.compareTo(e)<0?this:e},O.prototype.max=function(e){return this.compareTo(e)>0?this:e},O.prototype.and=function(e){var n=ie();return this.bitwiseTo(e,ze,n),n},O.prototype.or=function(e){var n=ie();return this.bitwiseTo(e,et,n),n},O.prototype.xor=function(e){var n=ie();return this.bitwiseTo(e,ot,n),n},O.prototype.andNot=function(e){var n=ie();return this.bitwiseTo(e,st,n),n},O.prototype.not=function(){for(var e=ie(),n=0;n<this.t;++n)e[n]=this.DM&~this[n];return e.t=this.t,e.s=~this.s,e},O.prototype.shiftLeft=function(e){var n=ie();return e<0?this.rShiftTo(-e,n):this.lShiftTo(e,n),n},O.prototype.shiftRight=function(e){var n=ie();return e<0?this.lShiftTo(-e,n):this.rShiftTo(e,n),n},O.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+ft(this[e]);return this.s<0?this.t*this.DB:-1},O.prototype.bitCount=function(){for(var e=0,n=this.s&this.DM,s=0;s<this.t;++s)e+=Pt(this[s]^n);return e},O.prototype.testBit=function(e){var n=Math.floor(e/this.DB);return n>=this.t?this.s!=0:(this[n]&1<<e%this.DB)!=0},O.prototype.setBit=function(e){return this.changeBit(e,et)},O.prototype.clearBit=function(e){return this.changeBit(e,st)},O.prototype.flipBit=function(e){return this.changeBit(e,ot)},O.prototype.add=function(e){var n=ie();return this.addTo(e,n),n},O.prototype.subtract=function(e){var n=ie();return this.subTo(e,n),n},O.prototype.multiply=function(e){var n=ie();return this.multiplyTo(e,n),n},O.prototype.divide=function(e){var n=ie();return this.divRemTo(e,n,null),n},O.prototype.remainder=function(e){var n=ie();return this.divRemTo(e,null,n),n},O.prototype.divideAndRemainder=function(e){var n=ie(),s=ie();return this.divRemTo(e,n,s),new Array(n,s)},O.prototype.modPow=function(e,n){var s,c,g=e.bitLength(),b=Be(1);if(g<=0)return b;s=g<18?1:g<48?3:g<144?4:g<768?5:6,c=g<8?new ge(n):n.isEven()?new Je(n):new we(n);var C=new Array,F=3,k=s-1,U=(1<<s)-1;if(C[1]=c.convert(this),s>1){var N=ie();for(c.sqrTo(C[1],N);F<=U;)C[F]=ie(),c.mulTo(N,C[F-2],C[F]),F+=2}var $,z,G=e.t-1,Z=!0,ee=ie();for(g=Ze(e[G])-1;G>=0;){for(g>=k?$=e[G]>>g-k&U:($=(e[G]&(1<<g+1)-1)<<k-g,G>0&&($|=e[G-1]>>this.DB+g-k)),F=s;(1&$)==0;)$>>=1,--F;if((g-=F)<0&&(g+=this.DB,--G),Z)C[$].copyTo(b),Z=!1;else{for(;F>1;)c.sqrTo(b,ee),c.sqrTo(ee,b),F-=2;F>0?c.sqrTo(b,ee):(z=b,b=ee,ee=z),c.mulTo(ee,C[$],b)}for(;G>=0&&(e[G]&1<<g)==0;)c.sqrTo(b,ee),z=b,b=ee,ee=z,--g<0&&(g=this.DB-1,--G)}return c.revert(b)},O.prototype.modInverse=function(e){var n=e.isEven();if(this.isEven()&&n||e.signum()==0)return O.ZERO;for(var s=e.clone(),c=this.clone(),g=Be(1),b=Be(0),C=Be(0),F=Be(1);s.signum()!=0;){for(;s.isEven();)s.rShiftTo(1,s),n?(g.isEven()&&b.isEven()||(g.addTo(this,g),b.subTo(e,b)),g.rShiftTo(1,g)):b.isEven()||b.subTo(e,b),b.rShiftTo(1,b);for(;c.isEven();)c.rShiftTo(1,c),n?(C.isEven()&&F.isEven()||(C.addTo(this,C),F.subTo(e,F)),C.rShiftTo(1,C)):F.isEven()||F.subTo(e,F),F.rShiftTo(1,F);s.compareTo(c)>=0?(s.subTo(c,s),n&&g.subTo(C,g),b.subTo(F,b)):(c.subTo(s,c),n&&C.subTo(g,C),F.subTo(b,F))}return c.compareTo(O.ONE)!=0?O.ZERO:F.compareTo(e)>=0?F.subtract(e):F.signum()<0?(F.addTo(e,F),F.signum()<0?F.add(e):F):F},O.prototype.pow=function(e){return this.exp(e,new tt)},O.prototype.gcd=function(e){var n=this.s<0?this.negate():this.clone(),s=e.s<0?e.negate():e.clone();if(n.compareTo(s)<0){var c=n;n=s,s=c}var g=n.getLowestSetBit(),b=s.getLowestSetBit();if(b<0)return n;for(g<b&&(b=g),b>0&&(n.rShiftTo(b,n),s.rShiftTo(b,s));n.signum()>0;)(g=n.getLowestSetBit())>0&&n.rShiftTo(g,n),(g=s.getLowestSetBit())>0&&s.rShiftTo(g,s),n.compareTo(s)>=0?(n.subTo(s,n),n.rShiftTo(1,n)):(s.subTo(n,s),s.rShiftTo(1,s));return b>0&&s.lShiftTo(b,s),s},O.prototype.isProbablePrime=function(e){var n,s=this.abs();if(s.t==1&&s[0]<=Ce[Ce.length-1]){for(n=0;n<Ce.length;++n)if(s[0]==Ce[n])return!0;return!1}if(s.isEven())return!1;for(n=1;n<Ce.length;){for(var c=Ce[n],g=n+1;g<Ce.length&&c<W;)c*=Ce[g++];for(c=s.modInt(c);n<g;)if(c%Ce[n++]==0)return!1}return s.millerRabin(e)},O.prototype.square=function(){var e=ie();return this.squareTo(e),e},m.prototype.init=function(e){var n,s,c;for(n=0;n<256;++n)this.S[n]=n;for(s=0,n=0;n<256;++n)s=s+this.S[n]+e[n%e.length]&255,c=this.S[n],this.S[n]=this.S[s],this.S[s]=c;this.i=0,this.j=0},m.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]};var v,j,J;function X(){(function(e){j[J++]^=255&e,j[J++]^=e>>8&255,j[J++]^=e>>16&255,j[J++]^=e>>24&255,J>=256&&(J-=256)})(new Date().getTime())}if(j==null){var re;if(j=new Array,J=0,V!==void 0&&(V.crypto!==void 0||V.msCrypto!==void 0)){var ce=V.crypto||V.msCrypto;if(ce.getRandomValues){var fe=new Uint8Array(32);for(ce.getRandomValues(fe),re=0;re<32;++re)j[J++]=fe[re]}else if(L.appName=="Netscape"&&L.appVersion<"5"){var Se=V.crypto.random(32);for(re=0;re<Se.length;++re)j[J++]=255&Se.charCodeAt(re)}}for(;J<256;)re=Math.floor(65536*Math.random()),j[J++]=re>>>8,j[J++]=255&re;J=0,X()}function _e(){if(v==null){for(X(),(v=(function(){return new m})()).init(j),J=0;J<j.length;++J)j[J]=0;J=0}return v.next()}function Fe(){}function ut(t,e){return new O(t,e)}function yt(t,e,n){for(var s="",c=0;s.length<e;)s+=n(String.fromCharCode.apply(String,t.concat([(4278190080&c)>>24,(16711680&c)>>16,(65280&c)>>8,255&c]))),c+=1;return s}function le(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Ie(t,e){this.x=e,this.q=t}function ve(t,e,n,s){this.curve=t,this.x=e,this.y=n,this.z=s??O.ONE,this.zinv=null}function pt(t,e,n){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(n),this.infinity=new ve(this,null,null)}Fe.prototype.nextBytes=function(e){var n;for(n=0;n<e.length;++n)e[n]=_e()},le.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},le.prototype.setPublic=function(e,n){if(this.isPublic=!0,this.isPrivate=!1,typeof e!="string")this.n=e,this.e=n;else{if(!(e!=null&&n!=null&&e.length>0&&n.length>0))throw"Invalid RSA public key";this.n=ut(e,16),this.e=parseInt(n,16)}},le.prototype.encrypt=function(e){var n=(function(b,C){if(C<b.length+11)throw"Message too long for RSA";for(var F=new Array,k=b.length-1;k>=0&&C>0;){var U=b.charCodeAt(k--);U<128?F[--C]=U:U>127&&U<2048?(F[--C]=63&U|128,F[--C]=U>>6|192):(F[--C]=63&U|128,F[--C]=U>>6&63|128,F[--C]=U>>12|224)}F[--C]=0;for(var N=new Fe,$=new Array;C>2;){for($[0]=0;$[0]==0;)N.nextBytes($);F[--C]=$[0]}return F[--C]=2,F[--C]=0,new O(F)})(e,this.n.bitLength()+7>>3);if(n==null)return null;var s=this.doPublic(n);if(s==null)return null;var c=s.toString(16);return(1&c.length)==0?c:"0"+c},le.prototype.encryptOAEP=function(e,n,s){var c=(function(F,k,U,N){var $=E.crypto.MessageDigest,z=E.crypto.Util,G=null;if(U||(U="sha1"),typeof U=="string"&&(G=$.getCanonicalAlgName(U),N=$.getHashLength(G),U=function(oe){return gt(z.hashHex(Ft(oe),G))}),F.length+2*N+2>k)throw"Message too long for RSA";var Z,ee="";for(Z=0;Z<k-F.length-2*N-2;Z+=1)ee+="\0";var w=U("")+ee+""+F,D=new Array(N);new Fe().nextBytes(D);var B=yt(D,w.length,U),K=[];for(Z=0;Z<w.length;Z+=1)K[Z]=w.charCodeAt(Z)^B.charCodeAt(Z);var Y=yt(K,D.length,U),te=[0];for(Z=0;Z<D.length;Z+=1)te[Z+1]=D[Z]^Y.charCodeAt(Z);return new O(te.concat(K))})(e,this.n.bitLength()+7>>3,n,s);if(c==null)return null;var g=this.doPublic(c);if(g==null)return null;var b=g.toString(16);return(1&b.length)==0?b:"0"+b},le.prototype.type="RSA",Ie.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.x.equals(e.x)},Ie.prototype.toBigInteger=function(){return this.x},Ie.prototype.negate=function(){return new Ie(this.q,this.x.negate().mod(this.q))},Ie.prototype.add=function(e){return new Ie(this.q,this.x.add(e.toBigInteger()).mod(this.q))},Ie.prototype.subtract=function(e){return new Ie(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))},Ie.prototype.multiply=function(e){return new Ie(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))},Ie.prototype.square=function(){return new Ie(this.q,this.x.square().mod(this.q))},Ie.prototype.divide=function(e){return new Ie(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))},ve.prototype.getX=function(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ve.prototype.getY=function(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ve.prototype.equals=function(e){return e==this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(O.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(O.ZERO))},ve.prototype.isInfinity=function(){return this.x==null&&this.y==null||this.z.equals(O.ZERO)&&!this.y.toBigInteger().equals(O.ZERO)},ve.prototype.negate=function(){return new ve(this.curve,this.x,this.y.negate(),this.z)},ve.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var n=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),s=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(O.ZERO.equals(s))return O.ZERO.equals(n)?this.twice():this.curve.getInfinity();var c=new O("3"),g=this.x.toBigInteger(),b=this.y.toBigInteger(),C=(e.x.toBigInteger(),e.y.toBigInteger(),s.square()),F=C.multiply(s),k=g.multiply(C),U=n.square().multiply(this.z),N=U.subtract(k.shiftLeft(1)).multiply(e.z).subtract(F).multiply(s).mod(this.curve.q),$=k.multiply(c).multiply(n).subtract(b.multiply(F)).subtract(U.multiply(n)).multiply(e.z).add(n.multiply(F)).mod(this.curve.q),z=F.multiply(this.z).multiply(e.z).mod(this.curve.q);return new ve(this.curve,this.curve.fromBigInteger(N),this.curve.fromBigInteger($),z)},ve.prototype.twice=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=new O("3"),n=this.x.toBigInteger(),s=this.y.toBigInteger(),c=s.multiply(this.z),g=c.multiply(s).mod(this.curve.q),b=this.curve.a.toBigInteger(),C=n.square().multiply(e);O.ZERO.equals(b)||(C=C.add(this.z.square().multiply(b)));var F=(C=C.mod(this.curve.q)).square().subtract(n.shiftLeft(3).multiply(g)).shiftLeft(1).multiply(c).mod(this.curve.q),k=C.multiply(e).multiply(n).subtract(g.shiftLeft(1)).shiftLeft(2).multiply(g).subtract(C.square().multiply(C)).mod(this.curve.q),U=c.square().multiply(c).shiftLeft(3).mod(this.curve.q);return new ve(this.curve,this.curve.fromBigInteger(F),this.curve.fromBigInteger(k),U)},ve.prototype.multiply=function(e){if(this.isInfinity())return this;if(e.signum()==0)return this.curve.getInfinity();var n,s=e,c=s.multiply(new O("3")),g=this.negate(),b=this,C=this.curve.q.subtract(e),F=C.multiply(new O("3")),k=new ve(this.curve,this.x,this.y),U=k.negate();for(n=c.bitLength()-2;n>0;--n){b=b.twice();var N=c.testBit(n);N!=s.testBit(n)&&(b=b.add(N?this:g))}for(n=F.bitLength()-2;n>0;--n){k=k.twice();var $=F.testBit(n);$!=C.testBit(n)&&(k=k.add($?k:U))}return b},ve.prototype.multiplyTwo=function(e,n,s){var c;c=e.bitLength()>s.bitLength()?e.bitLength()-1:s.bitLength()-1;for(var g=this.curve.getInfinity(),b=this.add(n);c>=0;)g=g.twice(),e.testBit(c)?g=s.testBit(c)?g.add(b):g.add(this):s.testBit(c)&&(g=g.add(n)),--c;return g},pt.prototype.getQ=function(){return this.q},pt.prototype.getA=function(){return this.a},pt.prototype.getB=function(){return this.b},pt.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)},pt.prototype.getInfinity=function(){return this.infinity},pt.prototype.fromBigInteger=function(e){return new Ie(this.q,e)},pt.prototype.decodePointHex=function(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var n=(e.length-2)/2,s=e.substr(2,n),c=e.substr(n+2,n);return new ve(this,this.fromBigInteger(new O(s,16)),this.fromBigInteger(new O(c,16)));default:return null}},Ie.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ve.prototype.getEncoded=function(t){var e=function(b,C){var F=b.toByteArrayUnsigned();if(C<F.length)F=F.slice(F.length-C);else for(;C>F.length;)F.unshift(0);return F},n=this.getX().toBigInteger(),s=this.getY().toBigInteger(),c=e(n,32);return t?s.isEven()?c.unshift(2):c.unshift(3):(c.unshift(4),c=c.concat(e(s,32))),c},ve.decodeFrom=function(t,e){e[0];var n=e.length-1,s=e.slice(1,1+n/2),c=e.slice(1+n/2,1+n);s.unshift(0),c.unshift(0);var g=new O(s),b=new O(c);return new ve(t,t.fromBigInteger(g),t.fromBigInteger(b))},ve.decodeFromHex=function(t,e){e.substr(0,2);var n=e.length-2,s=e.substr(2,n/2),c=e.substr(2+n/2,n/2),g=new O(s,16),b=new O(c,16);return new ve(t,t.fromBigInteger(g),t.fromBigInteger(b))},ve.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var e=t.x.subtract(this.x),n=t.y.subtract(this.y).divide(e),s=n.square().subtract(this.x).subtract(t.x),c=n.multiply(this.x.subtract(s)).subtract(this.y);return new ve(this.curve,s,c)},ve.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var t=this.curve.fromBigInteger(O.valueOf(2)),e=this.curve.fromBigInteger(O.valueOf(3)),n=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(t)),s=n.square().subtract(this.x.multiply(t)),c=n.multiply(this.x.subtract(s)).subtract(this.y);return new ve(this.curve,s,c)},ve.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(t.signum()==0)return this.curve.getInfinity();var e,n=t,s=n.multiply(new O("3")),c=this.negate(),g=this;for(e=s.bitLength()-2;e>0;--e){g=g.twice();var b=s.testBit(e);b!=n.testBit(e)&&(g=g.add2D(b?this:c))}return g},ve.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),n=this.curve.getA().toBigInteger(),s=this.curve.getB().toBigInteger(),c=this.curve.getQ(),g=e.multiply(e).mod(c),b=t.multiply(t).multiply(t).add(n.multiply(t)).add(s).mod(c);return g.equals(b)},ve.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ve.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),n=this.getY().toBigInteger();if(e.compareTo(O.ONE)<0||e.compareTo(t.subtract(O.ONE))>0)throw new Error("x coordinate out of bounds");if(n.compareTo(O.ONE)<0||n.compareTo(t.subtract(O.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var ri=(function(){var t=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),e=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),n={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function s(b,C,F){return C?n[C]:String.fromCharCode(parseInt(F,16))}var c=new String(""),g=Object.hasOwnProperty;return function(b,C){var F,k,U=b.match(t),N=U[0],$=!1;N==="{"?F={}:N==="["?F=[]:(F=[],$=!0);for(var z=[F],G=1-$,Z=U.length;G<Z;++G){var ee;switch((N=U[G]).charCodeAt(0)){default:(ee=z[0])[k||ee.length]=+N,k=void 0;break;case 34:if((N=N.substring(1,N.length-1)).indexOf("\\")!==-1&&(N=N.replace(e,s)),ee=z[0],!k){if(!(ee instanceof Array)){k=N||c;break}k=ee.length}ee[k]=N,k=void 0;break;case 91:ee=z[0],z.unshift(ee[k||ee.length]=[]),k=void 0;break;case 93:z.shift();break;case 102:(ee=z[0])[k||ee.length]=!1,k=void 0;break;case 110:(ee=z[0])[k||ee.length]=null,k=void 0;break;case 116:(ee=z[0])[k||ee.length]=!0,k=void 0;break;case 123:ee=z[0],z.unshift(ee[k||ee.length]={}),k=void 0;break;case 125:z.shift()}}if($){if(z.length!==1)throw new Error;F=F[0]}else if(z.length)throw new Error;return C&&(F=(function w(D,B){var K=D[B];if(K&&(K===void 0?"undefined":R(K))==="object"){var Y=null;for(var te in K)if(g.call(K,te)&&K!==D){var ue=w(K,te);ue!==void 0?K[te]=ue:(Y||(Y=[]),Y.push(te))}if(Y)for(var oe=Y.length;--oe>=0;)delete K[Y[oe]]}return C.call(D,B,K)})({"":F},"")),F}})();E!==void 0&&E||(o.KJUR=E={}),E.asn1!==void 0&&E.asn1||(E.asn1={}),E.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if(e.substr(0,1)!="-")e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var n=e.substr(1).length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var s="",c=0;c<n;c++)s+="f";e=new O(s,16).xor(t).add(O.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return ct(t,e)},this.newObject=function(t){var e=E.asn1,n=e.ASN1Object,s=e.DERBoolean,c=e.DERInteger,g=e.DERBitString,b=e.DEROctetString,C=e.DERNull,F=e.DERObjectIdentifier,k=e.DEREnumerated,U=e.DERUTF8String,N=e.DERNumericString,$=e.DERPrintableString,z=e.DERTeletexString,G=e.DERIA5String,Z=e.DERUTCTime,ee=e.DERGeneralizedTime,w=e.DERVisibleString,D=e.DERBMPString,B=e.DERSequence,K=e.DERSet,Y=e.DERTaggedObject,te=e.ASN1Util.newObject;if(t instanceof e.ASN1Object)return t;var ue=Object.keys(t);if(ue.length!=1)throw new Error("key of param shall be only one.");var oe=ue[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+oe+":")==-1)throw new Error("undefined key: "+oe);if(oe=="bool")return new s(t[oe]);if(oe=="int")return new c(t[oe]);if(oe=="bitstr")return new g(t[oe]);if(oe=="octstr")return new b(t[oe]);if(oe=="null")return new C(t[oe]);if(oe=="oid")return new F(t[oe]);if(oe=="enum")return new k(t[oe]);if(oe=="utf8str")return new U(t[oe]);if(oe=="numstr")return new N(t[oe]);if(oe=="prnstr")return new $(t[oe]);if(oe=="telstr")return new z(t[oe]);if(oe=="ia5str")return new G(t[oe]);if(oe=="utctime")return new Z(t[oe]);if(oe=="gentime")return new ee(t[oe]);if(oe=="visstr")return new w(t[oe]);if(oe=="bmpstr")return new D(t[oe]);if(oe=="asn1")return new n(t[oe]);if(oe=="seq"){for(var me=t[oe],ae=[],de=0;de<me.length;de++){var Ae=te(me[de]);ae.push(Ae)}return new B({array:ae})}if(oe=="set"){for(me=t[oe],ae=[],de=0;de<me.length;de++)Ae=te(me[de]),ae.push(Ae);return new K({array:ae})}if(oe=="tag"){var Pe=t[oe];if(Object.prototype.toString.call(Pe)==="[object Array]"&&Pe.length==3){var ke=te(Pe[2]);return new Y({tag:Pe[0],explicit:Pe[1],obj:ke})}return new Y(Pe)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},E.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",n=parseInt(t.substr(0,2),16),s=(e=Math.floor(n/40)+"."+n%40,""),c=2;c<t.length;c+=2){var g=("00000000"+parseInt(t.substr(c,2),16).toString(2)).slice(-8);s+=g.substr(1,7),g.substr(0,1)=="0"&&(e=e+"."+new O(s,2).toString(10),s="")}return e},E.asn1.ASN1Util.oidIntToHex=function(t){var e=function(F){var k=F.toString(16);return k.length==1&&(k="0"+k),k},n=function(F){var k="",U=new O(F,10).toString(2),N=7-U.length%7;N==7&&(N=0);for(var $="",z=0;z<N;z++)$+="0";for(U=$+U,z=0;z<U.length-1;z+=7){var G=U.substr(z,7);z!=U.length-7&&(G="1"+G),k+=e(parseInt(G,2))}return k};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var s="",c=t.split("."),g=40*parseInt(c[0])+parseInt(c[1]);s+=e(g),c.splice(0,2);for(var b=0;b<c.length;b++)s+=n(c[b]);return s},E.asn1.ASN1Object=function(t){this.params=null,this.getLengthHexFromValue=function(){if(this.hV===void 0||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n=0,v="+this.hV);var e=this.hV.length/2,n=e.toString(16);if(n.length%2==1&&(n="0"+n),e<128)return n;var s=n.length/2;if(s>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+s).toString(16)+n},this.getEncodedHex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(e){this.params=e},t!=null&&t.tlv!=null&&(this.hTLV=t.tlv,this.isModified=!1)},E.asn1.DERAbstractString=function(t){E.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=rn(this.s).toLowerCase()},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},t!==void 0&&(typeof t=="string"?this.setString(t):t.str!==void 0?this.setString(t.str):t.hex!==void 0&&this.setStringHex(t.hex))},Le(E.asn1.DERAbstractString,E.asn1.ASN1Object),E.asn1.DERAbstractTime=function(t){E.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){var n=e.getTime()+6e4*e.getTimezoneOffset();return new Date(n)},this.formatDate=function(e,n,s){var c=this.zeroPadding,g=this.localDateToUTC(e),b=String(g.getFullYear());n=="utc"&&(b=b.substr(2,2));var C=b+c(String(g.getMonth()+1),2)+c(String(g.getDate()),2)+c(String(g.getHours()),2)+c(String(g.getMinutes()),2)+c(String(g.getSeconds()),2);if(s===!0){var F=g.getMilliseconds();if(F!=0){var k=c(String(F),3);C=C+"."+(k=k.replace(/[0]+$/,""))}}return C+"Z"},this.zeroPadding=function(e,n){return e.length>=n?e:new Array(n-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=Tt(e)},this.setByDateValue=function(e,n,s,c,g,b){var C=new Date(Date.UTC(e,n-1,s,c,g,b,0));this.setByDate(C)},this.getFreshValueHex=function(){return this.hV}},Le(E.asn1.DERAbstractTime,E.asn1.ASN1Object),E.asn1.DERAbstractStructured=function(t){E.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,t!==void 0&&t.array!==void 0&&(this.asn1Array=t.array)},Le(E.asn1.DERAbstractStructured,E.asn1.ASN1Object),E.asn1.DERBoolean=function(t){E.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=t==0?"010100":"0101ff"},Le(E.asn1.DERBoolean,E.asn1.ASN1Object),E.asn1.DERInteger=function(t){E.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=E.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var n=new O(String(e),10);this.setByBigInteger(n)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},t!==void 0&&(t.bigint!==void 0?this.setByBigInteger(t.bigint):t.int!==void 0?this.setByInteger(t.int):typeof t=="number"?this.setByInteger(t):t.hex!==void 0&&this.setValueHex(t.hex))},Le(E.asn1.DERInteger,E.asn1.ASN1Object),E.asn1.DERBitString=function(t){if(t!==void 0&&t.obj!==void 0){var e=E.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}E.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(n){this.hTLV=null,this.isModified=!0,this.hV=n},this.setUnusedBitsAndHexValue=function(n,s){if(n<0||7<n)throw"unused bits shall be from 0 to 7: u = "+n;var c="0"+n;this.hTLV=null,this.isModified=!0,this.hV=c+s},this.setByBinaryString=function(n){var s=8-(n=n.replace(/0+$/,"")).length%8;s==8&&(s=0);for(var c=0;c<=s;c++)n+="0";var g="";for(c=0;c<n.length-1;c+=8){var b=n.substr(c,8),C=parseInt(b,2).toString(16);C.length==1&&(C="0"+C),g+=C}this.hTLV=null,this.isModified=!0,this.hV="0"+s+g},this.setByBooleanArray=function(n){for(var s="",c=0;c<n.length;c++)n[c]==1?s+="1":s+="0";this.setByBinaryString(s)},this.newFalseArray=function(n){for(var s=new Array(n),c=0;c<n;c++)s[c]=!1;return s},this.getFreshValueHex=function(){return this.hV},t!==void 0&&(typeof t=="string"&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):t.hex!==void 0?this.setHexValueIncludingUnusedBits(t.hex):t.bin!==void 0?this.setByBinaryString(t.bin):t.array!==void 0&&this.setByBooleanArray(t.array))},Le(E.asn1.DERBitString,E.asn1.ASN1Object),E.asn1.DEROctetString=function(t){if(t!==void 0&&t.obj!==void 0){var e=E.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}E.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},Le(E.asn1.DEROctetString,E.asn1.DERAbstractString),E.asn1.DERNull=function(){E.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},Le(E.asn1.DERNull,E.asn1.ASN1Object),E.asn1.DERObjectIdentifier=function(t){E.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){var n=(function(c){var g=function($){var z=$.toString(16);return z.length==1&&(z="0"+z),z},b=function($){var z="",G=parseInt($,10).toString(2),Z=7-G.length%7;Z==7&&(Z=0);for(var ee="",w=0;w<Z;w++)ee+="0";for(G=ee+G,w=0;w<G.length-1;w+=7){var D=G.substr(w,7);w!=G.length-7&&(D="1"+D),z+=g(parseInt(D,2))}return z};try{if(!c.match(/^[0-9.]+$/))return null;var C="",F=c.split("."),k=40*parseInt(F[0],10)+parseInt(F[1],10);C+=g(k),F.splice(0,2);for(var U=0;U<F.length;U++)C+=b(F[U]);return C}catch{return null}})(e);if(n==null)throw new Error("malformed oid string: "+e);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.setValueName=function(e){var n=E.asn1.x509.OID.name2oid(e);if(n==="")throw new Error("DERObjectIdentifier oidName undefined: "+e);this.setValueOidString(n)},this.setValueNameOrOid=function(e){e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){typeof e=="string"?this.setValueNameOrOid(e):e.oid!==void 0?this.setValueNameOrOid(e.oid):e.name!==void 0?this.setValueNameOrOid(e.name):e.hex!==void 0&&this.setValueHex(e.hex)},t!==void 0&&this.setByParam(t)},Le(E.asn1.DERObjectIdentifier,E.asn1.ASN1Object),E.asn1.DEREnumerated=function(t){E.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=E.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var n=new O(String(e),10);this.setByBigInteger(n)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},t!==void 0&&(t.int!==void 0?this.setByInteger(t.int):typeof t=="number"?this.setByInteger(t):t.hex!==void 0&&this.setValueHex(t.hex))},Le(E.asn1.DEREnumerated,E.asn1.ASN1Object),E.asn1.DERUTF8String=function(t){E.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},Le(E.asn1.DERUTF8String,E.asn1.DERAbstractString),E.asn1.DERNumericString=function(t){E.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},Le(E.asn1.DERNumericString,E.asn1.DERAbstractString),E.asn1.DERPrintableString=function(t){E.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},Le(E.asn1.DERPrintableString,E.asn1.DERAbstractString),E.asn1.DERTeletexString=function(t){E.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},Le(E.asn1.DERTeletexString,E.asn1.DERAbstractString),E.asn1.DERIA5String=function(t){E.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},Le(E.asn1.DERIA5String,E.asn1.DERAbstractString),E.asn1.DERVisibleString=function(t){E.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="1a"},Le(E.asn1.DERVisibleString,E.asn1.DERAbstractString),E.asn1.DERBMPString=function(t){E.asn1.DERBMPString.superclass.constructor.call(this,t),this.hT="1e"},Le(E.asn1.DERBMPString,E.asn1.DERAbstractString),E.asn1.DERUTCTime=function(t){E.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=Tt(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=Tt(this.s)),this.hV},t!==void 0&&(t.str!==void 0?this.setString(t.str):typeof t=="string"&&t.match(/^[0-9]{12}Z$/)?this.setString(t):t.hex!==void 0?this.setStringHex(t.hex):t.date!==void 0&&this.setByDate(t.date))},Le(E.asn1.DERUTCTime,E.asn1.DERAbstractTime),E.asn1.DERGeneralizedTime=function(t){E.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=Tt(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=Tt(this.s)),this.hV},t!==void 0&&(t.str!==void 0?this.setString(t.str):typeof t=="string"&&t.match(/^[0-9]{14}Z$/)?this.setString(t):t.hex!==void 0?this.setStringHex(t.hex):t.date!==void 0&&this.setByDate(t.date),t.millis===!0&&(this.withMillis=!0))},Le(E.asn1.DERGeneralizedTime,E.asn1.DERAbstractTime),E.asn1.DERSequence=function(t){E.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var e="",n=0;n<this.asn1Array.length;n++)e+=this.asn1Array[n].getEncodedHex();return this.hV=e,this.hV}},Le(E.asn1.DERSequence,E.asn1.DERAbstractStructured),E.asn1.DERSet=function(t){E.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,n=0;n<this.asn1Array.length;n++){var s=this.asn1Array[n];e.push(s.getEncodedHex())}return this.sortFlag==1&&e.sort(),this.hV=e.join(""),this.hV},t!==void 0&&t.sortflag!==void 0&&t.sortflag==0&&(this.sortFlag=!1)},Le(E.asn1.DERSet,E.asn1.DERAbstractStructured),E.asn1.DERTaggedObject=function(t){E.asn1.DERTaggedObject.superclass.constructor.call(this);var e=E.asn1;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(n,s,c){this.hT=s,this.isExplicit=n,this.asn1Object=c,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=c.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,s),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(n){n.tag!=null&&(this.hT=n.tag),n.explicit!=null&&(this.isExplicit=n.explicit),n.tage!=null&&(this.hT=n.tage,this.isExplicit=!0),n.tagi!=null&&(this.hT=n.tagi,this.isExplicit=!1),n.obj!=null&&(n.obj instanceof e.ASN1Object?(this.asn1Object=n.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)):R(n.obj)=="object"&&(this.asn1Object=e.ASN1Util.newObject(n.obj),this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},t!=null&&this.setByParam(t)},Le(E.asn1.DERTaggedObject,E.asn1.ASN1Object);var E,ur,wt,se=new function(){};function ni(t){for(var e=new Array,n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}function ii(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}function Pr(t){for(var e="",n=0;n<t.length;n++){var s=t[n].toString(16);s.length==1&&(s="0"+s),e+=s}return e}function Tt(t){return Pr(ni(t))}function Tr(t){return t=(t=(t=t.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function cr(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),t=(t=t.replace(/-/g,"+")).replace(/_/g,"/")}function je(t){return t.length%2==1&&(t="0"+t),Tr(I(t))}function xe(t){return Q(cr(t))}function rn(t){return Ir(Lr(t))}function Ke(t){return decodeURIComponent(Rr(t))}function gt(t){for(var e="",n=0;n<t.length-1;n+=2)e+=String.fromCharCode(parseInt(t.substr(n,2),16));return e}function Ft(t){for(var e="",n=0;n<t.length;n++)e+=("0"+t.charCodeAt(n).toString(16)).slice(-2);return e}function oi(t){return I(t)}function si(t){var e=oi(t).replace(/(.{64})/g,`$1\r
`);return e=e.replace(/\r\n$/,"")}function ai(t){return Q(t.replace(/[^0-9A-Za-z\/+=]*/g,""))}function ct(t,e){return"-----BEGIN "+e+`-----\r
`+si(t)+`\r
-----END `+e+`-----\r
`}function At(t,e){if(t.indexOf("-----BEGIN ")==-1)throw"can't find PEM header: "+e;return ai(t=e!==void 0?(t=t.replace(new RegExp("^[^]*-----BEGIN "+e+"-----"),"")).replace(new RegExp("-----END "+e+"-----[^]*$"),""):(t=t.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function nn(t){var e,n,s,c,g,b,C,F,k,U,N;if(N=t.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return F=N[1],e=parseInt(F),F.length===2&&(50<=e&&e<100?e=1900+e:0<=e&&e<50&&(e=2e3+e)),n=parseInt(N[2])-1,s=parseInt(N[3]),c=parseInt(N[4]),g=parseInt(N[5]),b=parseInt(N[6]),C=0,(k=N[7])!==""&&(U=(k.substr(1)+"00").substr(0,3),C=parseInt(U)),Date.UTC(e,n,s,c,g,b,C);throw"unsupported zulu format: "+t}function ui(t){return~~(nn(t)/1e3)}function Ir(t){return t.replace(/%/g,"")}function Rr(t){return t.replace(/(..)/g,"%$1")}function ci(t){var e="malformed IPv6 address";if(!t.match(/^[0-9A-Fa-f:]+$/))throw e;var n=(t=t.toLowerCase()).split(":").length-1;if(n<2)throw e;var s=":".repeat(7-n+2),c=(t=t.replace("::",s)).split(":");if(c.length!=8)throw e;for(var g=0;g<8;g++)c[g]=("0000"+c[g]).slice(-4);return c.join("")}function li(t){if(!t.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var e=(t=t.toLowerCase()).match(/.{1,4}/g),n=0;n<8;n++)e[n]=e[n].replace(/^0+/,""),e[n]==""&&(e[n]="0");var s=(t=":"+e.join(":")+":").match(/:(0:){2,}/g);if(s===null)return t.slice(1,-1);var c="";for(n=0;n<s.length;n++)s[n].length>c.length&&(c=s[n]);return(t=t.replace(c,"::")).slice(1,-1)}function on(t){var e="malformed hex value";if(!t.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw e;if(t.length!=8)return t.length==32?li(t):t;try{return parseInt(t.substr(0,2),16)+"."+parseInt(t.substr(2,2),16)+"."+parseInt(t.substr(4,2),16)+"."+parseInt(t.substr(6,2),16)}catch{throw e}}function hi(t){return t.match(/.{4}/g).map((function(n){var s=parseInt(n.substr(0,2),16),c=parseInt(n.substr(2),16);if(s==0&c<128)return String.fromCharCode(c);if(s<8){var g=128|63&c;return Ke((192|(7&s)<<3|(192&c)>>6).toString(16)+g.toString(16))}g=128|(15&s)<<2|(192&c)>>6;var b=128|63&c;return Ke((224|(240&s)>>4).toString(16)+g.toString(16)+b.toString(16))})).join("")}function Lr(t){for(var e=encodeURIComponent(t),n="",s=0;s<e.length;s++)e[s]=="%"?(n+=e.substr(s,3),s+=2):n=n+"%"+Tt(e[s]);return n}function di(t){return!(t.length%2!=0||!t.match(/^[0-9a-f]+$/)&&!t.match(/^[0-9A-F]+$/))}function sn(t){return t.length%2==1?"0"+t:t.substr(0,1)>"7"?"00"+t:t}se.getLblen=function(t,e){if(t.substr(e+2,1)!="8")return 1;var n=parseInt(t.substr(e+3,1));return n==0?-1:0<n&&n<10?n+1:-2},se.getL=function(t,e){var n=se.getLblen(t,e);return n<1?"":t.substr(e+2,2*n)},se.getVblen=function(t,e){var n;return(n=se.getL(t,e))==""?-1:(n.substr(0,1)==="8"?new O(n.substr(2),16):new O(n,16)).intValue()},se.getVidx=function(t,e){var n=se.getLblen(t,e);return n<0?n:e+2*(n+1)},se.getV=function(t,e){var n=se.getVidx(t,e),s=se.getVblen(t,e);return t.substr(n,2*s)},se.getTLV=function(t,e){return t.substr(e,2)+se.getL(t,e)+se.getV(t,e)},se.getTLVblen=function(t,e){return 2+2*se.getLblen(t,e)+2*se.getVblen(t,e)},se.getNextSiblingIdx=function(t,e){return se.getVidx(t,e)+2*se.getVblen(t,e)},se.getChildIdx=function(t,e){var n,s,c,g=se,b=[];n=g.getVidx(t,e),s=2*g.getVblen(t,e),t.substr(e,2)=="03"&&(n+=2,s-=2),c=0;for(var C=n;c<=s;){var F=g.getTLVblen(t,C);if((c+=F)<=s&&b.push(C),C+=F,c>=s)break}return b},se.getNthChildIdx=function(t,e,n){return se.getChildIdx(t,e)[n]},se.getIdxbyList=function(t,e,n,s){var c,g,b=se;return n.length==0?s!==void 0&&t.substr(e,2)!==s?-1:e:(c=n.shift())>=(g=b.getChildIdx(t,e)).length?-1:b.getIdxbyList(t,g[c],n,s)},se.getIdxbyListEx=function(t,e,n,s){var c,g,b=se;if(n.length==0)return s!==void 0&&t.substr(e,2)!==s?-1:e;c=n.shift(),g=b.getChildIdx(t,e);for(var C=0,F=0;F<g.length;F++){var k=t.substr(g[F],2);if(typeof c=="number"&&!b.isContextTag(k)&&C==c||typeof c=="string"&&b.isContextTag(k,c))return b.getIdxbyListEx(t,g[F],n,s);b.isContextTag(k)||C++}return-1},se.getTLVbyList=function(t,e,n,s){var c=se,g=c.getIdxbyList(t,e,n,s);return g==-1||g>=t.length?null:c.getTLV(t,g)},se.getTLVbyListEx=function(t,e,n,s){var c=se,g=c.getIdxbyListEx(t,e,n,s);return g==-1?null:c.getTLV(t,g)},se.getVbyList=function(t,e,n,s,c){var g,b,C=se;return(g=C.getIdxbyList(t,e,n,s))==-1||g>=t.length?null:(b=C.getV(t,g),c===!0&&(b=b.substr(2)),b)},se.getVbyListEx=function(t,e,n,s,c){var g,b,C=se;return(g=C.getIdxbyListEx(t,e,n,s))==-1?null:(b=C.getV(t,g),t.substr(g,2)=="03"&&c!==!1&&(b=b.substr(2)),b)},se.getInt=function(t,e,n){n==null&&(n=-1);try{var s=t.substr(e,2);if(s!="02"&&s!="03")return n;var c=se.getV(t,e);return s=="02"?parseInt(c,16):(function(b){try{var C=b.substr(0,2);if(C=="00")return parseInt(b.substr(2),16);var F=parseInt(C,16),k=b.substr(2),U=parseInt(k,16).toString(2);return U=="0"&&(U="00000000"),U=U.slice(0,0-F),parseInt(U,2)}catch{return-1}})(c)}catch{return n}},se.getOID=function(t,e,n){n==null&&(n=null);try{return t.substr(e,2)!="06"?n:(function(c){if(!di(c))return null;try{var g=[],b=c.substr(0,2),C=parseInt(b,16);g[0]=new String(Math.floor(C/40)),g[1]=new String(C%40);for(var F=c.substr(2),k=[],U=0;U<F.length/2;U++)k.push(parseInt(F.substr(2*U,2),16));var N=[],$="";for(U=0;U<k.length;U++)128&k[U]?$+=fi((127&k[U]).toString(2),7):($+=fi((127&k[U]).toString(2),7),N.push(new String(parseInt($,2))),$="");var z=g.join(".");return N.length>0&&(z=z+"."+N.join(".")),z}catch{return null}})(se.getV(t,e))}catch{return n}},se.getOIDName=function(t,e,n){n==null&&(n=null);try{var s=se.getOID(t,e,n);if(s==n)return n;var c=E.asn1.x509.OID.oid2name(s);return c==""?s:c}catch{return n}},se.getString=function(t,e,n){n==null&&(n=null);try{return gt(se.getV(t,e))}catch{return n}},se.hextooidstr=function(t){var e=function($,z){return $.length>=z?$:new Array(z-$.length+1).join("0")+$},n=[],s=t.substr(0,2),c=parseInt(s,16);n[0]=new String(Math.floor(c/40)),n[1]=new String(c%40);for(var g=t.substr(2),b=[],C=0;C<g.length/2;C++)b.push(parseInt(g.substr(2*C,2),16));var F=[],k="";for(C=0;C<b.length;C++)128&b[C]?k+=e((127&b[C]).toString(2),7):(k+=e((127&b[C]).toString(2),7),F.push(new String(parseInt(k,2))),k="");var U=n.join(".");return F.length>0&&(U=U+"."+F.join(".")),U},se.dump=function(t,e,n,s){var c=se,g=c.getV,b=c.dump,C=c.getChildIdx,F=t;t instanceof E.asn1.ASN1Object&&(F=t.getEncodedHex());var k=function(oe,me){return oe.length<=2*me?oe:oe.substr(0,me)+"..(total "+oe.length/2+"bytes).."+oe.substr(oe.length-me,me)};e===void 0&&(e={ommit_long_octet:32}),n===void 0&&(n=0),s===void 0&&(s="");var U,N=e.ommit_long_octet;if((U=F.substr(n,2))=="01")return($=g(F,n))=="00"?s+`BOOLEAN FALSE
`:s+`BOOLEAN TRUE
`;if(U=="02")return s+"INTEGER "+k($=g(F,n),N)+`
`;if(U=="03"){var $=g(F,n);if(c.isASN1HEX($.substr(2))){var z=s+`BITSTRING, encapsulates
`;return z+=b($.substr(2),e,0,s+"  ")}return s+"BITSTRING "+k($,N)+`
`}if(U=="04")return $=g(F,n),c.isASN1HEX($)?(z=s+`OCTETSTRING, encapsulates
`,z+=b($,e,0,s+"  ")):s+"OCTETSTRING "+k($,N)+`
`;if(U=="05")return s+`NULL
`;if(U=="06"){var G=g(F,n),Z=E.asn1.ASN1Util.oidHexToInt(G),ee=E.asn1.x509.OID.oid2name(Z),w=Z.replace(/\./g," ");return ee!=""?s+"ObjectIdentifier "+ee+" ("+w+`)
`:s+"ObjectIdentifier ("+w+`)
`}if(U=="0a")return s+"ENUMERATED "+parseInt(g(F,n))+`
`;if(U=="0c")return s+"UTF8String '"+Ke(g(F,n))+`'
`;if(U=="13")return s+"PrintableString '"+Ke(g(F,n))+`'
`;if(U=="14")return s+"TeletexString '"+Ke(g(F,n))+`'
`;if(U=="16")return s+"IA5String '"+Ke(g(F,n))+`'
`;if(U=="17")return s+"UTCTime "+Ke(g(F,n))+`
`;if(U=="18")return s+"GeneralizedTime "+Ke(g(F,n))+`
`;if(U=="1a")return s+"VisualString '"+Ke(g(F,n))+`'
`;if(U=="1e")return s+"BMPString '"+hi(g(F,n))+`'
`;if(U=="30"){if(F.substr(n,4)=="3000")return s+`SEQUENCE {}
`;z=s+`SEQUENCE
`;var D=e;if(((Y=C(F,n)).length==2||Y.length==3)&&F.substr(Y[0],2)=="06"&&F.substr(Y[Y.length-1],2)=="04"){ee=c.oidname(g(F,Y[0]));var B=JSON.parse(JSON.stringify(e));B.x509ExtName=ee,D=B}for(var K=0;K<Y.length;K++)z+=b(F,D,Y[K],s+"  ");return z}if(U=="31"){z=s+`SET
`;var Y=C(F,n);for(K=0;K<Y.length;K++)z+=b(F,e,Y[K],s+"  ");return z}if((128&(U=parseInt(U,16)))!=0){var te=31&U;if((32&U)!=0){for(z=s+"["+te+`]
`,Y=C(F,n),K=0;K<Y.length;K++)z+=b(F,e,Y[K],s+"  ");return z}if($=g(F,n),se.isASN1HEX($)){var z=s+"["+te+`]
`;return z+=b($,e,0,s+"  ")}return($.substr(0,8)=="68747470"||e.x509ExtName==="subjectAltName"&&te==2)&&($=Ke($)),z=s+"["+te+"] "+$+`
`}return s+"UNKNOWN("+U+") "+g(F,n)+`
`},se.isContextTag=function(t,e){var n,s;t=t.toLowerCase();try{n=parseInt(t,16)}catch{return-1}if(e===void 0)return(192&n)==128;try{return e.match(/^\[[0-9]+\]$/)!=null&&!((s=parseInt(e.substr(1,e.length-1),10))>31)&&(192&n)==128&&(31&n)==s}catch{return!1}},se.isASN1HEX=function(t){var e=se;if(t.length%2==1)return!1;var n=e.getVblen(t,0),s=t.substr(0,2),c=e.getL(t,0);return t.length-s.length-c.length==2*n},se.checkStrictDER=function(t,e,n,s,c){var g=se;if(n===void 0){if(typeof t!="string")throw new Error("not hex string");if(t=t.toLowerCase(),!E.lang.String.isHex(t))throw new Error("not hex string");n=t.length,c=(s=t.length/2)<128?1:Math.ceil(s.toString(16))+1}if(g.getL(t,e).length>2*c)throw new Error("L of TLV too long: idx="+e);var b=g.getVblen(t,e);if(b>s)throw new Error("value of L too long than hex: idx="+e);var C=g.getTLV(t,e),F=C.length-2-g.getL(t,e).length;if(F!==2*b)throw new Error("V string length and L's value not the same:"+F+"/"+2*b);if(e===0&&t.length!=C.length)throw new Error("total length and TLV length unmatch:"+t.length+"!="+C.length);var k=t.substr(e,2);if(k==="02"){var U=g.getVidx(t,e);if(t.substr(U,2)=="00"&&t.charCodeAt(U+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(k,16)){for(var N=g.getVblen(t,e),$=0,z=g.getChildIdx(t,e),G=0;G<z.length;G++)$+=g.getTLV(t,z[G]).length,g.checkStrictDER(t,z[G],n,s,c);if(2*N!=$)throw new Error("sum of children's TLV length and L unmatch: "+2*N+"!="+$)}},se.oidname=function(t){var e=E.asn1;E.lang.String.isHex(t)&&(t=e.ASN1Util.oidHexToInt(t));var n=e.x509.OID.oid2name(t);return n===""&&(n=t),n},E!==void 0&&E||(o.KJUR=E={}),E.lang!==void 0&&E.lang||(E.lang={}),E.lang.String=function(){},typeof l=="function"?(o.utf8tob64u=ur=function(e){return Tr(l.from(e,"utf8").toString("base64"))},o.b64utoutf8=wt=function(e){return l.from(cr(e),"base64").toString("utf8")}):(o.utf8tob64u=ur=function(e){return je(Ir(Lr(e)))},o.b64utoutf8=wt=function(e){return decodeURIComponent(Rr(xe(e)))}),E.lang.String.isInteger=function(t){return!!t.match(/^[0-9]+$/)||!!t.match(/^-[0-9]+$/)},E.lang.String.isHex=function(t){return di(t)},E.lang.String.isBase64=function(t){return!(!(t=t.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||t.length%4!=0)},E.lang.String.isBase64URL=function(t){return!t.match(/[+/=]/)&&(t=cr(t),E.lang.String.isBase64(t))},E.lang.String.isIntegerArray=function(t){return!!(t=t.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},E.lang.String.isPrintable=function(t){return t.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null},E.lang.String.isIA5=function(t){return t.match(/^[\x20-\x21\x23-\x7f]*$/)!==null},E.lang.String.isMail=function(t){return t.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};var fi=function(e,n,s){return s==null&&(s="0"),e.length>=n?e:new Array(n-e.length+1).join(s)+e};function Le(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e)}E!==void 0&&E||(o.KJUR=E={}),E.crypto!==void 0&&E.crypto||(E.crypto={}),E.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:A.algo.MD5,sha1:A.algo.SHA1,sha224:A.algo.SHA224,sha256:A.algo.SHA256,sha384:A.algo.SHA384,sha512:A.algo.SHA512,ripemd160:A.algo.RIPEMD160},this.getDigestInfoHex=function(t,e){if(this.DIGESTINFOHEAD[e]===void 0)throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,n){var s=this.getDigestInfoHex(t,e),c=n/4;if(s.length+22>c)throw"key is too short for SigAlg: keylen="+n+","+e;for(var g="0001",b="00"+s,C="",F=c-g.length-b.length,k=0;k<F;k+=2)C+="ff";return g+C+b},this.hashString=function(t,e){return new E.crypto.MessageDigest({alg:e}).digestString(t)},this.hashHex=function(t,e){return new E.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return this.hashString(t,"sha1")},this.sha256=function(t){return this.hashString(t,"sha256")},this.sha256Hex=function(t){return this.hashHex(t,"sha256")},this.sha512=function(t){return this.hashString(t,"sha512")},this.sha512Hex=function(t){return this.hashHex(t,"sha512")},this.isKey=function(t){return t instanceof le||t instanceof E.crypto.DSA||t instanceof E.crypto.ECDSA}},E.crypto.Util.md5=function(t){return new E.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(t)},E.crypto.Util.ripemd160=function(t){return new E.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},E.crypto.Util.SECURERANDOMGEN=new Fe,E.crypto.Util.getRandomHexOfNbytes=function(t){var e=new Array(t);return E.crypto.Util.SECURERANDOMGEN.nextBytes(e),Pr(e)},E.crypto.Util.getRandomBigIntegerOfNbytes=function(t){return new O(E.crypto.Util.getRandomHexOfNbytes(t),16)},E.crypto.Util.getRandomHexOfNbits=function(t){var e=t%8,n=new Array((t-e)/8+1);return E.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<e&255^255)&n[0],Pr(n)},E.crypto.Util.getRandomBigIntegerOfNbits=function(t){return new O(E.crypto.Util.getRandomHexOfNbits(t),16)},E.crypto.Util.getRandomBigIntegerZeroToMax=function(t){for(var e=t.bitLength();;){var n=E.crypto.Util.getRandomBigIntegerOfNbits(e);if(t.compareTo(n)!=-1)return n}},E.crypto.Util.getRandomBigIntegerMinToMax=function(t,e){var n=t.compareTo(e);if(n==1)throw"biMin is greater than biMax";if(n==0)return t;var s=e.subtract(t);return E.crypto.Util.getRandomBigIntegerZeroToMax(s).add(t)},E.crypto.MessageDigest=function(t){this.setAlgAndProvider=function(e,n){if((e=E.crypto.MessageDigest.getCanonicalAlgName(e))!==null&&n===void 0&&(n=E.crypto.Util.DEFAULTPROVIDER[e]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(e)!=-1&&n=="cryptojs"){try{this.md=E.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[e].create()}catch(s){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+s}this.updateString=function(s){this.md.update(s)},this.updateHex=function(s){var c=A.enc.Hex.parse(s);this.md.update(c)},this.digest=function(){return this.md.finalize().toString(A.enc.Hex)},this.digestString=function(s){return this.updateString(s),this.digest()},this.digestHex=function(s){return this.updateHex(s),this.digest()}}if(":sha256:".indexOf(e)!=-1&&n=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(s){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+s}this.updateString=function(s){this.md.update(s)},this.updateHex=function(s){var c=sjcl.codec.hex.toBits(s);this.md.update(c)},this.digest=function(){var s=this.md.finalize();return sjcl.codec.hex.fromBits(s)},this.digestString=function(s){return this.updateString(s),this.digest()},this.digestHex=function(s){return this.updateHex(s),this.digest()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},t!==void 0&&t.alg!==void 0&&(this.algName=t.alg,t.prov===void 0&&(this.provName=E.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},E.crypto.MessageDigest.getCanonicalAlgName=function(t){return typeof t=="string"&&(t=(t=t.toLowerCase()).replace(/-/,"")),t},E.crypto.MessageDigest.getHashLength=function(t){var e=E.crypto.MessageDigest,n=e.getCanonicalAlgName(t);if(e.HASHLENGTH[n]===void 0)throw"not supported algorithm: "+t;return e.HASHLENGTH[n]},E.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},E.crypto.Mac=function(t){this.setAlgAndProvider=function(e,n){if((e=e.toLowerCase())==null&&(e="hmacsha1"),(e=e.toLowerCase()).substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+e;n===void 0&&(n=E.crypto.Util.DEFAULTPROVIDER[e]),this.algProv=e+"/"+n;var s=e.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(s)!=-1&&n=="cryptojs"){try{var c=E.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[s];this.mac=A.algo.HMAC.create(c,this.pass)}catch(g){throw"setAlgAndProvider hash alg set fail hashAlg="+s+"/"+g}this.updateString=function(g){this.mac.update(g)},this.updateHex=function(g){var b=A.enc.Hex.parse(g);this.mac.update(b)},this.doFinal=function(){return this.mac.finalize().toString(A.enc.Hex)},this.doFinalString=function(g){return this.updateString(g),this.doFinal()},this.doFinalHex=function(g){return this.updateHex(g),this.doFinal()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(e){if(typeof e=="string"){var n=e;return e.length%2!=1&&e.match(/^[0-9A-Fa-f]+$/)||(n=Ft(e)),void(this.pass=A.enc.Hex.parse(n))}if((e===void 0?"undefined":R(e))!="object")throw"KJUR.crypto.Mac unsupported password type: "+e;if(n=null,e.hex!==void 0){if(e.hex.length%2!=0||!e.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+e.hex;n=e.hex}if(e.utf8!==void 0&&(n=rn(e.utf8)),e.rstr!==void 0&&(n=Ft(e.rstr)),e.b64!==void 0&&(n=Q(e.b64)),e.b64u!==void 0&&(n=xe(e.b64u)),n==null)throw"KJUR.crypto.Mac unsupported password type: "+e;this.pass=A.enc.Hex.parse(n)},t!==void 0&&(t.pass!==void 0&&this.setPassword(t.pass),t.alg!==void 0&&(this.algName=t.alg,t.prov===void 0&&(this.provName=E.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},E.crypto.Signature=function(t){var e=null;if(this._setAlgNames=function(){var n=this.algName.match(/^(.+)with(.+)$/);n&&(this.mdAlgName=n[1].toLowerCase(),this.pubkeyAlgName=n[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(n,s){for(var c="",g=s/4-n.length,b=0;b<g;b++)c+="0";return c+n},this.setAlgAndProvider=function(n,s){if(this._setAlgNames(),s!="cryptojs/jsrsa")throw new Error("provider not supported: "+s);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new E.crypto.MessageDigest({alg:this.mdAlgName})}catch(c){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+c)}this.init=function(c,g){var b=null;try{b=g===void 0?Ne.getKey(c):Ne.getKey(c,g)}catch(C){throw"init failed:"+C}if(b.isPrivate===!0)this.prvKey=b,this.state="SIGN";else{if(b.isPublic!==!0)throw"init failed.:"+b;this.pubKey=b,this.state="VERIFY"}},this.updateString=function(c){this.md.updateString(c)},this.updateHex=function(c){this.md.updateHex(c)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&E.crypto.ECDSA!==void 0&&(this.prvKey=new E.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof le&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof le&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof E.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof E.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(c){return this.updateString(c),this.sign()},this.signHex=function(c){return this.updateHex(c),this.sign()},this.verify=function(c){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&E.crypto.ECDSA!==void 0&&(this.pubKey=new E.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof le&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,c,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof le&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,c);if(E.crypto.ECDSA!==void 0&&this.pubKey instanceof E.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,c);if(E.crypto.DSA!==void 0&&this.pubKey instanceof E.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,c);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(n,s){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(n){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(n){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(n){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(n){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(n){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=t,t!==void 0&&(t.alg!==void 0&&(this.algName=t.alg,t.prov===void 0?this.provName=E.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),t.psssaltlen!==void 0&&(this.pssSaltLen=t.psssaltlen),t.prvkeypem!==void 0)){if(t.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{e=Ne.getKey(t.prvkeypem),this.init(e)}catch(n){throw"fatal error to load pem private key: "+n}}},E.crypto.Cipher=function(t){},E.crypto.Cipher.encrypt=function(t,e,n){if(e instanceof le&&e.isPublic){var s=E.crypto.Cipher.getAlgByKeyAndName(e,n);if(s==="RSA")return e.encrypt(t);if(s==="RSAOAEP")return e.encryptOAEP(t,"sha1");var c=s.match(/^RSAOAEP(\d+)$/);if(c!==null)return e.encryptOAEP(t,"sha"+c[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.encrypt: unsupported key or algorithm"},E.crypto.Cipher.decrypt=function(t,e,n){if(e instanceof le&&e.isPrivate){var s=E.crypto.Cipher.getAlgByKeyAndName(e,n);if(s==="RSA")return e.decrypt(t);if(s==="RSAOAEP")return e.decryptOAEP(t,"sha1");var c=s.match(/^RSAOAEP(\d+)$/);if(c!==null)return e.decryptOAEP(t,"sha"+c[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.decrypt: unsupported key or algorithm"},E.crypto.Cipher.getAlgByKeyAndName=function(t,e){if(t instanceof le){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(e)!=-1)return e;if(e==null)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+e}throw"getAlgByKeyAndName: not supported algorithm name: "+e},E.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},E!==void 0&&E||(o.KJUR=E={}),E.crypto!==void 0&&E.crypto||(E.crypto={}),E.crypto.ECDSA=function(t){var e=Error,n=O,s=ve,c=E.crypto.ECDSA,g=E.crypto.ECParameterDB,b=c.getName,C=se,F=C.getVbyListEx,k=C.isASN1HEX,U=new Fe;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(N){return new n(N.bitLength(),U).mod(N.subtract(n.ONE)).add(n.ONE)},this.setNamedCurve=function(N){this.ecparams=g.getByName(N),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=N},this.setPrivateKeyHex=function(N){this.isPrivate=!0,this.prvKeyHex=N},this.setPublicKeyHex=function(N){this.isPublic=!0,this.pubKeyHex=N},this.getPublicKeyXYHex=function(){var N=this.pubKeyHex;if(N.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var $=this.ecparams.keylen/4;if(N.length!==2+2*$)throw"malformed public key hex length";var z={};return z.x=N.substr(2,$),z.y=N.substr(2+$),z},this.getShortNISTPCurveName=function(){var N=this.curveName;return N==="secp256r1"||N==="NIST P-256"||N==="P-256"||N==="prime256v1"?"P-256":N==="secp384r1"||N==="NIST P-384"||N==="P-384"?"P-384":null},this.generateKeyPairHex=function(){var N=this.ecparams.n,$=this.getBigRandom(N),z=this.ecparams.G.multiply($),G=z.getX().toBigInteger(),Z=z.getY().toBigInteger(),ee=this.ecparams.keylen/4,w=("0000000000"+$.toString(16)).slice(-ee),D="04"+("0000000000"+G.toString(16)).slice(-ee)+("0000000000"+Z.toString(16)).slice(-ee);return this.setPrivateKeyHex(w),this.setPublicKeyHex(D),{ecprvhex:w,ecpubhex:D}},this.signWithMessageHash=function(N){return this.signHex(N,this.prvKeyHex)},this.signHex=function(N,$){var z=new n($,16),G=this.ecparams.n,Z=new n(N.substring(0,this.ecparams.keylen/4),16);do var ee=this.getBigRandom(G),w=this.ecparams.G.multiply(ee).getX().toBigInteger().mod(G);while(w.compareTo(n.ZERO)<=0);var D=ee.modInverse(G).multiply(Z.add(z.multiply(w))).mod(G);return c.biRSSigToASN1Sig(w,D)},this.sign=function(N,$){var z=$,G=this.ecparams.n,Z=n.fromByteArrayUnsigned(N);do var ee=this.getBigRandom(G),w=this.ecparams.G.multiply(ee).getX().toBigInteger().mod(G);while(w.compareTo(O.ZERO)<=0);var D=ee.modInverse(G).multiply(Z.add(z.multiply(w))).mod(G);return this.serializeSig(w,D)},this.verifyWithMessageHash=function(N,$){return this.verifyHex(N,$,this.pubKeyHex)},this.verifyHex=function(N,$,z){try{var G,Z,ee=c.parseSigHex($);G=ee.r,Z=ee.s;var w=s.decodeFromHex(this.ecparams.curve,z),D=new n(N.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(D,G,Z,w)}catch{return!1}},this.verify=function(N,$,z){var G,Z,ee;if(Bitcoin.Util.isArray($)){var w=this.parseSig($);G=w.r,Z=w.s}else{if(($===void 0?"undefined":R($))!=="object"||!$.r||!$.s)throw"Invalid value for signature";G=$.r,Z=$.s}if(z instanceof ve)ee=z;else{if(!Bitcoin.Util.isArray(z))throw"Invalid format for pubkey value, must be byte array or ECPointFp";ee=s.decodeFrom(this.ecparams.curve,z)}var D=n.fromByteArrayUnsigned(N);return this.verifyRaw(D,G,Z,ee)},this.verifyRaw=function(N,$,z,G){var Z=this.ecparams.n,ee=this.ecparams.G;if($.compareTo(n.ONE)<0||$.compareTo(Z)>=0||z.compareTo(n.ONE)<0||z.compareTo(Z)>=0)return!1;var w=z.modInverse(Z),D=N.multiply(w).mod(Z),B=$.multiply(w).mod(Z);return ee.multiply(D).add(G.multiply(B)).getX().toBigInteger().mod(Z).equals($)},this.serializeSig=function(N,$){var z=N.toByteArraySigned(),G=$.toByteArraySigned(),Z=[];return Z.push(2),Z.push(z.length),(Z=Z.concat(z)).push(2),Z.push(G.length),(Z=Z.concat(G)).unshift(Z.length),Z.unshift(48),Z},this.parseSig=function(N){var $;if(N[0]!=48)throw new Error("Signature not a valid DERSequence");if(N[$=2]!=2)throw new Error("First element in signature must be a DERInteger");var z=N.slice($+2,$+2+N[$+1]);if(N[$+=2+N[$+1]]!=2)throw new Error("Second element in signature must be a DERInteger");var G=N.slice($+2,$+2+N[$+1]);return $+=2+N[$+1],{r:n.fromByteArrayUnsigned(z),s:n.fromByteArrayUnsigned(G)}},this.parseSigCompact=function(N){if(N.length!==65)throw"Signature has the wrong length";var $=N[0]-27;if($<0||$>7)throw"Invalid signature type";var z=this.ecparams.n;return{r:n.fromByteArrayUnsigned(N.slice(1,33)).mod(z),s:n.fromByteArrayUnsigned(N.slice(33,65)).mod(z),i:$}},this.readPKCS5PrvKeyHex=function(N){if(k(N)===!1)throw new Error("not ASN.1 hex string");var $,z,G;try{$=F(N,0,["[0]",0],"06"),z=F(N,0,[1],"04");try{G=F(N,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=b($),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(G),this.setPrivateKeyHex(z),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(N){if(k(N)===!1)throw new e("not ASN.1 hex string");var $,z,G;try{F(N,0,[1,0],"06"),$=F(N,0,[1,1],"06"),z=F(N,0,[2,0,1],"04");try{G=F(N,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new e("malformed PKCS#8 plain ECC private key")}if(this.curveName=b($),this.curveName===void 0)throw new e("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(G),this.setPrivateKeyHex(z),this.isPublic=!1},this.readPKCS8PubKeyHex=function(N){if(k(N)===!1)throw new e("not ASN.1 hex string");var $,z;try{F(N,0,[0,0],"06"),$=F(N,0,[0,1],"06"),z=F(N,0,[1],"03")}catch{throw new e("malformed PKCS#8 ECC public key")}if(this.curveName=b($),this.curveName===null)throw new e("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(z)},this.readCertPubKeyHex=function(N,$){if(k(N)===!1)throw new e("not ASN.1 hex string");var z,G;try{z=F(N,0,[0,5,0,1],"06"),G=F(N,0,[0,5,1],"03")}catch{throw new e("malformed X.509 certificate ECC public key")}if(this.curveName=b(z),this.curveName===null)throw new e("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(G)},t!==void 0&&t.curve!==void 0&&(this.curveName=t.curve),this.curveName===void 0&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),t!==void 0&&(t.prv!==void 0&&this.setPrivateKeyHex(t.prv),t.pub!==void 0&&this.setPublicKeyHex(t.pub))},E.crypto.ECDSA.parseSigHex=function(t){var e=E.crypto.ECDSA.parseSigHexInHexRS(t);return{r:new O(e.r,16),s:new O(e.s,16)}},E.crypto.ECDSA.parseSigHexInHexRS=function(t){var e=se,n=e.getChildIdx,s=e.getV;if(e.checkStrictDER(t,0),t.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var c=n(t,0);if(c.length!=2)throw new Error("signature shall have two elements");var g=c[0],b=c[1];if(t.substr(g,2)!="02")throw new Error("1st item not ASN.1 integer");if(t.substr(b,2)!="02")throw new Error("2nd item not ASN.1 integer");return{r:s(t,g),s:s(t,b)}},E.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=E.crypto.ECDSA.parseSigHexInHexRS(t),n=e.r,s=e.s;if(n.substr(0,2)=="00"&&n.length%32==2&&(n=n.substr(2)),s.substr(0,2)=="00"&&s.length%32==2&&(s=s.substr(2)),n.length%32==30&&(n="00"+n),s.length%32==30&&(s="00"+s),n.length%32!=0)throw"unknown ECDSA sig r length error";if(s.length%32!=0)throw"unknown ECDSA sig s length error";return n+s},E.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),n=t.substr(t.length/2);return E.crypto.ECDSA.hexRSSigToASN1Sig(e,n)},E.crypto.ECDSA.hexRSSigToASN1Sig=function(t,e){var n=new O(t,16),s=new O(e,16);return E.crypto.ECDSA.biRSSigToASN1Sig(n,s)},E.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var n=E.asn1,s=new n.DERInteger({bigint:t}),c=new n.DERInteger({bigint:e});return new n.DERSequence({array:[s,c]}).getEncodedHex()},E.crypto.ECDSA.getName=function(t){return t==="2b8104001f"?"secp192k1":t==="2a8648ce3d030107"?"secp256r1":t==="2b8104000a"?"secp256k1":t==="2b81040021"?"secp224r1":t==="2b81040022"?"secp384r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(t)!==-1?"secp256r1":"|secp256k1|".indexOf(t)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(t)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(t)!==-1?"secp384r1":null},E!==void 0&&E||(o.KJUR=E={}),E.crypto!==void 0&&E.crypto||(E.crypto={}),E.crypto.ECParameterDB=new function(){var t={},e={};function n(s){return new O(s,16)}this.getByName=function(s){var c=s;if(e[c]!==void 0&&(c=e[s]),t[c]!==void 0)return t[c];throw"unregistered EC curve name: "+c},this.regist=function(s,c,g,b,C,F,k,U,N,$,z,G){t[s]={};var Z=n(g),ee=n(b),w=n(C),D=n(F),B=n(k),K=new pt(Z,ee,w),Y=K.decodePointHex("04"+U+N);t[s].name=s,t[s].keylen=c,t[s].curve=K,t[s].G=Y,t[s].n=D,t[s].h=B,t[s].oid=z,t[s].info=G;for(var te=0;te<$.length;te++)e[$[te]]=s}},E.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),E.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),E.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),E.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),E.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),E.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),E.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),E.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),E.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),E.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var Ne=(function(){var t=function(k,U,N){return e(A.AES,k,U,N)},e=function(k,U,N,$){var z=A.enc.Hex.parse(U),G=A.enc.Hex.parse(N),Z=A.enc.Hex.parse($),ee={};ee.key=G,ee.iv=Z,ee.ciphertext=z;var w=k.decrypt(ee,G,{iv:Z});return A.enc.Hex.stringify(w)},n=function(k,U,N){return s(A.AES,k,U,N)},s=function(k,U,N,$){var z=A.enc.Hex.parse(U),G=A.enc.Hex.parse(N),Z=A.enc.Hex.parse($),ee=k.encrypt(z,G,{iv:Z}),w=A.enc.Hex.parse(ee.toString());return A.enc.Base64.stringify(w)},c={"AES-256-CBC":{proc:t,eproc:n,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:n,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:n,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(k,U,N){return e(A.TripleDES,k,U,N)},eproc:function(k,U,N){return s(A.TripleDES,k,U,N)},keylen:24,ivlen:8},"DES-CBC":{proc:function(k,U,N){return e(A.DES,k,U,N)},eproc:function(k,U,N){return s(A.DES,k,U,N)},keylen:8,ivlen:8}},g=function(k){var U={},N=k.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));N&&(U.cipher=N[1],U.ivsalt=N[2]);var $=k.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));$&&(U.type=$[1]);var z=-1,G=0;k.indexOf(`\r
\r
`)!=-1&&(z=k.indexOf(`\r
\r
`),G=2),k.indexOf(`

`)!=-1&&(z=k.indexOf(`

`),G=1);var Z=k.indexOf("-----END");if(z!=-1&&Z!=-1){var ee=k.substring(z+2*G,Z-G);ee=ee.replace(/\s+/g,""),U.data=ee}return U},b=function(k,U,N){for(var $=N.substring(0,16),z=A.enc.Hex.parse($),G=A.enc.Utf8.parse(U),Z=c[k].keylen+c[k].ivlen,ee="",w=null;;){var D=A.algo.MD5.create();if(w!=null&&D.update(w),D.update(G),D.update(z),w=D.finalize(),(ee+=A.enc.Hex.stringify(w)).length>=2*Z)break}var B={};return B.keyhex=ee.substr(0,2*c[k].keylen),B.ivhex=ee.substr(2*c[k].keylen,2*c[k].ivlen),B},C=function(k,U,N,$){var z=A.enc.Base64.parse(k),G=A.enc.Hex.stringify(z);return(0,c[U].proc)(G,N,$)};return{version:"1.0.0",parsePKCS5PEM:function(k){return g(k)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(k,U,N){return b(k,U,N)},decryptKeyB64:function(k,U,N,$){return C(k,U,N,$)},getDecryptedKeyHex:function(k,U){var N=g(k),$=(N.type,N.cipher),z=N.ivsalt,G=N.data,Z=b($,U,z).keyhex;return C(G,$,Z,z)},getEncryptedPKCS5PEMFromPrvKeyHex:function(k,U,N,$,z){var G="";if($!==void 0&&$!=null||($="AES-256-CBC"),c[$]===void 0)throw new Error("KEYUTIL unsupported algorithm: "+$);z!==void 0&&z!=null||(z=(function(w){var D=A.lib.WordArray.random(w);return A.enc.Hex.stringify(D)})(c[$].ivlen).toUpperCase());var Z=(function(w,D,B,K){return(0,c[D].eproc)(w,B,K)})(U,$,b($,N,z).keyhex,z);return G="-----BEGIN "+k+` PRIVATE KEY-----\r
`,G+=`Proc-Type: 4,ENCRYPTED\r
`,G+="DEK-Info: "+$+","+z+`\r
`,G+=`\r
`,G+=Z.replace(/(.{64})/g,`$1\r
`),G+=`\r
-----END `+k+` PRIVATE KEY-----\r
`},parseHexOfEncryptedPKCS8:function(k){var U=se,N=U.getChildIdx,$=U.getV,z={},G=N(k,0);if(G.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+G.length);z.ciphertext=$(k,G[1]);var Z=N(k,G[0]);if(Z.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+Z.length);if($(k,Z[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var ee=N(k,Z[1]);if(Z.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+ee.length);var w=N(k,ee[1]);if(w.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+w.length);if($(k,w[0])!="2a864886f70d0307")throw"this only supports TripleDES";z.encryptionSchemeAlg="TripleDES",z.encryptionSchemeIV=$(k,w[1]);var D=N(k,ee[0]);if(D.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+D.length);if($(k,D[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var B=N(k,D[1]);if(B.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+B.length);z.pbkdf2Salt=$(k,B[0]);var K=$(k,B[1]);try{z.pbkdf2Iter=parseInt(K,16)}catch{throw new Error("malformed format pbkdf2Iter: "+K)}return z},getPBKDF2KeyHexFromParam:function(k,U){var N=A.enc.Hex.parse(k.pbkdf2Salt),$=k.pbkdf2Iter,z=A.PBKDF2(U,N,{keySize:6,iterations:$});return A.enc.Hex.stringify(z)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(k,U){var N=At(k,"ENCRYPTED PRIVATE KEY"),$=this.parseHexOfEncryptedPKCS8(N),z=Ne.getPBKDF2KeyHexFromParam($,U),G={};G.ciphertext=A.enc.Hex.parse($.ciphertext);var Z=A.enc.Hex.parse(z),ee=A.enc.Hex.parse($.encryptionSchemeIV),w=A.TripleDES.decrypt(G,Z,{iv:ee});return A.enc.Hex.stringify(w)},getKeyFromEncryptedPKCS8PEM:function(k,U){var N=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(k,U);return this.getKeyFromPlainPrivatePKCS8Hex(N)},parsePlainPrivatePKCS8Hex:function(k){var U=se,N=U.getChildIdx,$=U.getV,z={algparam:null};if(k.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var G=N(k,0);if(G.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(k.substr(G[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var Z=N(k,G[1]);if(Z.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(k.substr(Z[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(z.algoid=$(k,Z[0]),k.substr(Z[1],2)=="06"&&(z.algparam=$(k,Z[1])),k.substr(G[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return z.keyidx=U.getVidx(k,G[2]),z},getKeyFromPlainPrivatePKCS8PEM:function(k){var U=At(k,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(U)},getKeyFromPlainPrivatePKCS8Hex:function(k){var U,N=this.parsePlainPrivatePKCS8Hex(k);if(N.algoid=="2a864886f70d010101")U=new le;else if(N.algoid=="2a8648ce380401")U=new E.crypto.DSA;else{if(N.algoid!="2a8648ce3d0201")throw new Error("unsupported private key algorithm");U=new E.crypto.ECDSA}return U.readPKCS8PrvKeyHex(k),U},_getKeyFromPublicPKCS8Hex:function(k){var U,N=se.getVbyList(k,0,[0,0],"06");if(N==="2a864886f70d010101")U=new le;else if(N==="2a8648ce380401")U=new E.crypto.DSA;else{if(N!=="2a8648ce3d0201")throw new Error("unsupported PKCS#8 public key hex");U=new E.crypto.ECDSA}return U.readPKCS8PubKeyHex(k),U},parsePublicRawRSAKeyHex:function(k){var U=se,N=U.getChildIdx,$=U.getV,z={};if(k.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var G=N(k,0);if(G.length!=2)throw new Error("malformed RSA key(code:002)");if(k.substr(G[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(z.n=$(k,G[0]),k.substr(G[1],2)!="02")throw new Error("malformed RSA key(code:004)");return z.e=$(k,G[1]),z},parsePublicPKCS8Hex:function(k){var U=se,N=U.getChildIdx,$=U.getV,z={algparam:null},G=N(k,0);if(G.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+G.length);var Z=G[0];if(k.substr(Z,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var ee=N(k,Z);if(ee.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(k.substr(ee[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(z.algoid=$(k,ee[0]),k.substr(ee[1],2)=="06"?z.algparam=$(k,ee[1]):k.substr(ee[1],2)=="30"&&(z.algparam={},z.algparam.p=U.getVbyList(k,ee[1],[0],"02"),z.algparam.q=U.getVbyList(k,ee[1],[1],"02"),z.algparam.g=U.getVbyList(k,ee[1],[2],"02")),k.substr(G[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return z.key=$(k,G[1]).substr(2),z}}})();Ne.getKey=function(t,e,n){var s=(ee=se).getChildIdx,c=(ee.getV,ee.getVbyList),g=E.crypto,b=g.ECDSA,C=g.DSA,F=le,k=At,U=Ne;if(F!==void 0&&t instanceof F||b!==void 0&&t instanceof b||C!==void 0&&t instanceof C)return t;if(t.curve!==void 0&&t.xy!==void 0&&t.d===void 0)return new b({pub:t.xy,curve:t.curve});if(t.curve!==void 0&&t.d!==void 0)return new b({prv:t.d,curve:t.curve});if(t.kty===void 0&&t.n!==void 0&&t.e!==void 0&&t.d===void 0)return(de=new F).setPublic(t.n,t.e),de;if(t.kty===void 0&&t.n!==void 0&&t.e!==void 0&&t.d!==void 0&&t.p!==void 0&&t.q!==void 0&&t.dp!==void 0&&t.dq!==void 0&&t.co!==void 0&&t.qi===void 0)return(de=new F).setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dp,t.dq,t.co),de;if(t.kty===void 0&&t.n!==void 0&&t.e!==void 0&&t.d!==void 0&&t.p===void 0)return(de=new F).setPrivate(t.n,t.e,t.d),de;if(t.p!==void 0&&t.q!==void 0&&t.g!==void 0&&t.y!==void 0&&t.x===void 0)return(de=new C).setPublic(t.p,t.q,t.g,t.y),de;if(t.p!==void 0&&t.q!==void 0&&t.g!==void 0&&t.y!==void 0&&t.x!==void 0)return(de=new C).setPrivate(t.p,t.q,t.g,t.y,t.x),de;if(t.kty==="RSA"&&t.n!==void 0&&t.e!==void 0&&t.d===void 0)return(de=new F).setPublic(xe(t.n),xe(t.e)),de;if(t.kty==="RSA"&&t.n!==void 0&&t.e!==void 0&&t.d!==void 0&&t.p!==void 0&&t.q!==void 0&&t.dp!==void 0&&t.dq!==void 0&&t.qi!==void 0)return(de=new F).setPrivateEx(xe(t.n),xe(t.e),xe(t.d),xe(t.p),xe(t.q),xe(t.dp),xe(t.dq),xe(t.qi)),de;if(t.kty==="RSA"&&t.n!==void 0&&t.e!==void 0&&t.d!==void 0)return(de=new F).setPrivate(xe(t.n),xe(t.e),xe(t.d)),de;if(t.kty==="EC"&&t.crv!==void 0&&t.x!==void 0&&t.y!==void 0&&t.d===void 0){var N=(ae=new b({curve:t.crv})).ecparams.keylen/4,$="04"+("0000000000"+xe(t.x)).slice(-N)+("0000000000"+xe(t.y)).slice(-N);return ae.setPublicKeyHex($),ae}if(t.kty==="EC"&&t.crv!==void 0&&t.x!==void 0&&t.y!==void 0&&t.d!==void 0){N=(ae=new b({curve:t.crv})).ecparams.keylen/4,$="04"+("0000000000"+xe(t.x)).slice(-N)+("0000000000"+xe(t.y)).slice(-N);var z=("0000000000"+xe(t.d)).slice(-N);return ae.setPublicKeyHex($),ae.setPrivateKeyHex(z),ae}if(n==="pkcs5prv"){var G,Z=t,ee=se;if((G=s(Z,0)).length===9)(de=new F).readPKCS5PrvKeyHex(Z);else if(G.length===6)(de=new C).readPKCS5PrvKeyHex(Z);else{if(!(G.length>2&&Z.substr(G[1],2)==="04"))throw new Error("unsupported PKCS#1/5 hexadecimal key");(de=new b).readPKCS5PrvKeyHex(Z)}return de}if(n==="pkcs8prv")return de=U.getKeyFromPlainPrivatePKCS8Hex(t);if(n==="pkcs8pub")return U._getKeyFromPublicPKCS8Hex(t);if(n==="x509pub")return $e.getPublicKeyFromCertHex(t);if(t.indexOf("-END CERTIFICATE-",0)!=-1||t.indexOf("-END X509 CERTIFICATE-",0)!=-1||t.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return $e.getPublicKeyFromCertPEM(t);if(t.indexOf("-END PUBLIC KEY-")!=-1){var w=At(t,"PUBLIC KEY");return U._getKeyFromPublicPKCS8Hex(w)}if(t.indexOf("-END RSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")==-1){var D=k(t,"RSA PRIVATE KEY");return U.getKey(D,null,"pkcs5prv")}if(t.indexOf("-END DSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")==-1){var B=c(ke=k(t,"DSA PRIVATE KEY"),0,[1],"02"),K=c(ke,0,[2],"02"),Y=c(ke,0,[3],"02"),te=c(ke,0,[4],"02"),ue=c(ke,0,[5],"02");return(de=new C).setPrivate(new O(B,16),new O(K,16),new O(Y,16),new O(te,16),new O(ue,16)),de}if(t.indexOf("-END EC PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")==-1)return D=k(t,"EC PRIVATE KEY"),U.getKey(D,null,"pkcs5prv");if(t.indexOf("-END PRIVATE KEY-")!=-1)return U.getKeyFromPlainPrivatePKCS8PEM(t);if(t.indexOf("-END RSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")!=-1){var oe=U.getDecryptedKeyHex(t,e),me=new le;return me.readPKCS5PrvKeyHex(oe),me}if(t.indexOf("-END EC PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")!=-1){var ae,de=c(ke=U.getDecryptedKeyHex(t,e),0,[1],"04"),Ae=c(ke,0,[2,0],"06"),Pe=c(ke,0,[3,0],"03").substr(2);if(E.crypto.OID.oidhex2name[Ae]===void 0)throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+Ae);return(ae=new b({curve:E.crypto.OID.oidhex2name[Ae]})).setPublicKeyHex(Pe),ae.setPrivateKeyHex(de),ae.isPublic=!1,ae}if(t.indexOf("-END DSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")!=-1){var ke;return B=c(ke=U.getDecryptedKeyHex(t,e),0,[1],"02"),K=c(ke,0,[2],"02"),Y=c(ke,0,[3],"02"),te=c(ke,0,[4],"02"),ue=c(ke,0,[5],"02"),(de=new C).setPrivate(new O(B,16),new O(K,16),new O(Y,16),new O(te,16),new O(ue,16)),de}if(t.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return U.getKeyFromEncryptedPKCS8PEM(t,e);throw new Error("not supported argument")},Ne.generateKeypair=function(t,e){if(t=="RSA"){var n=e;(b=new le).generate(n,"10001"),b.isPrivate=!0,b.isPublic=!0;var s=new le,c=b.n.toString(16),g=b.e.toString(16);return s.setPublic(c,g),s.isPrivate=!1,s.isPublic=!0,(C={}).prvKeyObj=b,C.pubKeyObj=s,C}if(t=="EC"){var b,C,F=e,k=new E.crypto.ECDSA({curve:F}).generateKeyPairHex();return(b=new E.crypto.ECDSA({curve:F})).setPublicKeyHex(k.ecpubhex),b.setPrivateKeyHex(k.ecprvhex),b.isPrivate=!0,b.isPublic=!1,(s=new E.crypto.ECDSA({curve:F})).setPublicKeyHex(k.ecpubhex),s.isPrivate=!1,s.isPublic=!0,(C={}).prvKeyObj=b,C.pubKeyObj=s,C}throw new Error("unknown algorithm: "+t)},Ne.getPEM=function(t,e,n,s,c,g){var b=E,C=b.asn1,F=C.DERObjectIdentifier,k=C.DERInteger,U=C.ASN1Util.newObject,N=C.x509.SubjectPublicKeyInfo,$=b.crypto,z=$.DSA,G=$.ECDSA,Z=le;function ee(ae){return U({seq:[{int:0},{int:{bigint:ae.n}},{int:ae.e},{int:{bigint:ae.d}},{int:{bigint:ae.p}},{int:{bigint:ae.q}},{int:{bigint:ae.dmp1}},{int:{bigint:ae.dmq1}},{int:{bigint:ae.coeff}}]})}function w(ae){return U({seq:[{int:1},{octstr:{hex:ae.prvKeyHex}},{tag:["a0",!0,{oid:{name:ae.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+ae.pubKeyHex}}]}]})}function D(ae){return U({seq:[{int:0},{int:{bigint:ae.p}},{int:{bigint:ae.q}},{int:{bigint:ae.g}},{int:{bigint:ae.y}},{int:{bigint:ae.x}}]})}if((Z!==void 0&&t instanceof Z||z!==void 0&&t instanceof z||G!==void 0&&t instanceof G)&&t.isPublic==1&&(e===void 0||e=="PKCS8PUB"))return ct(te=new N(t).getEncodedHex(),"PUBLIC KEY");if(e=="PKCS1PRV"&&Z!==void 0&&t instanceof Z&&(n===void 0||n==null)&&t.isPrivate==1)return ct(te=ee(t).getEncodedHex(),"RSA PRIVATE KEY");if(e=="PKCS1PRV"&&G!==void 0&&t instanceof G&&(n===void 0||n==null)&&t.isPrivate==1){var B=new F({name:t.curveName}).getEncodedHex(),K=w(t).getEncodedHex(),Y="";return Y+=ct(B,"EC PARAMETERS"),Y+=ct(K,"EC PRIVATE KEY")}if(e=="PKCS1PRV"&&z!==void 0&&t instanceof z&&(n===void 0||n==null)&&t.isPrivate==1)return ct(te=D(t).getEncodedHex(),"DSA PRIVATE KEY");if(e=="PKCS5PRV"&&Z!==void 0&&t instanceof Z&&n!==void 0&&n!=null&&t.isPrivate==1){var te=ee(t).getEncodedHex();return s===void 0&&(s="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",te,n,s,g)}if(e=="PKCS5PRV"&&G!==void 0&&t instanceof G&&n!==void 0&&n!=null&&t.isPrivate==1)return te=w(t).getEncodedHex(),s===void 0&&(s="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",te,n,s,g);if(e=="PKCS5PRV"&&z!==void 0&&t instanceof z&&n!==void 0&&n!=null&&t.isPrivate==1)return te=D(t).getEncodedHex(),s===void 0&&(s="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",te,n,s,g);var ue=function(de,Ae){var Pe=oe(de,Ae);return new U({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:Pe.pbkdf2Salt}},{int:Pe.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:Pe.encryptionSchemeIV}}]}]}]},{octstr:{hex:Pe.ciphertext}}]}).getEncodedHex()},oe=function(de,Ae){var Pe=A.lib.WordArray.random(8),ke=A.lib.WordArray.random(8),lt=A.PBKDF2(Ae,Pe,{keySize:6,iterations:100}),rt=A.enc.Hex.parse(de),nt=A.TripleDES.encrypt(rt,lt,{iv:ke})+"",De={};return De.ciphertext=nt,De.pbkdf2Salt=A.enc.Hex.stringify(Pe),De.pbkdf2Iter=100,De.encryptionSchemeAlg="DES-EDE3-CBC",De.encryptionSchemeIV=A.enc.Hex.stringify(ke),De};if(e=="PKCS8PRV"&&Z!=null&&t instanceof Z&&t.isPrivate==1){var me=ee(t).getEncodedHex();return te=U({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:me}}]}).getEncodedHex(),n===void 0||n==null?ct(te,"PRIVATE KEY"):ct(K=ue(te,n),"ENCRYPTED PRIVATE KEY")}if(e=="PKCS8PRV"&&G!==void 0&&t instanceof G&&t.isPrivate==1)return me=new U({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]}).getEncodedHex(),te=U({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:t.curveName}}]},{octstr:{hex:me}}]}).getEncodedHex(),n===void 0||n==null?ct(te,"PRIVATE KEY"):ct(K=ue(te,n),"ENCRYPTED PRIVATE KEY");if(e=="PKCS8PRV"&&z!==void 0&&t instanceof z&&t.isPrivate==1)return me=new k({bigint:t.x}).getEncodedHex(),te=U({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]}]},{octstr:{hex:me}}]}).getEncodedHex(),n===void 0||n==null?ct(te,"PRIVATE KEY"):ct(K=ue(te,n),"ENCRYPTED PRIVATE KEY");throw new Error("unsupported object nor format")},Ne.getKeyFromCSRPEM=function(t){var e=At(t,"CERTIFICATE REQUEST");return Ne.getKeyFromCSRHex(e)},Ne.getKeyFromCSRHex=function(t){var e=Ne.parseCSRHex(t);return Ne.getKey(e.p8pubkeyhex,null,"pkcs8pub")},Ne.parseCSRHex=function(t){var e=se,n=e.getChildIdx,s=e.getTLV,c={},g=t;if(g.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var b=n(g,0);if(b.length<1)throw new Error("malformed CSR(code:002)");if(g.substr(b[0],2)!="30")throw new Error("malformed CSR(code:003)");var C=n(g,b[0]);if(C.length<3)throw new Error("malformed CSR(code:004)");return c.p8pubkeyhex=s(g,C[2]),c},Ne.getKeyID=function(t){var e=Ne,n=se;typeof t=="string"&&t.indexOf("BEGIN ")!=-1&&(t=e.getKey(t));var s=At(e.getPEM(t)),c=n.getIdxbyList(s,0,[1]),g=n.getV(s,c).substring(2);return E.crypto.Util.hashHex(g,"sha1")},Ne.getJWKFromKey=function(t){var e={};if(t instanceof le&&t.isPrivate)return e.kty="RSA",e.n=je(t.n.toString(16)),e.e=je(t.e.toString(16)),e.d=je(t.d.toString(16)),e.p=je(t.p.toString(16)),e.q=je(t.q.toString(16)),e.dp=je(t.dmp1.toString(16)),e.dq=je(t.dmq1.toString(16)),e.qi=je(t.coeff.toString(16)),e;if(t instanceof le&&t.isPublic)return e.kty="RSA",e.n=je(t.n.toString(16)),e.e=je(t.e.toString(16)),e;if(t instanceof E.crypto.ECDSA&&t.isPrivate){if((s=t.getShortNISTPCurveName())!=="P-256"&&s!=="P-384")throw new Error("unsupported curve name for JWT: "+s);var n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=s,e.x=je(n.x),e.y=je(n.y),e.d=je(t.prvKeyHex),e}if(t instanceof E.crypto.ECDSA&&t.isPublic){var s;if((s=t.getShortNISTPCurveName())!=="P-256"&&s!=="P-384")throw new Error("unsupported curve name for JWT: "+s);return n=t.getPublicKeyXYHex(),e.kty="EC",e.crv=s,e.x=je(n.x),e.y=je(n.y),e}throw new Error("not supported key object")},le.getPosArrayOfChildrenFromHex=function(t){return se.getChildIdx(t,0)},le.getHexValueArrayOfChildrenFromHex=function(t){var e,n=se.getV,s=n(t,(e=le.getPosArrayOfChildrenFromHex(t))[0]),c=n(t,e[1]),g=n(t,e[2]),b=n(t,e[3]),C=n(t,e[4]),F=n(t,e[5]),k=n(t,e[6]),U=n(t,e[7]),N=n(t,e[8]);return(e=new Array).push(s,c,g,b,C,F,k,U,N),e},le.prototype.readPrivateKeyFromPEMString=function(t){var e=At(t),n=le.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])},le.prototype.readPKCS5PrvKeyHex=function(t){var e=le.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},le.prototype.readPKCS8PrvKeyHex=function(t){var e,n,s,c,g,b,C,F,k=se,U=k.getVbyListEx;if(k.isASN1HEX(t)===!1)throw new Error("not ASN.1 hex string");try{e=U(t,0,[2,0,1],"02"),n=U(t,0,[2,0,2],"02"),s=U(t,0,[2,0,3],"02"),c=U(t,0,[2,0,4],"02"),g=U(t,0,[2,0,5],"02"),b=U(t,0,[2,0,6],"02"),C=U(t,0,[2,0,7],"02"),F=U(t,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(e,n,s,c,g,b,C,F)},le.prototype.readPKCS5PubKeyHex=function(t){var e=se,n=e.getV;if(e.isASN1HEX(t)===!1)throw new Error("keyHex is not ASN.1 hex string");var s=e.getChildIdx(t,0);if(s.length!==2||t.substr(s[0],2)!=="02"||t.substr(s[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var c=n(t,s[0]),g=n(t,s[1]);this.setPublic(c,g)},le.prototype.readPKCS8PubKeyHex=function(t){var e=se;if(e.isASN1HEX(t)===!1)throw new Error("not ASN.1 hex string");if(e.getTLVbyListEx(t,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var n=e.getTLVbyListEx(t,0,[1,0]);this.readPKCS5PubKeyHex(n)},le.prototype.readCertPubKeyHex=function(t,e){var n,s;(n=new $e).readCertHex(t),s=n.getPublicKeyHex(),this.readPKCS8PubKeyHex(s)};function pi(t,e){for(var n="",s=e/4-t.length,c=0;c<s;c++)n+="0";return n+t}function gi(t,e,n){for(var s="",c=0;s.length<e;)s+=gt(n(Ft(t+String.fromCharCode.apply(String,[(4278190080&c)>>24,(16711680&c)>>16,(65280&c)>>8,255&c])))),c+=1;return s}function mi(t){for(var e in E.crypto.Util.DIGESTINFOHEAD){var n=E.crypto.Util.DIGESTINFOHEAD[e],s=n.length;if(t.substring(0,s)==n)return[e,t.substring(s)]}return[]}function $e(t){var e,n=se,s=n.getChildIdx,c=n.getV,g=n.getTLV,b=n.getVbyList,C=n.getVbyListEx,F=n.getTLVbyList,k=n.getTLVbyListEx,U=n.getIdxbyList,N=n.getIdxbyListEx,$=n.getVidx,z=n.getInt,G=n.oidname,Z=n.hextooidstr,ee=At;try{e=E.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var w=F(this.hex,0,[0,0]);if(w.substr(0,2)=="a0"){var D=F(w,0,[0]),B=z(D,0);if(B<0||2<B)throw new Error("malformed version field");return this.version=B+1,this.version}return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return C(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var w=k(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(w)},this.getAlgorithmIdentifierName=function(w){for(var D in e)if(w===e[D])return D;return G(C(w,0,[0],"06"))},this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return F(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(){return this.getX500Name(this.getSubjectHex())},this.getSubjectHex=function(){return F(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var w=b(this.hex,0,[0,4+this.foffset,0]);return w=w.replace(/(..)/g,"%$1"),w=decodeURIComponent(w)},this.getNotAfter=function(){var w=b(this.hex,0,[0,4+this.foffset,1]);return w=w.replace(/(..)/g,"%$1"),w=decodeURIComponent(w)},this.getPublicKeyHex=function(){return n.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return U(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var w=this.getPublicKeyIdx();return U(this.hex,w,[1,0],"30")},this.getPublicKey=function(){return Ne.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var w=F(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(w)},this.getSignatureValueHex=function(){return b(this.hex,0,[2],"03",!0)},this.verifySignature=function(w){var D=this.getSignatureAlgorithmField(),B=this.getSignatureValueHex(),K=F(this.hex,0,[0],"30"),Y=new E.crypto.Signature({alg:D});return Y.init(w),Y.updateHex(K),Y.verify(B)},this.parseExt=function(w){var D,B,K;if(w===void 0){if(K=this.hex,this.version!==3)return-1;D=U(K,0,[0,7,0],"30"),B=s(K,D)}else{K=At(w);var Y=U(K,0,[0,3,0,0],"06");if(c(K,Y)!="2a864886f70d01090e")return void(this.aExtInfo=new Array);D=U(K,0,[0,3,0,1,0],"30"),B=s(K,D),this.hex=K}this.aExtInfo=new Array;for(var te=0;te<B.length;te++){var ue={critical:!1},oe=0;s(K,B[te]).length===3&&(ue.critical=!0,oe=1),ue.oid=n.hextooidstr(b(K,B[te],[0],"06"));var me=U(K,B[te],[1+oe]);ue.vidx=$(K,me),this.aExtInfo.push(ue)}},this.getExtInfo=function(w){var D=this.aExtInfo,B=w;if(w.match(/^[0-9.]+$/)||(B=E.asn1.x509.OID.name2oid(w)),B!==""){for(var K=0;K<D.length;K++)if(D[K].oid===B)return D[K]}},this.getExtBasicConstraints=function(w,D){if(w===void 0&&D===void 0){var B=this.getExtInfo("basicConstraints");if(B===void 0)return;w=g(this.hex,B.vidx),D=B.critical}var K={extname:"basicConstraints"};if(D&&(K.critical=!0),w==="3000")return K;if(w==="30030101ff")return K.cA=!0,K;if(w.substr(0,12)==="30060101ff02"){var Y=c(w,10),te=parseInt(Y,16);return K.cA=!0,K.pathLen=te,K}throw new Error("hExtV parse error: "+w)},this.getExtKeyUsage=function(w,D){if(w===void 0&&D===void 0){var B=this.getExtInfo("keyUsage");if(B===void 0)return;w=g(this.hex,B.vidx),D=B.critical}var K={extname:"keyUsage"};return D&&(K.critical=!0),K.names=this.getExtKeyUsageString(w).split(","),K},this.getExtKeyUsageBin=function(w){if(w===void 0){var D=this.getExtInfo("keyUsage");if(D===void 0)return"";w=g(this.hex,D.vidx)}if(w.length!=8&&w.length!=10)throw new Error("malformed key usage value: "+w);var B="000000000000000"+parseInt(w.substr(6),16).toString(2);return w.length==8&&(B=B.slice(-8)),w.length==10&&(B=B.slice(-16)),(B=B.replace(/0+$/,""))==""&&(B="0"),B},this.getExtKeyUsageString=function(w){for(var D=this.getExtKeyUsageBin(w),B=new Array,K=0;K<D.length;K++)D.substr(K,1)=="1"&&B.push($e.KEYUSAGE_NAME[K]);return B.join(",")},this.getExtSubjectKeyIdentifier=function(w,D){if(w===void 0&&D===void 0){var B=this.getExtInfo("subjectKeyIdentifier");if(B===void 0)return;w=g(this.hex,B.vidx),D=B.critical}var K={extname:"subjectKeyIdentifier"};D&&(K.critical=!0);var Y=c(w,0);return K.kid={hex:Y},K},this.getExtAuthorityKeyIdentifier=function(w,D){if(w===void 0&&D===void 0){var B=this.getExtInfo("authorityKeyIdentifier");if(B===void 0)return;w=g(this.hex,B.vidx),D=B.critical}var K={extname:"authorityKeyIdentifier"};D&&(K.critical=!0);for(var Y=s(w,0),te=0;te<Y.length;te++){var ue=w.substr(Y[te],2);if(ue==="80"&&(K.kid={hex:c(w,Y[te])}),ue==="a1"){var oe=g(w,Y[te]),me=this.getGeneralNames(oe);K.issuer=me[0].dn}ue==="82"&&(K.sn={hex:c(w,Y[te])})}return K},this.getExtExtKeyUsage=function(w,D){if(w===void 0&&D===void 0){var B=this.getExtInfo("extKeyUsage");if(B===void 0)return;w=g(this.hex,B.vidx),D=B.critical}var K={extname:"extKeyUsage",array:[]};D&&(K.critical=!0);for(var Y=s(w,0),te=0;te<Y.length;te++)K.array.push(G(c(w,Y[te])));return K},this.getExtExtKeyUsageName=function(){var w=this.getExtInfo("extKeyUsage");if(w===void 0)return w;var D=new Array,B=g(this.hex,w.vidx);if(B==="")return D;for(var K=s(B,0),Y=0;Y<K.length;Y++)D.push(G(c(B,K[Y])));return D},this.getExtSubjectAltName=function(w,D){if(w===void 0&&D===void 0){var B=this.getExtInfo("subjectAltName");if(B===void 0)return;w=g(this.hex,B.vidx),D=B.critical}var K={extname:"subjectAltName",array:[]};return D&&(K.critical=!0),K.array=this.getGeneralNames(w),K},this.getExtIssuerAltName=function(w,D){if(w===void 0&&D===void 0){var B=this.getExtInfo("issuerAltName");if(B===void 0)return;w=g(this.hex,B.vidx),D=B.critical}var K={extname:"issuerAltName",array:[]};return D&&(K.critical=!0),K.array=this.getGeneralNames(w),K},this.getGeneralNames=function(w){for(var D=s(w,0),B=[],K=0;K<D.length;K++){var Y=this.getGeneralName(g(w,D[K]));Y!==void 0&&B.push(Y)}return B},this.getGeneralName=function(w){var D=w.substr(0,2),B=c(w,0),K=gt(B);return D=="81"?{rfc822:K}:D=="82"?{dns:K}:D=="86"?{uri:K}:D=="87"?{ip:on(B)}:D=="a4"?{dn:this.getX500Name(B)}:void 0},this.getExtSubjectAltName2=function(){var w,D,B,K=this.getExtInfo("subjectAltName");if(K===void 0)return K;for(var Y=new Array,te=g(this.hex,K.vidx),ue=s(te,0),oe=0;oe<ue.length;oe++)B=te.substr(ue[oe],2),w=c(te,ue[oe]),B==="81"&&(D=Ke(w),Y.push(["MAIL",D])),B==="82"&&(D=Ke(w),Y.push(["DNS",D])),B==="84"&&(D=$e.hex2dn(w,0),Y.push(["DN",D])),B==="86"&&(D=Ke(w),Y.push(["URI",D])),B==="87"&&(D=on(w),Y.push(["IP",D]));return Y},this.getExtCRLDistributionPoints=function(w,D){if(w===void 0&&D===void 0){var B=this.getExtInfo("cRLDistributionPoints");if(B===void 0)return;w=g(this.hex,B.vidx),D=B.critical}var K={extname:"cRLDistributionPoints",array:[]};D&&(K.critical=!0);for(var Y=s(w,0),te=0;te<Y.length;te++){var ue=g(w,Y[te]);K.array.push(this.getDistributionPoint(ue))}return K},this.getDistributionPoint=function(w){for(var D={},B=s(w,0),K=0;K<B.length;K++){var Y=w.substr(B[K],2),te=g(w,B[K]);Y=="a0"&&(D.dpname=this.getDistributionPointName(te))}return D},this.getDistributionPointName=function(w){for(var D={},B=s(w,0),K=0;K<B.length;K++){var Y=w.substr(B[K],2),te=g(w,B[K]);Y=="a0"&&(D.full=this.getGeneralNames(te))}return D},this.getExtCRLDistributionPointsURI=function(){var w=this.getExtInfo("cRLDistributionPoints");if(w===void 0)return w;for(var D=new Array,B=s(this.hex,w.vidx),K=0;K<B.length;K++)try{var Y=Ke(b(this.hex,B[K],[0,0,0],"86"));D.push(Y)}catch{}return D},this.getExtAIAInfo=function(){var w=this.getExtInfo("authorityInfoAccess");if(w===void 0)return w;for(var D={ocsp:[],caissuer:[]},B=s(this.hex,w.vidx),K=0;K<B.length;K++){var Y=b(this.hex,B[K],[0],"06"),te=b(this.hex,B[K],[1],"86");Y==="2b06010505073001"&&D.ocsp.push(Ke(te)),Y==="2b06010505073002"&&D.caissuer.push(Ke(te))}return D},this.getExtAuthorityInfoAccess=function(w,D){if(w===void 0&&D===void 0){var B=this.getExtInfo("authorityInfoAccess");if(B===void 0)return;w=g(this.hex,B.vidx),D=B.critical}var K={extname:"authorityInfoAccess",array:[]};D&&(K.critical=!0);for(var Y=s(w,0),te=0;te<Y.length;te++){var ue=C(w,Y[te],[0],"06"),oe=Ke(b(w,Y[te],[1],"86"));if(ue=="2b06010505073001")K.array.push({ocsp:oe});else{if(ue!="2b06010505073002")throw new Error("unknown method: "+ue);K.array.push({caissuer:oe})}}return K},this.getExtCertificatePolicies=function(w,D){if(w===void 0&&D===void 0){var B=this.getExtInfo("certificatePolicies");if(B===void 0)return;w=g(this.hex,B.vidx),D=B.critical}var K={extname:"certificatePolicies",array:[]};D&&(K.critical=!0);for(var Y=s(w,0),te=0;te<Y.length;te++){var ue=g(w,Y[te]),oe=this.getPolicyInformation(ue);K.array.push(oe)}return K},this.getPolicyInformation=function(w){var D={},B=b(w,0,[0],"06");D.policyoid=G(B);var K=N(w,0,[1],"30");if(K!=-1){D.array=[];for(var Y=s(w,K),te=0;te<Y.length;te++){var ue=g(w,Y[te]),oe=this.getPolicyQualifierInfo(ue);D.array.push(oe)}}return D},this.getPolicyQualifierInfo=function(w){var D={},B=b(w,0,[0],"06");if(B==="2b06010505070201"){var K=C(w,0,[1],"16");D.cps=gt(K)}else if(B==="2b06010505070202"){var Y=F(w,0,[1],"30");D.unotice=this.getUserNotice(Y)}return D},this.getUserNotice=function(w){for(var D={},B=s(w,0),K=0;K<B.length;K++){var Y=g(w,B[K]);Y.substr(0,2)!="30"&&(D.exptext=this.getDisplayText(Y))}return D},this.getDisplayText=function(w){var D={};return D.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[w.substr(0,2)],D.str=gt(c(w,0)),D},this.getExtCRLNumber=function(w,D){var B={extname:"cRLNumber"};if(D&&(B.critical=!0),w.substr(0,2)=="02")return B.num={hex:c(w,0)},B;throw new Error("hExtV parse error: "+w)},this.getExtCRLReason=function(w,D){var B={extname:"cRLReason"};if(D&&(B.critical=!0),w.substr(0,2)=="0a")return B.code=parseInt(c(w,0),16),B;throw new Error("hExtV parse error: "+w)},this.getExtOcspNonce=function(w,D){var B={extname:"ocspNonce"};D&&(B.critical=!0);var K=c(w,0);return B.hex=K,B},this.getExtOcspNoCheck=function(w,D){var B={extname:"ocspNoCheck"};return D&&(B.critical=!0),B},this.getExtAdobeTimeStamp=function(w,D){if(w===void 0&&D===void 0){var B=this.getExtInfo("adobeTimeStamp");if(B===void 0)return;w=g(this.hex,B.vidx),D=B.critical}var K={extname:"adobeTimeStamp"};D&&(K.critical=!0);var Y=s(w,0);if(Y.length>1){var te=g(w,Y[1]),ue=this.getGeneralName(te);ue.uri!=null&&(K.uri=ue.uri)}if(Y.length>2){var oe=g(w,Y[2]);oe=="0101ff"&&(K.reqauth=!0),oe=="010100"&&(K.reqauth=!1)}return K},this.getX500NameRule=function(w){for(var D=null,B=[],K=0;K<w.length;K++)for(var Y=w[K],te=0;te<Y.length;te++)B.push(Y[te]);for(K=0;K<B.length;K++){var ue=B[K],oe=ue.ds,me=ue.value,ae=ue.type;if(oe!="prn"&&oe!="utf8"&&oe!="ia5")return"mixed";if(oe=="ia5"){if(ae!="CN")return"mixed";if(E.lang.String.isMail(me))continue;return"mixed"}if(ae=="C"){if(oe=="prn")continue;return"mixed"}if(D==null)D=oe;else if(D!==oe)return"mixed"}return D??"prn"},this.getX500Name=function(w){var D=this.getX500NameArray(w);return{array:D,str:this.dnarraytostr(D)}},this.getX500NameArray=function(w){for(var D=[],B=s(w,0),K=0;K<B.length;K++)D.push(this.getRDN(g(w,B[K])));return D},this.getRDN=function(w){for(var D=[],B=s(w,0),K=0;K<B.length;K++)D.push(this.getAttrTypeAndValue(g(w,B[K])));return D},this.getAttrTypeAndValue=function(w){var D={type:null,value:null,ds:null},B=s(w,0),K=b(w,B[0],[],"06"),Y=b(w,B[1],[]),te=E.asn1.ASN1Util.oidHexToInt(K);return D.type=E.asn1.x509.OID.oid2atype(te),D.ds=this.HEX2STAG[w.substr(B[1],2)],D.ds!="bmp"?D.value=Ke(Y):D.value=hi(Y),D},this.readCertPEM=function(w){this.readCertHex(ee(w))},this.readCertHex=function(w){this.hex=w,this.getVersion();try{U(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(){var w={};return w.version=this.getVersion(),w.serial={hex:this.getSerialNumberHex()},w.sigalg=this.getSignatureAlgorithmField(),w.issuer=this.getIssuer(),w.notbefore=this.getNotBefore(),w.notafter=this.getNotAfter(),w.subject=this.getSubject(),w.sbjpubkey=ct(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo.length>0&&(w.ext=this.getExtParamArray()),w.sighex=this.getSignatureValueHex(),w},this.getExtParamArray=function(w){w==null&&N(this.hex,0,[0,"[3]"])!=-1&&(w=k(this.hex,0,[0,"[3]",0],"30"));for(var D=[],B=s(w,0),K=0;K<B.length;K++){var Y=g(w,B[K]),te=this.getExtParam(Y);te!=null&&D.push(te)}return D},this.getExtParam=function(w){var D=s(w,0).length;if(D!=2&&D!=3)throw new Error("wrong number elements in Extension: "+D+" "+w);var B=Z(b(w,0,[0],"06")),K=!1;D==3&&F(w,0,[1])=="0101ff"&&(K=!0);var Y=F(w,0,[D-1,0]),te=void 0;if(B=="2.5.29.14"?te=this.getExtSubjectKeyIdentifier(Y,K):B=="2.5.29.15"?te=this.getExtKeyUsage(Y,K):B=="2.5.29.17"?te=this.getExtSubjectAltName(Y,K):B=="2.5.29.18"?te=this.getExtIssuerAltName(Y,K):B=="2.5.29.19"?te=this.getExtBasicConstraints(Y,K):B=="2.5.29.31"?te=this.getExtCRLDistributionPoints(Y,K):B=="2.5.29.32"?te=this.getExtCertificatePolicies(Y,K):B=="2.5.29.35"?te=this.getExtAuthorityKeyIdentifier(Y,K):B=="2.5.29.37"?te=this.getExtExtKeyUsage(Y,K):B=="1.3.6.1.5.5.7.1.1"?te=this.getExtAuthorityInfoAccess(Y,K):B=="2.5.29.20"?te=this.getExtCRLNumber(Y,K):B=="2.5.29.21"?te=this.getExtCRLReason(Y,K):B=="1.3.6.1.5.5.7.48.1.2"?te=this.getExtOcspNonce(Y,K):B=="1.3.6.1.5.5.7.48.1.5"?te=this.getExtOcspNoCheck(Y,K):B=="1.2.840.113583.1.1.9.1"&&(te=this.getExtAdobeTimeStamp(Y,K)),te!=null)return te;var ue={extname:B,extn:Y};return K&&(ue.critical=!0),ue},this.findExt=function(w,D){for(var B=0;B<w.length;B++)if(w[B].extname==D)return w[B];return null},this.updateExtCDPFullURI=function(w,D){var B=this.findExt(w,"cRLDistributionPoints");if(B!=null&&B.array!=null){for(var K=B.array,Y=0;Y<K.length;Y++)if(K[Y].dpname!=null&&K[Y].dpname.full!=null)for(var te=K[Y].dpname.full,ue=0;ue<te.length;ue++){var oe=te[Y];oe.uri!=null&&(oe.uri=D)}}},this.updateExtAIAOCSP=function(w,D){var B=this.findExt(w,"authorityInfoAccess");if(B!=null&&B.array!=null)for(var K=B.array,Y=0;Y<K.length;Y++)K[Y].ocsp!=null&&(K[Y].ocsp=D)},this.updateExtAIACAIssuer=function(w,D){var B=this.findExt(w,"authorityInfoAccess");if(B!=null&&B.array!=null)for(var K=B.array,Y=0;Y<K.length;Y++)K[Y].caissuer!=null&&(K[Y].caissuer=D)},this.dnarraytostr=function(w){return"/"+w.map((function(D){return(function(K){return K.map((function(Y){return(function(ue){return ue.type+"="+ue.value})(Y).replace(/\+/,"\\+")})).join("+")})(D).replace(/\//,"\\/")})).join("/")},this.getInfo=function(){var w,D,B,K=function(lt){return JSON.stringify(lt.array).replace(/[\[\]\{\}\"]/g,"")},Y=function(lt){for(var rt="",nt=lt.array,De=0;De<nt.length;De++){var Ve=nt[De];if(rt+="    policy oid: "+Ve.policyoid+`
`,Ve.array!==void 0)for(var Ge=0;Ge<Ve.array.length;Ge++){var it=Ve.array[Ge];it.cps!==void 0&&(rt+="    cps: "+it.cps+`
`)}}return rt},te=function(lt){for(var rt="",nt=lt.array,De=0;De<nt.length;De++){var Ve=nt[De];try{Ve.dpname.full[0].uri!==void 0&&(rt+="    "+Ve.dpname.full[0].uri+`
`)}catch{}try{Ve.dname.full[0].dn.hex!==void 0&&(rt+="    "+$e.hex2dn(Ve.dpname.full[0].dn.hex)+`
`)}catch{}}return rt},ue=function(lt){for(var rt="",nt=lt.array,De=0;De<nt.length;De++){var Ve=nt[De];Ve.caissuer!==void 0&&(rt+="    caissuer: "+Ve.caissuer+`
`),Ve.ocsp!==void 0&&(rt+="    ocsp: "+Ve.ocsp+`
`)}return rt};if(w=`Basic Fields
`,w+="  serial number: "+this.getSerialNumberHex()+`
`,w+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,w+="  issuer: "+this.getIssuerString()+`
`,w+="  notBefore: "+this.getNotBefore()+`
`,w+="  notAfter: "+this.getNotAfter()+`
`,w+="  subject: "+this.getSubjectString()+`
`,w+=`  subject public key info: 
`,w+="    key algorithm: "+(D=this.getPublicKey()).type+`
`,D.type==="RSA"&&(w+="    n="+sn(D.n.toString(16)).substr(0,16)+`...
`,w+="    e="+sn(D.e.toString(16))+`
`),(B=this.aExtInfo)!=null){w+=`X509v3 Extensions:
`;for(var oe=0;oe<B.length;oe++){var me=B[oe],ae=E.asn1.x509.OID.oid2name(me.oid);ae===""&&(ae=me.oid);var de="";if(me.critical===!0&&(de="CRITICAL"),w+="  "+ae+" "+de+`:
`,ae==="basicConstraints"){var Ae=this.getExtBasicConstraints();Ae.cA===void 0?w+=`    {}
`:(w+="    cA=true",Ae.pathLen!==void 0&&(w+=", pathLen="+Ae.pathLen),w+=`
`)}else if(ae==="keyUsage")w+="    "+this.getExtKeyUsageString()+`
`;else if(ae==="subjectKeyIdentifier")w+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(ae==="authorityKeyIdentifier"){var Pe=this.getExtAuthorityKeyIdentifier();Pe.kid!==void 0&&(w+="    kid="+Pe.kid.hex+`
`)}else ae==="extKeyUsage"?w+="    "+this.getExtExtKeyUsage().array.join(", ")+`
`:ae==="subjectAltName"?w+="    "+K(this.getExtSubjectAltName())+`
`:ae==="cRLDistributionPoints"?w+=te(this.getExtCRLDistributionPoints()):ae==="authorityInfoAccess"?w+=ue(this.getExtAuthorityInfoAccess()):ae==="certificatePolicies"&&(w+=Y(this.getExtCertificatePolicies()))}}return w+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,w+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`},typeof t=="string"&&(t.indexOf("-----BEGIN")!=-1?this.readCertPEM(t):E.lang.String.isHex(t)&&this.readCertHex(t))}le.prototype.sign=function(t,e){var n=(function(c){return E.crypto.Util.hashString(c,e)})(t);return this.signWithMessageHash(n,e)},le.prototype.signWithMessageHash=function(t,e){var n=ut(E.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),16);return pi(this.doPrivate(n).toString(16),this.n.bitLength())},le.prototype.signPSS=function(t,e,n){var s=(function(g){return E.crypto.Util.hashHex(g,e)})(Ft(t));return n===void 0&&(n=-1),this.signWithMessageHashPSS(s,e,n)},le.prototype.signWithMessageHashPSS=function(t,e,n){var s,c=gt(t),g=c.length,b=this.n.bitLength()-1,C=Math.ceil(b/8),F=function(w){return E.crypto.Util.hashHex(w,e)};if(n===-1||n===void 0)n=g;else if(n===-2)n=C-g-2;else if(n<-2)throw new Error("invalid salt length");if(C<g+n+2)throw new Error("data too long");var k="";n>0&&(k=new Array(n),new Fe().nextBytes(k),k=String.fromCharCode.apply(String,k));var U=gt(F(Ft("\0\0\0\0\0\0\0\0"+c+k))),N=[];for(s=0;s<C-n-g-2;s+=1)N[s]=0;var $=String.fromCharCode.apply(String,N)+""+k,z=gi(U,$.length,F),G=[];for(s=0;s<$.length;s+=1)G[s]=$.charCodeAt(s)^z.charCodeAt(s);var Z=65280>>8*C-b&255;for(G[0]&=~Z,s=0;s<g;s++)G.push(U.charCodeAt(s));return G.push(188),pi(this.doPrivate(new O(G)).toString(16),this.n.bitLength())},le.prototype.verify=function(t,e){if((e=e.toLowerCase()).match(/^[0-9a-f]+$/)==null)return!1;var n=ut(e,16),s=this.n.bitLength();if(n.bitLength()>s)return!1;var c=this.doPublic(n).toString(16);if(c.length+3!=s/4)return!1;var g=mi(c.replace(/^1f+00/,""));if(g.length==0)return!1;var b=g[0];return g[1]==(function(F){return E.crypto.Util.hashString(F,b)})(t)},le.prototype.verifyWithMessageHash=function(t,e){if(e.length!=Math.ceil(this.n.bitLength()/4))return!1;var n=ut(e,16);if(n.bitLength()>this.n.bitLength())return 0;var s=mi(this.doPublic(n).toString(16).replace(/^1f+00/,""));return s.length==0?!1:(s[0],s[1]==t)},le.prototype.verifyPSS=function(t,e,n,s){var c=(function(b){return E.crypto.Util.hashHex(b,n)})(Ft(t));return s===void 0&&(s=-1),this.verifyWithMessageHashPSS(c,e,n,s)},le.prototype.verifyWithMessageHashPSS=function(t,e,n,s){if(e.length!=Math.ceil(this.n.bitLength()/4))return!1;var c,g=new O(e,16),b=function(B){return E.crypto.Util.hashHex(B,n)},C=gt(t),F=C.length,k=this.n.bitLength()-1,U=Math.ceil(k/8);if(s===-1||s===void 0)s=F;else if(s===-2)s=U-F-2;else if(s<-2)throw new Error("invalid salt length");if(U<F+s+2)throw new Error("data too long");var N=this.doPublic(g).toByteArray();for(c=0;c<N.length;c+=1)N[c]&=255;for(;N.length<U;)N.unshift(0);if(N[U-1]!==188)throw new Error("encoded message does not end in 0xbc");var $=(N=String.fromCharCode.apply(String,N)).substr(0,U-F-1),z=N.substr($.length,F),G=65280>>8*U-k&255;if(($.charCodeAt(0)&G)!=0)throw new Error("bits beyond keysize not zero");var Z=gi(z,$.length,b),ee=[];for(c=0;c<$.length;c+=1)ee[c]=$.charCodeAt(c)^Z.charCodeAt(c);ee[0]&=~G;var w=U-F-s-2;for(c=0;c<w;c+=1)if(ee[c]!==0)throw new Error("leftmost octets not zero");if(ee[w]!==1)throw new Error("0x01 marker not found");return z===gt(b(Ft("\0\0\0\0\0\0\0\0"+C+String.fromCharCode.apply(String,ee.slice(-s)))))},le.SALT_LEN_HLEN=-1,le.SALT_LEN_MAX=-2,le.SALT_LEN_RECOVER=-2,$e.hex2dn=function(t,e){e===void 0&&(e=0);var n=new $e;return se.getTLV(t,e),n.getX500Name(t).str},$e.hex2rdn=function(t,e){if(e===void 0&&(e=0),t.substr(e,2)!=="31")throw new Error("malformed RDN");for(var n=new Array,s=se.getChildIdx(t,e),c=0;c<s.length;c++)n.push($e.hex2attrTypeValue(t,s[c]));return(n=n.map((function(g){return g.replace("+","\\+")}))).join("+")},$e.hex2attrTypeValue=function(t,e){var n=se,s=n.getV;if(e===void 0&&(e=0),t.substr(e,2)!=="30")throw new Error("malformed attribute type and value");var c=n.getChildIdx(t,e);c.length!==2||t.substr(c[0],2);var g=s(t,c[0]),b=E.asn1.ASN1Util.oidHexToInt(g);return E.asn1.x509.OID.oid2atype(b)+"="+gt(s(t,c[1]))},$e.getPublicKeyFromCertHex=function(t){var e=new $e;return e.readCertHex(t),e.getPublicKey()},$e.getPublicKeyFromCertPEM=function(t){var e=new $e;return e.readCertPEM(t),e.getPublicKey()},$e.getPublicKeyInfoPropOfCertPEM=function(t){var e,n,s=se.getVbyList,c={};return c.algparam=null,(e=new $e).readCertPEM(t),n=e.getPublicKeyHex(),c.keyhex=s(n,0,[1],"03").substr(2),c.algoid=s(n,0,[0,0],"06"),c.algoid==="2a8648ce3d0201"&&(c.algparam=s(n,0,[0,1],"06")),c},$e.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],E!==void 0&&E||(o.KJUR=E={}),E.jws!==void 0&&E.jws||(E.jws={}),E.jws.JWS=function(){var t=E.jws.JWS.isSafeJSONString;this.parseJWS=function(e,n){if(this.parsedJWS===void 0||!n&&this.parsedJWS.sigvalH===void 0){var s=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(s==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var c=s[1],g=s[2],b=s[3],C=c+"."+g;if(this.parsedJWS={},this.parsedJWS.headB64U=c,this.parsedJWS.payloadB64U=g,this.parsedJWS.sigvalB64U=b,this.parsedJWS.si=C,!n){var F=xe(b),k=ut(F,16);this.parsedJWS.sigvalH=F,this.parsedJWS.sigvalBI=k}var U=wt(c),N=wt(g);if(this.parsedJWS.headS=U,this.parsedJWS.payloadS=N,!t(U,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+U}}},E.jws.JWS.sign=function(t,e,n,s,c){var g,b,C,F=E,k=F.jws.JWS,U=k.readSafeJSONString,N=k.isSafeJSONString,$=F.crypto,z=($.ECDSA,$.Mac),G=$.Signature,Z=JSON;if(typeof e!="string"&&(e===void 0?"undefined":R(e))!="object")throw"spHeader must be JSON string or object: "+e;if((e===void 0?"undefined":R(e))=="object"&&(b=e,g=Z.stringify(b)),typeof e=="string"){if(!N(g=e))throw"JWS Head is not safe JSON string: "+g;b=U(g)}if(C=n,(n===void 0?"undefined":R(n))=="object"&&(C=Z.stringify(n)),t!=""&&t!=null||b.alg===void 0||(t=b.alg),t!=""&&t!=null&&b.alg===void 0&&(b.alg=t,g=Z.stringify(b)),t!==b.alg)throw"alg and sHeader.alg doesn't match: "+t+"!="+b.alg;var ee=null;if(k.jwsalg2sigalg[t]===void 0)throw"unsupported alg name: "+t;ee=k.jwsalg2sigalg[t];var w=ur(g)+"."+ur(C),D="";if(ee.substr(0,4)=="Hmac"){if(s===void 0)throw"mac key shall be specified for HS* alg";var B=new z({alg:ee,prov:"cryptojs",pass:s});B.updateString(w),D=B.doFinal()}else if(ee.indexOf("withECDSA")!=-1){(Y=new G({alg:ee})).init(s,c),Y.updateString(w);var K=Y.sign();D=E.crypto.ECDSA.asn1SigToConcatSig(K)}else{var Y;ee!="none"&&((Y=new G({alg:ee})).init(s,c),Y.updateString(w),D=Y.sign())}return w+"."+je(D)},E.jws.JWS.verify=function(t,e,n){var s,c=E,g=c.jws.JWS,b=g.readSafeJSONString,C=c.crypto,F=C.ECDSA,k=C.Mac,U=C.Signature;R(le)!==void 0&&(s=le);var N=t.split(".");if(N.length!==3)return!1;var $=N[0]+"."+N[1],z=xe(N[2]),G=b(wt(N[0])),Z=null,ee=null;if(G.alg===void 0)throw"algorithm not specified in header";if(ee=(Z=G.alg).substr(0,2),n!=null&&Object.prototype.toString.call(n)==="[object Array]"&&n.length>0&&(":"+n.join(":")+":").indexOf(":"+Z+":")==-1)throw"algorithm '"+Z+"' not accepted in the list";if(Z!="none"&&e===null)throw"key shall be specified to verify.";if(typeof e=="string"&&e.indexOf("-----BEGIN ")!=-1&&(e=Ne.getKey(e)),!(ee!="RS"&&ee!="PS"||e instanceof s))throw"key shall be a RSAKey obj for RS* and PS* algs";if(ee=="ES"&&!(e instanceof F))throw"key shall be a ECDSA obj for ES* algs";var w=null;if(g.jwsalg2sigalg[G.alg]===void 0)throw"unsupported alg name: "+Z;if((w=g.jwsalg2sigalg[Z])=="none")throw"not supported";if(w.substr(0,4)=="Hmac"){if(e===void 0)throw"hexadecimal key shall be specified for HMAC";var D=new k({alg:w,pass:e});return D.updateString($),z==D.doFinal()}if(w.indexOf("withECDSA")!=-1){var B,K=null;try{K=F.concatSigToASN1Sig(z)}catch{return!1}return(B=new U({alg:w})).init(e),B.updateString($),B.verify(K)}return(B=new U({alg:w})).init(e),B.updateString($),B.verify(z)},E.jws.JWS.parse=function(t){var e,n,s,c=t.split("."),g={};if(c.length!=2&&c.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return e=c[0],n=c[1],c.length==3&&(s=c[2]),g.headerObj=E.jws.JWS.readSafeJSONString(wt(e)),g.payloadObj=E.jws.JWS.readSafeJSONString(wt(n)),g.headerPP=JSON.stringify(g.headerObj,null,"  "),g.payloadObj==null?g.payloadPP=wt(n):g.payloadPP=JSON.stringify(g.payloadObj,null,"  "),s!==void 0&&(g.sigHex=xe(s)),g},E.jws.JWS.verifyJWT=function(t,e,n){var s=E.jws,c=s.JWS,g=c.readSafeJSONString,b=c.inArray,C=c.includedArray,F=t.split("."),k=F[0],U=F[1],N=(xe(F[2]),g(wt(k))),$=g(wt(U));if(N.alg===void 0)return!1;if(n.alg===void 0)throw"acceptField.alg shall be specified";if(!b(N.alg,n.alg)||$.iss!==void 0&&R(n.iss)==="object"&&!b($.iss,n.iss)||$.sub!==void 0&&R(n.sub)==="object"&&!b($.sub,n.sub))return!1;if($.aud!==void 0&&R(n.aud)==="object"){if(typeof $.aud=="string"){if(!b($.aud,n.aud))return!1}else if(R($.aud)=="object"&&!C($.aud,n.aud))return!1}var z=s.IntDate.getNow();return n.verifyAt!==void 0&&typeof n.verifyAt=="number"&&(z=n.verifyAt),n.gracePeriod!==void 0&&typeof n.gracePeriod=="number"||(n.gracePeriod=0),!($.exp!==void 0&&typeof $.exp=="number"&&$.exp+n.gracePeriod<z)&&!($.nbf!==void 0&&typeof $.nbf=="number"&&z<$.nbf-n.gracePeriod)&&!($.iat!==void 0&&typeof $.iat=="number"&&z<$.iat-n.gracePeriod)&&($.jti===void 0||n.jti===void 0||$.jti===n.jti)&&!!c.verify(t,e,n.alg)},E.jws.JWS.includedArray=function(t,e){var n=E.jws.JWS.inArray;if(t===null||(t===void 0?"undefined":R(t))!=="object"||typeof t.length!="number")return!1;for(var s=0;s<t.length;s++)if(!n(t[s],e))return!1;return!0},E.jws.JWS.inArray=function(t,e){if(e===null||(e===void 0?"undefined":R(e))!=="object"||typeof e.length!="number")return!1;for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1},E.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},E.jws.JWS.isSafeJSONString=function(t,e,n){var s=null;try{return((s=ri(t))===void 0?"undefined":R(s))!="object"||s.constructor===Array?0:(e&&(e[n]=s),1)}catch{return 0}},E.jws.JWS.readSafeJSONString=function(t){var e=null;try{return((e=ri(t))===void 0?"undefined":R(e))!="object"||e.constructor===Array?null:e}catch{return null}},E.jws.JWS.getEncodedSignatureValueFromJWS=function(t){var e=t.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(e==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]},E.jws.JWS.getJWKthumbprint=function(t){if(t.kty!=="RSA"&&t.kty!=="EC"&&t.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var e="{";if(t.kty==="RSA"){if(typeof t.n!="string"||typeof t.e!="string")throw"wrong n and e value for RSA key";e+='"e":"'+t.e+'",',e+='"kty":"'+t.kty+'",',e+='"n":"'+t.n+'"}'}else if(t.kty==="EC"){if(typeof t.crv!="string"||typeof t.x!="string"||typeof t.y!="string")throw"wrong crv, x and y value for EC key";e+='"crv":"'+t.crv+'",',e+='"kty":"'+t.kty+'",',e+='"x":"'+t.x+'",',e+='"y":"'+t.y+'"}'}else if(t.kty==="oct"){if(typeof t.k!="string")throw"wrong k value for oct(symmetric) key";e+='"kty":"'+t.kty+'",',e+='"k":"'+t.k+'"}'}var n=Ft(e);return je(E.crypto.Util.hashHex(n,"sha256"))},E.jws.IntDate={},E.jws.IntDate.get=function(t){var e=E.jws.IntDate,n=e.getNow,s=e.getZulu;if(t=="now")return n();if(t=="now + 1hour")return n()+3600;if(t=="now + 1day")return n()+86400;if(t=="now + 1month")return n()+2592e3;if(t=="now + 1year")return n()+31536e3;if(t.match(/Z$/))return s(t);if(t.match(/^[0-9]+$/))return parseInt(t);throw"unsupported format: "+t},E.jws.IntDate.getZulu=function(t){return ui(t)},E.jws.IntDate.getNow=function(){return~~(new Date/1e3)},E.jws.IntDate.intDate2UTCString=function(t){return new Date(1e3*t).toUTCString()},E.jws.IntDate.intDate2Zulu=function(t){var e=new Date(1e3*t);return("0000"+e.getUTCFullYear()).slice(-4)+("00"+(e.getUTCMonth()+1)).slice(-2)+("00"+e.getUTCDate()).slice(-2)+("00"+e.getUTCHours()).slice(-2)+("00"+e.getUTCMinutes()).slice(-2)+("00"+e.getUTCSeconds()).slice(-2)+"Z"},o.SecureRandom=Fe,o.rng_seed_time=X,o.BigInteger=O,o.RSAKey=le;var is=E.crypto.EDSA;o.EDSA=is;var os=E.crypto.DSA;o.DSA=os;var ss=E.crypto.Signature;o.Signature=ss;var as=E.crypto.MessageDigest;o.MessageDigest=as;var us=E.crypto.Mac;o.Mac=us;var cs=E.crypto.Cipher;o.Cipher=cs,o.KEYUTIL=Ne,o.ASN1HEX=se,o.X509=$e,o.CryptoJS=A,o.b64tohex=Q,o.b64toBA=ne,o.stoBA=ni,o.BAtos=ii,o.BAtohex=Pr,o.stohex=Tt,o.stob64=function(e){return I(Tt(e))},o.stob64u=function(e){return Tr(I(Tt(e)))},o.b64utos=function(e){return ii(ne(cr(e)))},o.b64tob64u=Tr,o.b64utob64=cr,o.hex2b64=I,o.hextob64u=je,o.b64utohex=xe,o.utf8tob64u=ur,o.b64utoutf8=wt,o.utf8tob64=function(e){return I(Ir(Lr(e)))},o.b64toutf8=function(e){return decodeURIComponent(Rr(Q(e)))},o.utf8tohex=rn,o.hextoutf8=Ke,o.hextorstr=gt,o.rstrtohex=Ft,o.hextob64=oi,o.hextob64nl=si,o.b64nltohex=ai,o.hextopem=ct,o.pemtohex=At,o.hextoArrayBuffer=function(e){if(e.length%2!=0)throw"input is not even length";if(e.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var n=new ArrayBuffer(e.length/2),s=new DataView(n),c=0;c<e.length/2;c++)s.setUint8(c,parseInt(e.substr(2*c,2),16));return n},o.ArrayBuffertohex=function(e){for(var n="",s=new DataView(e),c=0;c<e.byteLength;c++)n+=("00"+s.getUint8(c).toString(16)).slice(-2);return n},o.zulutomsec=nn,o.zulutosec=ui,o.zulutodate=function(e){return new Date(nn(e))},o.datetozulu=function(e,n,s){var c,g=e.getUTCFullYear();if(n){if(g<1950||2049<g)throw"not proper year for UTCTime: "+g;c=(""+g).slice(-2)}else c=("000"+g).slice(-4);if(c+=("0"+(e.getUTCMonth()+1)).slice(-2),c+=("0"+e.getUTCDate()).slice(-2),c+=("0"+e.getUTCHours()).slice(-2),c+=("0"+e.getUTCMinutes()).slice(-2),c+=("0"+e.getUTCSeconds()).slice(-2),s){var b=e.getUTCMilliseconds();b!==0&&(c+="."+(b=(b=("00"+b).slice(-3)).replace(/0+$/g,"")))}return c+="Z"},o.uricmptohex=Ir,o.hextouricmp=Rr,o.ipv6tohex=ci,o.hextoipv6=li,o.hextoip=on,o.iptohex=function(e){var n="malformed IP address";if(!(e=e.toLowerCase(e)).match(/^[0-9.]+$/)){if(e.match(/^[0-9a-f:]+$/)&&e.indexOf(":")!==-1)return ci(e);throw n}var s=e.split(".");if(s.length!==4)throw n;var c="";try{for(var g=0;g<4;g++)c+=("0"+parseInt(s[g]).toString(16)).slice(-2);return c}catch{throw n}},o.encodeURIComponentAll=Lr,o.newline_toUnix=function(e){return e=e.replace(/\r\n/gm,`
`)},o.newline_toDos=function(e){return e=(e=e.replace(/\r\n/gm,`
`)).replace(/\n/gm,`\r
`)},o.hextoposhex=sn,o.intarystrtohex=function(e){e=(e=(e=e.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return e.split(/,/).map((function(n,s,c){var g=parseInt(n);if(g<0||255<g)throw"integer not in range 0-255";return("00"+g.toString(16)).slice(-2)})).join("")}catch(n){throw"malformed integer array string: "+n}},o.strdiffidx=function(e,n){var s=e.length;e.length>n.length&&(s=n.length);for(var c=0;c<s;c++)if(e.charCodeAt(c)!=n.charCodeAt(c))return c;return e.length!=n.length?s:-1},o.KJUR=E;var ls=E.crypto;o.crypto=ls;var hs=E.asn1;o.asn1=hs;var ds=E.jws;o.jws=ds;var fs=E.lang;o.lang=fs}).call(this,u(28).Buffer)},function(a,o,u){(function(l){var h=u(30),_=u(31),y=u(32);function f(){return d.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function p(W,m){if(f()<m)throw new RangeError("Invalid typed array length");return d.TYPED_ARRAY_SUPPORT?(W=new Uint8Array(m)).__proto__=d.prototype:(W===null&&(W=new d(m)),W.length=m),W}function d(W,m,v){if(!(d.TYPED_ARRAY_SUPPORT||this instanceof d))return new d(W,m,v);if(typeof W=="number"){if(typeof m=="string")throw new Error("If encoding is specified then the first argument must be a string");return x(this,W)}return S(this,W,m,v)}function S(W,m,v,j){if(typeof m=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&m instanceof ArrayBuffer?(function(X,re,ce,fe){if(re.byteLength,ce<0||re.byteLength<ce)throw new RangeError("'offset' is out of bounds");if(re.byteLength<ce+(fe||0))throw new RangeError("'length' is out of bounds");return re=ce===void 0&&fe===void 0?new Uint8Array(re):fe===void 0?new Uint8Array(re,ce):new Uint8Array(re,ce,fe),d.TYPED_ARRAY_SUPPORT?(X=re).__proto__=d.prototype:X=q(X,re),X})(W,m,v,j):typeof m=="string"?(function(X,re,ce){if(typeof ce=="string"&&ce!==""||(ce="utf8"),!d.isEncoding(ce))throw new TypeError('"encoding" must be a valid string encoding');var fe=0|R(re,ce),Se=(X=p(X,fe)).write(re,ce);return Se!==fe&&(X=X.slice(0,Se)),X})(W,m,v):(function(X,re){if(d.isBuffer(re)){var ce=0|H(re.length);return(X=p(X,ce)).length===0||re.copy(X,0,0,ce),X}if(re){if(typeof ArrayBuffer<"u"&&re.buffer instanceof ArrayBuffer||"length"in re)return typeof re.length!="number"||(function(Se){return Se!=Se})(re.length)?p(X,0):q(X,re);if(re.type==="Buffer"&&y(re.data))return q(X,re.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")})(W,m)}function P(W){if(typeof W!="number")throw new TypeError('"size" argument must be a number');if(W<0)throw new RangeError('"size" argument must not be negative')}function x(W,m){if(P(m),W=p(W,m<0?0:0|H(m)),!d.TYPED_ARRAY_SUPPORT)for(var v=0;v<m;++v)W[v]=0;return W}function q(W,m){var v=m.length<0?0:0|H(m.length);W=p(W,v);for(var j=0;j<v;j+=1)W[j]=255&m[j];return W}function H(W){if(W>=f())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f().toString(16)+" bytes");return 0|W}function R(W,m){if(d.isBuffer(W))return W.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(W)||W instanceof ArrayBuffer))return W.byteLength;typeof W!="string"&&(W=""+W);var v=W.length;if(v===0)return 0;for(var j=!1;;)switch(m){case"ascii":case"latin1":case"binary":return v;case"utf8":case"utf-8":case void 0:return at(W).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*v;case"hex":return v>>>1;case"base64":return Je(W).length;default:if(j)return at(W).length;m=(""+m).toLowerCase(),j=!0}}function L(W,m,v){var j=!1;if((m===void 0||m<0)&&(m=0),m>this.length||((v===void 0||v>this.length)&&(v=this.length),v<=0)||(v>>>=0)<=(m>>>=0))return"";for(W||(W="utf8");;)switch(W){case"hex":return Be(this,m,v);case"utf8":case"utf-8":return be(this,m,v);case"ascii":return Ue(this,m,v);case"latin1":case"binary":return Qe(this,m,v);case"base64":return ye(this,m,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ze(this,m,v);default:if(j)throw new TypeError("Unknown encoding: "+W);W=(W+"").toLowerCase(),j=!0}}function V(W,m,v){var j=W[m];W[m]=W[v],W[v]=j}function A(W,m,v,j,J){if(W.length===0)return-1;if(typeof v=="string"?(j=v,v=0):v>2147483647?v=2147483647:v<-2147483648&&(v=-2147483648),v=+v,isNaN(v)&&(v=J?0:W.length-1),v<0&&(v=W.length+v),v>=W.length){if(J)return-1;v=W.length-1}else if(v<0){if(!J)return-1;v=0}if(typeof m=="string"&&(m=d.from(m,j)),d.isBuffer(m))return m.length===0?-1:M(W,m,v,j,J);if(typeof m=="number")return m&=255,d.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?J?Uint8Array.prototype.indexOf.call(W,m,v):Uint8Array.prototype.lastIndexOf.call(W,m,v):M(W,[m],v,j,J);throw new TypeError("val must be string, number or Buffer")}function M(W,m,v,j,J){var X,re=1,ce=W.length,fe=m.length;if(j!==void 0&&((j=String(j).toLowerCase())==="ucs2"||j==="ucs-2"||j==="utf16le"||j==="utf-16le")){if(W.length<2||m.length<2)return-1;re=2,ce/=2,fe/=2,v/=2}function Se(yt,le){return re===1?yt[le]:yt.readUInt16BE(le*re)}if(J){var _e=-1;for(X=v;X<ce;X++)if(Se(W,X)===Se(m,_e===-1?0:X-_e)){if(_e===-1&&(_e=X),X-_e+1===fe)return _e*re}else _e!==-1&&(X-=X-_e),_e=-1}else for(v+fe>ce&&(v=ce-fe),X=v;X>=0;X--){for(var Fe=!0,ut=0;ut<fe;ut++)if(Se(W,X+ut)!==Se(m,ut)){Fe=!1;break}if(Fe)return X}return-1}function T(W,m,v,j){v=Number(v)||0;var J=W.length-v;j?(j=Number(j))>J&&(j=J):j=J;var X=m.length;if(X%2!=0)throw new TypeError("Invalid hex string");j>X/2&&(j=X/2);for(var re=0;re<j;++re){var ce=parseInt(m.substr(2*re,2),16);if(isNaN(ce))return re;W[v+re]=ce}return re}function I(W,m,v,j){return Ce(at(m,W.length-v),W,v,j)}function Q(W,m,v,j){return Ce((function(X){for(var re=[],ce=0;ce<X.length;++ce)re.push(255&X.charCodeAt(ce));return re})(m),W,v,j)}function ne(W,m,v,j){return Q(W,m,v,j)}function O(W,m,v,j){return Ce(Je(m),W,v,j)}function ie(W,m,v,j){return Ce((function(X,re){for(var ce,fe,Se,_e=[],Fe=0;Fe<X.length&&!((re-=2)<0);++Fe)fe=(ce=X.charCodeAt(Fe))>>8,Se=ce%256,_e.push(Se),_e.push(fe);return _e})(m,W.length-v),W,v,j)}function ye(W,m,v){return m===0&&v===W.length?h.fromByteArray(W):h.fromByteArray(W.slice(m,v))}function be(W,m,v){v=Math.min(W.length,v);for(var j=[],J=m;J<v;){var X,re,ce,fe,Se=W[J],_e=null,Fe=Se>239?4:Se>223?3:Se>191?2:1;if(J+Fe<=v)switch(Fe){case 1:Se<128&&(_e=Se);break;case 2:(192&(X=W[J+1]))==128&&(fe=(31&Se)<<6|63&X)>127&&(_e=fe);break;case 3:X=W[J+1],re=W[J+2],(192&X)==128&&(192&re)==128&&(fe=(15&Se)<<12|(63&X)<<6|63&re)>2047&&(fe<55296||fe>57343)&&(_e=fe);break;case 4:X=W[J+1],re=W[J+2],ce=W[J+3],(192&X)==128&&(192&re)==128&&(192&ce)==128&&(fe=(15&Se)<<18|(63&X)<<12|(63&re)<<6|63&ce)>65535&&fe<1114112&&(_e=fe)}_e===null?(_e=65533,Fe=1):_e>65535&&(_e-=65536,j.push(_e>>>10&1023|55296),_e=56320|1023&_e),j.push(_e),J+=Fe}return(function(yt){var le=yt.length;if(le<=We)return String.fromCharCode.apply(String,yt);for(var Ie="",ve=0;ve<le;)Ie+=String.fromCharCode.apply(String,yt.slice(ve,ve+=We));return Ie})(j)}o.Buffer=d,o.SlowBuffer=function(m){return+m!=m&&(m=0),d.alloc(+m)},o.INSPECT_MAX_BYTES=50,d.TYPED_ARRAY_SUPPORT=l.TYPED_ARRAY_SUPPORT!==void 0?l.TYPED_ARRAY_SUPPORT:(function(){try{var m=new Uint8Array(1);return m.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},m.foo()===42&&typeof m.subarray=="function"&&m.subarray(1,1).byteLength===0}catch{return!1}})(),o.kMaxLength=f(),d.poolSize=8192,d._augment=function(W){return W.__proto__=d.prototype,W},d.from=function(W,m,v){return S(null,W,m,v)},d.TYPED_ARRAY_SUPPORT&&(d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0})),d.alloc=function(W,m,v){return(function(J,X,re,ce){return P(X),X<=0?p(J,X):re!==void 0?typeof ce=="string"?p(J,X).fill(re,ce):p(J,X).fill(re):p(J,X)})(null,W,m,v)},d.allocUnsafe=function(W){return x(null,W)},d.allocUnsafeSlow=function(W){return x(null,W)},d.isBuffer=function(m){return!(m==null||!m._isBuffer)},d.compare=function(m,v){if(!d.isBuffer(m)||!d.isBuffer(v))throw new TypeError("Arguments must be Buffers");if(m===v)return 0;for(var j=m.length,J=v.length,X=0,re=Math.min(j,J);X<re;++X)if(m[X]!==v[X]){j=m[X],J=v[X];break}return j<J?-1:J<j?1:0},d.isEncoding=function(m){switch(String(m).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(m,v){if(!y(m))throw new TypeError('"list" argument must be an Array of Buffers');if(m.length===0)return d.alloc(0);var j;if(v===void 0)for(v=0,j=0;j<m.length;++j)v+=m[j].length;var J=d.allocUnsafe(v),X=0;for(j=0;j<m.length;++j){var re=m[j];if(!d.isBuffer(re))throw new TypeError('"list" argument must be an Array of Buffers');re.copy(J,X),X+=re.length}return J},d.byteLength=R,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var m=this.length;if(m%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var v=0;v<m;v+=2)V(this,v,v+1);return this},d.prototype.swap32=function(){var m=this.length;if(m%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var v=0;v<m;v+=4)V(this,v,v+3),V(this,v+1,v+2);return this},d.prototype.swap64=function(){var m=this.length;if(m%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var v=0;v<m;v+=8)V(this,v,v+7),V(this,v+1,v+6),V(this,v+2,v+5),V(this,v+3,v+4);return this},d.prototype.toString=function(){var m=0|this.length;return m===0?"":arguments.length===0?be(this,0,m):L.apply(this,arguments)},d.prototype.equals=function(m){if(!d.isBuffer(m))throw new TypeError("Argument must be a Buffer");return this===m||d.compare(this,m)===0},d.prototype.inspect=function(){var m="",v=o.INSPECT_MAX_BYTES;return this.length>0&&(m=this.toString("hex",0,v).match(/.{2}/g).join(" "),this.length>v&&(m+=" ... ")),"<Buffer "+m+">"},d.prototype.compare=function(m,v,j,J,X){if(!d.isBuffer(m))throw new TypeError("Argument must be a Buffer");if(v===void 0&&(v=0),j===void 0&&(j=m?m.length:0),J===void 0&&(J=0),X===void 0&&(X=this.length),v<0||j>m.length||J<0||X>this.length)throw new RangeError("out of range index");if(J>=X&&v>=j)return 0;if(J>=X)return-1;if(v>=j)return 1;if(this===m)return 0;for(var re=(X>>>=0)-(J>>>=0),ce=(j>>>=0)-(v>>>=0),fe=Math.min(re,ce),Se=this.slice(J,X),_e=m.slice(v,j),Fe=0;Fe<fe;++Fe)if(Se[Fe]!==_e[Fe]){re=Se[Fe],ce=_e[Fe];break}return re<ce?-1:ce<re?1:0},d.prototype.includes=function(m,v,j){return this.indexOf(m,v,j)!==-1},d.prototype.indexOf=function(m,v,j){return A(this,m,v,j,!0)},d.prototype.lastIndexOf=function(m,v,j){return A(this,m,v,j,!1)},d.prototype.write=function(m,v,j,J){if(v===void 0)J="utf8",j=this.length,v=0;else if(j===void 0&&typeof v=="string")J=v,j=this.length,v=0;else{if(!isFinite(v))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");v|=0,isFinite(j)?(j|=0,J===void 0&&(J="utf8")):(J=j,j=void 0)}var X=this.length-v;if((j===void 0||j>X)&&(j=X),m.length>0&&(j<0||v<0)||v>this.length)throw new RangeError("Attempt to write outside buffer bounds");J||(J="utf8");for(var re=!1;;)switch(J){case"hex":return T(this,m,v,j);case"utf8":case"utf-8":return I(this,m,v,j);case"ascii":return Q(this,m,v,j);case"latin1":case"binary":return ne(this,m,v,j);case"base64":return O(this,m,v,j);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,m,v,j);default:if(re)throw new TypeError("Unknown encoding: "+J);J=(""+J).toLowerCase(),re=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var We=4096;function Ue(W,m,v){var j="";v=Math.min(W.length,v);for(var J=m;J<v;++J)j+=String.fromCharCode(127&W[J]);return j}function Qe(W,m,v){var j="";v=Math.min(W.length,v);for(var J=m;J<v;++J)j+=String.fromCharCode(W[J]);return j}function Be(W,m,v){var j=W.length;(!m||m<0)&&(m=0),(!v||v<0||v>j)&&(v=j);for(var J="",X=m;X<v;++X)J+=tt(W[X]);return J}function Ze(W,m,v){for(var j=W.slice(m,v),J="",X=0;X<j.length;X+=2)J+=String.fromCharCode(j[X]+256*j[X+1]);return J}function ge(W,m,v){if(W%1!=0||W<0)throw new RangeError("offset is not uint");if(W+m>v)throw new RangeError("Trying to access beyond buffer length")}function we(W,m,v,j,J,X){if(!d.isBuffer(W))throw new TypeError('"buffer" argument must be a Buffer instance');if(m>J||m<X)throw new RangeError('"value" argument is out of bounds');if(v+j>W.length)throw new RangeError("Index out of range")}function ze(W,m,v,j){m<0&&(m=65535+m+1);for(var J=0,X=Math.min(W.length-v,2);J<X;++J)W[v+J]=(m&255<<8*(j?J:1-J))>>>8*(j?J:1-J)}function et(W,m,v,j){m<0&&(m=4294967295+m+1);for(var J=0,X=Math.min(W.length-v,4);J<X;++J)W[v+J]=m>>>8*(j?J:3-J)&255}function ot(W,m,v,j,J,X){if(v+j>W.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("Index out of range")}function st(W,m,v,j,J){return J||ot(W,0,v,4),_.write(W,m,v,j,23,4),v+4}function ft(W,m,v,j,J){return J||ot(W,0,v,8),_.write(W,m,v,j,52,8),v+8}d.prototype.slice=function(m,v){var j,J=this.length;if((m=~~m)<0?(m+=J)<0&&(m=0):m>J&&(m=J),(v=v===void 0?J:~~v)<0?(v+=J)<0&&(v=0):v>J&&(v=J),v<m&&(v=m),d.TYPED_ARRAY_SUPPORT)(j=this.subarray(m,v)).__proto__=d.prototype;else{var X=v-m;j=new d(X,void 0);for(var re=0;re<X;++re)j[re]=this[re+m]}return j},d.prototype.readUIntLE=function(m,v,j){m|=0,v|=0,j||ge(m,v,this.length);for(var J=this[m],X=1,re=0;++re<v&&(X*=256);)J+=this[m+re]*X;return J},d.prototype.readUIntBE=function(m,v,j){m|=0,v|=0,j||ge(m,v,this.length);for(var J=this[m+--v],X=1;v>0&&(X*=256);)J+=this[m+--v]*X;return J},d.prototype.readUInt8=function(m,v){return v||ge(m,1,this.length),this[m]},d.prototype.readUInt16LE=function(m,v){return v||ge(m,2,this.length),this[m]|this[m+1]<<8},d.prototype.readUInt16BE=function(m,v){return v||ge(m,2,this.length),this[m]<<8|this[m+1]},d.prototype.readUInt32LE=function(m,v){return v||ge(m,4,this.length),(this[m]|this[m+1]<<8|this[m+2]<<16)+16777216*this[m+3]},d.prototype.readUInt32BE=function(m,v){return v||ge(m,4,this.length),16777216*this[m]+(this[m+1]<<16|this[m+2]<<8|this[m+3])},d.prototype.readIntLE=function(m,v,j){m|=0,v|=0,j||ge(m,v,this.length);for(var J=this[m],X=1,re=0;++re<v&&(X*=256);)J+=this[m+re]*X;return J>=(X*=128)&&(J-=Math.pow(2,8*v)),J},d.prototype.readIntBE=function(m,v,j){m|=0,v|=0,j||ge(m,v,this.length);for(var J=v,X=1,re=this[m+--J];J>0&&(X*=256);)re+=this[m+--J]*X;return re>=(X*=128)&&(re-=Math.pow(2,8*v)),re},d.prototype.readInt8=function(m,v){return v||ge(m,1,this.length),128&this[m]?-1*(255-this[m]+1):this[m]},d.prototype.readInt16LE=function(m,v){v||ge(m,2,this.length);var j=this[m]|this[m+1]<<8;return 32768&j?4294901760|j:j},d.prototype.readInt16BE=function(m,v){v||ge(m,2,this.length);var j=this[m+1]|this[m]<<8;return 32768&j?4294901760|j:j},d.prototype.readInt32LE=function(m,v){return v||ge(m,4,this.length),this[m]|this[m+1]<<8|this[m+2]<<16|this[m+3]<<24},d.prototype.readInt32BE=function(m,v){return v||ge(m,4,this.length),this[m]<<24|this[m+1]<<16|this[m+2]<<8|this[m+3]},d.prototype.readFloatLE=function(m,v){return v||ge(m,4,this.length),_.read(this,m,!0,23,4)},d.prototype.readFloatBE=function(m,v){return v||ge(m,4,this.length),_.read(this,m,!1,23,4)},d.prototype.readDoubleLE=function(m,v){return v||ge(m,8,this.length),_.read(this,m,!0,52,8)},d.prototype.readDoubleBE=function(m,v){return v||ge(m,8,this.length),_.read(this,m,!1,52,8)},d.prototype.writeUIntLE=function(m,v,j,J){m=+m,v|=0,j|=0,J||we(this,m,v,j,Math.pow(2,8*j)-1,0);var X=1,re=0;for(this[v]=255&m;++re<j&&(X*=256);)this[v+re]=m/X&255;return v+j},d.prototype.writeUIntBE=function(m,v,j,J){m=+m,v|=0,j|=0,J||we(this,m,v,j,Math.pow(2,8*j)-1,0);var X=j-1,re=1;for(this[v+X]=255&m;--X>=0&&(re*=256);)this[v+X]=m/re&255;return v+j},d.prototype.writeUInt8=function(m,v,j){return m=+m,v|=0,j||we(this,m,v,1,255,0),d.TYPED_ARRAY_SUPPORT||(m=Math.floor(m)),this[v]=255&m,v+1},d.prototype.writeUInt16LE=function(m,v,j){return m=+m,v|=0,j||we(this,m,v,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[v]=255&m,this[v+1]=m>>>8):ze(this,m,v,!0),v+2},d.prototype.writeUInt16BE=function(m,v,j){return m=+m,v|=0,j||we(this,m,v,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[v]=m>>>8,this[v+1]=255&m):ze(this,m,v,!1),v+2},d.prototype.writeUInt32LE=function(m,v,j){return m=+m,v|=0,j||we(this,m,v,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[v+3]=m>>>24,this[v+2]=m>>>16,this[v+1]=m>>>8,this[v]=255&m):et(this,m,v,!0),v+4},d.prototype.writeUInt32BE=function(m,v,j){return m=+m,v|=0,j||we(this,m,v,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[v]=m>>>24,this[v+1]=m>>>16,this[v+2]=m>>>8,this[v+3]=255&m):et(this,m,v,!1),v+4},d.prototype.writeIntLE=function(m,v,j,J){if(m=+m,v|=0,!J){var X=Math.pow(2,8*j-1);we(this,m,v,j,X-1,-X)}var re=0,ce=1,fe=0;for(this[v]=255&m;++re<j&&(ce*=256);)m<0&&fe===0&&this[v+re-1]!==0&&(fe=1),this[v+re]=(m/ce>>0)-fe&255;return v+j},d.prototype.writeIntBE=function(m,v,j,J){if(m=+m,v|=0,!J){var X=Math.pow(2,8*j-1);we(this,m,v,j,X-1,-X)}var re=j-1,ce=1,fe=0;for(this[v+re]=255&m;--re>=0&&(ce*=256);)m<0&&fe===0&&this[v+re+1]!==0&&(fe=1),this[v+re]=(m/ce>>0)-fe&255;return v+j},d.prototype.writeInt8=function(m,v,j){return m=+m,v|=0,j||we(this,m,v,1,127,-128),d.TYPED_ARRAY_SUPPORT||(m=Math.floor(m)),m<0&&(m=255+m+1),this[v]=255&m,v+1},d.prototype.writeInt16LE=function(m,v,j){return m=+m,v|=0,j||we(this,m,v,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[v]=255&m,this[v+1]=m>>>8):ze(this,m,v,!0),v+2},d.prototype.writeInt16BE=function(m,v,j){return m=+m,v|=0,j||we(this,m,v,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[v]=m>>>8,this[v+1]=255&m):ze(this,m,v,!1),v+2},d.prototype.writeInt32LE=function(m,v,j){return m=+m,v|=0,j||we(this,m,v,4,2147483647,-2147483648),d.TYPED_ARRAY_SUPPORT?(this[v]=255&m,this[v+1]=m>>>8,this[v+2]=m>>>16,this[v+3]=m>>>24):et(this,m,v,!0),v+4},d.prototype.writeInt32BE=function(m,v,j){return m=+m,v|=0,j||we(this,m,v,4,2147483647,-2147483648),m<0&&(m=4294967295+m+1),d.TYPED_ARRAY_SUPPORT?(this[v]=m>>>24,this[v+1]=m>>>16,this[v+2]=m>>>8,this[v+3]=255&m):et(this,m,v,!1),v+4},d.prototype.writeFloatLE=function(m,v,j){return st(this,m,v,!0,j)},d.prototype.writeFloatBE=function(m,v,j){return st(this,m,v,!1,j)},d.prototype.writeDoubleLE=function(m,v,j){return ft(this,m,v,!0,j)},d.prototype.writeDoubleBE=function(m,v,j){return ft(this,m,v,!1,j)},d.prototype.copy=function(m,v,j,J){if(j||(j=0),J||J===0||(J=this.length),v>=m.length&&(v=m.length),v||(v=0),J>0&&J<j&&(J=j),J===j||m.length===0||this.length===0)return 0;if(v<0)throw new RangeError("targetStart out of bounds");if(j<0||j>=this.length)throw new RangeError("sourceStart out of bounds");if(J<0)throw new RangeError("sourceEnd out of bounds");J>this.length&&(J=this.length),m.length-v<J-j&&(J=m.length-v+j);var X,re=J-j;if(this===m&&j<v&&v<J)for(X=re-1;X>=0;--X)m[X+v]=this[X+j];else if(re<1e3||!d.TYPED_ARRAY_SUPPORT)for(X=0;X<re;++X)m[X+v]=this[X+j];else Uint8Array.prototype.set.call(m,this.subarray(j,j+re),v);return re},d.prototype.fill=function(m,v,j,J){if(typeof m=="string"){if(typeof v=="string"?(J=v,v=0,j=this.length):typeof j=="string"&&(J=j,j=this.length),m.length===1){var X=m.charCodeAt(0);X<256&&(m=X)}if(J!==void 0&&typeof J!="string")throw new TypeError("encoding must be a string");if(typeof J=="string"&&!d.isEncoding(J))throw new TypeError("Unknown encoding: "+J)}else typeof m=="number"&&(m&=255);if(v<0||this.length<v||this.length<j)throw new RangeError("Out of range index");if(j<=v)return this;var re;if(v>>>=0,j=j===void 0?this.length:j>>>0,m||(m=0),typeof m=="number")for(re=v;re<j;++re)this[re]=m;else{var ce=d.isBuffer(m)?m:at(new d(m,J).toString()),fe=ce.length;for(re=0;re<j-v;++re)this[re+v]=ce[re%fe]}return this};var Pt=/[^+\/0-9A-Za-z-_]/g;function tt(W){return W<16?"0"+W.toString(16):W.toString(16)}function at(W,m){var v;m=m||1/0;for(var j=W.length,J=null,X=[],re=0;re<j;++re){if((v=W.charCodeAt(re))>55295&&v<57344){if(!J){if(v>56319){(m-=3)>-1&&X.push(239,191,189);continue}if(re+1===j){(m-=3)>-1&&X.push(239,191,189);continue}J=v;continue}if(v<56320){(m-=3)>-1&&X.push(239,191,189),J=v;continue}v=65536+(J-55296<<10|v-56320)}else J&&(m-=3)>-1&&X.push(239,191,189);if(J=null,v<128){if((m-=1)<0)break;X.push(v)}else if(v<2048){if((m-=2)<0)break;X.push(v>>6|192,63&v|128)}else if(v<65536){if((m-=3)<0)break;X.push(v>>12|224,v>>6&63|128,63&v|128)}else{if(!(v<1114112))throw new Error("Invalid code point");if((m-=4)<0)break;X.push(v>>18|240,v>>12&63|128,v>>6&63|128,63&v|128)}}return X}function Je(W){return h.toByteArray((function(v){if((v=(function(J){return J.trim?J.trim():J.replace(/^\s+|\s+$/g,"")})(v).replace(Pt,"")).length<2)return"";for(;v.length%4!=0;)v+="=";return v})(W))}function Ce(W,m,v,j){for(var J=0;J<j&&!(J+v>=m.length||J>=W.length);++J)m[J+v]=W[J];return J}}).call(this,u(29))},function(a,o){var u;u=(function(){return this})();try{u=u||new Function("return this")()}catch{typeof window=="object"&&(u=window)}a.exports=u},function(a,o,u){o.byteLength=function(x){var q=d(x),H=q[0],R=q[1];return 3*(H+R)/4-R},o.toByteArray=function(x){var q,H,R=d(x),L=R[0],V=R[1],A=new _((function(Q,ne,O){return 3*(ne+O)/4-O})(0,L,V)),M=0,T=V>0?L-4:L;for(H=0;H<T;H+=4)q=h[x.charCodeAt(H)]<<18|h[x.charCodeAt(H+1)]<<12|h[x.charCodeAt(H+2)]<<6|h[x.charCodeAt(H+3)],A[M++]=q>>16&255,A[M++]=q>>8&255,A[M++]=255&q;return V===2&&(q=h[x.charCodeAt(H)]<<2|h[x.charCodeAt(H+1)]>>4,A[M++]=255&q),V===1&&(q=h[x.charCodeAt(H)]<<10|h[x.charCodeAt(H+1)]<<4|h[x.charCodeAt(H+2)]>>2,A[M++]=q>>8&255,A[M++]=255&q),A},o.fromByteArray=function(x){for(var q,H=x.length,R=H%3,L=[],V=16383,A=0,M=H-R;A<M;A+=V)L.push(S(x,A,A+V>M?M:A+V));return R===1?(q=x[H-1],L.push(l[q>>2]+l[q<<4&63]+"==")):R===2&&(q=(x[H-2]<<8)+x[H-1],L.push(l[q>>10]+l[q>>4&63]+l[q<<2&63]+"=")),L.join("")};for(var l=[],h=[],_=typeof Uint8Array<"u"?Uint8Array:Array,y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,p=y.length;f<p;++f)l[f]=y[f],h[y.charCodeAt(f)]=f;function d(P){var x=P.length;if(x%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var q=P.indexOf("=");return q===-1&&(q=x),[q,q===x?0:4-q%4]}function S(P,x,q){for(var H,R,L=[],V=x;V<q;V+=3)H=(P[V]<<16&16711680)+(P[V+1]<<8&65280)+(255&P[V+2]),L.push(l[(R=H)>>18&63]+l[R>>12&63]+l[R>>6&63]+l[63&R]);return L.join("")}h[45]=62,h[95]=63},function(a,o){o.read=function(u,l,h,_,y){var f,p,d=8*y-_-1,S=(1<<d)-1,P=S>>1,x=-7,q=h?y-1:0,H=h?-1:1,R=u[l+q];for(q+=H,f=R&(1<<-x)-1,R>>=-x,x+=d;x>0;f=256*f+u[l+q],q+=H,x-=8);for(p=f&(1<<-x)-1,f>>=-x,x+=_;x>0;p=256*p+u[l+q],q+=H,x-=8);if(f===0)f=1-P;else{if(f===S)return p?NaN:1/0*(R?-1:1);p+=Math.pow(2,_),f-=P}return(R?-1:1)*p*Math.pow(2,f-_)},o.write=function(u,l,h,_,y,f){var p,d,S,P=8*f-y-1,x=(1<<P)-1,q=x>>1,H=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=_?0:f-1,L=_?1:-1,V=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(d=isNaN(l)?1:0,p=x):(p=Math.floor(Math.log(l)/Math.LN2),l*(S=Math.pow(2,-p))<1&&(p--,S*=2),(l+=p+q>=1?H/S:H*Math.pow(2,1-q))*S>=2&&(p++,S/=2),p+q>=x?(d=0,p=x):p+q>=1?(d=(l*S-1)*Math.pow(2,y),p+=q):(d=l*Math.pow(2,q-1)*Math.pow(2,y),p=0));y>=8;u[h+R]=255&d,R+=L,d/=256,y-=8);for(p=p<<y|d,P+=y;P>0;u[h+R]=255&p,R+=L,p/=256,P-=8);u[h+R-L]|=128*V}},function(a,o){var u={}.toString;a.exports=Array.isArray||function(l){return u.call(l)=="[object Array]"}},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(_){var y=_.jws,f=_.KeyUtil,p=_.X509,d=_.crypto,S=_.hextob64u,P=_.b64tohex,x=_.AllowedSigningAlgs;return(function(){function q(){(function(R,L){if(!(R instanceof L))throw new TypeError("Cannot call a class as a function")})(this,q)}return q.parseJwt=function(R){l.Log.debug("JoseUtil.parseJwt");try{var L=y.JWS.parse(R);return{header:L.headerObj,payload:L.payloadObj}}catch(V){l.Log.error(V)}},q.validateJwt=function(R,L,V,A,M,T,I){l.Log.debug("JoseUtil.validateJwt");try{if(L.kty==="RSA")if(L.e&&L.n)L=f.getKey(L);else{if(!L.x5c||!L.x5c.length)return l.Log.error("JoseUtil.validateJwt: RSA key missing key material",L),Promise.reject(new Error("RSA key missing key material"));var Q=P(L.x5c[0]);L=p.getPublicKeyFromCertHex(Q)}else{if(L.kty!=="EC")return l.Log.error("JoseUtil.validateJwt: Unsupported key type",L&&L.kty),Promise.reject(new Error(L.kty));if(!(L.crv&&L.x&&L.y))return l.Log.error("JoseUtil.validateJwt: EC key missing key material",L),Promise.reject(new Error("EC key missing key material"));L=f.getKey(L)}return q._validateJwt(R,L,V,A,M,T,I)}catch(ne){return l.Log.error(ne&&ne.message||ne),Promise.reject("JWT validation failed")}},q.validateJwtAttributes=function(R,L,V,A,M,T){A||(A=0),M||(M=parseInt(Date.now()/1e3));var I=q.parseJwt(R).payload;if(!I.iss)return l.Log.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(I.iss!==L)return l.Log.error("JoseUtil._validateJwt: Invalid issuer in token",I.iss),Promise.reject(new Error("Invalid issuer in token: "+I.iss));if(!I.aud)return l.Log.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(I.aud===V||Array.isArray(I.aud)&&I.aud.indexOf(V)>=0))return l.Log.error("JoseUtil._validateJwt: Invalid audience in token",I.aud),Promise.reject(new Error("Invalid audience in token: "+I.aud));if(I.azp&&I.azp!==V)return l.Log.error("JoseUtil._validateJwt: Invalid azp in token",I.azp),Promise.reject(new Error("Invalid azp in token: "+I.azp));if(!T){var Q=M+A,ne=M-A;if(!I.iat)return l.Log.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(Q<I.iat)return l.Log.error("JoseUtil._validateJwt: iat is in the future",I.iat),Promise.reject(new Error("iat is in the future: "+I.iat));if(I.nbf&&Q<I.nbf)return l.Log.error("JoseUtil._validateJwt: nbf is in the future",I.nbf),Promise.reject(new Error("nbf is in the future: "+I.nbf));if(!I.exp)return l.Log.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(I.exp<ne)return l.Log.error("JoseUtil._validateJwt: exp is in the past",I.exp),Promise.reject(new Error("exp is in the past:"+I.exp))}return Promise.resolve(I)},q._validateJwt=function(R,L,V,A,M,T,I){return q.validateJwtAttributes(R,V,A,M,T,I).then((function(Q){try{return y.JWS.verify(R,L,x)?Q:(l.Log.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed")))}catch(ne){return l.Log.error(ne&&ne.message||ne),Promise.reject(new Error("signature validation failed"))}}))},q.hashString=function(R,L){try{return d.Util.hashString(R,L)}catch(V){l.Log.error(V)}},q.hexToBase64Url=function(R){try{return S(R)}catch(L){l.Log.error(L)}},q})()};var l=u(0);a.exports=o.default},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.SigninResponse=void 0;var l=(function(){function y(f,p){for(var d=0;d<p.length;d++){var S=p[d];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(f,S.key,S)}}return function(f,p,d){return p&&y(f.prototype,p),d&&y(f,d),f}})(),h=u(3);function _(y,f){if(!(y instanceof f))throw new TypeError("Cannot call a class as a function")}o.SigninResponse=(function(){function y(f){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#";_(this,y);var d=h.UrlUtility.parseUrlFragment(f,p);this.error=d.error,this.error_description=d.error_description,this.error_uri=d.error_uri,this.code=d.code,this.state=d.state,this.id_token=d.id_token,this.session_state=d.session_state,this.access_token=d.access_token,this.token_type=d.token_type,this.scope=d.scope,this.profile=void 0,this.expires_in=d.expires_in}return l(y,[{key:"expires_in",get:function(){if(this.expires_at){var p=parseInt(Date.now()/1e3);return this.expires_at-p}},set:function(p){var d=parseInt(p);if(typeof d=="number"&&d>0){var S=parseInt(Date.now()/1e3);this.expires_at=S+d}}},{key:"expired",get:function(){var p=this.expires_in;if(p!==void 0)return p<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}},{key:"isOpenIdConnect",get:function(){return this.scopes.indexOf("openid")>=0||!!this.id_token}}]),y})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.SignoutRequest=void 0;var l=u(0),h=u(3),_=u(9);o.SignoutRequest=function y(f){var p=f.url,d=f.id_token_hint,S=f.post_logout_redirect_uri,P=f.data,x=f.extraQueryParams,q=f.request_type;if((function(L,V){if(!(L instanceof V))throw new TypeError("Cannot call a class as a function")})(this,y),!p)throw l.Log.error("SignoutRequest.ctor: No url passed"),new Error("url");for(var H in d&&(p=h.UrlUtility.addQueryParam(p,"id_token_hint",d)),S&&(p=h.UrlUtility.addQueryParam(p,"post_logout_redirect_uri",S),P&&(this.state=new _.State({data:P,request_type:q}),p=h.UrlUtility.addQueryParam(p,"state",this.state.id))),x)p=h.UrlUtility.addQueryParam(p,H,x[H]);this.url=p}},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.SignoutResponse=void 0;var l=u(3);o.SignoutResponse=function h(_){(function(p,d){if(!(p instanceof d))throw new TypeError("Cannot call a class as a function")})(this,h);var y=l.UrlUtility.parseUrlFragment(_,"?");this.error=y.error,this.error_description=y.error_description,this.error_uri=y.error_uri,this.state=y.state}},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.InMemoryWebStorage=void 0;var l=(function(){function _(y,f){for(var p=0;p<f.length;p++){var d=f[p];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(y,d.key,d)}}return function(y,f,p){return f&&_(y.prototype,f),p&&_(y,p),y}})(),h=u(0);o.InMemoryWebStorage=(function(){function _(){(function(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")})(this,_),this._data={}}return _.prototype.getItem=function(f){return h.Log.debug("InMemoryWebStorage.getItem",f),this._data[f]},_.prototype.setItem=function(f,p){h.Log.debug("InMemoryWebStorage.setItem",f),this._data[f]=p},_.prototype.removeItem=function(f){h.Log.debug("InMemoryWebStorage.removeItem",f),delete this._data[f]},_.prototype.key=function(f){return Object.getOwnPropertyNames(this._data)[f]},l(_,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),_})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.UserManager=void 0;var l=(function(){function V(A,M){for(var T=0;T<M.length;T++){var I=M[T];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(A,I.key,I)}}return function(A,M,T){return M&&V(A.prototype,M),T&&V(A,T),A}})(),h=u(0),_=u(10),y=u(39),f=u(15),p=u(45),d=u(47),S=u(18),P=u(8),x=u(20),q=u(11),H=u(4);function R(V,A){if(!(V instanceof A))throw new TypeError("Cannot call a class as a function")}function L(V,A){if(!V)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!A||typeof A!="object"&&typeof A!="function"?V:A}o.UserManager=(function(V){function A(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d.SilentRenewService,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:S.SessionMonitor,Q=arguments.length>3&&arguments[3]!==void 0?arguments[3]:x.TokenRevocationClient,ne=arguments.length>4&&arguments[4]!==void 0?arguments[4]:q.TokenClient,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:H.JoseUtil;R(this,A),M instanceof y.UserManagerSettings||(M=new y.UserManagerSettings(M));var ie=L(this,V.call(this,M));return ie._events=new p.UserManagerEvents(M),ie._silentRenewService=new T(ie),ie.settings.automaticSilentRenew&&(h.Log.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),ie.startSilentRenew()),ie.settings.monitorSession&&(h.Log.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),ie._sessionMonitor=new I(ie)),ie._tokenRevocationClient=new Q(ie._settings),ie._tokenClient=new ne(ie._settings),ie._joseUtil=O,ie}return(function(T,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);T.prototype=Object.create(I&&I.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(T,I):T.__proto__=I)})(A,V),A.prototype.getUser=function(){var T=this;return this._loadUser().then((function(I){return I?(h.Log.info("UserManager.getUser: user loaded"),T._events.load(I,!1),I):(h.Log.info("UserManager.getUser: user not found in storage"),null)}))},A.prototype.removeUser=function(){var T=this;return this.storeUser(null).then((function(){h.Log.info("UserManager.removeUser: user removed from storage"),T._events.unload()}))},A.prototype.signinRedirect=function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(T=Object.assign({},T)).request_type="si:r";var I={useReplaceToNavigate:T.useReplaceToNavigate};return this._signinStart(T,this._redirectNavigator,I).then((function(){h.Log.info("UserManager.signinRedirect: successful")}))},A.prototype.signinRedirectCallback=function(T){return this._signinEnd(T||this._redirectNavigator.url).then((function(I){return I.profile&&I.profile.sub?h.Log.info("UserManager.signinRedirectCallback: successful, signed in sub: ",I.profile.sub):h.Log.info("UserManager.signinRedirectCallback: no sub"),I}))},A.prototype.signinPopup=function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(T=Object.assign({},T)).request_type="si:p";var I=T.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return I?(T.redirect_uri=I,T.display="popup",this._signin(T,this._popupNavigator,{startUrl:I,popupWindowFeatures:T.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:T.popupWindowTarget||this.settings.popupWindowTarget}).then((function(Q){return Q&&(Q.profile&&Q.profile.sub?h.Log.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",Q.profile.sub):h.Log.info("UserManager.signinPopup: no sub")),Q}))):(h.Log.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))},A.prototype.signinPopupCallback=function(T){return this._signinCallback(T,this._popupNavigator).then((function(I){return I&&(I.profile&&I.profile.sub?h.Log.info("UserManager.signinPopupCallback: successful, signed in sub: ",I.profile.sub):h.Log.info("UserManager.signinPopupCallback: no sub")),I})).catch((function(I){h.Log.error(I.message)}))},A.prototype.signinSilent=function(){var T=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return I=Object.assign({},I),this._loadUser().then((function(Q){return Q&&Q.refresh_token?(I.refresh_token=Q.refresh_token,T._useRefreshToken(I)):(I.request_type="si:s",I.id_token_hint=I.id_token_hint||T.settings.includeIdTokenInSilentRenew&&Q&&Q.id_token,Q&&T._settings.validateSubOnSilentRenew&&(h.Log.debug("UserManager.signinSilent, subject prior to silent renew: ",Q.profile.sub),I.current_sub=Q.profile.sub),T._signinSilentIframe(I))}))},A.prototype._useRefreshToken=function(){var T=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._tokenClient.exchangeRefreshToken(I).then((function(Q){return Q?Q.access_token?T._loadUser().then((function(ne){if(ne){var O=Promise.resolve();return Q.id_token&&(O=T._validateIdTokenFromTokenRefreshToken(ne.profile,Q.id_token)),O.then((function(){return h.Log.debug("UserManager._useRefreshToken: refresh token response success"),ne.id_token=Q.id_token||ne.id_token,ne.access_token=Q.access_token,ne.refresh_token=Q.refresh_token||ne.refresh_token,ne.expires_in=Q.expires_in,T.storeUser(ne).then((function(){return T._events.load(ne),ne}))}))}return null})):(h.Log.error("UserManager._useRefreshToken: No access token returned from token endpoint"),Promise.reject("No access token returned from token endpoint")):(h.Log.error("UserManager._useRefreshToken: No response returned from token endpoint"),Promise.reject("No response returned from token endpoint"))}))},A.prototype._validateIdTokenFromTokenRefreshToken=function(T,I){var Q=this;return this._metadataService.getIssuer().then((function(ne){return Q.settings.getEpochTime().then((function(O){return Q._joseUtil.validateJwtAttributes(I,ne,Q._settings.client_id,Q._settings.clockSkew,O).then((function(ie){return ie?ie.sub!==T.sub?(h.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: sub in id_token does not match current sub"),Promise.reject(new Error("sub in id_token does not match current sub"))):ie.auth_time&&ie.auth_time!==T.auth_time?(h.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: auth_time in id_token does not match original auth_time"),Promise.reject(new Error("auth_time in id_token does not match original auth_time"))):ie.azp&&ie.azp!==T.azp?(h.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp in id_token does not match original azp"),Promise.reject(new Error("azp in id_token does not match original azp"))):!ie.azp&&T.azp?(h.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp not in id_token, but present in original id_token"),Promise.reject(new Error("azp not in id_token, but present in original id_token"))):void 0:(h.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: Failed to validate id_token"),Promise.reject(new Error("Failed to validate id_token")))}))}))}))},A.prototype._signinSilentIframe=function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=T.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return I?(T.redirect_uri=I,T.prompt=T.prompt||"none",this._signin(T,this._iframeNavigator,{startUrl:I,silentRequestTimeout:T.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(Q){return Q&&(Q.profile&&Q.profile.sub?h.Log.info("UserManager.signinSilent: successful, signed in sub: ",Q.profile.sub):h.Log.info("UserManager.signinSilent: no sub")),Q}))):(h.Log.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},A.prototype.signinSilentCallback=function(T){return this._signinCallback(T,this._iframeNavigator).then((function(I){return I&&(I.profile&&I.profile.sub?h.Log.info("UserManager.signinSilentCallback: successful, signed in sub: ",I.profile.sub):h.Log.info("UserManager.signinSilentCallback: no sub")),I}))},A.prototype.signinCallback=function(T){var I=this;return this.readSigninResponseState(T).then((function(Q){var ne=Q.state;return Q.response,ne.request_type==="si:r"?I.signinRedirectCallback(T):ne.request_type==="si:p"?I.signinPopupCallback(T):ne.request_type==="si:s"?I.signinSilentCallback(T):Promise.reject(new Error("invalid response_type in state"))}))},A.prototype.signoutCallback=function(T,I){var Q=this;return this.readSignoutResponseState(T).then((function(ne){var O=ne.state,ie=ne.response;return O?O.request_type==="so:r"?Q.signoutRedirectCallback(T):O.request_type==="so:p"?Q.signoutPopupCallback(T,I):Promise.reject(new Error("invalid response_type in state")):ie}))},A.prototype.querySessionStatus=function(){var T=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(I=Object.assign({},I)).request_type="si:s";var Q=I.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return Q?(I.redirect_uri=Q,I.prompt="none",I.response_type=I.response_type||this.settings.query_status_response_type,I.scope=I.scope||"openid",I.skipUserInfo=!0,this._signinStart(I,this._iframeNavigator,{startUrl:Q,silentRequestTimeout:I.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(ne){return T.processSigninResponse(ne.url).then((function(O){if(h.Log.debug("UserManager.querySessionStatus: got signin response"),O.session_state&&O.profile.sub)return h.Log.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",O.profile.sub),{session_state:O.session_state,sub:O.profile.sub,sid:O.profile.sid};h.Log.info("querySessionStatus successful, user not authenticated")})).catch((function(O){if(O.session_state&&T.settings.monitorAnonymousSession&&(O.message=="login_required"||O.message=="consent_required"||O.message=="interaction_required"||O.message=="account_selection_required"))return h.Log.info("UserManager.querySessionStatus: querySessionStatus success for anonymous user"),{session_state:O.session_state};throw O}))}))):(h.Log.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},A.prototype._signin=function(T,I){var Q=this,ne=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._signinStart(T,I,ne).then((function(O){return Q._signinEnd(O.url,T)}))},A.prototype._signinStart=function(T,I){var Q=this,ne=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return I.prepare(ne).then((function(O){return h.Log.debug("UserManager._signinStart: got navigator window handle"),Q.createSigninRequest(T).then((function(ie){return h.Log.debug("UserManager._signinStart: got signin request"),ne.url=ie.url,ne.id=ie.state.id,O.navigate(ne)})).catch((function(ie){throw O.close&&(h.Log.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),O.close()),ie}))}))},A.prototype._signinEnd=function(T){var I=this,Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.processSigninResponse(T).then((function(ne){h.Log.debug("UserManager._signinEnd: got signin response");var O=new f.User(ne);if(Q.current_sub){if(Q.current_sub!==O.profile.sub)return h.Log.debug("UserManager._signinEnd: current user does not match user returned from signin. sub from signin: ",O.profile.sub),Promise.reject(new Error("login_required"));h.Log.debug("UserManager._signinEnd: current user matches user returned from signin")}return I.storeUser(O).then((function(){return h.Log.debug("UserManager._signinEnd: user stored"),I._events.load(O),O}))}))},A.prototype._signinCallback=function(T,I){h.Log.debug("UserManager._signinCallback");var Q=this._settings.response_mode==="query"||!this._settings.response_mode&&P.SigninRequest.isCode(this._settings.response_type)?"?":"#";return I.callback(T,void 0,Q)},A.prototype.signoutRedirect=function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(T=Object.assign({},T)).request_type="so:r";var I=T.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;I&&(T.post_logout_redirect_uri=I);var Q={useReplaceToNavigate:T.useReplaceToNavigate};return this._signoutStart(T,this._redirectNavigator,Q).then((function(){h.Log.info("UserManager.signoutRedirect: successful")}))},A.prototype.signoutRedirectCallback=function(T){return this._signoutEnd(T||this._redirectNavigator.url).then((function(I){return h.Log.info("UserManager.signoutRedirectCallback: successful"),I}))},A.prototype.signoutPopup=function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(T=Object.assign({},T)).request_type="so:p";var I=T.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return T.post_logout_redirect_uri=I,T.display="popup",T.post_logout_redirect_uri&&(T.state=T.state||{}),this._signout(T,this._popupNavigator,{startUrl:I,popupWindowFeatures:T.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:T.popupWindowTarget||this.settings.popupWindowTarget}).then((function(){h.Log.info("UserManager.signoutPopup: successful")}))},A.prototype.signoutPopupCallback=function(T,I){return I===void 0&&typeof T=="boolean"&&(I=T,T=null),this._popupNavigator.callback(T,I,"?").then((function(){h.Log.info("UserManager.signoutPopupCallback: successful")}))},A.prototype._signout=function(T,I){var Q=this,ne=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._signoutStart(T,I,ne).then((function(O){return Q._signoutEnd(O.url)}))},A.prototype._signoutStart=function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=this,Q=arguments[1],ne=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Q.prepare(ne).then((function(O){return h.Log.debug("UserManager._signoutStart: got navigator window handle"),I._loadUser().then((function(ie){return h.Log.debug("UserManager._signoutStart: loaded current user from storage"),(I._settings.revokeAccessTokenOnSignout?I._revokeInternal(ie):Promise.resolve()).then((function(){var ye=T.id_token_hint||ie&&ie.id_token;return ye&&(h.Log.debug("UserManager._signoutStart: Setting id_token into signout request"),T.id_token_hint=ye),I.removeUser().then((function(){return h.Log.debug("UserManager._signoutStart: user removed, creating signout request"),I.createSignoutRequest(T).then((function(be){return h.Log.debug("UserManager._signoutStart: got signout request"),ne.url=be.url,be.state&&(ne.id=be.state.id),O.navigate(ne)}))}))}))})).catch((function(ie){throw O.close&&(h.Log.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),O.close()),ie}))}))},A.prototype._signoutEnd=function(T){return this.processSignoutResponse(T).then((function(I){return h.Log.debug("UserManager._signoutEnd: got signout response"),I}))},A.prototype.revokeAccessToken=function(){var T=this;return this._loadUser().then((function(I){return T._revokeInternal(I,!0).then((function(Q){if(Q)return h.Log.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),I.access_token=null,I.refresh_token=null,I.expires_at=null,I.token_type=null,T.storeUser(I).then((function(){h.Log.debug("UserManager.revokeAccessToken: user stored"),T._events.load(I)}))}))})).then((function(){h.Log.info("UserManager.revokeAccessToken: access token revoked successfully")}))},A.prototype._revokeInternal=function(T,I){var Q=this;if(T){var ne=T.access_token,O=T.refresh_token;return this._revokeAccessTokenInternal(ne,I).then((function(ie){return Q._revokeRefreshTokenInternal(O,I).then((function(ye){return ie||ye||h.Log.debug("UserManager.revokeAccessToken: no need to revoke due to no token(s), or JWT format"),ie||ye}))}))}return Promise.resolve(!1)},A.prototype._revokeAccessTokenInternal=function(T,I){return!T||T.indexOf(".")>=0?Promise.resolve(!1):this._tokenRevocationClient.revoke(T,I).then((function(){return!0}))},A.prototype._revokeRefreshTokenInternal=function(T,I){return T?this._tokenRevocationClient.revoke(T,I,"refresh_token").then((function(){return!0})):Promise.resolve(!1)},A.prototype.startSilentRenew=function(){this._silentRenewService.start()},A.prototype.stopSilentRenew=function(){this._silentRenewService.stop()},A.prototype._loadUser=function(){return this._userStore.get(this._userStoreKey).then((function(T){return T?(h.Log.debug("UserManager._loadUser: user storageString loaded"),f.User.fromStorageString(T)):(h.Log.debug("UserManager._loadUser: no user storageString"),null)}))},A.prototype.storeUser=function(T){if(T){h.Log.debug("UserManager.storeUser: storing user");var I=T.toStorageString();return this._userStore.set(this._userStoreKey,I)}return h.Log.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)},l(A,[{key:"_redirectNavigator",get:function(){return this.settings.redirectNavigator}},{key:"_popupNavigator",get:function(){return this.settings.popupNavigator}},{key:"_iframeNavigator",get:function(){return this.settings.iframeNavigator}},{key:"_userStore",get:function(){return this.settings.userStore}},{key:"events",get:function(){return this._events}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),A})(_.OidcClient)},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.UserManagerSettings=void 0;var l=(function(){function q(H,R){for(var L=0;L<R.length;L++){var V=R[L];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(H,V.key,V)}}return function(H,R,L){return R&&q(H.prototype,R),L&&q(H,L),H}})(),h=(u(0),u(5)),_=u(40),y=u(41),f=u(43),p=u(6),d=u(1),S=u(8);function P(q,H){if(!(q instanceof H))throw new TypeError("Cannot call a class as a function")}function x(q,H){if(!q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!H||typeof H!="object"&&typeof H!="function"?q:H}o.UserManagerSettings=(function(q){function H(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},L=R.popup_redirect_uri,V=R.popup_post_logout_redirect_uri,A=R.popupWindowFeatures,M=R.popupWindowTarget,T=R.silent_redirect_uri,I=R.silentRequestTimeout,Q=R.automaticSilentRenew,ne=Q!==void 0&&Q,O=R.validateSubOnSilentRenew,ie=O!==void 0&&O,ye=R.includeIdTokenInSilentRenew,be=ye===void 0||ye,We=R.monitorSession,Ue=We===void 0||We,Qe=R.monitorAnonymousSession,Be=Qe!==void 0&&Qe,Ze=R.checkSessionInterval,ge=Ze===void 0?2e3:Ze,we=R.stopCheckSessionOnError,ze=we===void 0||we,et=R.query_status_response_type,ot=R.revokeAccessTokenOnSignout,st=ot!==void 0&&ot,ft=R.accessTokenExpiringNotificationTime,Pt=ft===void 0?60:ft,tt=R.redirectNavigator,at=tt===void 0?new _.RedirectNavigator:tt,Je=R.popupNavigator,Ce=Je===void 0?new y.PopupNavigator:Je,W=R.iframeNavigator,m=W===void 0?new f.IFrameNavigator:W,v=R.userStore,j=v===void 0?new p.WebStorageStateStore({store:d.Global.sessionStorage}):v;P(this,H);var J=x(this,q.call(this,arguments[0]));return J._popup_redirect_uri=L,J._popup_post_logout_redirect_uri=V,J._popupWindowFeatures=A,J._popupWindowTarget=M,J._silent_redirect_uri=T,J._silentRequestTimeout=I,J._automaticSilentRenew=ne,J._validateSubOnSilentRenew=ie,J._includeIdTokenInSilentRenew=be,J._accessTokenExpiringNotificationTime=Pt,J._monitorSession=Ue,J._monitorAnonymousSession=Be,J._checkSessionInterval=ge,J._stopCheckSessionOnError=ze,et?J._query_status_response_type=et:arguments[0]&&arguments[0].response_type?J._query_status_response_type=S.SigninRequest.isOidc(arguments[0].response_type)?"id_token":"code":J._query_status_response_type="id_token",J._revokeAccessTokenOnSignout=st,J._redirectNavigator=at,J._popupNavigator=Ce,J._iframeNavigator=m,J._userStore=j,J}return(function(L,V){if(typeof V!="function"&&V!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof V);L.prototype=Object.create(V&&V.prototype,{constructor:{value:L,enumerable:!1,writable:!0,configurable:!0}}),V&&(Object.setPrototypeOf?Object.setPrototypeOf(L,V):L.__proto__=V)})(H,q),l(H,[{key:"popup_redirect_uri",get:function(){return this._popup_redirect_uri}},{key:"popup_post_logout_redirect_uri",get:function(){return this._popup_post_logout_redirect_uri}},{key:"popupWindowFeatures",get:function(){return this._popupWindowFeatures}},{key:"popupWindowTarget",get:function(){return this._popupWindowTarget}},{key:"silent_redirect_uri",get:function(){return this._silent_redirect_uri}},{key:"silentRequestTimeout",get:function(){return this._silentRequestTimeout}},{key:"automaticSilentRenew",get:function(){return this._automaticSilentRenew}},{key:"validateSubOnSilentRenew",get:function(){return this._validateSubOnSilentRenew}},{key:"includeIdTokenInSilentRenew",get:function(){return this._includeIdTokenInSilentRenew}},{key:"accessTokenExpiringNotificationTime",get:function(){return this._accessTokenExpiringNotificationTime}},{key:"monitorSession",get:function(){return this._monitorSession}},{key:"monitorAnonymousSession",get:function(){return this._monitorAnonymousSession}},{key:"checkSessionInterval",get:function(){return this._checkSessionInterval}},{key:"stopCheckSessionOnError",get:function(){return this._stopCheckSessionOnError}},{key:"query_status_response_type",get:function(){return this._query_status_response_type}},{key:"revokeAccessTokenOnSignout",get:function(){return this._revokeAccessTokenOnSignout}},{key:"redirectNavigator",get:function(){return this._redirectNavigator}},{key:"popupNavigator",get:function(){return this._popupNavigator}},{key:"iframeNavigator",get:function(){return this._iframeNavigator}},{key:"userStore",get:function(){return this._userStore}}]),H})(h.OidcClientSettings)},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.RedirectNavigator=void 0;var l=(function(){function _(y,f){for(var p=0;p<f.length;p++){var d=f[p];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(y,d.key,d)}}return function(y,f,p){return f&&_(y.prototype,f),p&&_(y,p),y}})(),h=u(0);o.RedirectNavigator=(function(){function _(){(function(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")})(this,_)}return _.prototype.prepare=function(){return Promise.resolve(this)},_.prototype.navigate=function(f){return f&&f.url?(f.useReplaceToNavigate?window.location.replace(f.url):window.location=f.url,Promise.resolve()):(h.Log.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))},l(_,[{key:"url",get:function(){return window.location.href}}]),_})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.PopupNavigator=void 0;var l=u(0),h=u(42);o.PopupNavigator=(function(){function _(){(function(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")})(this,_)}return _.prototype.prepare=function(f){var p=new h.PopupWindow(f);return Promise.resolve(p)},_.prototype.callback=function(f,p,d){l.Log.debug("PopupNavigator.callback");try{return h.PopupWindow.notifyOpener(f,p,d),Promise.resolve()}catch(S){return Promise.reject(S)}},_})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.PopupWindow=void 0;var l=(function(){function y(f,p){for(var d=0;d<p.length;d++){var S=p[d];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(f,S.key,S)}}return function(f,p,d){return p&&y(f.prototype,p),d&&y(f,d),f}})(),h=u(0),_=u(3);o.PopupWindow=(function(){function y(f){var p=this;(function(x,q){if(!(x instanceof q))throw new TypeError("Cannot call a class as a function")})(this,y),this._promise=new Promise((function(P,x){p._resolve=P,p._reject=x}));var d=f.popupWindowTarget||"_blank",S=f.popupWindowFeatures||"location=no,toolbar=no,width=500,height=500,left=100,top=100;";this._popup=window.open("",d,S),this._popup&&(h.Log.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),500))}return y.prototype.navigate=function(p){return this._popup?p&&p.url?(h.Log.debug("PopupWindow.navigate: Setting URL in popup"),this._id=p.id,this._id&&(window["popupCallback_"+p.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=p.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise},y.prototype._success=function(p){h.Log.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(p)},y.prototype._error=function(p){h.Log.error("PopupWindow.error: ",p),this._cleanup(),this._reject(new Error(p))},y.prototype.close=function(){this._cleanup(!1)},y.prototype._cleanup=function(p){h.Log.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!p&&this._popup.close(),this._popup=null},y.prototype._checkForPopupClosed=function(){this._popup&&!this._popup.closed||this._error("Popup window closed")},y.prototype._callback=function(p,d){this._cleanup(d),p?(h.Log.debug("PopupWindow.callback success"),this._success({url:p})):(h.Log.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))},y.notifyOpener=function(p,d,S){if(window.opener){if(p=p||window.location.href){var P=_.UrlUtility.parseUrlFragment(p,S);if(P.state){var x="popupCallback_"+P.state,q=window.opener[x];q?(h.Log.debug("PopupWindow.notifyOpener: passing url message to opener"),q(p,d)):h.Log.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else h.Log.warn("PopupWindow.notifyOpener: no state found in response url")}}else h.Log.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")},l(y,[{key:"promise",get:function(){return this._promise}}]),y})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.IFrameNavigator=void 0;var l=u(0),h=u(44);o.IFrameNavigator=(function(){function _(){(function(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")})(this,_)}return _.prototype.prepare=function(f){var p=new h.IFrameWindow(f);return Promise.resolve(p)},_.prototype.callback=function(f){l.Log.debug("IFrameNavigator.callback");try{return h.IFrameWindow.notifyParent(f),Promise.resolve()}catch(p){return Promise.reject(p)}},_})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.IFrameWindow=void 0;var l=(function(){function _(y,f){for(var p=0;p<f.length;p++){var d=f[p];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(y,d.key,d)}}return function(y,f,p){return f&&_(y.prototype,f),p&&_(y,p),y}})(),h=u(0);o.IFrameWindow=(function(){function _(y){var f=this;(function(d,S){if(!(d instanceof S))throw new TypeError("Cannot call a class as a function")})(this,_),this._promise=new Promise((function(p,d){f._resolve=p,f._reject=d})),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.width=0,this._frame.height=0,window.document.body.appendChild(this._frame)}return _.prototype.navigate=function(f){if(f&&f.url){var p=f.silentRequestTimeout||1e4;h.Log.debug("IFrameWindow.navigate: Using timeout of:",p),this._timer=window.setTimeout(this._timeout.bind(this),p),this._frame.src=f.url}else this._error("No url provided");return this.promise},_.prototype._success=function(f){this._cleanup(),h.Log.debug("IFrameWindow: Successful response from frame window"),this._resolve(f)},_.prototype._error=function(f){this._cleanup(),h.Log.error(f),this._reject(new Error(f))},_.prototype.close=function(){this._cleanup()},_.prototype._cleanup=function(){this._frame&&(h.Log.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)},_.prototype._timeout=function(){h.Log.debug("IFrameWindow.timeout"),this._error("Frame window timed out")},_.prototype._message=function(f){if(h.Log.debug("IFrameWindow.message"),this._timer&&f.origin===this._origin&&f.source===this._frame.contentWindow&&typeof f.data=="string"&&(f.data.startsWith("http://")||f.data.startsWith("https://"))){var p=f.data;p?this._success({url:p}):this._error("Invalid response from frame")}},_.notifyParent=function(f){h.Log.debug("IFrameWindow.notifyParent"),(f=f||window.location.href)&&(h.Log.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(f,location.protocol+"//"+location.host))},l(_,[{key:"promise",get:function(){return this._promise}},{key:"_origin",get:function(){return location.protocol+"//"+location.host}}]),_})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.UserManagerEvents=void 0;var l=u(0),h=u(16),_=u(17);o.UserManagerEvents=(function(y){function f(p){(function(P,x){if(!(P instanceof x))throw new TypeError("Cannot call a class as a function")})(this,f);var d=(function(P,x){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!x||typeof x!="object"&&typeof x!="function"?P:x})(this,y.call(this,p));return d._userLoaded=new _.Event("User loaded"),d._userUnloaded=new _.Event("User unloaded"),d._silentRenewError=new _.Event("Silent renew error"),d._userSignedIn=new _.Event("User signed in"),d._userSignedOut=new _.Event("User signed out"),d._userSessionChanged=new _.Event("User session changed"),d}return(function(d,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);d.prototype=Object.create(S&&S.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(d,S):d.__proto__=S)})(f,y),f.prototype.load=function(d){var S=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];l.Log.debug("UserManagerEvents.load"),y.prototype.load.call(this,d),S&&this._userLoaded.raise(d)},f.prototype.unload=function(){l.Log.debug("UserManagerEvents.unload"),y.prototype.unload.call(this),this._userUnloaded.raise()},f.prototype.addUserLoaded=function(d){this._userLoaded.addHandler(d)},f.prototype.removeUserLoaded=function(d){this._userLoaded.removeHandler(d)},f.prototype.addUserUnloaded=function(d){this._userUnloaded.addHandler(d)},f.prototype.removeUserUnloaded=function(d){this._userUnloaded.removeHandler(d)},f.prototype.addSilentRenewError=function(d){this._silentRenewError.addHandler(d)},f.prototype.removeSilentRenewError=function(d){this._silentRenewError.removeHandler(d)},f.prototype._raiseSilentRenewError=function(d){l.Log.debug("UserManagerEvents._raiseSilentRenewError",d.message),this._silentRenewError.raise(d)},f.prototype.addUserSignedIn=function(d){this._userSignedIn.addHandler(d)},f.prototype.removeUserSignedIn=function(d){this._userSignedIn.removeHandler(d)},f.prototype._raiseUserSignedIn=function(){l.Log.debug("UserManagerEvents._raiseUserSignedIn"),this._userSignedIn.raise()},f.prototype.addUserSignedOut=function(d){this._userSignedOut.addHandler(d)},f.prototype.removeUserSignedOut=function(d){this._userSignedOut.removeHandler(d)},f.prototype._raiseUserSignedOut=function(){l.Log.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise()},f.prototype.addUserSessionChanged=function(d){this._userSessionChanged.addHandler(d)},f.prototype.removeUserSessionChanged=function(d){this._userSessionChanged.removeHandler(d)},f.prototype._raiseUserSessionChanged=function(){l.Log.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise()},f})(h.AccessTokenEvents)},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.Timer=void 0;var l=(function(){function d(S,P){for(var x=0;x<P.length;x++){var q=P[x];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(S,q.key,q)}}return function(S,P,x){return P&&d(S.prototype,P),x&&d(S,x),S}})(),h=u(0),_=u(1),y=u(17);function f(d,S){if(!(d instanceof S))throw new TypeError("Cannot call a class as a function")}function p(d,S){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!S||typeof S!="object"&&typeof S!="function"?d:S}o.Timer=(function(d){function S(P){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.Global.timer,q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;f(this,S);var H=p(this,d.call(this,P));return H._timer=x,H._nowFunc=q||function(){return Date.now()/1e3},H}return(function(x,q){if(typeof q!="function"&&q!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof q);x.prototype=Object.create(q&&q.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),q&&(Object.setPrototypeOf?Object.setPrototypeOf(x,q):x.__proto__=q)})(S,d),S.prototype.init=function(x){x<=0&&(x=1),x=parseInt(x);var q=this.now+x;if(this.expiration===q&&this._timerHandle)h.Log.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);else{this.cancel(),h.Log.debug("Timer.init timer "+this._name+" for duration:",x),this._expiration=q;var H=5;x<H&&(H=x),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*H)}},S.prototype.cancel=function(){this._timerHandle&&(h.Log.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)},S.prototype._callback=function(){var x=this._expiration-this.now;h.Log.debug("Timer.callback; "+this._name+" timer expires in:",x),this._expiration<=this.now&&(this.cancel(),d.prototype.raise.call(this))},l(S,[{key:"now",get:function(){return parseInt(this._nowFunc())}},{key:"expiration",get:function(){return this._expiration}}]),S})(y.Event)},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.SilentRenewService=void 0;var l=u(0);o.SilentRenewService=(function(){function h(_){(function(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")})(this,h),this._userManager=_}return h.prototype.start=function(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then((function(y){})).catch((function(y){l.Log.error("SilentRenewService.start: Error from getUser:",y.message)})))},h.prototype.stop=function(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)},h.prototype._tokenExpiring=function(){var y=this;this._userManager.signinSilent().then((function(f){l.Log.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")}),(function(f){l.Log.error("SilentRenewService._tokenExpiring: Error from signinSilent:",f.message),y._userManager.events._raiseSilentRenewError(f)}))},h})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.CordovaPopupNavigator=void 0;var l=u(21);o.CordovaPopupNavigator=(function(){function h(){(function(y,f){if(!(y instanceof f))throw new TypeError("Cannot call a class as a function")})(this,h)}return h.prototype.prepare=function(y){var f=new l.CordovaPopupWindow(y);return Promise.resolve(f)},h})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.CordovaIFrameNavigator=void 0;var l=u(21);o.CordovaIFrameNavigator=(function(){function h(){(function(y,f){if(!(y instanceof f))throw new TypeError("Cannot call a class as a function")})(this,h)}return h.prototype.prepare=function(y){y.popupWindowFeatures="hidden=yes";var f=new l.CordovaPopupWindow(y);return Promise.resolve(f)},h})()},function(a,o,u){Object.defineProperty(o,"__esModule",{value:!0}),o.Version="1.11.6"}])}))})(Kr)),Kr.exports}var Rn=Fu();function Au(i,r){throw i.error==="invalid_redirect_uri"?new Error(`Dynamic client registration failed: the provided redirect uri [${r.redirectUrl?.toString()}] is invalid - ${i.error_description??""}`):i.error==="invalid_client_metadata"?new Error(`Dynamic client registration failed: the provided client metadata ${JSON.stringify(r)} is invalid - ${i.error_description??""}`):new Error(`Dynamic client registration failed: ${i.error} - ${i.error_description??""}`)}function xu(i){return typeof i.client_id=="string"}function ku(i){return Array.isArray(i.redirect_uris)&&i.redirect_uris.every(r=>typeof r=="string")}function Cu(i,r){if(!xu(i))throw new Error(`Dynamic client registration failed: no client_id has been found on ${JSON.stringify(i)}`);if(r.redirectUrl&&ku(i)&&i.redirect_uris[0]!==r.redirectUrl.toString())throw new Error(`Dynamic client registration failed: the returned redirect URIs ${JSON.stringify(i.redirect_uris)} don't match the provided ${JSON.stringify([r.redirectUrl.toString()])}`);return!0}async function Pu(i,r){if(!r.registrationEndpoint)throw new Error("Dynamic Registration could not be completed because the issuer has no registration endpoint.");if(!Array.isArray(r.idTokenSigningAlgValuesSupported))throw new Error("The OIDC issuer discovery profile is missing the 'id_token_signing_alg_values_supported' value, which is mandatory.");const a=iu(r.idTokenSigningAlgValuesSupported,Wr),o={client_name:i.clientName,application_type:"web",redirect_uris:[i.redirectUrl?.toString()],subject_type:"public",token_endpoint_auth_method:"client_secret_basic",id_token_signed_response_alg:a,grant_types:["authorization_code","refresh_token"]},u={"Content-Type":"application/json"},l=await fetch(r.registrationEndpoint.toString(),{method:"POST",headers:u,body:JSON.stringify(o)});if(l.ok){const h=await l.json();return Cu(h,i),{clientId:h.client_id,clientSecret:h.client_secret,expiresAt:h.client_secret_expires_at,idTokenSignedResponseAlg:h.id_token_signed_response_alg,clientType:"dynamic"}}throw l.status===400&&Au(await l.json(),i),new Error(`Dynamic client registration failed: the server returned ${l.status} ${l.statusText} - ${await l.text()}`)}function Tu(i){return i.error!==void 0&&typeof i.error=="string"}function Mi(i){return i.error_description!==void 0&&typeof i.error_description=="string"}function Iu(i){return i.error_uri!==void 0&&typeof i.error_uri=="string"}function Ru(i){return i.access_token!==void 0&&typeof i.access_token=="string"}function Lu(i){return i.id_token!==void 0&&typeof i.id_token=="string"}function Uu(i){return i.refresh_token!==void 0&&typeof i.refresh_token=="string"}function Du(i){return i.token_type!==void 0&&typeof i.token_type=="string"}function Ou(i){return i.expires_in===void 0||typeof i.expires_in=="number"}function Nu(i,r){if(r.grantType&&(!i.grantTypesSupported||!i.grantTypesSupported.includes(r.grantType)))throw new Error(`The issuer [${i.issuer}] does not support the [${r.grantType}] grant`);if(!i.tokenEndpoint)throw new Error(`This issuer [${i.issuer}] does not have a token endpoint`)}function Wo(i,r){if(Tu(i))throw new $o(`Token endpoint returned error [${i.error}]${Mi(i)?`: ${i.error_description}`:""}${Iu(i)?` (see ${i.error_uri})`:""}`,i.error,Mi(i)?i.error_description:void 0);if(!Ru(i))throw new wr(["access_token"]);if(!Lu(i))throw new wr(["id_token"]);if(!Du(i))throw new wr(["token_type"]);if(!Ou(i))throw new wr(["expires_in"]);if(!r&&i.token_type.toLowerCase()!=="bearer")throw new Error(`Invalid token endpoint response: requested a [Bearer] token, but got a 'token_type' value of [${i.token_type}].`);return i}async function Hu(i,r,a,o){Nu(i,a);const u={"content-type":"application/x-www-form-urlencoded"};let l;o&&(l=await pu(),u.DPoP=await ei(i.tokenEndpoint,"POST",l)),r.clientSecret&&(u.Authorization=`Basic ${btoa(`${r.clientId}:${r.clientSecret}`)}`);const h={grant_type:a.grantType,redirect_uri:a.redirectUrl,code:a.code,code_verifier:a.codeVerifier,client_id:r.clientId},_={method:"POST",headers:u,body:new URLSearchParams(h).toString()},f=await(await fetch(i.tokenEndpoint,_)).json(),p=Wo(f,o),{webId:d,clientId:S}=await Oo(p.id_token,i.jwksUri,i.issuer,r.clientId);return{accessToken:p.access_token,idToken:p.id_token,refreshToken:Uu(p)?p.refresh_token:void 0,webId:d,clientId:S,dpopKey:l,expiresIn:p.expires_in}}const Mu=i=>{try{return new URL(i),!0}catch{return!1}};async function Bu(i,r,a,o){if(a.clientId===void 0)throw new Error("No client ID available when trying to refresh the access token.");const u={grant_type:"refresh_token",refresh_token:i};let l={};o!==void 0&&(l={DPoP:await ei(r.tokenEndpoint,"POST",o)});let h={};a.clientSecret!==void 0?h={Authorization:`Basic ${btoa(`${a.clientId}:${a.clientSecret}`)}`}:Mu(a.clientId)&&(u.client_id=a.clientId);const _=await fetch(r.tokenEndpoint,{method:"POST",body:new URLSearchParams(u).toString(),headers:{...l,...h,"Content-Type":"application/x-www-form-urlencoded"}});let y;try{y=await _.json()}catch{throw new Error(`The token endpoint of issuer ${r.issuer} returned a malformed response.`)}const f=Wo(y,o!==void 0),{webId:p}=await Oo(f.id_token,r.jwksUri,r.issuer,a.clientId);return{accessToken:f.access_token,idToken:f.id_token,refreshToken:typeof f.refresh_token=="string"?f.refresh_token:void 0,webId:p,dpopKey:o,expiresIn:f.expires_in}}function ju(i){const r=Ho(i);return r.hash="",i.includes(`${r.origin}/`)?r.href:`${r.origin}${r.href.substring(r.origin.length+1)}`}async function Ku(){await new Rn.OidcClient({response_mode:"query"}).clearStaleState(new Rn.WebStorageStateStore({}));const r=window.localStorage,a=[];for(let o=0;o<=r.length;o+=1){const u=r.key(o);u&&(u.match(/^oidc\..+$/)||u.match(/^solidClientAuthenticationUser:.+$/))&&a.push(u)}a.forEach(o=>r.removeItem(o))}class $u extends hu{constructor(r,a){super(r,a)}}class Vu extends cu{login=async(r,a)=>{r.prompt!=="none"&&await this.sessionInfoManager.clear(r.sessionId);const o=r.redirectUrl??ju(window.location.href);if(!No(o))throw new Error(`${o} is not a valid redirect URL, it is either a malformed IRI, includes a hash fragment, or reserved query parameters ('code' or 'state').`);await this.loginHandler.handle({...r,redirectUrl:o,clientName:r.clientName??r.clientId,eventEmitter:a})};validateCurrentSession=async r=>{const a=await this.sessionInfoManager.get(r);return a===void 0||a.clientAppId===void 0||a.issuer===void 0?null:a};handleIncomingRedirect=async(r,a)=>{try{const o=await this.redirectHandler.handle(r,a,void 0);return this.fetch=o.fetch.bind(window),this.boundLogout=o.getLogoutUrl,await this.cleanUrlAfterRedirect(r),{isLoggedIn:o.isLoggedIn,webId:o.webId,sessionId:o.sessionId,expirationDate:o.expirationDate,clientAppId:o.clientAppId}}catch(o){await this.cleanUrlAfterRedirect(r),a.emit(He.ERROR,"redirect",o);return}};async cleanUrlAfterRedirect(r){const a=Ho(r).href;for(window.history.replaceState(null,"",a);window.location.href!==a;)await new Promise(o=>{setTimeout(()=>o(),1)})}}function Bi(i){return typeof i.oidcIssuer=="string"}function ji(i){return typeof i.redirectUrl=="string"}class qu{storageUtility;oidcHandler;issuerConfigFetcher;clientRegistrar;constructor(r,a,o,u){this.storageUtility=r,this.oidcHandler=a,this.issuerConfigFetcher=o,this.clientRegistrar=u,this.storageUtility=r,this.oidcHandler=a,this.issuerConfigFetcher=o,this.clientRegistrar=u}async canHandle(r){return Bi(r)&&ji(r)}async handle(r){if(!Bi(r))throw new In(`OidcLoginHandler requires an OIDC issuer: missing property 'oidcIssuer' in ${JSON.stringify(r)}`);if(!ji(r))throw new In(`OidcLoginHandler requires a redirect URL: missing property 'redirectUrl' in ${JSON.stringify(r)}`);const a=await this.issuerConfigFetcher.fetchConfig(r.oidcIssuer),o=await uu(r,a,this.storageUtility,this.clientRegistrar),u={issuer:a.issuer,dpop:r.tokenType.toLowerCase()==="dpop",...r,issuerConfiguration:a,client:o,scopes:za(r.customScopes)};return this.oidcHandler.handle(u)}}class Wu extends Ya{async handle(r){const a={authority:r.issuer.toString(),client_id:r.client.clientId,client_secret:r.client.clientSecret,redirect_uri:r.redirectUrl,response_type:"code",scope:r.scopes.join(" "),filterProtocolClaims:!0,loadUserInfo:!1,code_verifier:!0,prompt:r.prompt??"consent"},o=new Rn.OidcClient(a);try{const u=await o.createSigninRequest();return await this.setupRedirectHandler({oidcLoginOptions:r,state:u.state._id,codeVerifier:u.state._code_verifier,targetUrl:u.url.toString()})}catch(u){console.error(u)}}}const Ju=".well-known/openid-configuration",Ki={issuer:{toKey:"issuer",convertToUrl:!0},authorization_endpoint:{toKey:"authorizationEndpoint",convertToUrl:!0},token_endpoint:{toKey:"tokenEndpoint",convertToUrl:!0},userinfo_endpoint:{toKey:"userinfoEndpoint",convertToUrl:!0},jwks_uri:{toKey:"jwksUri",convertToUrl:!0},registration_endpoint:{toKey:"registrationEndpoint",convertToUrl:!0},end_session_endpoint:{toKey:"endSessionEndpoint",convertToUrl:!0},scopes_supported:{toKey:"scopesSupported"},response_types_supported:{toKey:"responseTypesSupported"},response_modes_supported:{toKey:"responseModesSupported"},grant_types_supported:{toKey:"grantTypesSupported"},acr_values_supported:{toKey:"acrValuesSupported"},subject_types_supported:{toKey:"subjectTypesSupported"},id_token_signing_alg_values_supported:{toKey:"idTokenSigningAlgValuesSupported"},id_token_encryption_alg_values_supported:{toKey:"idTokenEncryptionAlgValuesSupported"},id_token_encryption_enc_values_supported:{toKey:"idTokenEncryptionEncValuesSupported"},userinfo_signing_alg_values_supported:{toKey:"userinfoSigningAlgValuesSupported"},userinfo_encryption_alg_values_supported:{toKey:"userinfoEncryptionAlgValuesSupported"},userinfo_encryption_enc_values_supported:{toKey:"userinfoEncryptionEncValuesSupported"},request_object_signing_alg_values_supported:{toKey:"requestObjectSigningAlgValuesSupported"},request_object_encryption_alg_values_supported:{toKey:"requestObjectEncryptionAlgValuesSupported"},request_object_encryption_enc_values_supported:{toKey:"requestObjectEncryptionEncValuesSupported"},token_endpoint_auth_methods_supported:{toKey:"tokenEndpointAuthMethodsSupported"},token_endpoint_auth_signing_alg_values_supported:{toKey:"tokenEndpointAuthSigningAlgValuesSupported"},display_values_supported:{toKey:"displayValuesSupported"},claim_types_supported:{toKey:"claimTypesSupported"},claims_supported:{toKey:"claimsSupported"},service_documentation:{toKey:"serviceDocumentation"},claims_locales_supported:{toKey:"claimsLocalesSupported"},ui_locales_supported:{toKey:"uiLocalesSupported"},claims_parameter_supported:{toKey:"claimsParameterSupported"},request_parameter_supported:{toKey:"requestParameterSupported"},request_uri_parameter_supported:{toKey:"requestUriParameterSupported"},require_request_uri_registration:{toKey:"requireRequestUriRegistration"},op_policy_uri:{toKey:"opPolicyUri",convertToUrl:!0},op_tos_uri:{toKey:"opTosUri",convertToUrl:!0}};function zu(i){const r={};return Object.keys(i).forEach(a=>{Ki[a]&&(r[Ki[a].toKey]=i[a])}),Array.isArray(r.scopesSupported)||(r.scopesSupported=["openid"]),r}class ti{storageUtility;constructor(r){this.storageUtility=r,this.storageUtility=r}static getLocalStorageKey(r){return`issuerConfig:${r}`}async fetchConfig(r){let a;const o=new URL(Ju,r.endsWith("/")?r:`${r}/`).href,u=await fetch(o);try{a=zu(await u.json())}catch(l){throw new In(`[${r.toString()}] has an invalid configuration: ${l.message}`)}return await this.storageUtility.set(ti.getLocalStorageKey(r),JSON.stringify(a)),a}}async function Gu(i,r){await Bo(i,r),await Ku()}class Yu extends eu{async get(r){const[a,o,u,l,h,_,y,f]=await Promise.all([this.storageUtility.getForUser(r,"isLoggedIn",{secure:!0}),this.storageUtility.getForUser(r,"webId",{secure:!0}),this.storageUtility.getForUser(r,"clientId",{secure:!1}),this.storageUtility.getForUser(r,"clientSecret",{secure:!1}),this.storageUtility.getForUser(r,"redirectUrl",{secure:!1}),this.storageUtility.getForUser(r,"refreshToken",{secure:!0}),this.storageUtility.getForUser(r,"issuer",{secure:!1}),this.storageUtility.getForUser(r,"tokenType",{secure:!1})]);if(typeof h=="string"&&!No(h)){await Promise.all([this.storageUtility.deleteAllUserData(r,{secure:!1}),this.storageUtility.deleteAllUserData(r,{secure:!0})]);return}if(f!==void 0&&!nu(f))throw new Error(`Tokens of type [${f}] are not supported.`);if(!(u===void 0&&a===void 0&&o===void 0&&_===void 0))return{sessionId:r,webId:o,isLoggedIn:a==="true",redirectUrl:h,refreshToken:_,issuer:y,clientAppId:u,clientAppSecret:l,tokenType:f??"DPoP"}}async clear(r){return Gu(r,this.storageUtility)}}class Xu{async canHandle(r){try{return new URL(r),!0}catch(a){throw new Error(`[${r}] is not a valid URL, and cannot be used as a redirect URL: ${a}`)}}async handle(r){return Mo()}}class Qu{storageUtility;sessionInfoManager;issuerConfigFetcher;clientRegistrar;tokerRefresher;constructor(r,a,o,u,l){this.storageUtility=r,this.sessionInfoManager=a,this.issuerConfigFetcher=o,this.clientRegistrar=u,this.tokerRefresher=l,this.storageUtility=r,this.sessionInfoManager=a,this.issuerConfigFetcher=o,this.clientRegistrar=u,this.tokerRefresher=l}async canHandle(r){try{const a=new URL(r);return a.searchParams.get("code")!==null&&a.searchParams.get("state")!==null}catch(a){throw new Error(`[${r}] is not a valid URL, and cannot be used as a redirect URL: ${a}`)}}async handle(r,a){if(!await this.canHandle(r))throw new Error(`AuthCodeRedirectHandler cannot handle [${r}]: it is missing one of [code, state].`);const o=new URL(r),u=o.searchParams.get("state"),l=await this.storageUtility.getForUser(u,"sessionId",{errorIfNull:!0}),{issuerConfig:h,codeVerifier:_,redirectUrl:y,dpop:f}=await Ko(l,this.storageUtility,this.issuerConfigFetcher),p=o.searchParams.get("iss");if(typeof p=="string"&&p!==h.issuer)throw new Error(`The value of the iss parameter (${p}) does not match the issuer identifier of the authorization server (${h.issuer}). See [rfc9207](https://www.rfc-editor.org/rfc/rfc9207.html#section-2.3-3.1.1)`);if(_===void 0)throw new Error(`The code verifier for session ${l} is missing from storage.`);if(y===void 0)throw new Error(`The redirect URL for session ${l} is missing from storage.`);const d=await this.clientRegistrar.getClient({sessionId:l},h),S=Date.now(),P=await Hu(h,d,{grantType:"authorization_code",code:o.searchParams.get("code"),codeVerifier:_,redirectUrl:y},f);window.localStorage.removeItem(`oidc.${u}`);let x;P.refreshToken!==void 0&&(x={sessionId:l,refreshToken:P.refreshToken,tokenRefresher:this.tokerRefresher});const q=wu(P.accessToken,{dpopKey:P.dpopKey,refreshOptions:x,eventEmitter:a,expiresIn:P.expiresIn});await lu(this.storageUtility,l,P.webId,P.clientId,"true",void 0,!0);const H=await this.sessionInfoManager.get(l);if(!H)throw new Error(`Could not retrieve session: [${l}].`);return Object.assign(H,{fetch:q,getLogoutUrl:ru({idTokenHint:P.idToken,endSessionEndpoint:h.endSessionEndpoint}),expirationDate:typeof P.expiresIn=="number"?S+P.expiresIn*1e3:void 0})}}class Zu extends Ja{constructor(r){super(r)}}class ec{get storage(){return window.localStorage}async get(r){return this.storage.getItem(r)||void 0}async set(r,a){this.storage.setItem(r,a)}async delete(r){this.storage.removeItem(r)}}class tc{redirect(r,a){a&&a.handleRedirect?a.handleRedirect(r):a&&a.redirectByReplacingState?window.history.replaceState({},"",r):window.location.href=r}}class rc{storageUtility;constructor(r){this.storageUtility=r,this.storageUtility=r}async getClient(r,a){const[o,u,l,h,_]=await Promise.all([this.storageUtility.getForUser(r.sessionId,"clientId",{secure:!1}),this.storageUtility.getForUser(r.sessionId,"clientSecret",{secure:!1}),this.storageUtility.getForUser(r.sessionId,"expiresAt",{secure:!1}),this.storageUtility.getForUser(r.sessionId,"clientName",{secure:!1}),this.storageUtility.getForUser(r.sessionId,"clientType",{secure:!1})]),y=l!==void 0?Number.parseInt(l,10):-1,f=u!==void 0&&y!==0&&Math.floor(Date.now()/1e3)>y;if(o&&au(_)&&!f)return u!==void 0?{clientId:o,clientSecret:u,clientName:h,clientType:"dynamic",expiresAt:y}:{clientId:o,clientName:h,clientType:_};try{const p=await Pu(r,a),d={clientId:p.clientId,clientType:"dynamic"};return p.clientSecret!==void 0&&(d.clientSecret=p.clientSecret,d.expiresAt=String(p.expiresAt)),p.idTokenSignedResponseAlg&&(d.idTokenSignedResponseAlg=p.idTokenSignedResponseAlg),await this.storageUtility.setForUser(r.sessionId,d,{secure:!1}),p}catch(p){throw new Error("Client registration failed.",{cause:p})}}}class nc{async canHandle(r){try{return new URL(r).searchParams.has("error")}catch(a){throw new Error(`[${r}] is not a valid URL, and cannot be used as a redirect URL: ${a}`)}}async handle(r,a){if(a!==void 0){const o=new URL(r),u=o.searchParams.get("error"),l=o.searchParams.get("error_description");a.emit(He.ERROR,u,l)}return Mo()}}class ic{storageUtility;issuerConfigFetcher;clientRegistrar;constructor(r,a,o){this.storageUtility=r,this.issuerConfigFetcher=a,this.clientRegistrar=o,this.storageUtility=r,this.issuerConfigFetcher=a,this.clientRegistrar=o}async refresh(r,a,o,u){const l=await Ko(r,this.storageUtility,this.issuerConfigFetcher),h=await this.clientRegistrar.getClient({sessionId:r},l.issuerConfig);if(a===void 0)throw new Error(`Session [${r}] has no refresh token to allow it to refresh its access token.`);if(l.dpop&&o===void 0)throw new Error(`For session [${r}], the key bound to the DPoP access token must be provided to refresh said access token.`);const _=await Bu(a,l.issuerConfig,h,o);return _.refreshToken!==void 0&&u?.emit(He.NEW_REFRESH_TOKEN,_.refreshToken),_}}function $i(i){const r=new du,a=i.secureStorage||r,o=i.insecureStorage||new ec,u=new $u(a,o),l=new ti(u),h=new rc(u),_=new Yu(u),y=new ic(u,l,h),f=new tc,p=new qu(u,new Wu(u,f),l,h),d=new Zu([new nc,new Qu(u,_,l,h,y),new Xu]);return new Vu(p,d,new Za(_,f),_,l)}const mn=`${Do}currentSession`,Ln=`${Do}currentUrl`;async function oc(i,r,a){const o=await r.validateCurrentSession(i);return o!==null?(window.localStorage.setItem(Ln,window.location.href),await r.login({sessionId:i,prompt:"none",oidcIssuer:o.issuer,redirectUrl:o.redirectUrl,clientId:o.clientAppId,clientSecret:o.clientAppSecret,tokenType:o.tokenType??"DPoP"},a.events),!0):!1}function sc(i){return!!i?.isLoggedIn}class ac{info;events;clientAuthentication;tokenRequestInProgress=!1;constructor(r={},a=void 0){this.events=new Su,r.clientAuthentication?this.clientAuthentication=r.clientAuthentication:r.secureStorage&&r.insecureStorage?this.clientAuthentication=$i({secureStorage:r.secureStorage,insecureStorage:r.insecureStorage}):this.clientAuthentication=$i({}),r.sessionInfo?this.info={sessionId:r.sessionInfo.sessionId,isLoggedIn:!1,webId:r.sessionInfo.webId,clientAppId:r.sessionInfo.clientAppId}:this.info={sessionId:a??Zn(),isLoggedIn:!1},this.events.on(He.LOGIN,()=>window.localStorage.setItem(mn,this.info.sessionId)),this.events.on(He.SESSION_EXPIRED,()=>this.internalLogout(!1)),this.events.on(He.ERROR,()=>this.internalLogout(!1))}login=async r=>(await this.clientAuthentication.login({sessionId:this.info.sessionId,...r,tokenType:r.tokenType??"DPoP"},this.events),new Promise(()=>{}));fetch=(r,a)=>this.clientAuthentication.fetch(r,a);internalLogout=async(r,a)=>{window.localStorage.removeItem(mn),await this.clientAuthentication.logout(this.info.sessionId,a),this.info.isLoggedIn=!1,r&&this.events.emit(He.LOGOUT)};logout=async r=>this.internalLogout(!0,r);handleIncomingRedirect=async(r={})=>{if(this.info.isLoggedIn)return this.info;if(this.tokenRequestInProgress)return;const a=typeof r=="string"?{url:r}:r,o=a.url??window.location.href;this.tokenRequestInProgress=!0;const u=await this.clientAuthentication.handleIncomingRedirect(o,this.events);if(sc(u)){this.setSessionInfo(u);const l=window.localStorage.getItem(Ln);l===null?this.events.emit(He.LOGIN):(window.localStorage.removeItem(Ln),this.events.emit(He.SESSION_RESTORED,l))}else if(a.restorePreviousSession===!0){const l=window.localStorage.getItem(mn);if(l!==null&&await oc(l,this.clientAuthentication,this))return new Promise(()=>{})}return this.tokenRequestInProgress=!1,u};setSessionInfo(r){this.info.isLoggedIn=r.isLoggedIn,this.info.webId=r.webId,this.info.sessionId=r.sessionId,this.info.clientAppId=r.clientAppId,this.info.expirationDate=r.expirationDate,this.events.on(He.SESSION_EXTENDED,a=>{this.info.expirationDate=Date.now()+a*1e3})}}let vn;function xr(){return typeof vn>"u"&&(vn=new ac),vn}function uc(...i){return xr().login(...i)}function cc(...i){return xr().logout(...i)}function lc(...i){return xr().handleIncomingRedirect(...i)}const kt=i=>i??Oe;var Un=new Set;function hc(){const i=document.documentElement.clientWidth;return Math.abs(window.innerWidth-i)}function dc(){const i=Number(getComputedStyle(document.body).paddingRight.replace(/px/,""));return isNaN(i)||!i?0:i}function Vi(i){if(Un.add(i),!document.documentElement.classList.contains("wa-scroll-lock")){const r=hc()+dc();let a=getComputedStyle(document.documentElement).scrollbarGutter;(!a||a==="auto")&&(a="stable"),r<2&&(a=""),document.documentElement.style.setProperty("--wa-scroll-lock-gutter",a),document.documentElement.classList.add("wa-scroll-lock"),document.documentElement.style.setProperty("--wa-scroll-lock-size",`${r}px`)}}function qi(i){Un.delete(i),Un.size===0&&(document.documentElement.classList.remove("wa-scroll-lock"),document.documentElement.style.removeProperty("--wa-scroll-lock-size"))}function fc(i){return i.split(" ").map(r=>r.trim()).filter(r=>r!=="")}var pc=class extends Event{constructor(){super("wa-after-hide",{bubbles:!0,cancelable:!1,composed:!0})}},gc=class extends Event{constructor(){super("wa-after-show",{bubbles:!0,cancelable:!1,composed:!0})}},mc=class extends Event{constructor(i){super("wa-hide",{bubbles:!0,cancelable:!0,composed:!0}),this.detail=i}},vc=class extends Event{constructor(){super("wa-show",{bubbles:!0,cancelable:!0,composed:!0})}};var Jo=class{constructor(i,...r){this.slotNames=[],this.handleSlotChange=a=>{const o=a.target;(this.slotNames.includes("[default]")&&!o.name||o.name&&this.slotNames.includes(o.name))&&this.host.requestUpdate()},(this.host=i).addController(this),this.slotNames=r}hasDefaultSlot(){return[...this.host.childNodes].some(i=>{if(i.nodeType===Node.TEXT_NODE&&i.textContent.trim()!=="")return!0;if(i.nodeType===Node.ELEMENT_NODE){const r=i;if(r.tagName.toLowerCase()==="wa-visually-hidden")return!1;if(!r.hasAttribute("slot"))return!0}return!1})}hasNamedSlot(i){return this.host.querySelector(`:scope > [slot="${i}"]`)!==null}test(i){return i==="[default]"?this.hasDefaultSlot():this.hasNamedSlot(i)}hostConnected(){this.host.shadowRoot.addEventListener("slotchange",this.handleSlotChange)}hostDisconnected(){this.host.shadowRoot.removeEventListener("slotchange",this.handleSlotChange)}};function Nr(i,r){return new Promise(a=>{const o=new AbortController,{signal:u}=o;if(i.classList.contains(r))return;i.classList.remove(r),i.classList.add(r);let l=()=>{i.classList.remove(r),a(),o.abort()};i.addEventListener("animationend",l,{once:!0,signal:u}),i.addEventListener("animationcancel",l,{once:!0,signal:u})})}function tn(i,r){const a={waitUntilFirstUpdate:!1,...r};return(o,u)=>{const{update:l}=o,h=Array.isArray(i)?i:[i];o.update=function(_){h.forEach(y=>{const f=y;if(_.has(f)){const p=_.get(f),d=this[f];p!==d&&(!a.waitUntilFirstUpdate||this.hasUpdated)&&this[u](p,d)}}),l.call(this,_)}}}const zo={ATTRIBUTE:1,CHILD:2},Go=i=>(...r)=>({_$litDirective$:i,values:r});let Yo=class{constructor(r){}get _$AU(){return this._$AM._$AU}_$AT(r,a,o){this._$Ct=r,this._$AM=a,this._$Ci=o}_$AS(r,a){return this.update(r,a)}update(r,a){return this.render(...a)}};const Xo=Go(class extends Yo{constructor(i){if(super(i),i.type!==zo.ATTRIBUTE||i.name!=="class"||i.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(i){return" "+Object.keys(i).filter((r=>i[r])).join(" ")+" "}update(i,[r]){if(this.st===void 0){this.st=new Set,i.strings!==void 0&&(this.nt=new Set(i.strings.join(" ").split(/\s/).filter((o=>o!==""))));for(const o in r)r[o]&&!this.nt?.has(o)&&this.st.add(o);return this.render(r)}const a=i.element.classList;for(const o of this.st)o in r||(a.remove(o),this.st.delete(o));for(const o in r){const u=!!r[o];u===this.st.has(o)||this.nt?.has(o)||(u?(a.add(o),this.st.add(o)):(a.remove(o),this.st.delete(o)))}return Mt}});var yc=`:host {
  --width: 31rem;
  --spacing: var(--wa-space-l);
  --show-duration: 200ms;
  --hide-duration: 200ms;

  display: none;
}

:host([open]) {
  display: block;
}

.dialog {
  display: flex;
  flex-direction: column;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  width: var(--width);
  max-width: calc(100% - var(--wa-space-2xl));
  max-height: calc(100% - var(--wa-space-2xl));
  background-color: var(--wa-color-surface-raised);
  border-radius: var(--wa-panel-border-radius);
  border: none;
  box-shadow: var(--wa-shadow-l);
  padding: 0;
  margin: auto;

  &.show {
    animation: show-dialog var(--show-duration) ease;

    &::backdrop {
      animation: show-backdrop var(--show-duration, 200ms) ease;
    }
  }

  &.hide {
    animation: show-dialog var(--hide-duration) ease reverse;

    &::backdrop {
      animation: show-backdrop var(--hide-duration, 200ms) ease reverse;
    }
  }

  &.pulse {
    animation: pulse 250ms ease;
  }
}

.dialog:focus {
  outline: none;
}

/* Ensure there's enough vertical padding for phones that don't update vh when chrome appears (e.g. iPhone) */
@media screen and (max-width: 420px) {
  .dialog {
    max-height: 80vh;
  }
}

.open {
  display: flex;
  opacity: 1;
}

.header {
  flex: 0 0 auto;
  display: flex;
  flex-wrap: nowrap;

  padding-inline-start: var(--spacing);
  padding-block-end: 0;

  /* Subtract the close button's padding so that the X is visually aligned with the edges of the dialog content */
  padding-inline-end: calc(var(--spacing) - var(--wa-form-control-padding-block));
  padding-block-start: calc(var(--spacing) - var(--wa-form-control-padding-block));
}

.title {
  align-self: center;
  flex: 1 1 auto;
  font-family: inherit;
  font-size: var(--wa-font-size-l);
  font-weight: var(--wa-font-weight-heading);
  line-height: var(--wa-line-height-condensed);
  margin: 0;
}

.header-actions {
  align-self: start;
  display: flex;
  flex-shrink: 0;
  flex-wrap: wrap;
  justify-content: end;
  gap: var(--wa-space-2xs);
  padding-inline-start: var(--spacing);
}

.header-actions wa-button,
.header-actions ::slotted(wa-button) {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
}

.body {
  flex: 1 1 auto;
  display: block;
  padding: var(--spacing);
  overflow: auto;
  -webkit-overflow-scrolling: touch;

  &:focus {
    outline: none;
  }

  &:focus-visible {
    outline: var(--wa-focus-ring);
    outline-offset: var(--wa-focus-ring-offset);
  }
}

.footer {
  flex: 0 0 auto;
  display: flex;
  flex-wrap: wrap;
  gap: var(--wa-space-xs);
  justify-content: end;
  padding: var(--spacing);
  padding-block-start: 0;
}

.footer ::slotted(wa-button:not(:first-of-type)) {
  margin-inline-start: var(--wa-spacing-xs);
}

.dialog::backdrop {
  /*
    NOTE: the ::backdrop element doesn't inherit properly in Safari yet, but it will in 17.4! At that time, we can
    remove the fallback values here.
  */
  background-color: var(--wa-color-overlay-modal, rgb(0 0 0 / 0.25));
}

@keyframes pulse {
  0% {
    scale: 1;
  }
  50% {
    scale: 1.02;
  }
  100% {
    scale: 1;
  }
}

@keyframes show-dialog {
  from {
    opacity: 0;
    scale: 0.8;
  }
  to {
    opacity: 1;
    scale: 1;
  }
}

@keyframes show-backdrop {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@media (forced-colors: active) {
  .dialog {
    border: solid 1px white;
  }
}
`,Dt=class extends Gt{constructor(){super(...arguments),this.localize=new Kn(this),this.hasSlotController=new Jo(this,"footer","header-actions","label"),this.open=!1,this.label="",this.withoutHeader=!1,this.lightDismiss=!1,this.handleDocumentKeyDown=i=>{i.key==="Escape"&&this.open&&(i.preventDefault(),i.stopPropagation(),this.requestClose(this.dialog))}}firstUpdated(){this.open&&(this.addOpenListeners(),this.dialog.showModal(),Vi(this))}disconnectedCallback(){super.disconnectedCallback(),qi(this),this.removeOpenListeners()}async requestClose(i){const r=new mc({source:i});if(this.dispatchEvent(r),r.defaultPrevented){this.open=!0,Nr(this.dialog,"pulse");return}this.removeOpenListeners(),await Nr(this.dialog,"hide"),this.open=!1,this.dialog.close(),qi(this);const a=this.originalTrigger;typeof a?.focus=="function"&&setTimeout(()=>a.focus()),this.dispatchEvent(new pc)}addOpenListeners(){document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){document.removeEventListener("keydown",this.handleDocumentKeyDown)}handleDialogCancel(i){i.preventDefault(),!this.dialog.classList.contains("hide")&&i.target===this.dialog&&this.requestClose(this.dialog)}handleDialogClick(i){const a=i.target.closest('[data-dialog="close"]');a&&(i.stopPropagation(),this.requestClose(a))}async handleDialogPointerDown(i){i.target===this.dialog&&(this.lightDismiss?this.requestClose(this.dialog):await Nr(this.dialog,"pulse"))}handleOpenChange(){this.open&&!this.dialog.open?this.show():!this.open&&this.dialog.open&&(this.open=!0,this.requestClose(this.dialog))}async show(){const i=new vc;if(this.dispatchEvent(i),i.defaultPrevented){this.open=!1;return}this.addOpenListeners(),this.originalTrigger=document.activeElement,this.open=!0,this.dialog.showModal(),Vi(this),requestAnimationFrame(()=>{const r=this.querySelector("[autofocus]");r&&typeof r.focus=="function"?r.focus():this.dialog.focus()}),await Nr(this.dialog,"show"),this.dispatchEvent(new gc)}render(){const i=!this.withoutHeader,r=this.hasSlotController.test("footer");return Me`
      <dialog
        part="dialog"
        class=${Xo({dialog:!0,open:this.open})}
        @cancel=${this.handleDialogCancel}
        @click=${this.handleDialogClick}
        @pointerdown=${this.handleDialogPointerDown}
      >
        ${i?Me`
              <header part="header" class="header">
                <h2 part="title" class="title" id="title">
                  <!-- If there's no label, use an invisible character to prevent the header from collapsing -->
                  <slot name="label"> ${this.label.length>0?this.label:""} </slot>
                </h2>
                <div part="header-actions" class="header-actions">
                  <slot name="header-actions"></slot>
                  <wa-button
                    part="close-button"
                    exportparts="base:close-button__base"
                    class="close"
                    appearance="plain"
                    @click="${a=>this.requestClose(a.target)}"
                  >
                    <wa-icon
                      name="xmark"
                      label=${this.localize.term("close")}
                      library="system"
                      variant="solid"
                    ></wa-icon>
                  </wa-button>
                </div>
              </header>
            `:""}

        <div part="body" class="body"><slot></slot></div>

        ${r?Me`
              <footer part="footer" class="footer">
                <slot name="footer"></slot>
              </footer>
            `:""}
      </dialog>
    `}};Dt.css=yc;he([Zr(".dialog")],Dt.prototype,"dialog",2);he([pe({type:Boolean,reflect:!0})],Dt.prototype,"open",2);he([pe({reflect:!0})],Dt.prototype,"label",2);he([pe({attribute:"without-header",type:Boolean,reflect:!0})],Dt.prototype,"withoutHeader",2);he([pe({attribute:"light-dismiss",type:Boolean})],Dt.prototype,"lightDismiss",2);he([tn("open",{waitUntilFirstUpdate:!0})],Dt.prototype,"handleOpenChange",1);Dt=he([Et("wa-dialog")],Dt);document.addEventListener("click",i=>{const r=i.target.closest("[data-dialog]");if(r instanceof Element){const[a,o]=fc(r.getAttribute("data-dialog")||"");if(a==="open"&&o?.length){const l=r.getRootNode().getElementById(o);l?.localName==="wa-dialog"?l.open=!0:console.warn(`A dialog with an ID of "${o}" could not be found in this document.`)}}});document.addEventListener("pointerdown",()=>{});var wc=()=>({checkValidity(i){const r=i.input,a={message:"",isValid:!0,invalidKeys:[]};if(!r)return a;let o=!0;if("checkValidity"in r&&(o=r.checkValidity()),o)return a;if(a.isValid=!1,"validationMessage"in r&&(a.message=r.validationMessage),!("validity"in r))return a.invalidKeys.push("customError"),a;for(const u in r.validity){if(u==="valid")continue;const l=u;r.validity[l]&&a.invalidKeys.push(l)}return a}});var Qo=class extends Event{constructor(){super("wa-invalid",{bubbles:!0,cancelable:!1,composed:!0})}},bc=()=>({observedAttributes:["custom-error"],checkValidity(i){const r={message:"",isValid:!0,invalidKeys:[]};return i.customError&&(r.message=i.customError,r.isValid=!1,r.invalidKeys=["customError"]),r}}),Ot=class extends Gt{constructor(){super(),this.name=null,this.disabled=!1,this.required=!1,this.assumeInteractionOn=["input"],this.validators=[],this.valueHasChanged=!1,this.hasInteracted=!1,this.customError=null,this.emittedEvents=[],this.emitInvalid=i=>{i.target===this&&(this.hasInteracted=!0,this.dispatchEvent(new Qo))},this.handleInteraction=i=>{const r=this.emittedEvents;r.includes(i.type)||r.push(i.type),r.length===this.assumeInteractionOn?.length&&(this.hasInteracted=!0)},this.addEventListener("invalid",this.emitInvalid)}static get validators(){return[bc()]}static get observedAttributes(){const i=new Set(super.observedAttributes||[]);for(const r of this.validators)if(r.observedAttributes)for(const a of r.observedAttributes)i.add(a);return[...i]}connectedCallback(){super.connectedCallback(),this.updateValidity(),this.assumeInteractionOn.forEach(i=>{this.addEventListener(i,this.handleInteraction)})}firstUpdated(...i){super.firstUpdated(...i),this.updateValidity()}willUpdate(i){if(i.has("customError")&&(this.customError||(this.customError=null),this.setCustomValidity(this.customError||"")),i.has("value")||i.has("disabled")){const r=this.value;if(Array.isArray(r)){if(this.name){const a=new FormData;for(const o of r)a.append(this.name,o);this.setValue(a,a)}}else this.setValue(r,r)}i.has("disabled")&&(this.customStates.set("disabled",this.disabled),(this.hasAttribute("disabled")||!this.matches(":disabled"))&&this.toggleAttribute("disabled",this.disabled)),this.updateValidity(),super.willUpdate(i)}get labels(){return this.internals.labels}getForm(){return this.internals.form}get validity(){return this.internals.validity}get willValidate(){return this.internals.willValidate}get validationMessage(){return this.internals.validationMessage}checkValidity(){return this.updateValidity(),this.internals.checkValidity()}reportValidity(){return this.updateValidity(),this.hasInteracted=!0,this.internals.reportValidity()}get validationTarget(){return this.input||void 0}setValidity(...i){const r=i[0],a=i[1];let o=i[2];o||(o=this.validationTarget),this.internals.setValidity(r,a,o||void 0),this.requestUpdate("validity"),this.setCustomStates()}setCustomStates(){const i=!!this.required,r=this.internals.validity.valid,a=this.hasInteracted;this.customStates.set("required",i),this.customStates.set("optional",!i),this.customStates.set("invalid",!r),this.customStates.set("valid",r),this.customStates.set("user-invalid",!r&&a),this.customStates.set("user-valid",r&&a)}setCustomValidity(i){if(!i){this.customError=null,this.setValidity({});return}this.customError=i,this.setValidity({customError:!0},i,this.validationTarget)}formResetCallback(){this.resetValidity(),this.hasInteracted=!1,this.valueHasChanged=!1,this.emittedEvents=[],this.updateValidity()}formDisabledCallback(i){this.disabled=i,this.updateValidity()}formStateRestoreCallback(i,r){this.value=i,r==="restore"&&this.resetValidity(),this.updateValidity()}setValue(...i){const[r,a]=i;this.internals.setFormValue(r,a)}get allValidators(){const i=this.constructor.validators||[],r=this.validators||[];return[...i,...r]}resetValidity(){this.setCustomValidity(""),this.setValidity({})}updateValidity(){if(this.disabled||this.hasAttribute("disabled")||!this.willValidate){this.resetValidity();return}const i=this.allValidators;if(!i?.length)return;const r={customError:!!this.customError},a=this.validationTarget||this.input||void 0;let o="";for(const u of i){const{isValid:l,message:h,invalidKeys:_}=u.checkValidity(this);l||(o||(o=h),_?.length>=0&&_.forEach(y=>r[y]=!0))}o||(o=this.validationMessage),this.setValidity(r,o,a)}};Ot.formAssociated=!0;he([pe({reflect:!0})],Ot.prototype,"name",2);he([pe({type:Boolean})],Ot.prototype,"disabled",2);he([pe({state:!0,attribute:!1})],Ot.prototype,"valueHasChanged",2);he([pe({state:!0,attribute:!1})],Ot.prototype,"hasInteracted",2);he([pe({attribute:"custom-error",reflect:!0})],Ot.prototype,"customError",2);he([pe({attribute:!1,state:!0,type:Object})],Ot.prototype,"validity",1);var _c=`@layer wa-utilities {
  :where(:root),
  .wa-neutral,
  :host([variant='neutral']) {
    --wa-color-fill-loud: var(--wa-color-neutral-fill-loud);
    --wa-color-fill-normal: var(--wa-color-neutral-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-neutral-fill-quiet);
    --wa-color-border-loud: var(--wa-color-neutral-border-loud);
    --wa-color-border-normal: var(--wa-color-neutral-border-normal);
    --wa-color-border-quiet: var(--wa-color-neutral-border-quiet);
    --wa-color-on-loud: var(--wa-color-neutral-on-loud);
    --wa-color-on-normal: var(--wa-color-neutral-on-normal);
    --wa-color-on-quiet: var(--wa-color-neutral-on-quiet);
  }

  .wa-brand,
  :host([variant='brand']) {
    --wa-color-fill-loud: var(--wa-color-brand-fill-loud);
    --wa-color-fill-normal: var(--wa-color-brand-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-brand-fill-quiet);
    --wa-color-border-loud: var(--wa-color-brand-border-loud);
    --wa-color-border-normal: var(--wa-color-brand-border-normal);
    --wa-color-border-quiet: var(--wa-color-brand-border-quiet);
    --wa-color-on-loud: var(--wa-color-brand-on-loud);
    --wa-color-on-normal: var(--wa-color-brand-on-normal);
    --wa-color-on-quiet: var(--wa-color-brand-on-quiet);
  }

  .wa-success,
  :host([variant='success']) {
    --wa-color-fill-loud: var(--wa-color-success-fill-loud);
    --wa-color-fill-normal: var(--wa-color-success-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-success-fill-quiet);
    --wa-color-border-loud: var(--wa-color-success-border-loud);
    --wa-color-border-normal: var(--wa-color-success-border-normal);
    --wa-color-border-quiet: var(--wa-color-success-border-quiet);
    --wa-color-on-loud: var(--wa-color-success-on-loud);
    --wa-color-on-normal: var(--wa-color-success-on-normal);
    --wa-color-on-quiet: var(--wa-color-success-on-quiet);
  }

  .wa-warning,
  :host([variant='warning']) {
    --wa-color-fill-loud: var(--wa-color-warning-fill-loud);
    --wa-color-fill-normal: var(--wa-color-warning-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-warning-fill-quiet);
    --wa-color-border-loud: var(--wa-color-warning-border-loud);
    --wa-color-border-normal: var(--wa-color-warning-border-normal);
    --wa-color-border-quiet: var(--wa-color-warning-border-quiet);
    --wa-color-on-loud: var(--wa-color-warning-on-loud);
    --wa-color-on-normal: var(--wa-color-warning-on-normal);
    --wa-color-on-quiet: var(--wa-color-warning-on-quiet);
  }

  .wa-danger,
  :host([variant='danger']) {
    --wa-color-fill-loud: var(--wa-color-danger-fill-loud);
    --wa-color-fill-normal: var(--wa-color-danger-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-danger-fill-quiet);
    --wa-color-border-loud: var(--wa-color-danger-border-loud);
    --wa-color-border-normal: var(--wa-color-danger-border-normal);
    --wa-color-border-quiet: var(--wa-color-danger-border-quiet);
    --wa-color-on-loud: var(--wa-color-danger-on-loud);
    --wa-color-on-normal: var(--wa-color-danger-on-normal);
    --wa-color-on-quiet: var(--wa-color-danger-on-quiet);
  }
}
`;var Sc=`@layer wa-utilities {
  :host([size='small']),
  .wa-size-s {
    font-size: var(--wa-font-size-s);
  }

  :host([size='medium']),
  .wa-size-m {
    font-size: var(--wa-font-size-m);
  }

  :host([size='large']),
  .wa-size-l {
    font-size: var(--wa-font-size-l);
  }
}
`;const Zo=Symbol.for(""),Ec=i=>{if(i?.r===Zo)return i?._$litStatic$},Wi=(i,...r)=>({_$litStatic$:r.reduce(((a,o,u)=>a+(l=>{if(l._$litStatic$!==void 0)return l._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${l}. Use 'unsafeStatic' to pass non-literal values, but
            take care to ensure page security.`)})(o)+i[u+1]),i[0]),r:Zo}),Ji=new Map,Fc=i=>(r,...a)=>{const o=a.length;let u,l;const h=[],_=[];let y,f=0,p=!1;for(;f<o;){for(y=r[f];f<o&&(l=a[f],(u=Ec(l))!==void 0);)y+=u+r[++f],p=!0;f!==o&&_.push(l),h.push(y),f++}if(f===o&&h.push(r[o]),p){const d=h.join("$$lit$$");(r=Ji.get(d))===void 0&&(h.raw=h,Ji.set(d,r=h)),a=_}return i(r,...a)},yn=Fc(Me);var Ac=`@layer wa-component {
  :host {
    display: inline-block;

    /* Workaround because Chrome doesn't like :host(:has()) below
     * https://issues.chromium.org/issues/40062355
     * Firefox doesn't like this nested rule, so both are needed */
    &:has(wa-badge) {
      position: relative;
    }
  }

  /* Apply relative positioning only when needed to position wa-badge
   * This avoids creating a new stacking context for every button */
  :host(:has(wa-badge)) {
    position: relative;
  }
}

.button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  user-select: none;
  -webkit-user-select: none;
  white-space: nowrap;
  vertical-align: middle;
  transition-property: background, border, box-shadow, color;
  transition-duration: var(--wa-transition-fast);
  transition-timing-function: var(--wa-transition-easing);
  cursor: pointer;
  padding: 0 var(--wa-form-control-padding-inline);
  font-family: inherit;
  font-size: inherit;
  font-weight: var(--wa-font-weight-action);
  line-height: calc(var(--wa-form-control-height) - var(--border-width) * 2);
  height: var(--wa-form-control-height);
  width: 100%;

  background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
  border-color: transparent;
  color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
  border-radius: var(--wa-form-control-border-radius);
  border-style: var(--wa-border-style);
  border-width: var(--wa-border-width-s);
}

/* Appearance modifiers */
:host([appearance='plain']) {
  .button {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: transparent;
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='outlined']) {
  .button {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: transparent;
    border-color: var(--wa-color-border-loud, var(--wa-color-neutral-border-loud));
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='filled']) {
  .button {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='filled-outlined']) {
  .button {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
    border-color: var(--wa-color-border-normal, var(--wa-color-neutral-border-normal));
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='accent']) {
  .button {
    color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
    background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
      var(--wa-color-mix-active)
    );
  }
}

/* Focus states */
.button:focus {
  outline: none;
}

.button:focus-visible {
  outline: var(--wa-focus-ring);
  outline-offset: var(--wa-focus-ring-offset);
}

/* Disabled state */
.button.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* When disabled, prevent mouse events from bubbling up from children */
.button.disabled * {
  pointer-events: none;
}

/* Keep it last so Safari doesn't stop parsing this block */
.button::-moz-focus-inner {
  border: 0;
}

/* Icon buttons */
.button.is-icon-button {
  outline-offset: 2px;
  width: var(--wa-form-control-height);
  aspect-ratio: 1;
}

.button.is-icon-button:has(wa-icon) {
  width: auto;
}

/* Pill modifier */
:host([pill]) .button {
  border-radius: var(--wa-border-radius-pill);
}

/*
 * Label
 */

.start,
.end {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  pointer-events: none;
}

.label {
  display: inline-block;
}

.is-icon-button .label {
  display: flex;
}

.label::slotted(wa-icon) {
  align-self: center;
}

/*
 * Caret modifier
 */

wa-icon[part='caret'] {
  display: flex;
  align-self: center;
  align-items: center;

  &::part(svg) {
    width: 0.875em;
    height: 0.875em;
  }

  .button:has(&) .end {
    display: none;
  }
}

/*
 * Loading modifier
 */

.loading {
  position: relative;
  cursor: wait;

  .start,
  .label,
  .end,
  .caret {
    visibility: hidden;
  }

  wa-spinner {
    --indicator-color: currentColor;
    --track-color: color-mix(in oklab, currentColor, transparent 90%);

    position: absolute;
    font-size: 1em;
    height: 1em;
    width: 1em;
    top: calc(50% - 0.5em);
    left: calc(50% - 0.5em);
  }
}

/*
 * Badges
 */

.button ::slotted(wa-badge) {
  border-color: var(--wa-color-surface-default);
  position: absolute;
  inset-block-start: 0;
  inset-inline-end: 0;
  translate: 50% -50%;
  pointer-events: none;
}

:host(:dir(rtl)) ::slotted(wa-badge) {
  translate: -50% -50%;
}

/*
* Button spacing
*/

slot[name='start']::slotted(*) {
  margin-inline-end: 0.75em;
}

slot[name='end']::slotted(*),
.button:not(.visually-hidden-label) [part='caret'] {
  margin-inline-start: 0.75em;
}

/*
 * Button group border radius modifications
 */

/* Remove border radius from all grouped buttons by default */
:host(.wa-button-group__button) .button {
  border-radius: 0;
}

/* Horizontal orientation */
:host(.wa-button-group__horizontal.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-form-control-border-radius);
  border-end-start-radius: var(--wa-form-control-border-radius);
}

:host(.wa-button-group__horizontal.wa-button-group__button-last) .button {
  border-start-end-radius: var(--wa-form-control-border-radius);
  border-end-end-radius: var(--wa-form-control-border-radius);
}

/* Vertical orientation */
:host(.wa-button-group__vertical) {
  flex: 1 1 auto;
}

:host(.wa-button-group__vertical) .button {
  width: 100%;
  justify-content: start;
}

:host(.wa-button-group__vertical.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-form-control-border-radius);
  border-start-end-radius: var(--wa-form-control-border-radius);
}

:host(.wa-button-group__vertical.wa-button-group__button-last) .button {
  border-end-start-radius: var(--wa-form-control-border-radius);
  border-end-end-radius: var(--wa-form-control-border-radius);
}

/* Handle pill modifier for button groups */
:host([pill].wa-button-group__horizontal.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-border-radius-pill);
  border-end-start-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__horizontal.wa-button-group__button-last) .button {
  border-start-end-radius: var(--wa-border-radius-pill);
  border-end-end-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__vertical.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-border-radius-pill);
  border-start-end-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__vertical.wa-button-group__button-last) .button {
  border-end-start-radius: var(--wa-border-radius-pill);
  border-end-end-radius: var(--wa-border-radius-pill);
}
`,Ee=class extends Ot{constructor(){super(...arguments),this.assumeInteractionOn=["click"],this.hasSlotController=new Jo(this,"[default]","start","end"),this.localize=new Kn(this),this.invalid=!1,this.isIconButton=!1,this.title="",this.variant="neutral",this.appearance="accent",this.size="medium",this.withCaret=!1,this.disabled=!1,this.loading=!1,this.pill=!1,this.type="button",this.form=null}static get validators(){return[...super.validators,wc()]}constructLightDOMButton(){const i=document.createElement("button");return i.type=this.type,i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.clipPath="inset(50%)",i.style.overflow="hidden",i.style.whiteSpace="nowrap",this.name&&(i.name=this.name),i.value=this.value||"",["form","formaction","formenctype","formmethod","formnovalidate","formtarget"].forEach(r=>{this.hasAttribute(r)&&i.setAttribute(r,this.getAttribute(r))}),i}handleClick(){if(!this.getForm())return;const r=this.constructLightDOMButton();this.parentElement?.append(r),r.click(),r.remove()}handleInvalid(){this.dispatchEvent(new Qo)}handleLabelSlotChange(){const i=this.labelSlot.assignedNodes({flatten:!0});let r=!1,a=!1,o=!1,u=!1;[...i].forEach(l=>{if(l.nodeType===Node.ELEMENT_NODE){const h=l;h.localName==="wa-icon"?(a=!0,r||(r=h.label!==void 0)):u=!0}else l.nodeType===Node.TEXT_NODE&&(l.textContent?.trim()||"").length>0&&(o=!0)}),this.isIconButton=a&&!o&&!u,this.isIconButton&&!r&&console.warn('Icon buttons must have a label for screen readers. Add <wa-icon label="..."> to remove this warning.',this)}isButton(){return!this.href}isLink(){return!!this.href}handleDisabledChange(){this.updateValidity()}setValue(...i){}click(){this.button.click()}focus(i){this.button.focus(i)}blur(){this.button.blur()}render(){const i=this.isLink(),r=i?Wi`a`:Wi`button`;return yn`
      <${r}
        part="base"
        class=${Xo({button:!0,caret:this.withCaret,disabled:this.disabled,loading:this.loading,rtl:this.localize.dir()==="rtl","has-label":this.hasSlotController.test("[default]"),"has-start":this.hasSlotController.test("start"),"has-end":this.hasSlotController.test("end"),"is-icon-button":this.isIconButton})}
        ?disabled=${kt(i?void 0:this.disabled)}
        type=${kt(i?void 0:this.type)}
        title=${this.title}
        name=${kt(i?void 0:this.name)}
        value=${kt(i?void 0:this.value)}
        href=${kt(i?this.href:void 0)}
        target=${kt(i?this.target:void 0)}
        download=${kt(i?this.download:void 0)}
        rel=${kt(i&&this.rel?this.rel:void 0)}
        role=${kt(i?void 0:"button")}
        aria-disabled=${this.disabled?"true":"false"}
        tabindex=${this.disabled?"-1":"0"}
        @invalid=${this.isButton()?this.handleInvalid:null}
        @click=${this.handleClick}
      >
        <slot name="start" part="start" class="start"></slot>
        <slot part="label" class="label" @slotchange=${this.handleLabelSlotChange}></slot>
        <slot name="end" part="end" class="end"></slot>
        ${this.withCaret?yn`
                <wa-icon part="caret" class="caret" library="system" name="chevron-down" variant="solid"></wa-icon>
              `:""}
        ${this.loading?yn`<wa-spinner part="spinner"></wa-spinner>`:""}
      </${r}>
    `}};Ee.shadowRootOptions={...Ot.shadowRootOptions,delegatesFocus:!0};Ee.css=[Ac,_c,Sc];he([Zr(".button")],Ee.prototype,"button",2);he([Zr("slot:not([name])")],Ee.prototype,"labelSlot",2);he([Qr()],Ee.prototype,"invalid",2);he([Qr()],Ee.prototype,"isIconButton",2);he([pe()],Ee.prototype,"title",2);he([pe({reflect:!0})],Ee.prototype,"variant",2);he([pe({reflect:!0})],Ee.prototype,"appearance",2);he([pe({reflect:!0})],Ee.prototype,"size",2);he([pe({attribute:"with-caret",type:Boolean,reflect:!0})],Ee.prototype,"withCaret",2);he([pe({type:Boolean})],Ee.prototype,"disabled",2);he([pe({type:Boolean,reflect:!0})],Ee.prototype,"loading",2);he([pe({type:Boolean,reflect:!0})],Ee.prototype,"pill",2);he([pe()],Ee.prototype,"type",2);he([pe({reflect:!0})],Ee.prototype,"name",2);he([pe({reflect:!0})],Ee.prototype,"value",2);he([pe({reflect:!0})],Ee.prototype,"href",2);he([pe()],Ee.prototype,"target",2);he([pe()],Ee.prototype,"rel",2);he([pe()],Ee.prototype,"download",2);he([pe({reflect:!0})],Ee.prototype,"form",2);he([pe({attribute:"formaction"})],Ee.prototype,"formAction",2);he([pe({attribute:"formenctype"})],Ee.prototype,"formEnctype",2);he([pe({attribute:"formmethod"})],Ee.prototype,"formMethod",2);he([pe({attribute:"formnovalidate",type:Boolean})],Ee.prototype,"formNoValidate",2);he([pe({attribute:"formtarget"})],Ee.prototype,"formTarget",2);he([tn("disabled",{waitUntilFirstUpdate:!0})],Ee.prototype,"handleDisabledChange",1);Ee=he([Et("wa-button")],Ee);var xc=class extends Event{constructor(){super("wa-load",{bubbles:!0,cancelable:!1,composed:!0})}};var Dn="";function kc(i){Dn=i}function Cc(){if(!Dn){const i=document.querySelector("[data-fa-kit-code]");i&&kc(i.getAttribute("data-fa-kit-code")||"")}return Dn}var Lt="7.0.1";function Pc(i,r,a){const o=Cc(),u=o.length>0;let l="solid";return r==="notdog"?(a==="solid"&&(l="solid"),a==="duo-solid"&&(l="duo-solid"),`https://ka-p.fontawesome.com/releases/v${Lt}/svgs/notdog-${l}/${i}.svg?token=${encodeURIComponent(o)}`):r==="chisel"?`https://ka-p.fontawesome.com/releases/v${Lt}/svgs/chisel-regular/${i}.svg?token=${encodeURIComponent(o)}`:r==="etch"?`https://ka-p.fontawesome.com/releases/v${Lt}/svgs/etch-solid/${i}.svg?token=${encodeURIComponent(o)}`:r==="jelly"?(a==="regular"&&(l="regular"),a==="duo-regular"&&(l="duo-regular"),a==="fill-regular"&&(l="fill-regular"),`https://ka-p.fontawesome.com/releases/v${Lt}/svgs/jelly-${l}/${i}.svg?token=${encodeURIComponent(o)}`):r==="slab"?((a==="solid"||a==="regular")&&(l="regular"),a==="press-regular"&&(l="press-regular"),`https://ka-p.fontawesome.com/releases/v${Lt}/svgs/slab-${l}/${i}.svg?token=${encodeURIComponent(o)}`):r==="thumbprint"?`https://ka-p.fontawesome.com/releases/v${Lt}/svgs/thumbprint-light/${i}.svg?token=${encodeURIComponent(o)}`:r==="whiteboard"?`https://ka-p.fontawesome.com/releases/v${Lt}/svgs/whiteboard-semibold/${i}.svg?token=${encodeURIComponent(o)}`:(r==="classic"&&(a==="thin"&&(l="thin"),a==="light"&&(l="light"),a==="regular"&&(l="regular"),a==="solid"&&(l="solid")),r==="sharp"&&(a==="thin"&&(l="sharp-thin"),a==="light"&&(l="sharp-light"),a==="regular"&&(l="sharp-regular"),a==="solid"&&(l="sharp-solid")),r==="duotone"&&(a==="thin"&&(l="duotone-thin"),a==="light"&&(l="duotone-light"),a==="regular"&&(l="duotone-regular"),a==="solid"&&(l="duotone")),r==="sharp-duotone"&&(a==="thin"&&(l="sharp-duotone-thin"),a==="light"&&(l="sharp-duotone-light"),a==="regular"&&(l="sharp-duotone-regular"),a==="solid"&&(l="sharp-duotone-solid")),r==="brands"&&(l="brands"),u?`https://ka-p.fontawesome.com/releases/v${Lt}/svgs/${l}/${i}.svg?token=${encodeURIComponent(o)}`:`https://ka-f.fontawesome.com/releases/v${Lt}/svgs/${l}/${i}.svg`)}var Tc={name:"default",resolver:(i,r="classic",a="solid")=>Pc(i,r,a),mutator:(i,r)=>{if(r?.family&&!i.hasAttribute("data-duotone-initialized")){const{family:a,variant:o}=r;if(a==="duotone"||a==="sharp-duotone"||a==="notdog"&&o==="duo-solid"||a==="jelly"&&o==="duo-regular"||a==="thumbprint"){const u=[...i.querySelectorAll("path")],l=u.find(_=>!_.hasAttribute("opacity")),h=u.find(_=>_.hasAttribute("opacity"));if(!l||!h)return;if(l.setAttribute("data-duotone-primary",""),h.setAttribute("data-duotone-secondary",""),r.swapOpacity&&l&&h){const _=h.getAttribute("opacity")||"0.4";l.style.setProperty("--path-opacity",_),h.style.setProperty("--path-opacity","1")}i.setAttribute("data-duotone-initialized","")}}}},Ic=Tc;function Rc(i){return`data:image/svg+xml,${encodeURIComponent(i)}`}var wn={solid:{check:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M434.8 70.1c14.3 10.4 17.5 30.4 7.1 44.7l-256 352c-5.5 7.6-14 12.3-23.4 13.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l101.5 101.5 234-321.7c10.4-14.3 30.4-17.5 44.7-7.1z"/></svg>',"chevron-down":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M201.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 338.7 54.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>',"chevron-left":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/></svg>',"chevron-right":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M311.1 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L243.2 256 73.9 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/></svg>',circle:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0z"/></svg>',eyedropper:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M341.6 29.2l-101.6 101.6-9.4-9.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-9.4-9.4 101.6-101.6c39-39 39-102.2 0-141.1s-102.2-39-141.1 0zM55.4 323.3c-15 15-23.4 35.4-23.4 56.6l0 42.4-26.6 39.9c-8.5 12.7-6.8 29.6 4 40.4s27.7 12.5 40.4 4l39.9-26.6 42.4 0c21.2 0 41.6-8.4 56.6-23.4l109.4-109.4-45.3-45.3-109.4 109.4c-3 3-7.1 4.7-11.3 4.7l-36.1 0 0-36.1c0-4.2 1.7-8.3 4.7-11.3l109.4-109.4-45.3-45.3-109.4 109.4z"/></svg>',"grip-vertical":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M128 40c0-22.1-17.9-40-40-40L40 0C17.9 0 0 17.9 0 40L0 88c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zm0 192c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM0 424l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 40c0-22.1-17.9-40-40-40L232 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM192 232l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 424c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48z"/></svg>',indeterminate:'<svg part="indeterminate-icon" class="icon" viewBox="0 0 16 16"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"><g stroke="currentColor" stroke-width="2"><g transform="translate(2.285714 6.857143)"><path d="M10.2857143,1.14285714 L1.14285714,1.14285714"/></g></g></g></svg>',minus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32z"/></svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M48 32C21.5 32 0 53.5 0 80L0 432c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48L48 32zm224 0c-26.5 0-48 21.5-48 48l0 352c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48l-64 0z"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M91.2 36.9c-12.4-6.8-27.4-6.5-39.6 .7S32 57.9 32 72l0 368c0 14.1 7.5 27.2 19.6 34.4s27.2 7.5 39.6 .7l336-184c12.8-7 20.8-20.5 20.8-35.1s-8-28.1-20.8-35.1l-336-184z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M309.5-18.9c-4.1-8-12.4-13.1-21.4-13.1s-17.3 5.1-21.4 13.1L193.1 125.3 33.2 150.7c-8.9 1.4-16.3 7.7-19.1 16.3s-.5 18 5.8 24.4l114.4 114.5-25.2 159.9c-1.4 8.9 2.3 17.9 9.6 23.2s16.9 6.1 25 2L288.1 417.6 432.4 491c8 4.1 17.7 3.3 25-2s11-14.2 9.6-23.2L441.7 305.9 556.1 191.4c6.4-6.4 8.6-15.8 5.8-24.4s-10.1-14.9-19.1-16.3L383 125.3 309.5-18.9z"/></svg>',user:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M224 248a120 120 0 1 0 0-240 120 120 0 1 0 0 240zm-29.7 56C95.8 304 16 383.8 16 482.3 16 498.7 29.3 512 45.7 512l356.6 0c16.4 0 29.7-13.3 29.7-29.7 0-98.5-79.8-178.3-178.3-178.3l-59.4 0z"/></svg>',xmark:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M55.1 73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L147.2 256 9.9 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192.5 301.3 329.9 438.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.8 256 375.1 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192.5 210.7 55.1 73.4z"/></svg>'},regular:{"circle-question":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M464 256a208 208 0 1 0 -416 0 208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0zm256-80c-17.7 0-32 14.3-32 32 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-44.2 35.8-80 80-80s80 35.8 80 80c0 47.2-36 67.2-56 74.5l0 3.8c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-8.1c0-20.5 14.8-35.2 30.1-40.2 6.4-2.1 13.2-5.5 18.2-10.3 4.3-4.2 7.7-10 7.7-19.6 0-17.7-14.3-32-32-32zM224 368a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/></svg>',"circle-xmark":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464a256 256 0 1 0 0-512 256 256 0 1 0 0 512zM167 167c-9.4 9.4-9.4 24.6 0 33.9l55 55-55 55c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l55-55 55 55c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-55-55 55-55c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-55 55-55-55c-9.4-9.4-24.6-9.4-33.9 0z"/></svg>',copy:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M384 336l-192 0c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l133.5 0c4.2 0 8.3 1.7 11.3 4.7l58.5 58.5c3 3 4.7 7.1 4.7 11.3L400 320c0 8.8-7.2 16-16 16zM192 384l192 0c35.3 0 64-28.7 64-64l0-197.5c0-17-6.7-33.3-18.7-45.3L370.7 18.7C358.7 6.7 342.5 0 325.5 0L192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-48 0 0 16c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l16 0 0-48-16 0z"/></svg>',eye:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288 80C222.8 80 169.2 109.6 128.1 147.7 89.6 183.5 63 226 49.4 256 63 286 89.6 328.5 128.1 364.3 169.2 402.4 222.8 432 288 432s118.8-29.6 159.9-67.7C486.4 328.5 513 286 526.6 256 513 226 486.4 183.5 447.9 147.7 406.8 109.6 353.2 80 288 80zM95.4 112.6C142.5 68.8 207.2 32 288 32s145.5 36.8 192.6 80.6c46.8 43.5 78.1 95.4 93 131.1 3.3 7.9 3.3 16.7 0 24.6-14.9 35.7-46.2 87.7-93 131.1-47.1 43.7-111.8 80.6-192.6 80.6S142.5 443.2 95.4 399.4c-46.8-43.5-78.1-95.4-93-131.1-3.3-7.9-3.3-16.7 0-24.6 14.9-35.7 46.2-87.7 93-131.1zM288 336c44.2 0 80-35.8 80-80 0-29.6-16.1-55.5-40-69.3-1.4 59.7-49.6 107.9-109.3 109.3 13.8 23.9 39.7 40 69.3 40zm-79.6-88.4c2.5 .3 5 .4 7.6 .4 35.3 0 64-28.7 64-64 0-2.6-.2-5.1-.4-7.6-37.4 3.9-67.2 33.7-71.1 71.1zm45.6-115c10.8-3 22.2-4.5 33.9-4.5 8.8 0 17.5 .9 25.8 2.6 .3 .1 .5 .1 .8 .2 57.9 12.2 101.4 63.7 101.4 125.2 0 70.7-57.3 128-128 128-61.6 0-113-43.5-125.2-101.4-1.8-8.6-2.8-17.5-2.8-26.6 0-11 1.4-21.8 4-32 .2-.7 .3-1.3 .5-1.9 11.9-43.4 46.1-77.6 89.5-89.5z"/></svg>',"eye-slash":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M41-24.9c-9.4-9.4-24.6-9.4-33.9 0S-2.3-.3 7 9.1l528 528c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-96.4-96.4c2.7-2.4 5.4-4.8 8-7.2 46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7 0-24.6-14.9-35.7-46.2-87.7-93-131.1-47.1-43.7-111.8-80.6-192.6-80.6-56.8 0-105.6 18.2-146 44.2L41-24.9zM176.9 111.1c32.1-18.9 69.2-31.1 111.1-31.1 65.2 0 118.8 29.6 159.9 67.7 38.5 35.7 65.1 78.3 78.6 108.3-13.6 30-40.2 72.5-78.6 108.3-3.1 2.8-6.2 5.6-9.4 8.4L393.8 328c14-20.5 22.2-45.3 22.2-72 0-70.7-57.3-128-128-128-26.7 0-51.5 8.2-72 22.2l-39.1-39.1zm182 182l-108-108c11.1-5.8 23.7-9.1 37.1-9.1 44.2 0 80 35.8 80 80 0 13.4-3.3 26-9.1 37.1zM103.4 173.2l-34-34c-32.6 36.8-55 75.8-66.9 104.5-3.3 7.9-3.3 16.7 0 24.6 14.9 35.7 46.2 87.7 93 131.1 47.1 43.7 111.8 80.6 192.6 80.6 37.3 0 71.2-7.9 101.5-20.6L352.2 422c-20 6.4-41.4 10-64.2 10-65.2 0-118.8-29.6-159.9-67.7-38.5-35.7-65.1-78.3-78.6-108.3 10.4-23.1 28.6-53.6 54-82.8z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288.1-32c9 0 17.3 5.1 21.4 13.1L383 125.3 542.9 150.7c8.9 1.4 16.3 7.7 19.1 16.3s.5 18-5.8 24.4L441.7 305.9 467 465.8c1.4 8.9-2.3 17.9-9.6 23.2s-17 6.1-25 2L288.1 417.6 143.8 491c-8 4.1-17.7 3.3-25-2s-11-14.2-9.6-23.2L134.4 305.9 20 191.4c-6.4-6.4-8.6-15.8-5.8-24.4s10.1-14.9 19.1-16.3l159.9-25.4 73.6-144.2c4.1-8 12.4-13.1 21.4-13.1zm0 76.8L230.3 158c-3.5 6.8-10 11.6-17.6 12.8l-125.5 20 89.8 89.9c5.4 5.4 7.9 13.1 6.7 20.7l-19.8 125.5 113.3-57.6c6.8-3.5 14.9-3.5 21.8 0l113.3 57.6-19.8-125.5c-1.2-7.6 1.3-15.3 6.7-20.7l89.8-89.9-125.5-20c-7.6-1.2-14.1-6-17.6-12.8L288.1 44.8z"/></svg>'}},Lc={name:"system",resolver:(i,r="classic",a="solid")=>{let u=wn[a][i]??wn.regular[i]??wn.regular["circle-question"];return u?Rc(u):""}},Uc=Lc;var Dc="classic",Oc=[Ic,Uc],On=[];function Nc(i){On.push(i)}function Hc(i){On=On.filter(r=>r!==i)}function bn(i){return Oc.find(r=>r.name===i)}function Mc(){return Dc}const Bc=(i,r)=>i?._$litType$!==void 0;var jc=class extends Event{constructor(){super("wa-error",{bubbles:!0,cancelable:!1,composed:!0})}},Kc=`:host {
  --primary-color: currentColor;
  --primary-opacity: 1;
  --secondary-color: currentColor;
  --secondary-opacity: 0.4;

  box-sizing: content-box;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  vertical-align: -0.125em;
}

/* Standard */
:host(:not([auto-width])) {
  width: 1.25em;
  height: 1em;
}

/* Auto-width */
:host([auto-width]) {
  width: auto;
  height: 1em;
}

svg {
  height: 1em;
  fill: currentColor;
  overflow: visible;

  /* Duotone colors with path-specific opacity fallback */
  path[data-duotone-primary] {
    color: var(--primary-color);
    opacity: var(--path-opacity, var(--primary-opacity));
  }

  path[data-duotone-secondary] {
    color: var(--secondary-color);
    opacity: var(--path-opacity, var(--secondary-opacity));
  }
}
`,yr=Symbol(),Hr=Symbol(),_n,Sn=new Map,dt=class extends Gt{constructor(){super(...arguments),this.svg=null,this.autoWidth=!1,this.swapOpacity=!1,this.label="",this.library="default",this.resolveIcon=async(i,r)=>{let a;if(r?.spriteSheet){this.hasUpdated||await this.updateComplete,this.svg=Me`<svg part="svg">
        <use part="use" href="${i}"></use>
      </svg>`,await this.updateComplete;const o=this.shadowRoot.querySelector("[part='svg']");return typeof r.mutator=="function"&&r.mutator(o,this),this.svg}try{if(a=await fetch(i,{mode:"cors"}),!a.ok)return a.status===410?yr:Hr}catch{return Hr}try{const o=document.createElement("div");o.innerHTML=await a.text();const u=o.firstElementChild;if(u?.tagName?.toLowerCase()!=="svg")return yr;_n||(_n=new DOMParser);const h=_n.parseFromString(u.outerHTML,"text/html").body.querySelector("svg");return h?(h.part.add("svg"),document.adoptNode(h)):yr}catch{return yr}}}connectedCallback(){super.connectedCallback(),Nc(this)}firstUpdated(i){super.firstUpdated(i),this.setIcon()}disconnectedCallback(){super.disconnectedCallback(),Hc(this)}getIconSource(){const i=bn(this.library),r=this.family||Mc();return this.name&&i?{url:i.resolver(this.name,r,this.variant,this.autoWidth),fromLibrary:!0}:{url:this.src,fromLibrary:!1}}handleLabelChange(){typeof this.label=="string"&&this.label.length>0?(this.setAttribute("role","img"),this.setAttribute("aria-label",this.label),this.removeAttribute("aria-hidden")):(this.removeAttribute("role"),this.removeAttribute("aria-label"),this.setAttribute("aria-hidden","true"))}async setIcon(){const{url:i,fromLibrary:r}=this.getIconSource(),a=r?bn(this.library):void 0;if(!i){this.svg=null;return}let o=Sn.get(i);o||(o=this.resolveIcon(i,a),Sn.set(i,o));const u=await o;if(u===Hr&&Sn.delete(i),i===this.getIconSource().url){if(Bc(u)){this.svg=u;return}switch(u){case Hr:case yr:this.svg=null,this.dispatchEvent(new jc);break;default:this.svg=u.cloneNode(!0),a?.mutator?.(this.svg,this),this.dispatchEvent(new xc)}}}updated(i){super.updated(i);const r=bn(this.library),a=this.shadowRoot?.querySelector("svg");a&&r?.mutator?.(a,this)}render(){return this.hasUpdated?this.svg:Me`<svg part="svg" fill="currentColor" width="16" height="16"></svg>`}};dt.css=Kc;he([Qr()],dt.prototype,"svg",2);he([pe({reflect:!0})],dt.prototype,"name",2);he([pe({reflect:!0})],dt.prototype,"family",2);he([pe({reflect:!0})],dt.prototype,"variant",2);he([pe({attribute:"auto-width",type:Boolean,reflect:!0})],dt.prototype,"autoWidth",2);he([pe({attribute:"swap-opacity",type:Boolean,reflect:!0})],dt.prototype,"swapOpacity",2);he([pe()],dt.prototype,"src",2);he([pe()],dt.prototype,"label",2);he([pe({reflect:!0})],dt.prototype,"library",2);he([tn("label")],dt.prototype,"handleLabelChange",1);he([tn(["family","name","library","variant","src","autoWidth","swapOpacity"])],dt.prototype,"setIcon",1);dt=he([Et("wa-icon")],dt);let Nn=class extends Yo{constructor(r){if(super(r),this.it=Oe,r.type!==zo.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(r){if(r===Oe||r==null)return this._t=void 0,this.it=r;if(r===Mt)return r;if(typeof r!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(r===this.it)return this._t;this.it=r;const a=[r];return a.raw=a,this._t={_$litType$:this.constructor.resultType,strings:a,values:[]}}};Nn.directiveName="unsafeHTML",Nn.resultType=1;const $c=Go(Nn),Vc=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
  viewBox="0 0 164.98936 240.00001"
  version="1.1"
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  xmlns:cc="http://creativecommons.org/ns#"
  xmlns:dc="http://purl.org/dc/elements/1.1/"
>
  <metadata>
    <rdf:RDF>
      <cc:Work rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g transform="translate(-317.40707,-420.21956)">
    <g transform="matrix(0.89526548,0,0,0.89526548,-11.212902,63.476514)">
      <path
        id="stalk"
        d="m 520.62695,590.04102 c 0.0953,-6.07416 0.70828,-18.58321 0.5918,-31.9629 -0.11369,-13.05772 -0.94675,-26.94319 -1.58984,-36.48437 -0.38151,-5.66028 -1.57307,-6.04267 -4.39649,-6.03516 -2.82342,0.008 -4.66066,1.25838 -4.68945,6.17188 -0.0504,8.60421 0.89605,21.43369 0.74805,34.5625 -0.13089,11.61039 -1.32712,23.33898 -1.48047,34.28125 -0.21838,15.58279 -11.47455,20.36575 -17.24219,20.73024 -10.04624,0.63487 -20.0913,-12.53202 -21.05664,-34.07399 -1.10596,-24.67974 -3.85922,-55.26933 -7.84375,-77.93164 -0.24039,-1.36722 -3.29551,-32.43398 -1.33203,-42.79688 0.64336,-3.39556 3.36845,-9.00219 -3.78906,-9.59961 -6.5191,-0.54414 -4.36743,7.41117 -5.32422,11.5293 -2.20573,9.49367 0.0775,33.05609 1.52539,47.75391 2.09454,21.26158 8.28525,44.39928 5.61328,80.52929 -1.43137,19.3548 -8.95104,24.74208 -22.67144,24.94655 -10.76892,0.16048 -20.97804,-5.92655 -26.67377,-21.48316 -1.93578,-5.28716 -0.94595,-17.18737 -5.03174,-38.58448 -3.47796,-18.21397 -4.47557,-41.26337 -4.09376,-48.46094 0.22371,-4.21726 -0.14667,-6.09224 -4.18164,-5.88867 -4.03497,0.20358 -4.20852,0.62542 -4.21679,5.3418 -0.0185,10.52527 1.78815,31.06074 4.30273,49.74414 2.57288,19.11649 1.14337,36.49684 0.35891,37.74219 -3.78843,6.01421 -18.01528,10.84255 -25.178,19.91468 -9.99006,12.65318 -6.50591,29.8061 5.24506,40.61459 3.5424,2.87674 12.02408,9.74058 22.36724,8.74308 9.87888,-0.95273 21.45587,-9.74176 32.04932,-8.33619 14.08082,1.86828 22.58994,16.03079 36.11801,15.47117 16.07163,-0.66483 30.61051,-10.79421 37.05584,-10.34788 25.76735,4.56347 44.66475,-10.64623 45.41428,-24.2109 1.64417,-29.7555 -25.69561,-22.11809 -30.59863,-41.8798 z m -117.0957,18.24023 c 5.1278,-0.29706 6.56217,7.10509 8.25391,12.65234 4.12408,13.52295 0.46732,14.9713 -8.21289,13.57227 -11.24829,-1.81294 -17.35537,-5.1681 -16.11329,-11.95898 1.26269,-6.90356 5.52562,-8.22448 10.8086,-11.9961 2.10139,-1.50022 3.82789,-2.18635 5.26367,-2.26953 z m 114.68359,3.72461 c 4.92594,-0.22589 14.62313,5.31318 14.64258,11.42773 0.0115,3.60503 -0.12924,6.95497 -11.42969,11.07227 -4.63317,1.68809 -13.92773,1.82748 -13.92773,-4.28711 0,-6.11458 2.92658,-17.85576 10.71484,-18.21289 z m -47.61328,5.0918 c 6.4484,0.38679 11.8835,12.13573 13.6836,17.4082 3.30013,9.66608 -6.2352,14.28516 -13.92774,14.28516 -7.69254,0 -16.78515,-2.26045 -16.78515,-8.57227 -10e-6,-6.31183 7.30745,-20.35741 15,-22.85742 0.68586,-0.2229 1.36222,-0.30369 2.02929,-0.26367 z"
      />
      <g id="caps">
        <path
          d="m 425.52675,498.54606 c 0.84637,5.4724 -7.01336,6.06091 -20.70812,6.06091 -0.48563,0 -3.73186,-1.06843 1.75423,-1.59317 3.51626,-0.33633 14.51824,-1.34096 14.59237,-2.71118 0.14789,-2.73369 -21.23411,-5.12155 -22.65996,-5.16004 -4.0146,-0.10838 -16.48086,-0.0665 -16.39507,3.28729 0.0437,1.70839 5.03248,3.33269 8.15007,4.38687 3.1176,1.05419 1.66148,1.84278 1.42364,1.81032 -7.4534,-1.01731 -11.45875,-4.29192 -12.62417,-7.34369 -5.27669,-13.81756 8.27891,-40.48529 21.46574,-40.15357 13.69304,0.34445 22.22805,23.48532 25.00127,41.41626 z"
        />
        <path
          d="m 496.57469,455.5282 c -0.39638,6.78103 -4.68667,4.34013 -24.19376,4.34013 -5.74251,0 -10.11397,-3.54219 -0.0266,-3.78457 5.03003,-0.12086 17.64961,1.37291 17.7552,-1.33648 0.15186,-3.89666 -30.24629,-9.56808 -32.2773,-9.62291 -5.71847,-0.15438 -35.34495,-2.87262 -35.22275,1.90456 0.0623,2.43347 18.28003,6.76746 22.72079,8.26906 4.44077,1.50161 2.36665,2.62489 2.02786,2.57866 -10.61677,-1.44908 -29.45387,-3.3351 -29.8291,-12.31801 -0.13897,-3.32684 11.33018,-21.33152 22.85821,-36.45096 5.72227,-7.50499 14.69089,-10.71405 21.08023,-10.55333 6.69795,0.16849 15.6453,6.40023 20.48814,14.55822 5.04761,8.50294 14.99949,35.90812 14.6191,42.41563 z"
        />
        <path
          d="m 548.26371,518.84668 c 0.13739,4.19673 -13.76959,4.51867 -22.13522,5.05438 -0.61834,0.0396 -6.72567,-2.07746 0.27388,-2.74696 4.4863,-0.42911 17.09486,-0.10375 17.01087,-2.74484 -0.11102,-3.49117 -20.48488,-4.74873 -28.55409,-4.97641 -5.12194,-0.14453 -30.49176,0.27234 -30.3823,3.47988 0.0744,2.17913 15.88508,3.00209 19.86273,4.34709 3.97766,1.34501 3.90556,3.42258 0.56638,3.02403 -9.53011,-1.13749 -25.47105,-3.59576 -25.57111,-7.76248 -0.15199,-6.32924 12.3886,-35.47992 19.38145,-42.94839 4.50982,-4.81655 11.21654,-7.76839 15.86324,-7.74675 6.08165,0.0283 16.46627,6.33051 21.03239,16.31168 6.88311,15.04589 12.49491,31.91748 12.65178,36.70877 z"
        />
      </g>
    </g>
  </g>
</svg>
`;var qc=Object.getOwnPropertyDescriptor,Wc=(i,r,a,o)=>{for(var u=o>1?void 0:o?qc(r,a):r,l=i.length-1,h;l>=0;l--)(h=i[l])&&(u=h(u)||u);return u};let Hn=class extends vt{render(){return Me`<div class="logo">${$c(Vc)}</div> `}};Hn.styles=Gr`
    :host {
      --size: 150px;
    }

    .logo svg {
      height: var(--size);
      fill: var(--color-text);
    }

    .logo svg #caps {
      fill: var(--color-primary);
    }
  `;Hn=Wc([Et("dtp-logo")],Hn);var Jc=Object.getOwnPropertyDescriptor,es=(i,r,a,o)=>{for(var u=o>1?void 0:o?Jc(r,a):r,l=i.length-1,h;l>=0;l--)(h=i[l])&&(u=h(u)||u);return u};let zi=class extends vt{render(){return Me`
      <form @submit=${this._submit}>
        <input required type="url" name="webidOrIdp" />
        <button type="submit">continue</button>
      </form>
    `}_submit(i){i.preventDefault();const r=i.target,a=new FormData(r),o=Object.fromEntries(a.entries()),u=new CustomEvent("confirm",{detail:{data:o}});this.dispatchEvent(u)}};zi=es([Et("dtp-signin-ui")],zi);let Gi=class extends vt{render(){return Me`<dtp-signin-ui @confirm=${this._confirm}></dtp-signin-ui>`}async _confirm(i){await uc({oidcIssuer:i.detail.data.webidOrIdp})}};Gi=es([Et("dtp-signin")],Gi);const zc=Gr`
  /*
https://github.com/tailwindlabs/tailwindcss/blob/a1f533a0e04ab7f94a31ced50843e638dc99ecac/packages/tailwindcss/preflight.css

MIT License

Copyright (c) Tailwind Labs, Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/

  /*
  1. Prevent padding and border from affecting element width. (https://github.com/mozdevs/cssremedy/issues/4)
  2. Remove default margins and padding
  3. Reset all borders.
*/

  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    box-sizing: border-box; /* 1 */
    margin: 0; /* 2 */
    padding: 0; /* 2 */
    border: 0 solid; /* 3 */
  }

  /*
  1. Use a consistent sensible line-height in all browsers.
  2. Prevent adjustments of font size after orientation changes in iOS.
  3. Use a more readable tab size.
  4. Use the user's configured \`sans\` font-family by default.
  5. Use the user's configured \`sans\` font-feature-settings by default.
  6. Use the user's configured \`sans\` font-variation-settings by default.
  7. Disable tap highlights on iOS.
*/

  html,
  :host {
    line-height: 1.5; /* 1 */
    -webkit-text-size-adjust: 100%; /* 2 */
    tab-size: 4; /* 3 */
    font-family: --theme(
      --default-font-family,
      ui-sans-serif,
      system-ui,
      sans-serif,
      "Apple Color Emoji",
      "Segoe UI Emoji",
      "Segoe UI Symbol",
      "Noto Color Emoji"
    ); /* 4 */
    font-feature-settings: --theme(
      --default-font-feature-settings,
      normal
    ); /* 5 */
    font-variation-settings: --theme(
      --default-font-variation-settings,
      normal
    ); /* 6 */
    -webkit-tap-highlight-color: transparent; /* 7 */
  }

  /*
  1. Add the correct height in Firefox.
  2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)
  3. Reset the default border style to a 1px solid border.
*/

  hr {
    height: 0; /* 1 */
    color: inherit; /* 2 */
    border-top-width: 1px; /* 3 */
  }

  /*
  Add the correct text decoration in Chrome, Edge, and Safari.
*/

  abbr:where([title]) {
    -webkit-text-decoration: underline dotted;
    text-decoration: underline dotted;
  }

  /*
  Remove the default font size and weight for headings.
*/

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-size: inherit;
    font-weight: inherit;
  }

  /*
  Reset links to optimize for opt-in styling instead of opt-out.
*/

  a {
    color: inherit;
    -webkit-text-decoration: inherit;
    text-decoration: inherit;
  }

  /*
  Add the correct font weight in Edge and Safari.
*/

  b,
  strong {
    font-weight: bolder;
  }

  /*
  1. Use the user's configured \`mono\` font-family by default.
  2. Use the user's configured \`mono\` font-feature-settings by default.
  3. Use the user's configured \`mono\` font-variation-settings by default.
  4. Correct the odd \`em\` font sizing in all browsers.
*/

  code,
  kbd,
  samp,
  pre {
    font-family: --theme(
      --default-mono-font-family,
      ui-monospace,
      SFMono-Regular,
      Menlo,
      Monaco,
      Consolas,
      "Liberation Mono",
      "Courier New",
      monospace
    ); /* 1 */
    font-feature-settings: --theme(
      --default-mono-font-feature-settings,
      normal
    ); /* 2 */
    font-variation-settings: --theme(
      --default-mono-font-variation-settings,
      normal
    ); /* 3 */
    font-size: 1em; /* 4 */
  }

  /*
  Add the correct font size in all browsers.
*/

  small {
    font-size: 80%;
  }

  /*
  Prevent \`sub\` and \`sup\` elements from affecting the line height in all browsers.
*/

  sub,
  sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
  }

  sub {
    bottom: -0.25em;
  }

  sup {
    top: -0.5em;
  }

  /*
  1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)
  2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)
  3. Remove gaps between table borders by default.
*/

  table {
    text-indent: 0; /* 1 */
    border-color: inherit; /* 2 */
    border-collapse: collapse; /* 3 */
  }

  /*
  Use the modern Firefox focus style for all focusable elements.
*/

  :-moz-focusring {
    outline: auto;
  }

  /*
  Add the correct vertical alignment in Chrome and Firefox.
*/

  progress {
    vertical-align: baseline;
  }

  /*
  Add the correct display in Chrome and Safari.
*/

  summary {
    display: list-item;
  }

  /*
  Make lists unstyled by default.
*/

  ol,
  ul,
  menu {
    list-style: none;
  }

  /*
  1. Make replaced elements \`display: block\` by default. (https://github.com/mozdevs/cssremedy/issues/14)
  2. Add \`vertical-align: middle\` to align replaced elements more sensibly by default. (https://github.com/jensimmons/cssremedy/issues/14#issuecomment-634934210)
      This can trigger a poorly considered lint error in some tools but is included by design.
*/

  img,
  svg,
  video,
  canvas,
  audio,
  iframe,
  embed,
  object {
    display: block; /* 1 */
    vertical-align: middle; /* 2 */
  }

  /*
  Constrain images and videos to the parent width and preserve their intrinsic aspect ratio. (https://github.com/mozdevs/cssremedy/issues/14)
*/

  img,
  video {
    max-width: 100%;
    height: auto;
  }

  /*
  1. Inherit font styles in all browsers.
  2. Remove border radius in all browsers.
  3. Remove background color in all browsers.
  4. Ensure consistent opacity for disabled states in all browsers.
*/

  button,
  input,
  select,
  optgroup,
  textarea,
  ::file-selector-button {
    font: inherit; /* 1 */
    font-feature-settings: inherit; /* 1 */
    font-variation-settings: inherit; /* 1 */
    letter-spacing: inherit; /* 1 */
    color: inherit; /* 1 */
    border-radius: 0; /* 2 */
    background-color: transparent; /* 3 */
    opacity: 1; /* 4 */
  }

  /*
  Restore default font weight.
*/

  :where(select:is([multiple], [size])) optgroup {
    font-weight: bolder;
  }

  /*
  Restore indentation.
*/

  :where(select:is([multiple], [size])) optgroup option {
    padding-inline-start: 20px;
  }

  /*
  Restore space after button.
*/

  ::file-selector-button {
    margin-inline-end: 4px;
  }

  /*
  Reset the default placeholder opacity in Firefox. (https://github.com/tailwindlabs/tailwindcss/issues/3300)
*/

  ::placeholder {
    opacity: 1;
  }

  /*
  Set the default placeholder color to a semi-transparent version of the current text color in browsers that do not
  crash when using \`color-mix()\` with \`currentcolor\`. (https://github.com/tailwindlabs/tailwindcss/issues/17194)
*/

  @supports (not (-webkit-appearance: -apple-pay-button)) /* Not Safari */ or
    (contain-intrinsic-size: 1px) /* Safari 17+ */ {
    ::placeholder {
      color: color-mix(in oklab, currentcolor 50%, transparent);
    }
  }

  /*
  Prevent resizing textareas horizontally by default.
*/

  textarea {
    resize: vertical;
  }

  /*
  Remove the inner padding in Chrome and Safari on macOS.
*/

  ::-webkit-search-decoration {
    -webkit-appearance: none;
  }

  /*
  1. Ensure date/time inputs have the same height when empty in iOS Safari.
  2. Ensure text alignment can be changed on date/time inputs in iOS Safari.
*/

  ::-webkit-date-and-time-value {
    min-height: 1lh; /* 1 */
    text-align: inherit; /* 2 */
  }

  /*
  Prevent height from changing on date/time inputs in macOS Safari when the input is set to \`display: block\`.
*/

  ::-webkit-datetime-edit {
    display: inline-flex;
  }

  /*
  Remove excess padding from pseudo-elements in date/time inputs to ensure consistent height across browsers.
*/

  ::-webkit-datetime-edit-fields-wrapper {
    padding: 0;
  }

  ::-webkit-datetime-edit,
  ::-webkit-datetime-edit-year-field,
  ::-webkit-datetime-edit-month-field,
  ::-webkit-datetime-edit-day-field,
  ::-webkit-datetime-edit-hour-field,
  ::-webkit-datetime-edit-minute-field,
  ::-webkit-datetime-edit-second-field,
  ::-webkit-datetime-edit-millisecond-field,
  ::-webkit-datetime-edit-meridiem-field {
    padding-block: 0;
  }

  /*
  Center dropdown marker shown on inputs with paired \`<datalist>\`s in Chrome. (https://github.com/tailwindlabs/tailwindcss/issues/18499)
*/

  ::-webkit-calendar-picker-indicator {
    line-height: 1;
  }

  /*
  Remove the additional \`:invalid\` styles in Firefox. (https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737)
*/

  :-moz-ui-invalid {
    box-shadow: none;
  }

  /*
  Correct the inability to style the border radius in iOS Safari.
*/

  button,
  input:where([type="button"], [type="reset"], [type="submit"]),
  ::file-selector-button {
    appearance: button;
  }

  /*
  Correct the cursor style of increment and decrement buttons in Safari.
*/

  ::-webkit-inner-spin-button,
  ::-webkit-outer-spin-button {
    height: auto;
  }

  /*
  Make elements with the HTML hidden attribute stay hidden by default.
*/

  [hidden]:where(:not([hidden="until-found"])) {
    display: none !important;
  }
`;var Gc=Object.defineProperty,Yc=Object.getOwnPropertyDescriptor,ts=(i,r,a,o)=>{for(var u=o>1?void 0:o?Yc(r,a):r,l=i.length-1,h;l>=0;l--)(h=i[l])&&(u=(o?h(r,a,u):h(u))||u);return o&&u&&Gc(r,a,u),u};let Jr=class extends vt{render(){return Me`
      <h1>ditup</h1>
      <p class="subtitle">do it together</p>
      <p class="tagline">turn ideas into collaborative action</p>
      <dtp-logo></dtp-logo>
      <a class="button primary" href="https://docs.ditup.org">learn more</a>
      <button class="button" @click=${this._startSignin}>sign in</button>

      <wa-dialog label="Sign in" id="signin-dialog">
        <dtp-signin></dtp-signin>
      </wa-dialog>
    `}_startSignin(){this._signinDialog&&(this._signinDialog.open=!0)}};Jr.styles=[zc,Gr`
      #signin-dialog,
      ::part(dialog) {
        color: var(--color-text);
      }

      :host {
        /* margin: 0 auto; */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        min-height: 100vh;
      }

      h1 {
        font-size: 2rem;
        color: var(--color-primary);
      }

      .subtitle,
      .tagline {
        font-size: 1.25rem;
      }

      .logo svg {
        height: 150px;
        fill: var(--color-text);
      }

      .logo svg #caps {
        fill: var(--color-primary);
      }

      .button {
        padding: 0.5rem 1rem;
        background-color: var(--color-surface);
        border-radius: var(--border-radius);
        font-size: 1.25rem;
        cursor: pointer;
      }

      .button:hover {
        filter: brightness(0.9);
      }

      .button.primary {
        background-color: var(--color-primary);
      }
    `];ts([Zr("#signin-dialog")],Jr.prototype,"_signinDialog",2);Jr=ts([Et("dtp-landing")],Jr);var En,Yi;function Xc(){return Yi||(Yi=1,En=i=>encodeURIComponent(i).replace(/[!'()*]/g,r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`)),En}var Qc=Xc();const Zc=qo(Qc);var el=Object.defineProperty,tl=Object.getOwnPropertyDescriptor,rs=(i,r,a,o)=>{for(var u=o>1?void 0:o?tl(r,a):r,l=i.length-1,h;l>=0;l--)(h=i[l])&&(u=(o?h(r,a,u):h(u))||u);return o&&u&&el(r,a,u),u};let zr=class extends vt{constructor(){super(...arguments),this.webid=""}render(){return Me`<header class="header">
        <a href="/"><dtp-logo class="logo"></dtp-logo></a>
        <a href="/profile/${Zc(this.webid)}">${this.webid}</a>
        <button @click=${this._signout}>sign out</button>
      </header>
      <main>
        <slot></slot>
      </main>`}_signout(){cc()}};zr.styles=Gr`
    .logo {
      --size: 2rem;
      justify-self: flex-start;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 1rem;
      padding: 1rem;
    }

    .header > :first-child {
      margin-right: auto;
    }
  `;rs([pe()],zr.prototype,"webid",2);zr=rs([Et("dtp-layout")],zr);const Xi=new WeakMap,Qi=i=>{if((a=>a.pattern!==void 0)(i))return i.pattern;let r=Xi.get(i);return r===void 0&&Xi.set(i,r=new URLPattern({pathname:i.path})),r};let rl=class{constructor(r,a,o){this.routes=[],this.o=[],this.t={},this.i=u=>{if(u.routes===this)return;const l=u.routes;this.o.push(l),l.h=this,u.stopImmediatePropagation(),u.onDisconnect=()=>{this.o?.splice(this.o.indexOf(l)>>>0,1)};const h=Zi(this.t);h!==void 0&&l.goto(h)},(this.l=r).addController(this),this.routes=[...a],this.fallback=o?.fallback}link(r){if(r?.startsWith("/"))return r;if(r?.startsWith("."))throw Error("Not implemented");return r??=this.u,(this.h?.link()??"")+r}async goto(r){let a;if(this.routes.length===0&&this.fallback===void 0)a=r,this.u="",this.t={0:a};else{const o=this.p(r);if(o===void 0)throw Error("No route found for "+r);const u=Qi(o).exec({pathname:r}),l=u?.pathname.groups??{};if(a=Zi(l),typeof o.enter=="function"&&await o.enter(l)===!1)return;this.v=o,this.t=l,this.u=a===void 0?r:r.substring(0,r.length-a.length)}if(a!==void 0)for(const o of this.o)o.goto(a);this.l.requestUpdate()}outlet(){return this.v?.render?.(this.t)}get params(){return this.t}p(r){const a=this.routes.find((o=>Qi(o).test({pathname:r})));return a||this.fallback===void 0?a:this.fallback?{...this.fallback,path:"/*"}:void 0}hostConnected(){this.l.addEventListener(kr.eventName,this.i);const r=new kr(this);this.l.dispatchEvent(r),this._=r.onDisconnect}hostDisconnected(){this._?.(),this.h=void 0}};const Zi=i=>{let r;for(const a of Object.keys(i))/\d+/.test(a)&&(r===void 0||a>r)&&(r=a);return r&&i[r]};class kr extends Event{constructor(r){super(kr.eventName,{bubbles:!0,composed:!0,cancelable:!1}),this.routes=r}}kr.eventName="lit-routes-connected";const nl=location.origin||location.protocol+"//"+location.host;class il extends rl{constructor(){super(...arguments),this.m=r=>{const a=r.button!==0||r.metaKey||r.ctrlKey||r.shiftKey;if(r.defaultPrevented||a)return;const o=r.composedPath().find((h=>h.tagName==="A"));if(o===void 0||o.target!==""||o.hasAttribute("download")||o.getAttribute("rel")==="external")return;const u=o.href;if(u===""||u.startsWith("mailto:"))return;const l=window.location;o.origin===nl&&(r.preventDefault(),u!==l.href&&(window.history.pushState({},"",u),this.goto(o.pathname)))},this.R=r=>{this.goto(window.location.pathname)}}hostConnected(){super.hostConnected(),window.addEventListener("click",this.m),window.addEventListener("popstate",this.R),this.goto(window.location.pathname)}hostDisconnected(){super.hostDisconnected(),window.removeEventListener("click",this.m),window.removeEventListener("popstate",this.R)}}var ol=Object.getOwnPropertyDescriptor,sl=(i,r,a,o)=>{for(var u=o>1?void 0:o?ol(r,a):r,l=i.length-1,h;l>=0;l--)(h=i[l])&&(u=h(u)||u);return u};let eo=class extends vt{constructor(){super(...arguments),this._routes=new il(this,[{path:"/",render:()=>Me`<div>home</div>`},{path:"/profile",render:()=>Me`/profile`},{path:"/profile/:webid",render:({webid:i})=>Me`/profile/${i}`},{path:"/*",render:()=>Me`404`}])}render(){return Me`${this._routes.outlet()}`}};eo=sl([Et("dtp-router")],eo);var al=Object.defineProperty,ul=Object.getOwnPropertyDescriptor,ns=(i,r,a,o)=>{for(var u=o>1?void 0:o?ul(r,a):r,l=i.length-1,h;l>=0;l--)(h=i[l])&&(u=(o?h(r,a,u):h(u))||u);return o&&u&&al(r,a,u),u};let Mn=class extends vt{constructor(){super(...arguments),this._updateSessionInfo=()=>{this._info={...xr().info}}}connectedCallback(){super.connectedCallback(),lc({restorePreviousSession:!0}).then(i=>{this._info=i}),this._session=xr(),this._session.events.addListener(He.LOGOUT,this._updateSessionInfo)}disconnectedCallback(){super.disconnectedCallback(),this._session?.events.removeListener(He.LOGOUT,this._updateSessionInfo)}render(){if(!this._info)return Me`<wa-spinner></wa-spinner>`;if(!this._info.isLoggedIn)return Me`<dtp-landing></dtp-landing>`;if(this._info.isLoggedIn)return Me`<dtp-layout webid=${kt(this._info.webId)}
        ><dtp-router></dtp-router
      ></dtp-layout>`;throw new Error("Unexpected session state")}};ns([Qr()],Mn.prototype,"_info",2);Mn=ns([Et("dtp-main")],Mn);
