(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();const ns=new Set,gn=new Map;let zr,Rs="ltr",Is="en";const $l=typeof MutationObserver<"u"&&typeof document<"u"&&typeof document.documentElement<"u";if($l){const t=new MutationObserver(Vl);Rs=document.documentElement.dir||"ltr",Is=document.documentElement.lang||navigator.language,t.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]})}function Hl(...t){t.map(e=>{const r=e.$code.toLowerCase();gn.has(r)?gn.set(r,Object.assign(Object.assign({},gn.get(r)),e)):gn.set(r,e),zr||(zr=e)}),Vl()}function Vl(){$l&&(Rs=document.documentElement.dir||"ltr",Is=document.documentElement.lang||navigator.language),[...ns.keys()].map(t=>{typeof t.requestUpdate=="function"&&t.requestUpdate()})}let Lc=class{constructor(e){this.host=e,this.host.addController(this)}hostConnected(){ns.add(this.host)}hostDisconnected(){ns.delete(this.host)}dir(){return`${this.host.dir||Rs}`.toLowerCase()}lang(){return`${this.host.lang||Is}`.toLowerCase()}getTranslationData(e){var r,n;const s=new Intl.Locale(e.replace(/_/g,"-")),a=s?.language.toLowerCase(),l=(n=(r=s?.region)===null||r===void 0?void 0:r.toLowerCase())!==null&&n!==void 0?n:"",c=gn.get(`${a}-${l}`),g=gn.get(a);return{locale:s,language:a,region:l,primary:c,secondary:g}}exists(e,r){var n;const{primary:s,secondary:a}=this.getTranslationData((n=r.lang)!==null&&n!==void 0?n:this.lang());return r=Object.assign({includeFallback:!1},r),!!(s&&s[e]||a&&a[e]||r.includeFallback&&zr&&zr[e])}term(e,...r){const{primary:n,secondary:s}=this.getTranslationData(this.lang());let a;if(n&&n[e])a=n[e];else if(s&&s[e])a=s[e];else if(zr&&zr[e])a=zr[e];else return console.error(`No translation found for: ${String(e)}`),String(e);return typeof a=="function"?a(...r):a}date(e,r){return e=new Date(e),new Intl.DateTimeFormat(this.lang(),r).format(e)}number(e,r){return e=Number(e),isNaN(e)?"":new Intl.NumberFormat(this.lang(),r).format(e)}relativeTime(e,r,n){return new Intl.RelativeTimeFormat(this.lang(),n).format(e,r)}};var Kl={$code:"en",$name:"English",$dir:"ltr",carousel:"Carousel",clearEntry:"Clear entry",close:"Close",copied:"Copied",copy:"Copy",currentValue:"Current value",error:"Error",goToSlide:(t,e)=>`Go to slide ${t} of ${e}`,hidePassword:"Hide password",loading:"Loading",nextSlide:"Next slide",numOptionsSelected:t=>t===0?"No options selected":t===1?"1 option selected":`${t} options selected`,pauseAnimation:"Pause animation",playAnimation:"Play animation",previousSlide:"Previous slide",progress:"Progress",remove:"Remove",resize:"Resize",scrollableRegion:"Scrollable region",scrollToEnd:"Scroll to end",scrollToStart:"Scroll to start",selectAColorFromTheScreen:"Select a color from the screen",showPassword:"Show password",slideNum:t=>`Slide ${t}`,toggleColorFormat:"Toggle color format",zoomIn:"Zoom in",zoomOut:"Zoom out"};Hl(Kl);var Dc=Kl;var di=class extends Lc{};Hl(Dc);var Oc=Object.defineProperty,Uc=Object.getOwnPropertyDescriptor,ql=t=>{throw TypeError(t)},Se=(t,e,r,n)=>{for(var s=n>1?void 0:n?Uc(e,r):e,a=t.length-1,l;a>=0;a--)(l=t[a])&&(s=(n?l(e,r,s):l(s))||s);return n&&s&&Oc(e,r,s),s},Wl=(t,e,r)=>e.has(t)||ql("Cannot "+r),Bc=(t,e,r)=>(Wl(t,e,"read from private field"),e.get(t)),Mc=(t,e,r)=>e.has(t)?ql("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),jc=(t,e,r,n)=>(Wl(t,e,"write to private field"),e.set(t,r),r);const Ci=globalThis,Ts=Ci.ShadowRoot&&(Ci.ShadyCSS===void 0||Ci.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Cs=Symbol(),ua=new WeakMap;let zl=class{constructor(e,r,n){if(this._$cssResult$=!0,n!==Cs)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=r}get styleSheet(){let e=this.o;const r=this.t;if(Ts&&e===void 0){const n=r!==void 0&&r.length===1;n&&(e=ua.get(r)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&ua.set(r,e))}return e}toString(){return this.cssText}};const Jl=t=>new zl(typeof t=="string"?t:t+"",void 0,Cs),en=(t,...e)=>{const r=t.length===1?t[0]:e.reduce(((n,s,a)=>n+(l=>{if(l._$cssResult$===!0)return l.cssText;if(typeof l=="number")return l;throw Error("Value passed to 'css' function must be a 'css' function result: "+l+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[a+1]),t[0]);return new zl(r,t,Cs)},$c=(t,e)=>{if(Ts)t.adoptedStyleSheets=e.map((r=>r instanceof CSSStyleSheet?r:r.styleSheet));else for(const r of e){const n=document.createElement("style"),s=Ci.litNonce;s!==void 0&&n.setAttribute("nonce",s),n.textContent=r.cssText,t.appendChild(n)}},ca=Ts?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let r="";for(const n of e.cssRules)r+=n.cssText;return Jl(r)})(t):t;const{is:Hc,defineProperty:Vc,getOwnPropertyDescriptor:Kc,getOwnPropertyNames:qc,getOwnPropertySymbols:Wc,getPrototypeOf:zc}=Object,Yi=globalThis,ha=Yi.trustedTypes,Jc=ha?ha.emptyScript:"",Gc=Yi.reactiveElementPolyfillSupport,ri=(t,e)=>t,Mi={toAttribute(t,e){switch(e){case Boolean:t=t?Jc:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let r=t;switch(e){case Boolean:r=t!==null;break;case Number:r=t===null?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch{r=null}}return r}},ks=(t,e)=>!Hc(t,e),da={attribute:!0,type:String,converter:Mi,reflect:!1,useDefault:!1,hasChanged:ks};Symbol.metadata??=Symbol("metadata"),Yi.litPropertyMetadata??=new WeakMap;let fn=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,r=da){if(r.state&&(r.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((r=Object.create(r)).wrapped=!0),this.elementProperties.set(e,r),!r.noAccessor){const n=Symbol(),s=this.getPropertyDescriptor(e,n,r);s!==void 0&&Vc(this.prototype,e,s)}}static getPropertyDescriptor(e,r,n){const{get:s,set:a}=Kc(this.prototype,e)??{get(){return this[r]},set(l){this[r]=l}};return{get:s,set(l){const c=s?.call(this);a?.call(this,l),this.requestUpdate(e,c,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??da}static _$Ei(){if(this.hasOwnProperty(ri("elementProperties")))return;const e=zc(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(ri("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(ri("properties"))){const r=this.properties,n=[...qc(r),...Wc(r)];for(const s of n)this.createProperty(s,r[s])}const e=this[Symbol.metadata];if(e!==null){const r=litPropertyMetadata.get(e);if(r!==void 0)for(const[n,s]of r)this.elementProperties.set(n,s)}this._$Eh=new Map;for(const[r,n]of this.elementProperties){const s=this._$Eu(r,n);s!==void 0&&this._$Eh.set(s,r)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const r=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const s of n)r.unshift(ca(s))}else e!==void 0&&r.push(ca(e));return r}static _$Eu(e,r){const n=r.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,r=this.constructor.elementProperties;for(const n of r.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return $c(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,r,n){this._$AK(e,n)}_$ET(e,r){const n=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,n);if(s!==void 0&&n.reflect===!0){const a=(n.converter?.toAttribute!==void 0?n.converter:Mi).toAttribute(r,n.type);this._$Em=e,a==null?this.removeAttribute(s):this.setAttribute(s,a),this._$Em=null}}_$AK(e,r){const n=this.constructor,s=n._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const a=n.getPropertyOptions(s),l=typeof a.converter=="function"?{fromAttribute:a.converter}:a.converter?.fromAttribute!==void 0?a.converter:Mi;this._$Em=s;const c=l.fromAttribute(r,a.type);this[s]=c??this._$Ej?.get(s)??c,this._$Em=null}}requestUpdate(e,r,n){if(e!==void 0){const s=this.constructor,a=this[e];if(n??=s.getPropertyOptions(e),!((n.hasChanged??ks)(a,r)||n.useDefault&&n.reflect&&a===this._$Ej?.get(e)&&!this.hasAttribute(s._$Eu(e,n))))return;this.C(e,r,n)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,r,{useDefault:n,reflect:s,wrapped:a},l){n&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,l??r??this[e]),a!==!0||l!==void 0)||(this._$AL.has(e)||(this.hasUpdated||n||(r=void 0),this._$AL.set(e,r)),s===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(r){Promise.reject(r)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,a]of this._$Ep)this[s]=a;this._$Ep=void 0}const n=this.constructor.elementProperties;if(n.size>0)for(const[s,a]of n){const{wrapped:l}=a,c=this[s];l!==!0||this._$AL.has(s)||c===void 0||this.C(s,void 0,a,c)}}let e=!1;const r=this._$AL;try{e=this.shouldUpdate(r),e?(this.willUpdate(r),this._$EO?.forEach((n=>n.hostUpdate?.())),this.update(r)):this._$EM()}catch(n){throw e=!1,this._$EM(),n}e&&this._$AE(r)}willUpdate(e){}_$AE(e){this._$EO?.forEach((r=>r.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach((r=>this._$ET(r,this[r]))),this._$EM()}updated(e){}firstUpdated(e){}};fn.elementStyles=[],fn.shadowRootOptions={mode:"open"},fn[ri("elementProperties")]=new Map,fn[ri("finalized")]=new Map,Gc?.({ReactiveElement:fn}),(Yi.reactiveElementVersions??=[]).push("2.1.1");const Ps=globalThis,ji=Ps.trustedTypes,fa=ji?ji.createPolicy("lit-html",{createHTML:t=>t}):void 0,Gl="$lit$",Cr=`lit$${Math.random().toFixed(9).slice(2)}$`,Yl="?"+Cr,Yc=`<${Yl}>`,Qr=document,si=()=>Qr.createComment(""),ai=t=>t===null||typeof t!="object"&&typeof t!="function",Ns=Array.isArray,Qc=t=>Ns(t)||typeof t?.[Symbol.iterator]=="function",ho=`[ 	
\f\r]`,Hn=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,pa=/-->/g,ga=/>/g,qr=RegExp(`>|${ho}(?:([^\\s"'>=/]+)(${ho}*=${ho}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),ma=/'/g,ya=/"/g,Ql=/^(?:script|style|textarea|title)$/i,Xc=t=>(e,...r)=>({_$litType$:t,strings:e,values:r}),Qe=Xc(1),Pr=Symbol.for("lit-noChange"),pt=Symbol.for("lit-nothing"),wa=new WeakMap,Gr=Qr.createTreeWalker(Qr,129);function Xl(t,e){if(!Ns(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return fa!==void 0?fa.createHTML(e):e}const Zc=(t,e)=>{const r=t.length-1,n=[];let s,a=e===2?"<svg>":e===3?"<math>":"",l=Hn;for(let c=0;c<r;c++){const g=t[c];let h,p,f=-1,_=0;for(;_<g.length&&(l.lastIndex=_,p=l.exec(g),p!==null);)_=l.lastIndex,l===Hn?p[1]==="!--"?l=pa:p[1]!==void 0?l=ga:p[2]!==void 0?(Ql.test(p[2])&&(s=RegExp("</"+p[2],"g")),l=qr):p[3]!==void 0&&(l=qr):l===qr?p[0]===">"?(l=s??Hn,f=-1):p[1]===void 0?f=-2:(f=l.lastIndex-p[2].length,h=p[1],l=p[3]===void 0?qr:p[3]==='"'?ya:ma):l===ya||l===ma?l=qr:l===pa||l===ga?l=Hn:(l=qr,s=void 0);const x=l===qr&&t[c+1].startsWith("/>")?" ":"";a+=l===Hn?g+Yc:f>=0?(n.push(h),g.slice(0,f)+Gl+g.slice(f)+Cr+x):g+Cr+(f===-2?c:x)}return[Xl(t,a+(t[r]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),n]};class li{constructor({strings:e,_$litType$:r},n){let s;this.parts=[];let a=0,l=0;const c=e.length-1,g=this.parts,[h,p]=Zc(e,r);if(this.el=li.createElement(h,n),Gr.currentNode=this.el.content,r===2||r===3){const f=this.el.content.firstChild;f.replaceWith(...f.childNodes)}for(;(s=Gr.nextNode())!==null&&g.length<c;){if(s.nodeType===1){if(s.hasAttributes())for(const f of s.getAttributeNames())if(f.endsWith(Gl)){const _=p[l++],x=s.getAttribute(f).split(Cr),S=/([.?@])?(.*)/.exec(_);g.push({type:1,index:a,name:S[2],strings:x,ctor:S[1]==="."?th:S[1]==="?"?rh:S[1]==="@"?nh:Qi}),s.removeAttribute(f)}else f.startsWith(Cr)&&(g.push({type:6,index:a}),s.removeAttribute(f));if(Ql.test(s.tagName)){const f=s.textContent.split(Cr),_=f.length-1;if(_>0){s.textContent=ji?ji.emptyScript:"";for(let x=0;x<_;x++)s.append(f[x],si()),Gr.nextNode(),g.push({type:2,index:++a});s.append(f[_],si())}}}else if(s.nodeType===8)if(s.data===Yl)g.push({type:2,index:a});else{let f=-1;for(;(f=s.data.indexOf(Cr,f+1))!==-1;)g.push({type:7,index:a}),f+=Cr.length-1}a++}}static createElement(e,r){const n=Qr.createElement("template");return n.innerHTML=e,n}}function wn(t,e,r=t,n){if(e===Pr)return e;let s=n!==void 0?r._$Co?.[n]:r._$Cl;const a=ai(e)?void 0:e._$litDirective$;return s?.constructor!==a&&(s?._$AO?.(!1),a===void 0?s=void 0:(s=new a(t),s._$AT(t,r,n)),n!==void 0?(r._$Co??=[])[n]=s:r._$Cl=s),s!==void 0&&(e=wn(t,s._$AS(t,e.values),s,n)),e}class eh{constructor(e,r){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=r}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:r},parts:n}=this._$AD,s=(e?.creationScope??Qr).importNode(r,!0);Gr.currentNode=s;let a=Gr.nextNode(),l=0,c=0,g=n[0];for(;g!==void 0;){if(l===g.index){let h;g.type===2?h=new fi(a,a.nextSibling,this,e):g.type===1?h=new g.ctor(a,g.name,g.strings,this,e):g.type===6&&(h=new ih(a,this,e)),this._$AV.push(h),g=n[++c]}l!==g?.index&&(a=Gr.nextNode(),l++)}return Gr.currentNode=Qr,s}p(e){let r=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,r),r+=n.strings.length-2):n._$AI(e[r])),r++}}class fi{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,r,n,s){this.type=2,this._$AH=pt,this._$AN=void 0,this._$AA=e,this._$AB=r,this._$AM=n,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const r=this._$AM;return r!==void 0&&e?.nodeType===11&&(e=r.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,r=this){e=wn(this,e,r),ai(e)?e===pt||e==null||e===""?(this._$AH!==pt&&this._$AR(),this._$AH=pt):e!==this._$AH&&e!==Pr&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Qc(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==pt&&ai(this._$AH)?this._$AA.nextSibling.data=e:this.T(Qr.createTextNode(e)),this._$AH=e}$(e){const{values:r,_$litType$:n}=e,s=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=li.createElement(Xl(n.h,n.h[0]),this.options)),n);if(this._$AH?._$AD===s)this._$AH.p(r);else{const a=new eh(s,this),l=a.u(this.options);a.p(r),this.T(l),this._$AH=a}}_$AC(e){let r=wa.get(e.strings);return r===void 0&&wa.set(e.strings,r=new li(e)),r}k(e){Ns(this._$AH)||(this._$AH=[],this._$AR());const r=this._$AH;let n,s=0;for(const a of e)s===r.length?r.push(n=new fi(this.O(si()),this.O(si()),this,this.options)):n=r[s],n._$AI(a),s++;s<r.length&&(this._$AR(n&&n._$AB.nextSibling,s),r.length=s)}_$AR(e=this._$AA.nextSibling,r){for(this._$AP?.(!1,!0,r);e!==this._$AB;){const n=e.nextSibling;e.remove(),e=n}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class Qi{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,r,n,s,a){this.type=1,this._$AH=pt,this._$AN=void 0,this.element=e,this.name=r,this._$AM=s,this.options=a,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=pt}_$AI(e,r=this,n,s){const a=this.strings;let l=!1;if(a===void 0)e=wn(this,e,r,0),l=!ai(e)||e!==this._$AH&&e!==Pr,l&&(this._$AH=e);else{const c=e;let g,h;for(e=a[0],g=0;g<a.length-1;g++)h=wn(this,c[n+g],r,g),h===Pr&&(h=this._$AH[g]),l||=!ai(h)||h!==this._$AH[g],h===pt?e=pt:e!==pt&&(e+=(h??"")+a[g+1]),this._$AH[g]=h}l&&!s&&this.j(e)}j(e){e===pt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class th extends Qi{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===pt?void 0:e}}class rh extends Qi{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==pt)}}class nh extends Qi{constructor(e,r,n,s,a){super(e,r,n,s,a),this.type=5}_$AI(e,r=this){if((e=wn(this,e,r,0)??pt)===Pr)return;const n=this._$AH,s=e===pt&&n!==pt||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,a=e!==pt&&(n===pt||s);s&&this.element.removeEventListener(this.name,this,n),a&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class ih{constructor(e,r,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=r,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){wn(this,e)}}const oh=Ps.litHtmlPolyfillSupport;oh?.(li,fi),(Ps.litHtmlVersions??=[]).push("3.3.1");const sh=(t,e,r)=>{const n=r?.renderBefore??e;let s=n._$litPart$;if(s===void 0){const a=r?.renderBefore??null;n._$litPart$=s=new fi(e.insertBefore(si(),a),a,void 0,r??{})}return s._$AI(t),s};const Ls=globalThis;let Ct=class extends fn{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=sh(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Pr}};Ct._$litElement$=!0,Ct.finalized=!0,Ls.litElementHydrateSupport?.({LitElement:Ct});const ah=Ls.litElementPolyfillSupport;ah?.({LitElement:Ct});(Ls.litElementVersions??=[]).push("4.2.1");const _t=t=>(e,r)=>{r!==void 0?r.addInitializer((()=>{customElements.define(t,e)})):customElements.define(t,e)};const lh={attribute:!0,type:String,converter:Mi,reflect:!1,hasChanged:ks},uh=(t=lh,e,r)=>{const{kind:n,metadata:s}=r;let a=globalThis.litPropertyMetadata.get(s);if(a===void 0&&globalThis.litPropertyMetadata.set(s,a=new Map),n==="setter"&&((t=Object.create(t)).wrapped=!0),a.set(r.name,t),n==="accessor"){const{name:l}=r;return{set(c){const g=e.get.call(this);e.set.call(this,c),this.requestUpdate(l,g,t)},init(c){return c!==void 0&&this.C(l,void 0,t,c),c}}}if(n==="setter"){const{name:l}=r;return function(c){const g=this[l];e.call(this,c),this.requestUpdate(l,g,t)}}throw Error("Unsupported decorator location: "+n)};function Te(t){return(e,r)=>typeof r=="object"?uh(t,e,r):((n,s,a)=>{const l=s.hasOwnProperty(a);return s.constructor.createProperty(a,n),l?Object.getOwnPropertyDescriptor(s,a):void 0})(t,e,r)}function Ot(t){return Te({...t,state:!0,attribute:!1})}const ch=(t,e,r)=>(r.configurable=!0,r.enumerable=!0,Reflect.decorate&&typeof e!="object"&&Object.defineProperty(t,e,r),r);function Ut(t,e){return(r,n,s)=>{const a=l=>l.renderRoot?.querySelector(t)??null;return ch(r,n,{get(){return a(this)}})}}var hh=`:host {
  box-sizing: border-box !important;
}

:host *,
:host *::before,
:host *::after {
  box-sizing: inherit !important;
}

[hidden] {
  display: none !important;
}
`,ki,Zt=class extends Ct{constructor(){super(),Mc(this,ki,!1),this.initialReflectedProperties=new Map,this.didSSR=!!this.shadowRoot,this.customStates={set:(e,r)=>{if(this.internals?.states)try{r?this.internals.states.add(e):this.internals.states.delete(e)}catch(n){if(String(n).includes("must start with '--'"))console.error("Your browser implements an outdated version of CustomStateSet. Consider using a polyfill");else throw n}},has:e=>{if(!this.internals?.states)return!1;try{return this.internals.states.has(e)}catch{return!1}}};try{this.internals=this.attachInternals()}catch{console.error("Element internals are not supported in your browser. Consider using a polyfill")}this.customStates.set("wa-defined",!0);let t=this.constructor;for(let[e,r]of t.elementProperties)r.default==="inherit"&&r.initial!==void 0&&typeof e=="string"&&this.customStates.set(`initial-${e}-${r.initial}`,!0)}static get styles(){const t=Array.isArray(this.css)?this.css:this.css?[this.css]:[];return[hh,...t].map(e=>typeof e=="string"?Jl(e):e)}attributeChangedCallback(t,e,r){Bc(this,ki)||(this.constructor.elementProperties.forEach((n,s)=>{n.reflect&&this[s]!=null&&this.initialReflectedProperties.set(s,this[s])}),jc(this,ki,!0)),super.attributeChangedCallback(t,e,r)}willUpdate(t){super.willUpdate(t),this.initialReflectedProperties.forEach((e,r)=>{t.has(r)&&this[r]==null&&(this[r]=e)})}firstUpdated(t){super.firstUpdated(t),this.didSSR&&this.shadowRoot?.querySelectorAll("slot").forEach(e=>{e.dispatchEvent(new Event("slotchange",{bubbles:!0,composed:!1,cancelable:!1}))})}update(t){try{super.update(t)}catch(e){if(this.didSSR&&!this.hasUpdated){const r=new Event("lit-hydration-error",{bubbles:!0,composed:!0,cancelable:!1});r.error=e,this.dispatchEvent(r)}throw e}}relayNativeEvent(t,e){t.stopImmediatePropagation(),this.dispatchEvent(new t.constructor(t.type,{...t,...e}))}};ki=new WeakMap;Se([Te()],Zt.prototype,"dir",2);Se([Te()],Zt.prototype,"lang",2);Se([Te({type:Boolean,reflect:!0,attribute:"did-ssr"})],Zt.prototype,"didSSR",2);var dh=`:host {
  --track-width: 2px;
  --track-color: var(--wa-color-neutral-fill-normal);
  --indicator-color: var(--wa-color-brand-fill-loud);
  --speed: 2s;

  /* Resizing a spinner element using anything but font-size will break the animation because the animation uses em units.
   Therefore, if a spinner is used in a flex container without \`flex: none\` applied, the spinner can grow/shrink and
   break the animation. The use of \`flex: none\` on the host element prevents this by always having the spinner sized
   according to its actual dimensions.
  */
  flex: none;
  display: inline-flex;
  width: 1em;
  height: 1em;
}

svg {
  width: 100%;
  height: 100%;
  aspect-ratio: 1;
  animation: spin var(--speed) linear infinite;
}

.track {
  stroke: var(--track-color);
}

.indicator {
  stroke: var(--indicator-color);
  stroke-dasharray: 75, 100;
  stroke-dashoffset: -5;
  animation: dash 1.5s ease-in-out infinite;
  stroke-linecap: round;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

@keyframes dash {
  0% {
    stroke-dasharray: 1, 150;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -35;
  }
  100% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -124;
  }
}
`,is=class extends Zt{constructor(){super(...arguments),this.localize=new di(this)}render(){return Qe`
      <svg
        part="base"
        role="progressbar"
        aria-label=${this.localize.term("loading")}
        fill="none"
        viewBox="0 0 50 50"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle class="track" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
        <circle class="indicator" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
      </svg>
    `}};is.css=dh;is=Se([_t("wa-spinner")],is);const An=crypto,Ds=t=>t instanceof CryptoKey,cr=new TextEncoder,vn=new TextDecoder;function Zl(...t){const e=t.reduce((s,{length:a})=>s+a,0),r=new Uint8Array(e);let n=0;for(const s of t)r.set(s,n),n+=s.length;return r}const fh=t=>{let e=t;typeof e=="string"&&(e=cr.encode(e));const r=32768,n=[];for(let s=0;s<e.length;s+=r)n.push(String.fromCharCode.apply(null,e.subarray(s,s+r)));return btoa(n.join(""))},Pi=t=>fh(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),ph=t=>{const e=atob(t),r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r},Yr=t=>{let e=t;e instanceof Uint8Array&&(e=vn.decode(e)),e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return ph(e)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}};class kt extends Error{constructor(e,r){super(e,r),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}kt.code="ERR_JOSE_GENERIC";class nr extends kt{constructor(e,r,n="unspecified",s="unspecified"){super(e,{cause:{claim:n,reason:s,payload:r}}),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=n,this.reason=s,this.payload=r}}nr.code="ERR_JWT_CLAIM_VALIDATION_FAILED";class os extends kt{constructor(e,r,n="unspecified",s="unspecified"){super(e,{cause:{claim:n,reason:s,payload:r}}),this.code="ERR_JWT_EXPIRED",this.claim=n,this.reason=s,this.payload=r}}os.code="ERR_JWT_EXPIRED";class eu extends kt{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}}eu.code="ERR_JOSE_ALG_NOT_ALLOWED";class qt extends kt{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}}qt.code="ERR_JOSE_NOT_SUPPORTED";class gh extends kt{constructor(e="decryption operation failed",r){super(e,r),this.code="ERR_JWE_DECRYPTION_FAILED"}}gh.code="ERR_JWE_DECRYPTION_FAILED";class mh extends kt{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}}mh.code="ERR_JWE_INVALID";class ft extends kt{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}}ft.code="ERR_JWS_INVALID";class Xi extends kt{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}}Xi.code="ERR_JWT_INVALID";class yh extends kt{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}}yh.code="ERR_JWK_INVALID";class Os extends kt{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}}Os.code="ERR_JWKS_INVALID";class Us extends kt{constructor(e="no applicable key found in the JSON Web Key Set",r){super(e,r),this.code="ERR_JWKS_NO_MATCHING_KEY"}}Us.code="ERR_JWKS_NO_MATCHING_KEY";class tu extends kt{constructor(e="multiple matching keys found in the JSON Web Key Set",r){super(e,r),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS"}}tu.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";class ru extends kt{constructor(e="request timed out",r){super(e,r),this.code="ERR_JWKS_TIMEOUT"}}ru.code="ERR_JWKS_TIMEOUT";class nu extends kt{constructor(e="signature verification failed",r){super(e,r),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}nu.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";function lr(t,e="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${e} must be ${t}`)}function Vn(t,e){return t.name===e}function fo(t){return parseInt(t.name.slice(4),10)}function wh(t){switch(t){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function vh(t,e){if(e.length&&!e.some(r=>t.usages.includes(r))){let r="CryptoKey does not support this operation, its usages must include ";if(e.length>2){const n=e.pop();r+=`one of ${e.join(", ")}, or ${n}.`}else e.length===2?r+=`one of ${e[0]} or ${e[1]}.`:r+=`${e[0]}.`;throw new TypeError(r)}}function bh(t,e,...r){switch(e){case"HS256":case"HS384":case"HS512":{if(!Vn(t.algorithm,"HMAC"))throw lr("HMAC");const n=parseInt(e.slice(2),10);if(fo(t.algorithm.hash)!==n)throw lr(`SHA-${n}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!Vn(t.algorithm,"RSASSA-PKCS1-v1_5"))throw lr("RSASSA-PKCS1-v1_5");const n=parseInt(e.slice(2),10);if(fo(t.algorithm.hash)!==n)throw lr(`SHA-${n}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!Vn(t.algorithm,"RSA-PSS"))throw lr("RSA-PSS");const n=parseInt(e.slice(2),10);if(fo(t.algorithm.hash)!==n)throw lr(`SHA-${n}`,"algorithm.hash");break}case"EdDSA":{if(t.algorithm.name!=="Ed25519"&&t.algorithm.name!=="Ed448")throw lr("Ed25519 or Ed448");break}case"Ed25519":{if(!Vn(t.algorithm,"Ed25519"))throw lr("Ed25519");break}case"ES256":case"ES384":case"ES512":{if(!Vn(t.algorithm,"ECDSA"))throw lr("ECDSA");const n=wh(e);if(t.algorithm.namedCurve!==n)throw lr(n,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}vh(t,r)}function iu(t,e,...r){if(r=r.filter(Boolean),r.length>2){const n=r.pop();t+=`one of type ${r.join(", ")}, or ${n}.`}else r.length===2?t+=`one of type ${r[0]} or ${r[1]}.`:t+=`of type ${r[0]}.`;return e==null?t+=` Received ${e}`:typeof e=="function"&&e.name?t+=` Received function ${e.name}`:typeof e=="object"&&e!=null&&e.constructor?.name&&(t+=` Received an instance of ${e.constructor.name}`),t}const ss=(t,...e)=>iu("Key must be ",t,...e);function ou(t,e,...r){return iu(`Key for the ${t} algorithm must be `,e,...r)}const su=t=>Ds(t)?!0:t?.[Symbol.toStringTag]==="KeyObject",ui=["CryptoKey"],au=(...t)=>{const e=t.filter(Boolean);if(e.length===0||e.length===1)return!0;let r;for(const n of e){const s=Object.keys(n);if(!r||r.size===0){r=new Set(s);continue}for(const a of s){if(r.has(a))return!1;r.add(a)}}return!0};function _h(t){return typeof t=="object"&&t!==null}function vr(t){if(!_h(t)||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}const lu=(t,e)=>{if(t.startsWith("RS")||t.startsWith("PS")){const{modulusLength:r}=e.algorithm;if(typeof r!="number"||r<2048)throw new TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}};function Fn(t){return vr(t)&&typeof t.kty=="string"}function Sh(t){return t.kty!=="oct"&&typeof t.d=="string"}function Eh(t){return t.kty!=="oct"&&typeof t.d>"u"}function xh(t){return Fn(t)&&t.kty==="oct"&&typeof t.k=="string"}function Ah(t){let e,r;switch(t.kty){case"RSA":{switch(t.alg){case"PS256":case"PS384":case"PS512":e={name:"RSA-PSS",hash:`SHA-${t.alg.slice(-3)}`},r=t.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":e={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${t.alg.slice(-3)}`},r=t.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":e={name:"RSA-OAEP",hash:`SHA-${parseInt(t.alg.slice(-3),10)||1}`},r=t.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new qt('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(t.alg){case"ES256":e={name:"ECDSA",namedCurve:"P-256"},r=t.d?["sign"]:["verify"];break;case"ES384":e={name:"ECDSA",namedCurve:"P-384"},r=t.d?["sign"]:["verify"];break;case"ES512":e={name:"ECDSA",namedCurve:"P-521"},r=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:"ECDH",namedCurve:t.crv},r=t.d?["deriveBits"]:[];break;default:throw new qt('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(t.alg){case"Ed25519":e={name:"Ed25519"},r=t.d?["sign"]:["verify"];break;case"EdDSA":e={name:t.crv},r=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:t.crv},r=t.d?["deriveBits"]:[];break;default:throw new qt('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new qt('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:e,keyUsages:r}}const uu=async t=>{if(!t.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');const{algorithm:e,keyUsages:r}=Ah(t),n=[e,t.ext??!1,t.key_ops??r],s={...t};return delete s.alg,delete s.use,An.subtle.importKey("jwk",s,...n)},cu=t=>Yr(t);let un,cn;const hu=t=>t?.[Symbol.toStringTag]==="KeyObject",$i=async(t,e,r,n,s=!1)=>{let a=t.get(e);if(a?.[n])return a[n];const l=await uu({...r,alg:n});return s&&Object.freeze(e),a?a[n]=l:t.set(e,{[n]:l}),l},Fh=(t,e)=>{if(hu(t)){let r=t.export({format:"jwk"});return delete r.d,delete r.dp,delete r.dq,delete r.p,delete r.q,delete r.qi,r.k?cu(r.k):(cn||(cn=new WeakMap),$i(cn,t,r,e))}return Fn(t)?t.k?Yr(t.k):(cn||(cn=new WeakMap),$i(cn,t,t,e,!0)):t},Rh=(t,e)=>{if(hu(t)){let r=t.export({format:"jwk"});return r.k?cu(r.k):(un||(un=new WeakMap),$i(un,t,r,e))}return Fn(t)?t.k?Yr(t.k):(un||(un=new WeakMap),$i(un,t,t,e,!0)):t},va={normalizePublicKey:Fh,normalizePrivateKey:Rh};async function du(t,e){if(!vr(t))throw new TypeError("JWK must be an object");switch(e||(e=t.alg),t.kty){case"oct":if(typeof t.k!="string"||!t.k)throw new TypeError('missing "k" (Key Value) Parameter value');return Yr(t.k);case"RSA":if("oth"in t&&t.oth!==void 0)throw new qt('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return uu({...t,alg:e});default:throw new qt('Unsupported "kty" (Key Type) Parameter value')}}const pn=t=>t?.[Symbol.toStringTag],as=(t,e,r)=>{if(e.use!==void 0&&e.use!=="sig")throw new TypeError("Invalid key for this operation, when present its use must be sig");if(e.key_ops!==void 0&&e.key_ops.includes?.(r)!==!0)throw new TypeError(`Invalid key for this operation, when present its key_ops must include ${r}`);if(e.alg!==void 0&&e.alg!==t)throw new TypeError(`Invalid key for this operation, when present its alg must be ${t}`);return!0},Ih=(t,e,r,n)=>{if(!(e instanceof Uint8Array)){if(n&&Fn(e)){if(xh(e)&&as(t,e,r))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!su(e))throw new TypeError(ou(t,e,...ui,"Uint8Array",n?"JSON Web Key":null));if(e.type!=="secret")throw new TypeError(`${pn(e)} instances for symmetric algorithms must be of type "secret"`)}},Th=(t,e,r,n)=>{if(n&&Fn(e))switch(r){case"sign":if(Sh(e)&&as(t,e,r))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(Eh(e)&&as(t,e,r))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!su(e))throw new TypeError(ou(t,e,...ui,n?"JSON Web Key":null));if(e.type==="secret")throw new TypeError(`${pn(e)} instances for asymmetric algorithms must not be of type "secret"`);if(r==="sign"&&e.type==="public")throw new TypeError(`${pn(e)} instances for asymmetric algorithm signing must be of type "private"`);if(r==="decrypt"&&e.type==="public")throw new TypeError(`${pn(e)} instances for asymmetric algorithm decryption must be of type "private"`);if(e.algorithm&&r==="verify"&&e.type==="private")throw new TypeError(`${pn(e)} instances for asymmetric algorithm verifying must be of type "public"`);if(e.algorithm&&r==="encrypt"&&e.type==="private")throw new TypeError(`${pn(e)} instances for asymmetric algorithm encryption must be of type "public"`)};function fu(t,e,r,n){e.startsWith("HS")||e==="dir"||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?Ih(e,r,n,t):Th(e,r,n,t)}fu.bind(void 0,!1);const ls=fu.bind(void 0,!0);function pu(t,e,r,n,s){if(s.crit!==void 0&&n?.crit===void 0)throw new t('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||n.crit===void 0)return new Set;if(!Array.isArray(n.crit)||n.crit.length===0||n.crit.some(l=>typeof l!="string"||l.length===0))throw new t('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let a;r!==void 0?a=new Map([...Object.entries(r),...e.entries()]):a=e;for(const l of n.crit){if(!a.has(l))throw new qt(`Extension Header Parameter "${l}" is not recognized`);if(s[l]===void 0)throw new t(`Extension Header Parameter "${l}" is missing`);if(a.get(l)&&n[l]===void 0)throw new t(`Extension Header Parameter "${l}" MUST be integrity protected`)}return new Set(n.crit)}const Ch=(t,e)=>{if(e!==void 0&&(!Array.isArray(e)||e.some(r=>typeof r!="string")))throw new TypeError(`"${t}" option must be an array of strings`);if(e)return new Set(e)},kh=async t=>{if(t instanceof Uint8Array)return{kty:"oct",k:Pi(t)};if(!Ds(t))throw new TypeError(ss(t,...ui,"Uint8Array"));if(!t.extractable)throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");const{ext:e,key_ops:r,alg:n,use:s,...a}=await An.subtle.exportKey("jwk",t);return a};async function Ph(t){return kh(t)}function gu(t,e){const r=`SHA-${t.slice(-3)}`;switch(t){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:t.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:e.namedCurve};case"Ed25519":return{name:"Ed25519"};case"EdDSA":return{name:e.name};default:throw new qt(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}async function mu(t,e,r){if(r==="sign"&&(e=await va.normalizePrivateKey(e,t)),r==="verify"&&(e=await va.normalizePublicKey(e,t)),Ds(e))return bh(e,t,r),e;if(e instanceof Uint8Array){if(!t.startsWith("HS"))throw new TypeError(ss(e,...ui));return An.subtle.importKey("raw",e,{hash:`SHA-${t.slice(-3)}`,name:"HMAC"},!1,[r])}throw new TypeError(ss(e,...ui,"Uint8Array","JSON Web Key"))}const Nh=async(t,e,r,n)=>{const s=await mu(t,e,"verify");lu(t,s);const a=gu(t,s.algorithm);try{return await An.subtle.verify(a,s,r,n)}catch{return!1}};async function Lh(t,e,r){if(!vr(t))throw new ft("Flattened JWS must be an object");if(t.protected===void 0&&t.header===void 0)throw new ft('Flattened JWS must have either of the "protected" or "header" members');if(t.protected!==void 0&&typeof t.protected!="string")throw new ft("JWS Protected Header incorrect type");if(t.payload===void 0)throw new ft("JWS Payload missing");if(typeof t.signature!="string")throw new ft("JWS Signature missing or incorrect type");if(t.header!==void 0&&!vr(t.header))throw new ft("JWS Unprotected Header incorrect type");let n={};if(t.protected)try{const I=Yr(t.protected);n=JSON.parse(vn.decode(I))}catch{throw new ft("JWS Protected Header is invalid")}if(!au(n,t.header))throw new ft("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const s={...n,...t.header},a=pu(ft,new Map([["b64",!0]]),r?.crit,n,s);let l=!0;if(a.has("b64")&&(l=n.b64,typeof l!="boolean"))throw new ft('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:c}=s;if(typeof c!="string"||!c)throw new ft('JWS "alg" (Algorithm) Header Parameter missing or invalid');const g=r&&Ch("algorithms",r.algorithms);if(g&&!g.has(c))throw new eu('"alg" (Algorithm) Header Parameter value not allowed');if(l){if(typeof t.payload!="string")throw new ft("JWS Payload must be a string")}else if(typeof t.payload!="string"&&!(t.payload instanceof Uint8Array))throw new ft("JWS Payload must be a string or an Uint8Array instance");let h=!1;typeof e=="function"?(e=await e(n,t),h=!0,ls(c,e,"verify"),Fn(e)&&(e=await du(e,c))):ls(c,e,"verify");const p=Zl(cr.encode(t.protected??""),cr.encode("."),typeof t.payload=="string"?cr.encode(t.payload):t.payload);let f;try{f=Yr(t.signature)}catch{throw new ft("Failed to base64url decode the signature")}if(!await Nh(c,e,f,p))throw new nu;let x;if(l)try{x=Yr(t.payload)}catch{throw new ft("Failed to base64url decode the payload")}else typeof t.payload=="string"?x=cr.encode(t.payload):x=t.payload;const S={payload:x};return t.protected!==void 0&&(S.protectedHeader=n),t.header!==void 0&&(S.unprotectedHeader=t.header),h?{...S,key:e}:S}async function Dh(t,e,r){if(t instanceof Uint8Array&&(t=vn.decode(t)),typeof t!="string")throw new ft("Compact JWS must be a string or Uint8Array");const{0:n,1:s,2:a,length:l}=t.split(".");if(l!==3)throw new ft("Invalid Compact JWS");const c=await Lh({payload:s,protected:n,signature:a},e,r),g={payload:c.payload,protectedHeader:c.protectedHeader};return typeof e=="function"?{...g,key:c.key}:g}const Ir=t=>Math.floor(t.getTime()/1e3),yu=60,wu=yu*60,Bs=wu*24,Oh=Bs*7,Uh=Bs*365.25,Bh=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,ni=t=>{const e=Bh.exec(t);if(!e||e[4]&&e[1])throw new TypeError("Invalid time period format");const r=parseFloat(e[2]),n=e[3].toLowerCase();let s;switch(n){case"sec":case"secs":case"second":case"seconds":case"s":s=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":s=Math.round(r*yu);break;case"hour":case"hours":case"hr":case"hrs":case"h":s=Math.round(r*wu);break;case"day":case"days":case"d":s=Math.round(r*Bs);break;case"week":case"weeks":case"w":s=Math.round(r*Oh);break;default:s=Math.round(r*Uh);break}return e[1]==="-"||e[4]==="ago"?-s:s},ba=t=>t.toLowerCase().replace(/^application\//,""),Mh=(t,e)=>typeof t=="string"?e.includes(t):Array.isArray(t)?e.some(Set.prototype.has.bind(new Set(t))):!1,jh=(t,e,r={})=>{let n;try{n=JSON.parse(vn.decode(e))}catch{}if(!vr(n))throw new Xi("JWT Claims Set must be a top-level JSON object");const{typ:s}=r;if(s&&(typeof t.typ!="string"||ba(t.typ)!==ba(s)))throw new nr('unexpected "typ" JWT header value',n,"typ","check_failed");const{requiredClaims:a=[],issuer:l,subject:c,audience:g,maxTokenAge:h}=r,p=[...a];h!==void 0&&p.push("iat"),g!==void 0&&p.push("aud"),c!==void 0&&p.push("sub"),l!==void 0&&p.push("iss");for(const S of new Set(p.reverse()))if(!(S in n))throw new nr(`missing required "${S}" claim`,n,S,"missing");if(l&&!(Array.isArray(l)?l:[l]).includes(n.iss))throw new nr('unexpected "iss" claim value',n,"iss","check_failed");if(c&&n.sub!==c)throw new nr('unexpected "sub" claim value',n,"sub","check_failed");if(g&&!Mh(n.aud,typeof g=="string"?[g]:g))throw new nr('unexpected "aud" claim value',n,"aud","check_failed");let f;switch(typeof r.clockTolerance){case"string":f=ni(r.clockTolerance);break;case"number":f=r.clockTolerance;break;case"undefined":f=0;break;default:throw new TypeError("Invalid clockTolerance option type")}const{currentDate:_}=r,x=Ir(_||new Date);if((n.iat!==void 0||h)&&typeof n.iat!="number")throw new nr('"iat" claim must be a number',n,"iat","invalid");if(n.nbf!==void 0){if(typeof n.nbf!="number")throw new nr('"nbf" claim must be a number',n,"nbf","invalid");if(n.nbf>x+f)throw new nr('"nbf" claim timestamp check failed',n,"nbf","check_failed")}if(n.exp!==void 0){if(typeof n.exp!="number")throw new nr('"exp" claim must be a number',n,"exp","invalid");if(n.exp<=x-f)throw new os('"exp" claim timestamp check failed',n,"exp","check_failed")}if(h){const S=x-n.iat,I=typeof h=="number"?h:ni(h);if(S-f>I)throw new os('"iat" claim timestamp check failed (too far in the past)',n,"iat","check_failed");if(S<0-f)throw new nr('"iat" claim timestamp check failed (it should be in the past)',n,"iat","check_failed")}return n};async function $h(t,e,r){const n=await Dh(t,e,r);if(n.protectedHeader.crit?.includes("b64")&&n.protectedHeader.b64===!1)throw new Xi("JWTs MUST NOT use unencoded payload");const a={payload:jh(n.protectedHeader,n.payload,r),protectedHeader:n.protectedHeader};return typeof e=="function"?{...a,key:n.key}:a}const Hh=async(t,e,r)=>{const n=await mu(t,e,"sign");lu(t,n);const s=await An.subtle.sign(gu(t,n.algorithm),n,r);return new Uint8Array(s)};class Vh{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,r){if(!this._protectedHeader&&!this._unprotectedHeader)throw new ft("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!au(this._protectedHeader,this._unprotectedHeader))throw new ft("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const n={...this._protectedHeader,...this._unprotectedHeader},s=pu(ft,new Map([["b64",!0]]),r?.crit,this._protectedHeader,n);let a=!0;if(s.has("b64")&&(a=this._protectedHeader.b64,typeof a!="boolean"))throw new ft('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:l}=n;if(typeof l!="string"||!l)throw new ft('JWS "alg" (Algorithm) Header Parameter missing or invalid');ls(l,e,"sign");let c=this._payload;a&&(c=cr.encode(Pi(c)));let g;this._protectedHeader?g=cr.encode(Pi(JSON.stringify(this._protectedHeader))):g=cr.encode("");const h=Zl(g,cr.encode("."),c),p=await Hh(l,e,h),f={signature:Pi(p),payload:""};return a&&(f.payload=vn.decode(c)),this._unprotectedHeader&&(f.header=this._unprotectedHeader),this._protectedHeader&&(f.protected=vn.decode(g)),f}}class Kh{constructor(e){this._flattened=new Vh(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,r){const n=await this._flattened.sign(e,r);if(n.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${n.protected}.${n.payload}.${n.signature}`}}function Wr(t,e){if(!Number.isFinite(e))throw new TypeError(`Invalid ${t} input`);return e}class qh{constructor(e={}){if(!vr(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return typeof e=="number"?this._payload={...this._payload,nbf:Wr("setNotBefore",e)}:e instanceof Date?this._payload={...this._payload,nbf:Wr("setNotBefore",Ir(e))}:this._payload={...this._payload,nbf:Ir(new Date)+ni(e)},this}setExpirationTime(e){return typeof e=="number"?this._payload={...this._payload,exp:Wr("setExpirationTime",e)}:e instanceof Date?this._payload={...this._payload,exp:Wr("setExpirationTime",Ir(e))}:this._payload={...this._payload,exp:Ir(new Date)+ni(e)},this}setIssuedAt(e){return typeof e>"u"?this._payload={...this._payload,iat:Ir(new Date)}:e instanceof Date?this._payload={...this._payload,iat:Wr("setIssuedAt",Ir(e))}:typeof e=="string"?this._payload={...this._payload,iat:Wr("setIssuedAt",Ir(new Date)+ni(e))}:this._payload={...this._payload,iat:Wr("setIssuedAt",e)},this}}class Wh extends qh{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,r){const n=new Kh(cr.encode(JSON.stringify(this._payload)));if(n.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new Xi("JWTs MUST NOT use unencoded payload");return n.sign(e,r)}}function zh(t){switch(typeof t=="string"&&t.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new qt('Unsupported "alg" value for a JSON Web Key Set')}}function Jh(t){return t&&typeof t=="object"&&Array.isArray(t.keys)&&t.keys.every(Gh)}function Gh(t){return vr(t)}function vu(t){return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}class Yh{constructor(e){if(this._cached=new WeakMap,!Jh(e))throw new Os("JSON Web Key Set malformed");this._jwks=vu(e)}async getKey(e,r){const{alg:n,kid:s}={...e,...r?.header},a=zh(n),l=this._jwks.keys.filter(h=>{let p=a===h.kty;if(p&&typeof s=="string"&&(p=s===h.kid),p&&typeof h.alg=="string"&&(p=n===h.alg),p&&typeof h.use=="string"&&(p=h.use==="sig"),p&&Array.isArray(h.key_ops)&&(p=h.key_ops.includes("verify")),p)switch(n){case"ES256":p=h.crv==="P-256";break;case"ES256K":p=h.crv==="secp256k1";break;case"ES384":p=h.crv==="P-384";break;case"ES512":p=h.crv==="P-521";break;case"Ed25519":p=h.crv==="Ed25519";break;case"EdDSA":p=h.crv==="Ed25519"||h.crv==="Ed448";break}return p}),{0:c,length:g}=l;if(g===0)throw new Us;if(g!==1){const h=new tu,{_cached:p}=this;throw h[Symbol.asyncIterator]=async function*(){for(const f of l)try{yield await _a(p,f,n)}catch{}},h}return _a(this._cached,c,n)}}async function _a(t,e,r){const n=t.get(e)||t.set(e,{}).get(e);if(n[r]===void 0){const s=await du({...e,ext:!0},r);if(s instanceof Uint8Array||s.type!=="public")throw new Os("JSON Web Key Set members must be public keys");n[r]=s}return n[r]}function Sa(t){const e=new Yh(t),r=async(n,s)=>e.getKey(n,s);return Object.defineProperties(r,{jwks:{value:()=>vu(e._jwks),enumerable:!0,configurable:!1,writable:!1}}),r}const Qh=async(t,e,r)=>{let n,s,a=!1;typeof AbortController=="function"&&(n=new AbortController,s=setTimeout(()=>{a=!0,n.abort()},e));const l=await fetch(t.href,{signal:n?n.signal:void 0,redirect:"manual",headers:r.headers}).catch(c=>{throw a?new ru:c});if(s!==void 0&&clearTimeout(s),l.status!==200)throw new kt("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await l.json()}catch{throw new kt("Failed to parse the JSON Web Key Set HTTP response as JSON")}};function Xh(){return typeof WebSocketPair<"u"||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"||typeof EdgeRuntime<"u"&&EdgeRuntime==="vercel"}let us;(typeof navigator>"u"||!navigator.userAgent?.startsWith?.("Mozilla/5.0 "))&&(us="jose/v5.10.0");const po=Symbol();function Zh(t,e){return!(typeof t!="object"||t===null||!("uat"in t)||typeof t.uat!="number"||Date.now()-t.uat>=e||!("jwks"in t)||!vr(t.jwks)||!Array.isArray(t.jwks.keys)||!Array.prototype.every.call(t.jwks.keys,vr))}class ed{constructor(e,r){if(!(e instanceof URL))throw new TypeError("url must be an instance of URL");this._url=new URL(e.href),this._options={agent:r?.agent,headers:r?.headers},this._timeoutDuration=typeof r?.timeoutDuration=="number"?r?.timeoutDuration:5e3,this._cooldownDuration=typeof r?.cooldownDuration=="number"?r?.cooldownDuration:3e4,this._cacheMaxAge=typeof r?.cacheMaxAge=="number"?r?.cacheMaxAge:6e5,r?.[po]!==void 0&&(this._cache=r?.[po],Zh(r?.[po],this._cacheMaxAge)&&(this._jwksTimestamp=this._cache.uat,this._local=Sa(this._cache.jwks)))}coolingDown(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cooldownDuration:!1}fresh(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cacheMaxAge:!1}async getKey(e,r){(!this._local||!this.fresh())&&await this.reload();try{return await this._local(e,r)}catch(n){if(n instanceof Us&&this.coolingDown()===!1)return await this.reload(),this._local(e,r);throw n}}async reload(){this._pendingFetch&&Xh()&&(this._pendingFetch=void 0);const e=new Headers(this._options.headers);us&&!e.has("User-Agent")&&(e.set("User-Agent",us),this._options.headers=Object.fromEntries(e.entries())),this._pendingFetch||(this._pendingFetch=Qh(this._url,this._timeoutDuration,this._options).then(r=>{this._local=Sa(r),this._cache&&(this._cache.uat=Date.now(),this._cache.jwks=r),this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(r=>{throw this._pendingFetch=void 0,r})),await this._pendingFetch}}function td(t,e){const r=new ed(t,e),n=async(s,a)=>r.getKey(s,a);return Object.defineProperties(n,{coolingDown:{get:()=>r.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>r.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>r.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>!!r._pendingFetch,enumerable:!0,configurable:!1},jwks:{value:()=>r._local?.jwks(),enumerable:!0,configurable:!1,writable:!1}}),n}function go(t){const e=t?.modulusLength??2048;if(typeof e!="number"||e<2048)throw new qt("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return e}async function rd(t,e){let r,n;switch(t){case"PS256":case"PS384":case"PS512":r={name:"RSA-PSS",hash:`SHA-${t.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:go(e)},n=["sign","verify"];break;case"RS256":case"RS384":case"RS512":r={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${t.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:go(e)},n=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":r={name:"RSA-OAEP",hash:`SHA-${parseInt(t.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:go(e)},n=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":r={name:"ECDSA",namedCurve:"P-256"},n=["sign","verify"];break;case"ES384":r={name:"ECDSA",namedCurve:"P-384"},n=["sign","verify"];break;case"ES512":r={name:"ECDSA",namedCurve:"P-521"},n=["sign","verify"];break;case"Ed25519":r={name:"Ed25519"},n=["sign","verify"];break;case"EdDSA":{n=["sign","verify"];const s="Ed25519";switch(s){case"Ed25519":case"Ed448":r={name:s};break;default:throw new qt("Invalid or unsupported crv option provided")}break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{n=["deriveKey","deriveBits"];const s="P-256";switch(s){case"P-256":case"P-384":case"P-521":{r={name:"ECDH",namedCurve:s};break}case"X25519":case"X448":r={name:s};break;default:throw new qt("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}break}default:throw new qt('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return An.subtle.generateKey(r,!1,n)}async function nd(t,e){return rd(t,e)}const It=[];for(let t=0;t<256;++t)It.push((t+256).toString(16).slice(1));function id(t,e=0){return(It[t[e+0]]+It[t[e+1]]+It[t[e+2]]+It[t[e+3]]+"-"+It[t[e+4]]+It[t[e+5]]+"-"+It[t[e+6]]+It[t[e+7]]+"-"+It[t[e+8]]+It[t[e+9]]+"-"+It[t[e+10]]+It[t[e+11]]+It[t[e+12]]+It[t[e+13]]+It[t[e+14]]+It[t[e+15]]).toLowerCase()}let mo;const od=new Uint8Array(16);function sd(){if(!mo){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");mo=crypto.getRandomValues.bind(crypto)}return mo(od)}const ad=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ea={randomUUID:ad};function Ms(t,e,r){if(Ea.randomUUID&&!t)return Ea.randomUUID();t=t||{};const n=t.random??t.rng?.()??sd();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,id(n)}const bu="solidClientAuthn:",Hi=["ES256","RS256"],ut={ERROR:"error",LOGIN:"login",LOGOUT:"logout",NEW_REFRESH_TOKEN:"newRefreshToken",NEW_TOKENS:"newTokens",AUTHORIZATION_REQUEST:"authorizationRequest",SESSION_EXPIRED:"sessionExpired",SESSION_EXTENDED:"sessionExtended",SESSION_RESTORED:"sessionRestore",TIMEOUT_SET:"timeoutSet"},xa=5,ld="openid",ud="offline_access",cd="webid",Aa=[ld,ud,cd];class hd{handleables;constructor(e){this.handleables=e,this.handleables=e}async getProperHandler(e){const r=await Promise.all(this.handleables.map(n=>n.canHandle(...e)));for(let n=0;n<r.length;n+=1)if(r[n])return this.handleables[n];return null}async canHandle(...e){return await this.getProperHandler(e)!==null}async handle(...e){const r=await this.getProperHandler(e);if(r)return r.handle(...e);throw new Error(`[${this.constructor.name}] cannot find a suitable handler for: ${e.map(n=>{try{return JSON.stringify(n)}catch{return n.toString()}}).join(", ")}`)}}async function _u(t,e,r,n){let s,a;try{const{payload:l}=await $h(t,td(new URL(e)),{issuer:r,audience:n});s=l}catch(l){throw new Error(`Token verification failed: ${l.stack}`)}if(typeof s.azp=="string"&&(a=s.azp),typeof s.webid=="string")return{webId:s.webid,clientId:a};if(typeof s.sub!="string")throw new Error(`The token ${JSON.stringify(s)} is invalid: it has no 'webid' claim and no 'sub' claim.`);try{return new URL(s.sub),{webId:s.sub,clientId:a}}catch(l){throw new Error(`The token has no 'webid' claim, and its 'sub' claim of [${s.sub}] is invalid as a URL - error [${l}].`)}}function dd(t){return Array.isArray(t)?Array.from(new Set([...Aa,...t.filter(e=>typeof e=="string"&&!e.includes(" "))])):Aa}function Su(t){try{const e=new URL(t),r=!e.searchParams.has("code")&&!e.searchParams.has("state"),n=e.hash==="";return r&&n}catch{return!1}}function Eu(t){const e=new URL(t);return e.searchParams.delete("state"),e.searchParams.delete("code"),e.searchParams.delete("error"),e.searchParams.delete("error_description"),e.searchParams.delete("iss"),e}function fd(t,e){return typeof t=="boolean"?!!t:!!e}class pd{storageUtility;redirector;constructor(e,r){this.storageUtility=e,this.redirector=r,this.storageUtility=e,this.redirector=r}parametersGuard=e=>e.issuerConfiguration.grantTypesSupported!==void 0&&e.issuerConfiguration.grantTypesSupported.indexOf("authorization_code")>-1&&e.redirectUrl!==void 0;async canHandle(e){return this.parametersGuard(e)}async setupRedirectHandler({oidcLoginOptions:e,state:r,codeVerifier:n,targetUrl:s}){if(!this.parametersGuard(e))throw new Error("The authorization code grant requires a redirectUrl.");await Promise.all([this.storageUtility.setForUser(r,{sessionId:e.sessionId}),this.storageUtility.setForUser(e.sessionId,{codeVerifier:n,issuer:e.issuer.toString(),redirectUrl:e.redirectUrl,dpop:(!!e.dpop).toString(),keepAlive:fd(e.keepAlive,!0).toString()})]),this.redirector.redirect(s,{handleRedirect:e.handleRedirect})}}class gd{sessionInfoManager;constructor(e){this.sessionInfoManager=e,this.sessionInfoManager=e}async canHandle(){return!0}async handle(e){await this.sessionInfoManager.clear(e)}}class md{redirector;constructor(e){this.redirector=e,this.redirector=e}async canHandle(e,r){return r?.logoutType==="idp"}async handle(e,r){if(r?.logoutType!=="idp")throw new Error("Attempting to call idp logout handler to perform app logout");if(r.toLogoutUrl===void 0)throw new Error("Cannot perform IDP logout. Did you log in using the OIDC authentication flow?");this.redirector.redirect(r.toLogoutUrl(r),{handleRedirect:r.handleRedirect})}}class yd{handlers;constructor(e,r){this.handlers=[new gd(e),new md(r)]}async canHandle(){return!0}async handle(e,r){for(const n of this.handlers)await n.canHandle(e,r)&&await n.handle(e,r)}}function xu(){return{isLoggedIn:!1,sessionId:Ms(),fetch:(...t)=>fetch(...t)}}async function Au(t,e){await Promise.all([e.deleteAllUserData(t,{secure:!1}),e.deleteAllUserData(t,{secure:!0})])}class wd{storageUtility;constructor(e){this.storageUtility=e,this.storageUtility=e}update(e,r){throw new Error("Not Implemented")}set(e,r){throw new Error("Not Implemented")}get(e){throw new Error("Not implemented")}async getAll(){throw new Error("Not implemented")}async clear(e){return Au(e,this.storageUtility)}async register(e){throw new Error("Not implemented")}async getRegisteredSessionIdAll(){throw new Error("Not implemented")}async clearAll(){throw new Error("Not implemented")}async setOidcContext(e,r){throw new Error("Not implemented")}}function vd({endSessionEndpoint:t,idTokenHint:e,postLogoutRedirectUri:r,state:n}){const s=new URL(t);return e!==void 0&&s.searchParams.append("id_token_hint",e),r!==void 0&&(s.searchParams.append("post_logout_redirect_uri",r),n!==void 0&&s.searchParams.append("state",n)),s.toString()}function bd({endSessionEndpoint:t,idTokenHint:e}){if(t!==void 0)return function({state:n,postLogoutUrl:s}){return vd({endSessionEndpoint:t,idTokenHint:e,state:n,postLogoutRedirectUri:s})}}function _d(t){return typeof t=="string"&&["DPoP","Bearer"].includes(t)}function Fu(t){try{return new URL(t),!0}catch{return!1}}function Sd(t,e){return e.find(r=>t.includes(r))??null}function Ed(t){return t.clientId!==void 0&&!Fu(t.clientId)}function xd(t,e){return e.scopesSupported.includes("webid")&&t.clientId!==void 0&&Fu(t.clientId)}function Ad(t){return typeof t=="string"&&["dynamic","static","solid-oidc"].includes(t)}async function Fd(t,e,r,n){let s;if(xd(t,e))s={clientId:t.clientId,clientName:t.clientName,clientType:"solid-oidc"};else if(Ed(t))s={clientId:t.clientId,clientSecret:t.clientSecret,clientName:t.clientName,clientType:"static"};else return n.getClient({sessionId:t.sessionId,clientName:t.clientName,redirectUrl:t.redirectUrl},e);const a={clientId:s.clientId,clientType:s.clientType};return s.clientType==="static"&&(a.clientSecret=s.clientSecret),s.clientName&&(a.clientName=s.clientName),await r.setForUser(t.sessionId,a),s}const Fa=(t,e)=>fetch(t,e);let Rd=class{loginHandler;redirectHandler;logoutHandler;sessionInfoManager;issuerConfigFetcher;boundLogout;constructor(e,r,n,s,a){this.loginHandler=e,this.redirectHandler=r,this.logoutHandler=n,this.sessionInfoManager=s,this.issuerConfigFetcher=a,this.loginHandler=e,this.redirectHandler=r,this.logoutHandler=n,this.sessionInfoManager=s,this.issuerConfigFetcher=a}fetch=Fa;logout=async(e,r)=>{await this.logoutHandler.handle(e,r?.logoutType==="idp"?{...r,toLogoutUrl:this.boundLogout}:r),this.fetch=Fa,delete this.boundLogout};getSessionInfo=async e=>this.sessionInfoManager.get(e);getAllSessionInfo=async()=>this.sessionInfoManager.getAll()};async function Ru(t,e,r){try{const[n,s,a,l,c]=await Promise.all([e.getForUser(t,"issuer",{errorIfNull:!0}),e.getForUser(t,"codeVerifier"),e.getForUser(t,"redirectUrl"),e.getForUser(t,"dpop",{errorIfNull:!0}),e.getForUser(t,"keepAlive")]);await e.deleteForUser(t,"codeVerifier");const g=await r.fetchConfig(n);return{codeVerifier:s,redirectUrl:a,issuerConfig:g,dpop:l==="true",keepAlive:typeof c=="string"?c==="true":!0}}catch(n){throw new Error(`Failed to retrieve OIDC context from storage associated with session [${t}]: ${n}`)}}async function Id(t,e,r,n,s,a,l,c){r!==void 0&&await t.setForUser(e,{webId:r},{secure:l}),n!==void 0&&await t.setForUser(e,{clientId:n},{secure:l}),await t.setForUser(e,{isLoggedIn:s},{secure:l})}class Td{secureStorage;insecureStorage;constructor(e,r){this.secureStorage=e,this.insecureStorage=r,this.secureStorage=e,this.insecureStorage=r}getKey(e){return`solidClientAuthenticationUser:${e}`}async getUserData(e,r){const n=await(r?this.secureStorage:this.insecureStorage).get(this.getKey(e));if(n===void 0)return{};try{return JSON.parse(n)}catch{throw new Error(`Data for user [${e}] in [${r?"secure":"unsecure"}] storage is corrupted - expected valid JSON, but got: ${n}`)}}async setUserData(e,r,n){await(n?this.secureStorage:this.insecureStorage).set(this.getKey(e),JSON.stringify(r))}async get(e,r){const n=await(r?.secure?this.secureStorage:this.insecureStorage).get(e);if(n===void 0&&r?.errorIfNull)throw new Error(`[${e}] is not stored`);return n}async set(e,r,n){return(n?.secure?this.secureStorage:this.insecureStorage).set(e,r)}async delete(e,r){return(r?.secure?this.secureStorage:this.insecureStorage).delete(e)}async getForUser(e,r,n){const s=await this.getUserData(e,n?.secure);let a;if((!s||!s[r])&&(a=void 0),a=s[r],a===void 0&&n?.errorIfNull)throw new Error(`Field [${r}] for user [${e}] is not stored`);return a||void 0}async setForUser(e,r,n){let s;try{s=await this.getUserData(e,n?.secure)}catch{s={}}await this.setUserData(e,{...s,...r},n?.secure)}async deleteForUser(e,r,n){const s=await this.getUserData(e,n?.secure);delete s[r],await this.setUserData(e,s,n?.secure)}async deleteAllUserData(e,r){await(r?.secure?this.secureStorage:this.insecureStorage).delete(this.getKey(e))}}class Cd{map={};async get(e){return this.map[e]||void 0}async set(e,r){this.map[e]=r}async delete(e){delete this.map[e]}}class cs extends Error{constructor(e){super(e)}}class Zn extends Error{missingFields;constructor(e){super(`Invalid response from OIDC provider: missing fields ${e}`),this.missingFields=e}}class Iu extends Error{error;errorDescription;constructor(e,r,n){super(e),this.error=r,this.errorDescription=n}}function kd(t){const e=new URL(t);return new URL(e.pathname,e.origin).toString()}async function js(t,e,r){return new Wh({htu:kd(t),htm:e.toUpperCase(),jti:Ms()}).setProtectedHeader({alg:Hi[0],jwk:r.publicKey,typ:"dpop+jwt"}).setIssuedAt().sign(r.privateKey,{})}async function Pd(){const{privateKey:t,publicKey:e}=await nd(Hi[0]),r={privateKey:t,publicKey:await Ph(e)};return[r.publicKey.alg]=Hi,r}const Tu=600;function Nd(t){return[401,403].includes(t)}async function Ld(t,e,r,n){const s=new Headers(n?.headers);return s.set("Authorization",`DPoP ${e}`),s.set("DPoP",await js(t,n?.method??"get",r)),{...n,headers:s}}async function Dd(t,e,r,n){if(r!==void 0)return Ld(t,e,r,n);const s=new Headers(n?.headers);return s.set("Authorization",`Bearer ${e}`),{...n,headers:s}}async function Ra(t,e,r,n,s=fetch){return s(e,await Dd(e.toString(),t,n,r))}async function Od(t,e,r){const n=await t.tokenRefresher.refresh(t.sessionId,t.refreshToken,e);return r?.emit(ut.SESSION_EXTENDED,n.expiresIn??Tu),{accessToken:n.accessToken,refreshToken:n.refreshToken,expiresIn:n.expiresIn}}const yo=t=>t!==void 0?t-xa>0?t-xa:t:Tu;function Ud(t,e){let r=t,n;const s=e?.refreshOptions;if(s!==void 0){const a=async()=>{try{const{accessToken:l,refreshToken:c,expiresIn:g}=await Od(s,e.dpopKey,e.eventEmitter);r=l,c!==void 0&&(s.refreshToken=c),clearTimeout(n),n=setTimeout(a,yo(g)*1e3),e.eventEmitter?.emit(ut.TIMEOUT_SET,n)}catch(l){l instanceof Iu&&(e?.eventEmitter?.emit(ut.ERROR,l.error,l.errorDescription),e?.eventEmitter?.emit(ut.SESSION_EXPIRED)),l instanceof Zn&&l.missingFields.includes("access_token")&&e?.eventEmitter?.emit(ut.SESSION_EXPIRED)}};n=setTimeout(a,yo(e.expiresIn)*1e3),e.eventEmitter?.emit(ut.TIMEOUT_SET,n)}else if(e!==void 0&&e.eventEmitter!==void 0){const a=setTimeout(()=>{e.eventEmitter.emit(ut.SESSION_EXPIRED)},yo(e.expiresIn)*1e3);e.eventEmitter.emit(ut.TIMEOUT_SET,a)}return async(a,l)=>{let c=await Ra(r,a,l,e?.dpopKey,e?.fetch);const g=!c.ok&&!Nd(c.status);return c.ok||g||c.url!==a&&e?.dpopKey!==void 0&&(c=await Ra(r,c.url,l,e.dpopKey,e.fetch)),c}}function Cu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vi={exports:{}},Ia;function pi(){if(Ia)return vi.exports;Ia=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(D,j,M){return Function.prototype.apply.call(D,j,M)},r;t&&typeof t.ownKeys=="function"?r=t.ownKeys:Object.getOwnPropertySymbols?r=function(D){return Object.getOwnPropertyNames(D).concat(Object.getOwnPropertySymbols(D))}:r=function(D){return Object.getOwnPropertyNames(D)};function n(P){console&&console.warn&&console.warn(P)}var s=Number.isNaN||function(D){return D!==D};function a(){a.init.call(this)}vi.exports=a,vi.exports.once=b,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function c(P){if(typeof P!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof P)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(P){if(typeof P!="number"||P<0||s(P))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+P+".");l=P}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(D){if(typeof D!="number"||D<0||s(D))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+D+".");return this._maxListeners=D,this};function g(P){return P._maxListeners===void 0?a.defaultMaxListeners:P._maxListeners}a.prototype.getMaxListeners=function(){return g(this)},a.prototype.emit=function(D){for(var j=[],M=1;M<arguments.length;M++)j.push(arguments[M]);var ne=D==="error",ce=this._events;if(ce!==void 0)ne=ne&&ce.error===void 0;else if(!ne)return!1;if(ne){var N;if(j.length>0&&(N=j[0]),N instanceof Error)throw N;var ee=new Error("Unhandled error."+(N?" ("+N.message+")":""));throw ee.context=N,ee}var we=ce[D];if(we===void 0)return!1;if(typeof we=="function")e(we,this,j);else for(var se=we.length,Re=S(we,se),M=0;M<se;++M)e(Re[M],this,j);return!0};function h(P,D,j,M){var ne,ce,N;if(c(j),ce=P._events,ce===void 0?(ce=P._events=Object.create(null),P._eventsCount=0):(ce.newListener!==void 0&&(P.emit("newListener",D,j.listener?j.listener:j),ce=P._events),N=ce[D]),N===void 0)N=ce[D]=j,++P._eventsCount;else if(typeof N=="function"?N=ce[D]=M?[j,N]:[N,j]:M?N.unshift(j):N.push(j),ne=g(P),ne>0&&N.length>ne&&!N.warned){N.warned=!0;var ee=new Error("Possible EventEmitter memory leak detected. "+N.length+" "+String(D)+" listeners added. Use emitter.setMaxListeners() to increase limit");ee.name="MaxListenersExceededWarning",ee.emitter=P,ee.type=D,ee.count=N.length,n(ee)}return P}a.prototype.addListener=function(D,j){return h(this,D,j,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(D,j){return h(this,D,j,!0)};function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(P,D,j){var M={fired:!1,wrapFn:void 0,target:P,type:D,listener:j},ne=p.bind(M);return ne.listener=j,M.wrapFn=ne,ne}a.prototype.once=function(D,j){return c(j),this.on(D,f(this,D,j)),this},a.prototype.prependOnceListener=function(D,j){return c(j),this.prependListener(D,f(this,D,j)),this},a.prototype.removeListener=function(D,j){var M,ne,ce,N,ee;if(c(j),ne=this._events,ne===void 0)return this;if(M=ne[D],M===void 0)return this;if(M===j||M.listener===j)--this._eventsCount===0?this._events=Object.create(null):(delete ne[D],ne.removeListener&&this.emit("removeListener",D,M.listener||j));else if(typeof M!="function"){for(ce=-1,N=M.length-1;N>=0;N--)if(M[N]===j||M[N].listener===j){ee=M[N].listener,ce=N;break}if(ce<0)return this;ce===0?M.shift():I(M,ce),M.length===1&&(ne[D]=M[0]),ne.removeListener!==void 0&&this.emit("removeListener",D,ee||j)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(D){var j,M,ne;if(M=this._events,M===void 0)return this;if(M.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):M[D]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete M[D]),this;if(arguments.length===0){var ce=Object.keys(M),N;for(ne=0;ne<ce.length;++ne)N=ce[ne],N!=="removeListener"&&this.removeAllListeners(N);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(j=M[D],typeof j=="function")this.removeListener(D,j);else if(j!==void 0)for(ne=j.length-1;ne>=0;ne--)this.removeListener(D,j[ne]);return this};function _(P,D,j){var M=P._events;if(M===void 0)return[];var ne=M[D];return ne===void 0?[]:typeof ne=="function"?j?[ne.listener||ne]:[ne]:j?F(ne):S(ne,ne.length)}a.prototype.listeners=function(D){return _(this,D,!0)},a.prototype.rawListeners=function(D){return _(this,D,!1)},a.listenerCount=function(P,D){return typeof P.listenerCount=="function"?P.listenerCount(D):x.call(P,D)},a.prototype.listenerCount=x;function x(P){var D=this._events;if(D!==void 0){var j=D[P];if(typeof j=="function")return 1;if(j!==void 0)return j.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function S(P,D){for(var j=new Array(D),M=0;M<D;++M)j[M]=P[M];return j}function I(P,D){for(;D+1<P.length;D++)P[D]=P[D+1];P.pop()}function F(P){for(var D=new Array(P.length),j=0;j<D.length;++j)D[j]=P[j].listener||P[j];return D}function b(P,D){return new Promise(function(j,M){function ne(N){P.removeListener(D,ce),M(N)}function ce(){typeof P.removeListener=="function"&&P.removeListener("error",ne),j([].slice.call(arguments))}T(P,D,ce,{once:!0}),D!=="error"&&A(P,ne,{once:!0})})}function A(P,D,j){typeof P.on=="function"&&T(P,"error",D,j)}function T(P,D,j,M){if(typeof P.on=="function")M.once?P.once(D,j):P.on(D,j);else if(typeof P.addEventListener=="function")P.addEventListener(D,function ne(ce){M.once&&P.removeEventListener(D,ne),j(ce)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof P)}return vi.exports}var Bd=pi();const Md=Cu(Bd);var Ni={exports:{}},jd=Ni.exports,Ta;function $d(){return Ta||(Ta=1,(function(t,e){(function(n,s){t.exports=s()})(jd,(function(){return(function(r){var n={};function s(a){if(n[a])return n[a].exports;var l=n[a]={i:a,l:!1,exports:{}};return r[a].call(l.exports,l,l.exports,s),l.l=!0,l.exports}return s.m=r,s.c=n,s.d=function(a,l,c){s.o(a,l)||Object.defineProperty(a,l,{enumerable:!0,get:c})},s.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},s.t=function(a,l){if(1&l&&(a=s(a)),8&l||4&l&&typeof a=="object"&&a&&a.__esModule)return a;var c=Object.create(null);if(s.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:a}),2&l&&typeof a!="string")for(var g in a)s.d(c,g,(function(h){return a[h]}).bind(null,g));return c},s.n=function(a){var l=a&&a.__esModule?function(){return a.default}:function(){return a};return s.d(l,"a",l),l},s.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)},s.p="",s(s.s=22)})([function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function h(p,f){for(var _=0;_<f.length;_++){var x=f[_];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,f,_){return f&&h(p.prototype,f),_&&h(p,_),p}})(),l={debug:function(){},info:function(){},warn:function(){},error:function(){}},c=void 0,g=void 0;(n.Log=(function(){function h(){(function(f,_){if(!(f instanceof _))throw new TypeError("Cannot call a class as a function")})(this,h)}return h.reset=function(){g=3,c=l},h.debug=function(){if(g>=4){for(var f=arguments.length,_=Array(f),x=0;x<f;x++)_[x]=arguments[x];c.debug.apply(c,Array.from(_))}},h.info=function(){if(g>=3){for(var f=arguments.length,_=Array(f),x=0;x<f;x++)_[x]=arguments[x];c.info.apply(c,Array.from(_))}},h.warn=function(){if(g>=2){for(var f=arguments.length,_=Array(f),x=0;x<f;x++)_[x]=arguments[x];c.warn.apply(c,Array.from(_))}},h.error=function(){if(g>=1){for(var f=arguments.length,_=Array(f),x=0;x<f;x++)_[x]=arguments[x];c.error.apply(c,Array.from(_))}},a(h,null,[{key:"NONE",get:function(){return 0}},{key:"ERROR",get:function(){return 1}},{key:"WARN",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"level",get:function(){return g},set:function(f){if(!(0<=f&&f<=4))throw new Error("Invalid log level");g=f}},{key:"logger",get:function(){return c},set:function(f){if(!f.debug&&f.info&&(f.debug=f.info),!(f.debug&&f.info&&f.warn&&f.error))throw new Error("Invalid logger");c=f}}]),h})()).reset()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function h(p,f){for(var _=0;_<f.length;_++){var x=f[_];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,f,_){return f&&h(p.prototype,f),_&&h(p,_),p}})(),l={setInterval:(function(h){function p(f,_){return h.apply(this,arguments)}return p.toString=function(){return h.toString()},p})((function(h,p){return setInterval(h,p)})),clearInterval:(function(h){function p(f){return h.apply(this,arguments)}return p.toString=function(){return h.toString()},p})((function(h){return clearInterval(h)}))},c=!1,g=null;n.Global=(function(){function h(){(function(f,_){if(!(f instanceof _))throw new TypeError("Cannot call a class as a function")})(this,h)}return h._testing=function(){c=!0},h.setXMLHttpRequest=function(f){g=f},a(h,null,[{key:"location",get:function(){if(!c)return location}},{key:"localStorage",get:function(){if(!c&&typeof window<"u")return localStorage}},{key:"sessionStorage",get:function(){if(!c&&typeof window<"u")return sessionStorage}},{key:"XMLHttpRequest",get:function(){if(!c&&typeof window<"u")return g||XMLHttpRequest}},{key:"timer",get:function(){if(!c)return l}}]),h})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.MetadataService=void 0;var a=(function(){function p(f,_){for(var x=0;x<_.length;x++){var S=_[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(f,S.key,S)}}return function(f,_,x){return _&&p(f.prototype,_),x&&p(f,x),f}})(),l=s(0),c=s(7);function g(p,f){if(!(p instanceof f))throw new TypeError("Cannot call a class as a function")}var h=".well-known/openid-configuration";n.MetadataService=(function(){function p(f){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c.JsonService;if(g(this,p),!f)throw l.Log.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=f,this._jsonService=new _(["application/jwk-set+json"])}return p.prototype.resetSigningKeys=function(){this._settings=this._settings||{},this._settings.signingKeys=void 0},p.prototype.getMetadata=function(){var _=this;return this._settings.metadata?(l.Log.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(l.Log.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then((function(x){l.Log.debug("MetadataService.getMetadata: json received");var S=_._settings.metadataSeed||{};return _._settings.metadata=Object.assign({},S,x),_._settings.metadata}))):(l.Log.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))},p.prototype.getIssuer=function(){return this._getMetadataProperty("issuer")},p.prototype.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},p.prototype.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},p.prototype.getTokenEndpoint=function(){var _=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return this._getMetadataProperty("token_endpoint",_)},p.prototype.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},p.prototype.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},p.prototype.getRevocationEndpoint=function(){return this._getMetadataProperty("revocation_endpoint",!0)},p.prototype.getKeysEndpoint=function(){return this._getMetadataProperty("jwks_uri",!0)},p.prototype._getMetadataProperty=function(_){var x=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return l.Log.debug("MetadataService.getMetadataProperty for: "+_),this.getMetadata().then((function(S){if(l.Log.debug("MetadataService.getMetadataProperty: metadata recieved"),S[_]===void 0){if(x===!0)return void l.Log.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+_);throw l.Log.error("MetadataService.getMetadataProperty: Metadata does not contain property "+_),new Error("Metadata does not contain property "+_)}return S[_]}))},p.prototype.getSigningKeys=function(){var _=this;return this._settings.signingKeys?(l.Log.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then((function(x){return l.Log.debug("MetadataService.getSigningKeys: jwks_uri received",x),_._jsonService.getJson(x).then((function(S){if(l.Log.debug("MetadataService.getSigningKeys: key set received",S),!S.keys)throw l.Log.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return _._settings.signingKeys=S.keys,_._settings.signingKeys}))}))},a(p,[{key:"metadataUrl",get:function(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(h)<0&&(this._metadataUrl[this._metadataUrl.length-1]!=="/"&&(this._metadataUrl+="/"),this._metadataUrl+=h))),this._metadataUrl}}]),p})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.UrlUtility=void 0;var a=s(0),l=s(1);n.UrlUtility=(function(){function c(){(function(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")})(this,c)}return c.addQueryParam=function(h,p,f){return h.indexOf("?")<0&&(h+="?"),h[h.length-1]!=="?"&&(h+="&"),h+=encodeURIComponent(p),h+="=",h+=encodeURIComponent(f)},c.parseUrlFragment=function(h){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l.Global;typeof h!="string"&&(h=f.location.href);var _=h.lastIndexOf(p);_>=0&&(h=h.substr(_+1)),p==="?"&&(_=h.indexOf("#"))>=0&&(h=h.substr(0,_));for(var x,S={},I=/([^&=]+)=([^&]*)/g,F=0;x=I.exec(h);)if(S[decodeURIComponent(x[1])]=decodeURIComponent(x[2].replace(/\+/g," ")),F++>50)return a.Log.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",h),{error:"Response exceeded expected number of parameters"};for(var b in S)return S;return{}},c})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.JoseUtil=void 0;var a=s(26),l=(function(g){return g&&g.__esModule?g:{default:g}})(s(33));n.JoseUtil=(0,l.default)({jws:a.jws,KeyUtil:a.KeyUtil,X509:a.X509,crypto:a.crypto,hextob64u:a.hextob64u,b64tohex:a.b64tohex,AllowedSigningAlgs:a.AllowedSigningAlgs})},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.OidcClientSettings=void 0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},l=(function(){function b(A,T){for(var P=0;P<T.length;P++){var D=T[P];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(A,D.key,D)}}return function(A,T,P){return T&&b(A.prototype,T),P&&b(A,P),A}})(),c=s(0),g=s(23),h=s(6),p=s(24),f=s(2);function _(b,A){if(!(b instanceof A))throw new TypeError("Cannot call a class as a function")}var x=".well-known/openid-configuration",S="id_token",I="openid",F="client_secret_post";n.OidcClientSettings=(function(){function b(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},T=A.authority,P=A.metadataUrl,D=A.metadata,j=A.signingKeys,M=A.metadataSeed,ne=A.client_id,ce=A.client_secret,N=A.response_type,ee=N===void 0?S:N,we=A.scope,se=we===void 0?I:we,Re=A.redirect_uri,Ne=A.post_logout_redirect_uri,Ue=A.client_authentication,je=Ue===void 0?F:Ue,me=A.prompt,Ie=A.display,G=A.max_age,pe=A.ui_locales,Ce=A.acr_values,xe=A.resource,Be=A.response_mode,He=A.filterProtocolClaims,ze=He===void 0||He,Ke=A.loadUserInfo,Ee=Ke===void 0||Ke,Ae=A.staleStateAge,ke=Ae===void 0?900:Ae,q=A.clockSkew,R=q===void 0?300:q,m=A.clockService,k=m===void 0?new g.ClockService:m,B=A.userInfoJwtIssuer,X=B===void 0?"OP":B,ie=A.mergeClaims,ge=ie!==void 0&&ie,re=A.stateStore,ve=re===void 0?new h.WebStorageStateStore:re,Fe=A.ResponseValidatorCtor,_e=Fe===void 0?p.ResponseValidator:Fe,Me=A.MetadataServiceCtor,et=Me===void 0?f.MetadataService:Me,Oe=A.extraQueryParams,Je=Oe===void 0?{}:Oe,L=A.extraTokenParams,w=L===void 0?{}:L;_(this,b),this._authority=T,this._metadataUrl=P,this._metadata=D,this._metadataSeed=M,this._signingKeys=j,this._client_id=ne,this._client_secret=ce,this._response_type=ee,this._scope=se,this._redirect_uri=Re,this._post_logout_redirect_uri=Ne,this._client_authentication=je,this._prompt=me,this._display=Ie,this._max_age=G,this._ui_locales=pe,this._acr_values=Ce,this._resource=xe,this._response_mode=Be,this._filterProtocolClaims=!!ze,this._loadUserInfo=!!Ee,this._staleStateAge=ke,this._clockSkew=R,this._clockService=k,this._userInfoJwtIssuer=X,this._mergeClaims=!!ge,this._stateStore=ve,this._validator=new _e(this),this._metadataService=new et(this),this._extraQueryParams=(Je===void 0?"undefined":a(Je))==="object"?Je:{},this._extraTokenParams=(w===void 0?"undefined":a(w))==="object"?w:{}}return b.prototype.getEpochTime=function(){return this._clockService.getEpochTime()},l(b,[{key:"client_id",get:function(){return this._client_id},set:function(T){if(this._client_id)throw c.Log.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=T}},{key:"client_secret",get:function(){return this._client_secret}},{key:"response_type",get:function(){return this._response_type}},{key:"scope",get:function(){return this._scope}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"post_logout_redirect_uri",get:function(){return this._post_logout_redirect_uri}},{key:"client_authentication",get:function(){return this._client_authentication}},{key:"prompt",get:function(){return this._prompt}},{key:"display",get:function(){return this._display}},{key:"max_age",get:function(){return this._max_age}},{key:"ui_locales",get:function(){return this._ui_locales}},{key:"acr_values",get:function(){return this._acr_values}},{key:"resource",get:function(){return this._resource}},{key:"response_mode",get:function(){return this._response_mode}},{key:"authority",get:function(){return this._authority},set:function(T){if(this._authority)throw c.Log.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=T}},{key:"metadataUrl",get:function(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(x)<0&&(this._metadataUrl[this._metadataUrl.length-1]!=="/"&&(this._metadataUrl+="/"),this._metadataUrl+=x)),this._metadataUrl}},{key:"metadata",get:function(){return this._metadata},set:function(T){this._metadata=T}},{key:"metadataSeed",get:function(){return this._metadataSeed},set:function(T){this._metadataSeed=T}},{key:"signingKeys",get:function(){return this._signingKeys},set:function(T){this._signingKeys=T}},{key:"filterProtocolClaims",get:function(){return this._filterProtocolClaims}},{key:"loadUserInfo",get:function(){return this._loadUserInfo}},{key:"staleStateAge",get:function(){return this._staleStateAge}},{key:"clockSkew",get:function(){return this._clockSkew}},{key:"userInfoJwtIssuer",get:function(){return this._userInfoJwtIssuer}},{key:"mergeClaims",get:function(){return this._mergeClaims}},{key:"stateStore",get:function(){return this._stateStore}},{key:"validator",get:function(){return this._validator}},{key:"metadataService",get:function(){return this._metadataService}},{key:"extraQueryParams",get:function(){return this._extraQueryParams},set:function(T){(T===void 0?"undefined":a(T))==="object"?this._extraQueryParams=T:this._extraQueryParams={}}},{key:"extraTokenParams",get:function(){return this._extraTokenParams},set:function(T){(T===void 0?"undefined":a(T))==="object"?this._extraTokenParams=T:this._extraTokenParams={}}}]),b})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.WebStorageStateStore=void 0;var a=s(0),l=s(1);function c(g,h){if(!(g instanceof h))throw new TypeError("Cannot call a class as a function")}n.WebStorageStateStore=(function(){function g(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},p=h.prefix,f=p===void 0?"oidc.":p,_=h.store,x=_===void 0?l.Global.localStorage:_;c(this,g),this._store=x,this._prefix=f}return g.prototype.set=function(p,f){return a.Log.debug("WebStorageStateStore.set",p),p=this._prefix+p,this._store.setItem(p,f),Promise.resolve()},g.prototype.get=function(p){a.Log.debug("WebStorageStateStore.get",p),p=this._prefix+p;var f=this._store.getItem(p);return Promise.resolve(f)},g.prototype.remove=function(p){a.Log.debug("WebStorageStateStore.remove",p),p=this._prefix+p;var f=this._store.getItem(p);return this._store.removeItem(p),Promise.resolve(f)},g.prototype.getAllKeys=function(){a.Log.debug("WebStorageStateStore.getAllKeys");for(var p=[],f=0;f<this._store.length;f++){var _=this._store.key(f);_.indexOf(this._prefix)===0&&p.push(_.substr(this._prefix.length))}return Promise.resolve(p)},g})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.JsonService=void 0;var a=s(0),l=s(1);function c(g,h){if(!(g instanceof h))throw new TypeError("Cannot call a class as a function")}n.JsonService=(function(){function g(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:l.Global.XMLHttpRequest,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;c(this,g),h&&Array.isArray(h)?this._contentTypes=h.slice():this._contentTypes=[],this._contentTypes.push("application/json"),f&&this._contentTypes.push("application/jwt"),this._XMLHttpRequest=p,this._jwtHandler=f}return g.prototype.getJson=function(p,f){var _=this;if(!p)throw a.Log.error("JsonService.getJson: No url passed"),new Error("url");return a.Log.debug("JsonService.getJson, url: ",p),new Promise((function(x,S){var I=new _._XMLHttpRequest;I.open("GET",p);var F=_._contentTypes,b=_._jwtHandler;I.onload=function(){if(a.Log.debug("JsonService.getJson: HTTP response received, status",I.status),I.status===200){var A=I.getResponseHeader("Content-Type");if(A){var T=F.find((function(P){if(A.startsWith(P))return!0}));if(T=="application/jwt")return void b(I).then(x,S);if(T)try{return void x(JSON.parse(I.responseText))}catch(P){return a.Log.error("JsonService.getJson: Error parsing JSON response",P.message),void S(P)}}S(Error("Invalid response Content-Type: "+A+", from URL: "+p))}else S(Error(I.statusText+" ("+I.status+")"))},I.onerror=function(){a.Log.error("JsonService.getJson: network error"),S(Error("Network Error"))},f&&(a.Log.debug("JsonService.getJson: token passed, setting Authorization header"),I.setRequestHeader("Authorization","Bearer "+f)),I.send()}))},g.prototype.postForm=function(p,f,_){var x=this;if(!p)throw a.Log.error("JsonService.postForm: No url passed"),new Error("url");return a.Log.debug("JsonService.postForm, url: ",p),new Promise((function(S,I){var F=new x._XMLHttpRequest;F.open("POST",p);var b=x._contentTypes;F.onload=function(){if(a.Log.debug("JsonService.postForm: HTTP response received, status",F.status),F.status!==200){if(F.status===400&&(j=F.getResponseHeader("Content-Type"))&&b.find((function(M){if(j.startsWith(M))return!0})))try{var D=JSON.parse(F.responseText);if(D&&D.error)return a.Log.error("JsonService.postForm: Error from server: ",D.error),void I(new Error(D.error))}catch(M){return a.Log.error("JsonService.postForm: Error parsing JSON response",M.message),void I(M)}I(Error(F.statusText+" ("+F.status+")"))}else{var j;if((j=F.getResponseHeader("Content-Type"))&&b.find((function(M){if(j.startsWith(M))return!0})))try{return void S(JSON.parse(F.responseText))}catch(M){return a.Log.error("JsonService.postForm: Error parsing JSON response",M.message),void I(M)}I(Error("Invalid response Content-Type: "+j+", from URL: "+p))}},F.onerror=function(){a.Log.error("JsonService.postForm: network error"),I(Error("Network Error"))};var A="";for(var T in f){var P=f[T];P&&(A.length>0&&(A+="&"),A+=encodeURIComponent(T),A+="=",A+=encodeURIComponent(P))}F.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),_!==void 0&&F.setRequestHeader("Authorization","Basic "+btoa(_)),F.send(A)}))},g})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.SigninRequest=void 0;var a=s(0),l=s(3),c=s(13);n.SigninRequest=(function(){function g(h){var p=h.url,f=h.client_id,_=h.redirect_uri,x=h.response_type,S=h.scope,I=h.authority,F=h.data,b=h.prompt,A=h.display,T=h.max_age,P=h.ui_locales,D=h.id_token_hint,j=h.login_hint,M=h.acr_values,ne=h.resource,ce=h.response_mode,N=h.request,ee=h.request_uri,we=h.extraQueryParams,se=h.request_type,Re=h.client_secret,Ne=h.extraTokenParams,Ue=h.skipUserInfo;if((function(xe,Be){if(!(xe instanceof Be))throw new TypeError("Cannot call a class as a function")})(this,g),!p)throw a.Log.error("SigninRequest.ctor: No url passed"),new Error("url");if(!f)throw a.Log.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!_)throw a.Log.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!x)throw a.Log.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!S)throw a.Log.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!I)throw a.Log.error("SigninRequest.ctor: No authority passed"),new Error("authority");var je=g.isOidc(x),me=g.isCode(x);ce||(ce=g.isCode(x)?"query":null),this.state=new c.SigninState({nonce:je,data:F,client_id:f,authority:I,redirect_uri:_,code_verifier:me,request_type:se,response_mode:ce,client_secret:Re,scope:S,extraTokenParams:Ne,skipUserInfo:Ue}),p=l.UrlUtility.addQueryParam(p,"client_id",f),p=l.UrlUtility.addQueryParam(p,"redirect_uri",_),p=l.UrlUtility.addQueryParam(p,"response_type",x),p=l.UrlUtility.addQueryParam(p,"scope",S),p=l.UrlUtility.addQueryParam(p,"state",this.state.id),je&&(p=l.UrlUtility.addQueryParam(p,"nonce",this.state.nonce)),me&&(p=l.UrlUtility.addQueryParam(p,"code_challenge",this.state.code_challenge),p=l.UrlUtility.addQueryParam(p,"code_challenge_method","S256"));var Ie={prompt:b,display:A,max_age:T,ui_locales:P,id_token_hint:D,login_hint:j,acr_values:M,resource:ne,request:N,request_uri:ee,response_mode:ce};for(var G in Ie)Ie[G]&&(p=l.UrlUtility.addQueryParam(p,G,Ie[G]));for(var pe in we)p=l.UrlUtility.addQueryParam(p,pe,we[pe]);this.url=p}return g.isOidc=function(p){return!!p.split(/\s+/g).filter((function(f){return f==="id_token"}))[0]},g.isOAuth=function(p){return!!p.split(/\s+/g).filter((function(f){return f==="token"}))[0]},g.isCode=function(p){return!!p.split(/\s+/g).filter((function(f){return f==="code"}))[0]},g})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.State=void 0;var a=(function(){function h(p,f){for(var _=0;_<f.length;_++){var x=f[_];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,f,_){return f&&h(p.prototype,f),_&&h(p,_),p}})(),l=s(0),c=(function(p){return p&&p.__esModule?p:{default:p}})(s(14));function g(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")}n.State=(function(){function h(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=p.id,_=p.data,x=p.created,S=p.request_type;g(this,h),this._id=f||(0,c.default)(),this._data=_,this._created=typeof x=="number"&&x>0?x:parseInt(Date.now()/1e3),this._request_type=S}return h.prototype.toStorageString=function(){return l.Log.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})},h.fromStorageString=function(f){return l.Log.debug("State.fromStorageString"),new h(JSON.parse(f))},h.clearStaleState=function(f,_){var x=Date.now()/1e3-_;return f.getAllKeys().then((function(S){l.Log.debug("State.clearStaleState: got keys",S);for(var I=[],F=function(P){var D=S[P];A=f.get(D).then((function(j){var M=!1;if(j)try{var ne=h.fromStorageString(j);l.Log.debug("State.clearStaleState: got item from key: ",D,ne.created),ne.created<=x&&(M=!0)}catch(ce){l.Log.error("State.clearStaleState: Error parsing state for key",D,ce.message),M=!0}else l.Log.debug("State.clearStaleState: no item in storage for key: ",D),M=!0;if(M)return l.Log.debug("State.clearStaleState: removed item for key: ",D),f.remove(D)})),I.push(A)},b=0;b<S.length;b++){var A;F(b)}return l.Log.debug("State.clearStaleState: waiting on promise count:",I.length),Promise.all(I)}))},a(h,[{key:"id",get:function(){return this._id}},{key:"data",get:function(){return this._data}},{key:"created",get:function(){return this._created}},{key:"request_type",get:function(){return this._request_type}}]),h})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.OidcClient=void 0;var a=(function(){function F(b,A){for(var T=0;T<A.length;T++){var P=A[T];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(b,P.key,P)}}return function(b,A,T){return A&&F(b.prototype,A),T&&F(b,T),b}})(),l=s(0),c=s(5),g=s(12),h=s(8),p=s(34),f=s(35),_=s(36),x=s(13),S=s(9);function I(F,b){if(!(F instanceof b))throw new TypeError("Cannot call a class as a function")}n.OidcClient=(function(){function F(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};I(this,F),b instanceof c.OidcClientSettings?this._settings=b:this._settings=new c.OidcClientSettings(b)}return F.prototype.createSigninRequest=function(){var A=this,T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P=T.response_type,D=T.scope,j=T.redirect_uri,M=T.data,ne=T.state,ce=T.prompt,N=T.display,ee=T.max_age,we=T.ui_locales,se=T.id_token_hint,Re=T.login_hint,Ne=T.acr_values,Ue=T.resource,je=T.request,me=T.request_uri,Ie=T.response_mode,G=T.extraQueryParams,pe=T.extraTokenParams,Ce=T.request_type,xe=T.skipUserInfo,Be=arguments[1];l.Log.debug("OidcClient.createSigninRequest");var He=this._settings.client_id;P=P||this._settings.response_type,D=D||this._settings.scope,j=j||this._settings.redirect_uri,ce=ce||this._settings.prompt,N=N||this._settings.display,ee=ee||this._settings.max_age,we=we||this._settings.ui_locales,Ne=Ne||this._settings.acr_values,Ue=Ue||this._settings.resource,Ie=Ie||this._settings.response_mode,G=G||this._settings.extraQueryParams,pe=pe||this._settings.extraTokenParams;var ze=this._settings.authority;return h.SigninRequest.isCode(P)&&P!=="code"?Promise.reject(new Error("OpenID Connect hybrid flow is not supported")):this._metadataService.getAuthorizationEndpoint().then((function(Ke){l.Log.debug("OidcClient.createSigninRequest: Received authorization endpoint",Ke);var Ee=new h.SigninRequest({url:Ke,client_id:He,redirect_uri:j,response_type:P,scope:D,data:M||ne,authority:ze,prompt:ce,display:N,max_age:ee,ui_locales:we,id_token_hint:se,login_hint:Re,acr_values:Ne,resource:Ue,request:je,request_uri:me,extraQueryParams:G,extraTokenParams:pe,request_type:Ce,response_mode:Ie,client_secret:A._settings.client_secret,skipUserInfo:xe}),Ae=Ee.state;return(Be=Be||A._stateStore).set(Ae.id,Ae.toStorageString()).then((function(){return Ee}))}))},F.prototype.readSigninResponseState=function(A,T){var P=arguments.length>2&&arguments[2]!==void 0&&arguments[2];l.Log.debug("OidcClient.readSigninResponseState");var D=this._settings.response_mode==="query"||!this._settings.response_mode&&h.SigninRequest.isCode(this._settings.response_type),j=D?"?":"#",M=new p.SigninResponse(A,j);if(!M.state)return l.Log.error("OidcClient.readSigninResponseState: No state in response"),Promise.reject(new Error("No state in response"));T=T||this._stateStore;var ne=P?T.remove.bind(T):T.get.bind(T);return ne(M.state).then((function(ce){if(!ce)throw l.Log.error("OidcClient.readSigninResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:x.SigninState.fromStorageString(ce),response:M}}))},F.prototype.processSigninResponse=function(A,T){var P=this;return l.Log.debug("OidcClient.processSigninResponse"),this.readSigninResponseState(A,T,!0).then((function(D){var j=D.state,M=D.response;return l.Log.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),P._validator.validateSigninResponse(j,M)}))},F.prototype.createSignoutRequest=function(){var A=this,T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P=T.id_token_hint,D=T.data,j=T.state,M=T.post_logout_redirect_uri,ne=T.extraQueryParams,ce=T.request_type,N=arguments[1];return l.Log.debug("OidcClient.createSignoutRequest"),M=M||this._settings.post_logout_redirect_uri,ne=ne||this._settings.extraQueryParams,this._metadataService.getEndSessionEndpoint().then((function(ee){if(!ee)throw l.Log.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");l.Log.debug("OidcClient.createSignoutRequest: Received end session endpoint",ee);var we=new f.SignoutRequest({url:ee,id_token_hint:P,post_logout_redirect_uri:M,data:D||j,extraQueryParams:ne,request_type:ce}),se=we.state;return se&&(l.Log.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),(N=N||A._stateStore).set(se.id,se.toStorageString())),we}))},F.prototype.readSignoutResponseState=function(A,T){var P=arguments.length>2&&arguments[2]!==void 0&&arguments[2];l.Log.debug("OidcClient.readSignoutResponseState");var D=new _.SignoutResponse(A);if(!D.state)return l.Log.debug("OidcClient.readSignoutResponseState: No state in response"),D.error?(l.Log.warn("OidcClient.readSignoutResponseState: Response was error: ",D.error),Promise.reject(new g.ErrorResponse(D))):Promise.resolve({state:void 0,response:D});var j=D.state;T=T||this._stateStore;var M=P?T.remove.bind(T):T.get.bind(T);return M(j).then((function(ne){if(!ne)throw l.Log.error("OidcClient.readSignoutResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:S.State.fromStorageString(ne),response:D}}))},F.prototype.processSignoutResponse=function(A,T){var P=this;return l.Log.debug("OidcClient.processSignoutResponse"),this.readSignoutResponseState(A,T,!0).then((function(D){var j=D.state,M=D.response;return j?(l.Log.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),P._validator.validateSignoutResponse(j,M)):(l.Log.debug("OidcClient.processSignoutResponse: No state from storage; skipping validating response"),M)}))},F.prototype.clearStaleState=function(A){return l.Log.debug("OidcClient.clearStaleState"),A=A||this._stateStore,S.State.clearStaleState(A,this.settings.staleStateAge)},a(F,[{key:"_stateStore",get:function(){return this.settings.stateStore}},{key:"_validator",get:function(){return this.settings.validator}},{key:"_metadataService",get:function(){return this.settings.metadataService}},{key:"settings",get:function(){return this._settings}},{key:"metadataService",get:function(){return this._metadataService}}]),F})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.TokenClient=void 0;var a=s(7),l=s(2),c=s(0);function g(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")}n.TokenClient=(function(){function h(p){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.JsonService,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l.MetadataService;if(g(this,h),!p)throw c.Log.error("TokenClient.ctor: No settings passed"),new Error("settings");this._settings=p,this._jsonService=new f,this._metadataService=new _(this._settings)}return h.prototype.exchangeCode=function(){var f=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(_=Object.assign({},_)).grant_type=_.grant_type||"authorization_code",_.client_id=_.client_id||this._settings.client_id,_.client_secret=_.client_secret||this._settings.client_secret,_.redirect_uri=_.redirect_uri||this._settings.redirect_uri;var x=void 0,S=_._client_authentication||this._settings._client_authentication;return delete _._client_authentication,_.code?_.redirect_uri?_.code_verifier?_.client_id?_.client_secret||S!="client_secret_basic"?(S=="client_secret_basic"&&(x=_.client_id+":"+_.client_secret,delete _.client_id,delete _.client_secret),this._metadataService.getTokenEndpoint(!1).then((function(I){return c.Log.debug("TokenClient.exchangeCode: Received token endpoint"),f._jsonService.postForm(I,_,x).then((function(F){return c.Log.debug("TokenClient.exchangeCode: response received"),F}))}))):(c.Log.error("TokenClient.exchangeCode: No client_secret passed"),Promise.reject(new Error("A client_secret is required"))):(c.Log.error("TokenClient.exchangeCode: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(c.Log.error("TokenClient.exchangeCode: No code_verifier passed"),Promise.reject(new Error("A code_verifier is required"))):(c.Log.error("TokenClient.exchangeCode: No redirect_uri passed"),Promise.reject(new Error("A redirect_uri is required"))):(c.Log.error("TokenClient.exchangeCode: No code passed"),Promise.reject(new Error("A code is required")))},h.prototype.exchangeRefreshToken=function(){var f=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(_=Object.assign({},_)).grant_type=_.grant_type||"refresh_token",_.client_id=_.client_id||this._settings.client_id,_.client_secret=_.client_secret||this._settings.client_secret;var x=void 0,S=_._client_authentication||this._settings._client_authentication;return delete _._client_authentication,_.refresh_token?_.client_id?(S=="client_secret_basic"&&(x=_.client_id+":"+_.client_secret,delete _.client_id,delete _.client_secret),this._metadataService.getTokenEndpoint(!1).then((function(I){return c.Log.debug("TokenClient.exchangeRefreshToken: Received token endpoint"),f._jsonService.postForm(I,_,x).then((function(F){return c.Log.debug("TokenClient.exchangeRefreshToken: response received"),F}))}))):(c.Log.error("TokenClient.exchangeRefreshToken: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(c.Log.error("TokenClient.exchangeRefreshToken: No refresh_token passed"),Promise.reject(new Error("A refresh_token is required")))},h})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorResponse=void 0;var a=s(0);function l(g,h){if(!(g instanceof h))throw new TypeError("Cannot call a class as a function")}function c(g,h){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!h||typeof h!="object"&&typeof h!="function"?g:h}n.ErrorResponse=(function(g){function h(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=p.error,_=p.error_description,x=p.error_uri,S=p.state,I=p.session_state;if(l(this,h),!f)throw a.Log.error("No error passed to ErrorResponse"),new Error("error");var F=c(this,g.call(this,_||f));return F.name="ErrorResponse",F.error=f,F.error_description=_,F.error_uri=x,F.state=S,F.session_state=I,F}return(function(f,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);f.prototype=Object.create(_&&_.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(f,_):f.__proto__=_)})(h,g),h})(Error)},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.SigninState=void 0;var a=(function(){function _(x,S){for(var I=0;I<S.length;I++){var F=S[I];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(x,F.key,F)}}return function(x,S,I){return S&&_(x.prototype,S),I&&_(x,I),x}})(),l=s(0),c=s(9),g=s(4),h=(function(x){return x&&x.__esModule?x:{default:x}})(s(14));function p(_,x){if(!(_ instanceof x))throw new TypeError("Cannot call a class as a function")}function f(_,x){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!x||typeof x!="object"&&typeof x!="function"?_:x}n.SigninState=(function(_){function x(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=S.nonce,F=S.authority,b=S.client_id,A=S.redirect_uri,T=S.code_verifier,P=S.response_mode,D=S.client_secret,j=S.scope,M=S.extraTokenParams,ne=S.skipUserInfo;p(this,x);var ce=f(this,_.call(this,arguments[0]));if(I===!0?ce._nonce=(0,h.default)():I&&(ce._nonce=I),T===!0?ce._code_verifier=(0,h.default)()+(0,h.default)()+(0,h.default)():T&&(ce._code_verifier=T),ce.code_verifier){var N=g.JoseUtil.hashString(ce.code_verifier,"SHA256");ce._code_challenge=g.JoseUtil.hexToBase64Url(N)}return ce._redirect_uri=A,ce._authority=F,ce._client_id=b,ce._response_mode=P,ce._client_secret=D,ce._scope=j,ce._extraTokenParams=M,ce._skipUserInfo=ne,ce}return(function(I,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);I.prototype=Object.create(F&&F.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(I,F):I.__proto__=F)})(x,_),x.prototype.toStorageString=function(){return l.Log.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,nonce:this.nonce,code_verifier:this.code_verifier,redirect_uri:this.redirect_uri,authority:this.authority,client_id:this.client_id,response_mode:this.response_mode,client_secret:this.client_secret,scope:this.scope,extraTokenParams:this.extraTokenParams,skipUserInfo:this.skipUserInfo})},x.fromStorageString=function(I){return l.Log.debug("SigninState.fromStorageString"),new x(JSON.parse(I))},a(x,[{key:"nonce",get:function(){return this._nonce}},{key:"authority",get:function(){return this._authority}},{key:"client_id",get:function(){return this._client_id}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"code_verifier",get:function(){return this._code_verifier}},{key:"code_challenge",get:function(){return this._code_challenge}},{key:"response_mode",get:function(){return this._response_mode}},{key:"client_secret",get:function(){return this._client_secret}},{key:"scope",get:function(){return this._scope}},{key:"extraTokenParams",get:function(){return this._extraTokenParams}},{key:"skipUserInfo",get:function(){return this._skipUserInfo}}]),x})(c.State)},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return(a!="undefined"&&a!==null&&a.getRandomValues!==void 0?l:c)().replace(/-/g,"")};var a=typeof window<"u"?window.crypto||window.msCrypto:null;function l(){return("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,(function(g){return(g^a.getRandomValues(new Uint8Array(1))[0]&15>>g/4).toString(16)}))}function c(){return("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,(function(g){return(g^16*Math.random()>>g/4).toString(16)}))}r.exports=n.default},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.User=void 0;var a=(function(){function c(g,h){for(var p=0;p<h.length;p++){var f=h[p];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(g,f.key,f)}}return function(g,h,p){return h&&c(g.prototype,h),p&&c(g,p),g}})(),l=s(0);n.User=(function(){function c(g){var h=g.id_token,p=g.session_state,f=g.access_token,_=g.refresh_token,x=g.token_type,S=g.scope,I=g.profile,F=g.expires_at,b=g.state;(function(T,P){if(!(T instanceof P))throw new TypeError("Cannot call a class as a function")})(this,c),this.id_token=h,this.session_state=p,this.access_token=f,this.refresh_token=_,this.token_type=x,this.scope=S,this.profile=I,this.expires_at=F,this.state=b}return c.prototype.toStorageString=function(){return l.Log.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},c.fromStorageString=function(h){return l.Log.debug("User.fromStorageString"),new c(JSON.parse(h))},a(c,[{key:"expires_in",get:function(){if(this.expires_at){var h=parseInt(Date.now()/1e3);return this.expires_at-h}},set:function(h){var p=parseInt(h);if(typeof p=="number"&&p>0){var f=parseInt(Date.now()/1e3);this.expires_at=f+p}}},{key:"expired",get:function(){var h=this.expires_in;if(h!==void 0)return h<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}}]),c})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.AccessTokenEvents=void 0;var a=s(0),l=s(46);function c(g,h){if(!(g instanceof h))throw new TypeError("Cannot call a class as a function")}n.AccessTokenEvents=(function(){function g(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},p=h.accessTokenExpiringNotificationTime,f=p===void 0?60:p,_=h.accessTokenExpiringTimer,x=_===void 0?new l.Timer("Access token expiring"):_,S=h.accessTokenExpiredTimer,I=S===void 0?new l.Timer("Access token expired"):S;c(this,g),this._accessTokenExpiringNotificationTime=f,this._accessTokenExpiring=x,this._accessTokenExpired=I}return g.prototype.load=function(p){if(p.access_token&&p.expires_in!==void 0){var f=p.expires_in;if(a.Log.debug("AccessTokenEvents.load: access token present, remaining duration:",f),f>0){var _=f-this._accessTokenExpiringNotificationTime;_<=0&&(_=1),a.Log.debug("AccessTokenEvents.load: registering expiring timer in:",_),this._accessTokenExpiring.init(_)}else a.Log.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();var x=f+1;a.Log.debug("AccessTokenEvents.load: registering expired timer in:",x),this._accessTokenExpired.init(x)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},g.prototype.unload=function(){a.Log.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},g.prototype.addAccessTokenExpiring=function(p){this._accessTokenExpiring.addHandler(p)},g.prototype.removeAccessTokenExpiring=function(p){this._accessTokenExpiring.removeHandler(p)},g.prototype.addAccessTokenExpired=function(p){this._accessTokenExpired.addHandler(p)},g.prototype.removeAccessTokenExpired=function(p){this._accessTokenExpired.removeHandler(p)},g})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.Event=void 0;var a=s(0);n.Event=(function(){function l(c){(function(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")})(this,l),this._name=c,this._callbacks=[]}return l.prototype.addHandler=function(g){this._callbacks.push(g)},l.prototype.removeHandler=function(g){var h=this._callbacks.findIndex((function(p){return p===g}));h>=0&&this._callbacks.splice(h,1)},l.prototype.raise=function(){a.Log.debug("Event: Raising event: "+this._name);for(var g=0;g<this._callbacks.length;g++){var h;(h=this._callbacks)[g].apply(h,arguments)}},l})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.SessionMonitor=void 0;var a=(function(){function p(f,_){for(var x=0;x<_.length;x++){var S=_[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(f,S.key,S)}}return function(f,_,x){return _&&p(f.prototype,_),x&&p(f,x),f}})(),l=s(0),c=s(19),g=s(1);function h(p,f){if(!(p instanceof f))throw new TypeError("Cannot call a class as a function")}n.SessionMonitor=(function(){function p(f){var _=this,x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c.CheckSessionIFrame,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g.Global.timer;if(h(this,p),!f)throw l.Log.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=f,this._CheckSessionIFrameCtor=x,this._timer=S,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),Promise.resolve(this._userManager.getUser().then((function(I){I?_._start(I):_._settings.monitorAnonymousSession&&_._userManager.querySessionStatus().then((function(F){var b={session_state:F.session_state};F.sub&&F.sid&&(b.profile={sub:F.sub,sid:F.sid}),_._start(b)})).catch((function(F){l.Log.error("SessionMonitor ctor: error from querySessionStatus:",F.message)}))})).catch((function(I){l.Log.error("SessionMonitor ctor: error from getUser:",I.message)})))}return p.prototype._start=function(_){var x=this,S=_.session_state;S&&(_.profile?(this._sub=_.profile.sub,this._sid=_.profile.sid,l.Log.debug("SessionMonitor._start: session_state:",S,", sub:",this._sub)):(this._sub=void 0,this._sid=void 0,l.Log.debug("SessionMonitor._start: session_state:",S,", anonymous user")),this._checkSessionIFrame?this._checkSessionIFrame.start(S):this._metadataService.getCheckSessionIframe().then((function(I){if(I){l.Log.debug("SessionMonitor._start: Initializing check session iframe");var F=x._client_id,b=x._checkSessionInterval,A=x._stopCheckSessionOnError;x._checkSessionIFrame=new x._CheckSessionIFrameCtor(x._callback.bind(x),F,I,b,A),x._checkSessionIFrame.load().then((function(){x._checkSessionIFrame.start(S)}))}else l.Log.warn("SessionMonitor._start: No check session iframe found in the metadata")})).catch((function(I){l.Log.error("SessionMonitor._start: Error from getCheckSessionIframe:",I.message)})))},p.prototype._stop=function(){var _=this;if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&(l.Log.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop()),this._settings.monitorAnonymousSession)var x=this._timer.setInterval((function(){_._timer.clearInterval(x),_._userManager.querySessionStatus().then((function(S){var I={session_state:S.session_state};S.sub&&S.sid&&(I.profile={sub:S.sub,sid:S.sid}),_._start(I)})).catch((function(S){l.Log.error("SessionMonitor: error from querySessionStatus:",S.message)}))}),1e3)},p.prototype._callback=function(){var _=this;this._userManager.querySessionStatus().then((function(x){var S=!0;x?x.sub===_._sub?(S=!1,_._checkSessionIFrame.start(x.session_state),x.sid===_._sid?l.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",x.session_state):(l.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",x.session_state),_._userManager.events._raiseUserSessionChanged())):l.Log.debug("SessionMonitor._callback: Different subject signed into OP:",x.sub):l.Log.debug("SessionMonitor._callback: Subject no longer signed into OP"),S&&(_._sub?(l.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),_._userManager.events._raiseUserSignedOut()):(l.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed in event"),_._userManager.events._raiseUserSignedIn()))})).catch((function(x){_._sub&&(l.Log.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",x.message),_._userManager.events._raiseUserSignedOut())}))},a(p,[{key:"_settings",get:function(){return this._userManager.settings}},{key:"_metadataService",get:function(){return this._userManager.metadataService}},{key:"_client_id",get:function(){return this._settings.client_id}},{key:"_checkSessionInterval",get:function(){return this._settings.checkSessionInterval}},{key:"_stopCheckSessionOnError",get:function(){return this._settings.stopCheckSessionOnError}}]),p})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.CheckSessionIFrame=void 0;var a=s(0);function l(c,g){if(!(c instanceof g))throw new TypeError("Cannot call a class as a function")}n.CheckSessionIFrame=(function(){function c(g,h,p,f){var _=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];l(this,c),this._callback=g,this._client_id=h,this._url=p,this._interval=f||2e3,this._stopOnError=_;var x=p.indexOf("/",p.indexOf("//")+2);this._frame_origin=p.substr(0,x),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.width=0,this._frame.height=0,this._frame.src=p}return c.prototype.load=function(){var h=this;return new Promise((function(p){h._frame.onload=function(){p()},window.document.body.appendChild(h._frame),h._boundMessageEvent=h._message.bind(h),window.addEventListener("message",h._boundMessageEvent,!1)}))},c.prototype._message=function(h){h.origin===this._frame_origin&&h.source===this._frame.contentWindow&&(h.data==="error"?(a.Log.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):h.data==="changed"?(a.Log.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):a.Log.debug("CheckSessionIFrame: "+h.data+" message from check session op iframe"))},c.prototype.start=function(h){var p=this;if(this._session_state!==h){a.Log.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=h;var f=function(){p._frame.contentWindow.postMessage(p._client_id+" "+p._session_state,p._frame_origin)};f(),this._timer=window.setInterval(f,this._interval)}},c.prototype.stop=function(){this._session_state=null,this._timer&&(a.Log.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)},c})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.TokenRevocationClient=void 0;var a=s(0),l=s(2),c=s(1);function g(f,_){if(!(f instanceof _))throw new TypeError("Cannot call a class as a function")}var h="access_token",p="refresh_token";n.TokenRevocationClient=(function(){function f(_){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c.Global.XMLHttpRequest,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l.MetadataService;if(g(this,f),!_)throw a.Log.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=_,this._XMLHttpRequestCtor=x,this._metadataService=new S(this._settings)}return f.prototype.revoke=function(x,S){var I=this,F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"access_token";if(!x)throw a.Log.error("TokenRevocationClient.revoke: No token provided"),new Error("No token provided.");if(F!==h&&F!=p)throw a.Log.error("TokenRevocationClient.revoke: Invalid token type"),new Error("Invalid token type.");return this._metadataService.getRevocationEndpoint().then((function(b){if(b){a.Log.debug("TokenRevocationClient.revoke: Revoking "+F);var A=I._settings.client_id,T=I._settings.client_secret;return I._revoke(b,A,T,x,F)}if(S)throw a.Log.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")}))},f.prototype._revoke=function(x,S,I,F,b){var A=this;return new Promise((function(T,P){var D=new A._XMLHttpRequestCtor;D.open("POST",x),D.onload=function(){a.Log.debug("TokenRevocationClient.revoke: HTTP response received, status",D.status),D.status===200?T():P(Error(D.statusText+" ("+D.status+")"))},D.onerror=function(){a.Log.debug("TokenRevocationClient.revoke: Network Error."),P("Network Error")};var j="client_id="+encodeURIComponent(S);I&&(j+="&client_secret="+encodeURIComponent(I)),j+="&token_type_hint="+encodeURIComponent(b),j+="&token="+encodeURIComponent(F),D.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),D.send(j)}))},f})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.CordovaPopupWindow=void 0;var a=(function(){function c(g,h){for(var p=0;p<h.length;p++){var f=h[p];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(g,f.key,f)}}return function(g,h,p){return h&&c(g.prototype,h),p&&c(g,p),g}})(),l=s(0);n.CordovaPopupWindow=(function(){function c(g){var h=this;(function(f,_){if(!(f instanceof _))throw new TypeError("Cannot call a class as a function")})(this,c),this._promise=new Promise((function(p,f){h._resolve=p,h._reject=f})),this.features=g.popupWindowFeatures||"location=no,toolbar=no,zoom=no",this.target=g.popupWindowTarget||"_blank",this.redirect_uri=g.startUrl,l.Log.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}return c.prototype._isInAppBrowserInstalled=function(h){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some((function(p){return h.hasOwnProperty(p)}))},c.prototype.navigate=function(h){if(h&&h.url){if(!window.cordova)return this._error("cordova is undefined");var p=window.cordova.require("cordova/plugin_list").metadata;if(this._isInAppBrowserInstalled(p)===!1)return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(h.url,this.target,this.features),this._popup?(l.Log.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise},c.prototype._loadStartCallback=function(h){h.url.indexOf(this.redirect_uri)===0&&this._success({url:h.url})},c.prototype._exitCallback=function(h){this._error(h)},c.prototype._success=function(h){this._cleanup(),l.Log.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(h)},c.prototype._error=function(h){this._cleanup(),l.Log.error(h),this._reject(new Error(h))},c.prototype.close=function(){this._cleanup()},c.prototype._cleanup=function(){this._popup&&(l.Log.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null},a(c,[{key:"promise",get:function(){return this._promise}}]),c})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=s(0),l=s(10),c=s(5),g=s(6),h=s(37),p=s(38),f=s(16),_=s(2),x=s(48),S=s(49),I=s(19),F=s(20),b=s(18),A=s(1),T=s(15),P=s(50);n.default={Version:P.Version,Log:a.Log,OidcClient:l.OidcClient,OidcClientSettings:c.OidcClientSettings,WebStorageStateStore:g.WebStorageStateStore,InMemoryWebStorage:h.InMemoryWebStorage,UserManager:p.UserManager,AccessTokenEvents:f.AccessTokenEvents,MetadataService:_.MetadataService,CordovaPopupNavigator:x.CordovaPopupNavigator,CordovaIFrameNavigator:S.CordovaIFrameNavigator,CheckSessionIFrame:I.CheckSessionIFrame,TokenRevocationClient:F.TokenRevocationClient,SessionMonitor:b.SessionMonitor,Global:A.Global,User:T.User},r.exports=n.default},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.ClockService=(function(){function a(){(function(c,g){if(!(c instanceof g))throw new TypeError("Cannot call a class as a function")})(this,a)}return a.prototype.getEpochTime=function(){return Promise.resolve(Date.now()/1e3|0)},a})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.ResponseValidator=void 0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},l=s(0),c=s(2),g=s(25),h=s(11),p=s(12),f=s(4);function _(S,I){if(!(S instanceof I))throw new TypeError("Cannot call a class as a function")}var x=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];n.ResponseValidator=(function(){function S(I){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c.MetadataService,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g.UserInfoService,A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:f.JoseUtil,T=arguments.length>4&&arguments[4]!==void 0?arguments[4]:h.TokenClient;if(_(this,S),!I)throw l.Log.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=I,this._metadataService=new F(this._settings),this._userInfoService=new b(this._settings),this._joseUtil=A,this._tokenClient=new T(this._settings)}return S.prototype.validateSigninResponse=function(F,b){var A=this;return l.Log.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(F,b).then((function(T){return l.Log.debug("ResponseValidator.validateSigninResponse: state processed"),A._validateTokens(F,T).then((function(P){return l.Log.debug("ResponseValidator.validateSigninResponse: tokens validated"),A._processClaims(F,P).then((function(D){return l.Log.debug("ResponseValidator.validateSigninResponse: claims processed"),D}))}))}))},S.prototype.validateSignoutResponse=function(F,b){return F.id!==b.state?(l.Log.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(l.Log.debug("ResponseValidator.validateSignoutResponse: state validated"),b.state=F.data,b.error?(l.Log.warn("ResponseValidator.validateSignoutResponse: Response was error",b.error),Promise.reject(new p.ErrorResponse(b))):Promise.resolve(b))},S.prototype._processSigninParams=function(F,b){if(F.id!==b.state)return l.Log.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!F.client_id)return l.Log.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!F.authority)return l.Log.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==F.authority)return l.Log.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=F.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==F.client_id)return l.Log.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=F.client_id;return l.Log.debug("ResponseValidator._processSigninParams: state validated"),b.state=F.data,b.error?(l.Log.warn("ResponseValidator._processSigninParams: Response was error",b.error),Promise.reject(new p.ErrorResponse(b))):F.nonce&&!b.id_token?(l.Log.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!F.nonce&&b.id_token?(l.Log.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):F.code_verifier&&!b.code?(l.Log.error("ResponseValidator._processSigninParams: Expecting code in response"),Promise.reject(new Error("No code in response"))):!F.code_verifier&&b.code?(l.Log.error("ResponseValidator._processSigninParams: Not expecting code in response"),Promise.reject(new Error("Unexpected code in response"))):(b.scope||(b.scope=F.scope),Promise.resolve(b))},S.prototype._processClaims=function(F,b){var A=this;if(b.isOpenIdConnect){if(l.Log.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),b.profile=this._filterProtocolClaims(b.profile),F.skipUserInfo!==!0&&this._settings.loadUserInfo&&b.access_token)return l.Log.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(b.access_token).then((function(T){return l.Log.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),T.sub!==b.profile.sub?(l.Log.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in id_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in id_token"))):(b.profile=A._mergeClaims(b.profile,T),l.Log.debug("ResponseValidator._processClaims: user info claims received, updated profile:",b.profile),b)}));l.Log.debug("ResponseValidator._processClaims: not loading user info")}else l.Log.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(b)},S.prototype._mergeClaims=function(F,b){var A=Object.assign({},F);for(var T in b){var P=b[T];Array.isArray(P)||(P=[P]);for(var D=0;D<P.length;D++){var j=P[D];A[T]?Array.isArray(A[T])?A[T].indexOf(j)<0&&A[T].push(j):A[T]!==j&&((j===void 0?"undefined":a(j))==="object"&&this._settings.mergeClaims?A[T]=this._mergeClaims(A[T],j):A[T]=[A[T],j]):A[T]=j}}return A},S.prototype._filterProtocolClaims=function(F){l.Log.debug("ResponseValidator._filterProtocolClaims, incoming claims:",F);var b=Object.assign({},F);return this._settings._filterProtocolClaims?(x.forEach((function(A){delete b[A]})),l.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",b)):l.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),b},S.prototype._validateTokens=function(F,b){return b.code?(l.Log.debug("ResponseValidator._validateTokens: Validating code"),this._processCode(F,b)):b.id_token?b.access_token?(l.Log.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(F,b)):(l.Log.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(F,b)):(l.Log.debug("ResponseValidator._validateTokens: No code to process or id_token to validate"),Promise.resolve(b))},S.prototype._processCode=function(F,b){var A=this,T={client_id:F.client_id,client_secret:F.client_secret,code:b.code,redirect_uri:F.redirect_uri,code_verifier:F.code_verifier};return F.extraTokenParams&&a(F.extraTokenParams)==="object"&&Object.assign(T,F.extraTokenParams),this._tokenClient.exchangeCode(T).then((function(P){for(var D in P)b[D]=P[D];return b.id_token?(l.Log.debug("ResponseValidator._processCode: token response successful, processing id_token"),A._validateIdTokenAttributes(F,b)):(l.Log.debug("ResponseValidator._processCode: token response successful, returning response"),b)}))},S.prototype._validateIdTokenAttributes=function(F,b){var A=this;return this._metadataService.getIssuer().then((function(T){var P=F.client_id,D=A._settings.clockSkew;return l.Log.debug("ResponseValidator._validateIdTokenAttributes: Validaing JWT attributes; using clock skew (in seconds) of: ",D),A._settings.getEpochTime().then((function(j){return A._joseUtil.validateJwtAttributes(b.id_token,T,P,D,j).then((function(M){return F.nonce&&F.nonce!==M.nonce?(l.Log.error("ResponseValidator._validateIdTokenAttributes: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):M.sub?(b.profile=M,b):(l.Log.error("ResponseValidator._validateIdTokenAttributes: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))}))},S.prototype._validateIdTokenAndAccessToken=function(F,b){var A=this;return this._validateIdToken(F,b).then((function(T){return A._validateAccessToken(T)}))},S.prototype._getSigningKeyForJwt=function(F){var b=this;return this._metadataService.getSigningKeys().then((function(A){var T=F.header.kid;if(!A)return l.Log.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));l.Log.debug("ResponseValidator._validateIdToken: Received signing keys");var P=void 0;if(T)P=A.filter((function(D){return D.kid===T}))[0];else{if((A=b._filterByAlg(A,F.header.alg)).length>1)return l.Log.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));P=A[0]}return Promise.resolve(P)}))},S.prototype._getSigningKeyForJwtWithSingleRetry=function(F){var b=this;return this._getSigningKeyForJwt(F).then((function(A){return A?Promise.resolve(A):(b._metadataService.resetSigningKeys(),b._getSigningKeyForJwt(F))}))},S.prototype._validateIdToken=function(F,b){var A=this;if(!F.nonce)return l.Log.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));var T=this._joseUtil.parseJwt(b.id_token);return T&&T.header&&T.payload?F.nonce!==T.payload.nonce?(l.Log.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):this._metadataService.getIssuer().then((function(P){return l.Log.debug("ResponseValidator._validateIdToken: Received issuer"),A._getSigningKeyForJwtWithSingleRetry(T).then((function(D){if(!D)return l.Log.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var j=F.client_id,M=A._settings.clockSkew;return l.Log.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",M),A._joseUtil.validateJwt(b.id_token,D,P,j,M).then((function(){return l.Log.debug("ResponseValidator._validateIdToken: JWT validation successful"),T.payload.sub?(b.profile=T.payload,b):(l.Log.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))})):(l.Log.error("ResponseValidator._validateIdToken: Failed to parse id_token",T),Promise.reject(new Error("Failed to parse id_token")))},S.prototype._filterByAlg=function(F,b){var A=null;if(b.startsWith("RS"))A="RSA";else if(b.startsWith("PS"))A="PS";else{if(!b.startsWith("ES"))return l.Log.debug("ResponseValidator._filterByAlg: alg not supported: ",b),[];A="EC"}return l.Log.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",A),F=F.filter((function(T){return T.kty===A})),l.Log.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",A,F.length),F},S.prototype._validateAccessToken=function(F){if(!F.profile)return l.Log.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!F.profile.at_hash)return l.Log.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!F.id_token)return l.Log.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));var b=this._joseUtil.parseJwt(F.id_token);if(!b||!b.header)return l.Log.error("ResponseValidator._validateAccessToken: Failed to parse id_token",b),Promise.reject(new Error("Failed to parse id_token"));var A=b.header.alg;if(!A||A.length!==5)return l.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",A),Promise.reject(new Error("Unsupported alg: "+A));var T=A.substr(2,3);if(!T)return l.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",A,T),Promise.reject(new Error("Unsupported alg: "+A));if((T=parseInt(T))!==256&&T!==384&&T!==512)return l.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",A,T),Promise.reject(new Error("Unsupported alg: "+A));var P="sha"+T,D=this._joseUtil.hashString(F.access_token,P);if(!D)return l.Log.error("ResponseValidator._validateAccessToken: access_token hash failed:",P),Promise.reject(new Error("Failed to validate at_hash"));var j=D.substr(0,D.length/2),M=this._joseUtil.hexToBase64Url(j);return M!==F.profile.at_hash?(l.Log.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",M,F.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(l.Log.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(F))},S})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.UserInfoService=void 0;var a=s(7),l=s(2),c=s(0),g=s(4);function h(p,f){if(!(p instanceof f))throw new TypeError("Cannot call a class as a function")}n.UserInfoService=(function(){function p(f){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.JsonService,x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l.MetadataService,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:g.JoseUtil;if(h(this,p),!f)throw c.Log.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=f,this._jsonService=new _(void 0,void 0,this._getClaimsFromJwt.bind(this)),this._metadataService=new x(this._settings),this._joseUtil=S}return p.prototype.getClaims=function(_){var x=this;return _?this._metadataService.getUserInfoEndpoint().then((function(S){return c.Log.debug("UserInfoService.getClaims: received userinfo url",S),x._jsonService.getJson(S,_).then((function(I){return c.Log.debug("UserInfoService.getClaims: claims received",I),I}))})):(c.Log.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))},p.prototype._getClaimsFromJwt=function(_){var x=this;try{var S=this._joseUtil.parseJwt(_.responseText);if(!S||!S.header||!S.payload)return c.Log.error("UserInfoService._getClaimsFromJwt: Failed to parse JWT",S),Promise.reject(new Error("Failed to parse id_token"));var I=S.header.kid,F=void 0;switch(this._settings.userInfoJwtIssuer){case"OP":F=this._metadataService.getIssuer();break;case"ANY":F=Promise.resolve(S.payload.iss);break;default:F=Promise.resolve(this._settings.userInfoJwtIssuer)}return F.then((function(b){return c.Log.debug("UserInfoService._getClaimsFromJwt: Received issuer:"+b),x._metadataService.getSigningKeys().then((function(A){if(!A)return c.Log.error("UserInfoService._getClaimsFromJwt: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));c.Log.debug("UserInfoService._getClaimsFromJwt: Received signing keys");var T=void 0;if(I)T=A.filter((function(j){return j.kid===I}))[0];else{if((A=x._filterByAlg(A,S.header.alg)).length>1)return c.Log.error("UserInfoService._getClaimsFromJwt: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));T=A[0]}if(!T)return c.Log.error("UserInfoService._getClaimsFromJwt: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var P=x._settings.client_id,D=x._settings.clockSkew;return c.Log.debug("UserInfoService._getClaimsFromJwt: Validaing JWT; using clock skew (in seconds) of: ",D),x._joseUtil.validateJwt(_.responseText,T,b,P,D,void 0,!0).then((function(){return c.Log.debug("UserInfoService._getClaimsFromJwt: JWT validation successful"),S.payload}))}))}))}catch(b){return c.Log.error("UserInfoService._getClaimsFromJwt: Error parsing JWT response",b.message),void reject(b)}},p.prototype._filterByAlg=function(_,x){var S=null;if(x.startsWith("RS"))S="RSA";else if(x.startsWith("PS"))S="PS";else{if(!x.startsWith("ES"))return c.Log.debug("UserInfoService._filterByAlg: alg not supported: ",x),[];S="EC"}return c.Log.debug("UserInfoService._filterByAlg: Looking for keys that match kty: ",S),_=_.filter((function(I){return I.kty===S})),c.Log.debug("UserInfoService._filterByAlg: Number of keys that match kty: ",S,_.length),_},p})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.AllowedSigningAlgs=n.b64tohex=n.hextob64u=n.crypto=n.X509=n.KeyUtil=n.jws=void 0;var a=s(27);n.jws=a.jws,n.KeyUtil=a.KEYUTIL,n.X509=a.X509,n.crypto=a.crypto,n.hextob64u=a.hextob64u,n.b64tohex=a.b64tohex,n.AllowedSigningAlgs=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"]},function(r,n,s){(function(a){Object.defineProperty(n,"__esModule",{value:!0});var l,c,g,h,p,f,_,x,S,I,F,b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},A={},T={},P=P||(l=Math,g=(c={}).lib={},h=g.Base=(function(){function o(){}return{extend:function(u){o.prototype=this;var d=new o;return u&&d.mixIn(u),d.hasOwnProperty("init")||(d.init=function(){d.$super.init.apply(this,arguments)}),d.init.prototype=d,d.$super=this,d},create:function(){var u=this.extend();return u.init.apply(u,arguments),u},init:function(){},mixIn:function(u){for(var d in u)u.hasOwnProperty(d)&&(this[d]=u[d]);u.hasOwnProperty("toString")&&(this.toString=u.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),p=g.WordArray=h.extend({init:function(i,u){i=this.words=i||[],this.sigBytes=u??4*i.length},toString:function(i){return(i||_).stringify(this)},concat:function(i){var u=this.words,d=i.words,y=this.sigBytes,C=i.sigBytes;if(this.clamp(),y%4)for(var U=0;U<C;U++){var K=d[U>>>2]>>>24-U%4*8&255;u[y+U>>>2]|=K<<24-(y+U)%4*8}else for(U=0;U<C;U+=4)u[y+U>>>2]=d[U>>>2];return this.sigBytes+=C,this},clamp:function(){var i=this.words,u=this.sigBytes;i[u>>>2]&=4294967295<<32-u%4*8,i.length=l.ceil(u/4)},clone:function(){var i=h.clone.call(this);return i.words=this.words.slice(0),i},random:function(i){for(var u=[],d=0;d<i;d+=4)u.push(4294967296*l.random()|0);return new p.init(u,i)}}),f=c.enc={},_=f.Hex={stringify:function(i){for(var u=i.words,d=i.sigBytes,y=[],C=0;C<d;C++){var U=u[C>>>2]>>>24-C%4*8&255;y.push((U>>>4).toString(16)),y.push((15&U).toString(16))}return y.join("")},parse:function(i){for(var u=i.length,d=[],y=0;y<u;y+=2)d[y>>>3]|=parseInt(i.substr(y,2),16)<<24-y%8*4;return new p.init(d,u/2)}},x=f.Latin1={stringify:function(i){for(var u=i.words,d=i.sigBytes,y=[],C=0;C<d;C++){var U=u[C>>>2]>>>24-C%4*8&255;y.push(String.fromCharCode(U))}return y.join("")},parse:function(i){for(var u=i.length,d=[],y=0;y<u;y++)d[y>>>2]|=(255&i.charCodeAt(y))<<24-y%4*8;return new p.init(d,u)}},S=f.Utf8={stringify:function(i){try{return decodeURIComponent(escape(x.stringify(i)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(i){return x.parse(unescape(encodeURIComponent(i)))}},I=g.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new p.init,this._nDataBytes=0},_append:function(i){typeof i=="string"&&(i=S.parse(i)),this._data.concat(i),this._nDataBytes+=i.sigBytes},_process:function(i){var u=this._data,d=u.words,y=u.sigBytes,C=this.blockSize,U=y/(4*C),K=(U=i?l.ceil(U):l.max((0|U)-this._minBufferSize,0))*C,$=l.min(4*K,y);if(K){for(var H=0;H<K;H+=C)this._doProcessBlock(d,H);var W=d.splice(0,K);u.sigBytes-=$}return new p.init(W,$)},clone:function(){var i=h.clone.call(this);return i._data=this._data.clone(),i},_minBufferSize:0}),g.Hasher=I.extend({cfg:h.extend(),init:function(i){this.cfg=this.cfg.extend(i),this.reset()},reset:function(){I.reset.call(this),this._doReset()},update:function(i){return this._append(i),this._process(),this},finalize:function(i){return i&&this._append(i),this._doFinalize()},blockSize:16,_createHelper:function(i){return function(u,d){return new i.init(d).finalize(u)}},_createHmacHelper:function(i){return function(u,d){return new F.HMAC.init(i,d).finalize(u)}}}),F=c.algo={},c);(function(o){var i,u=(i=P).lib,d=u.Base,y=u.WordArray;(i=i.x64={}).Word=d.extend({init:function(U,K){this.high=U,this.low=K}}),i.WordArray=d.extend({init:function(U,K){U=this.words=U||[],this.sigBytes=K??8*U.length},toX32:function(){for(var U=this.words,K=U.length,$=[],H=0;H<K;H++){var W=U[H];$.push(W.high),$.push(W.low)}return y.create($,this.sigBytes)},clone:function(){for(var U=d.clone.call(this),K=U.words=this.words.slice(0),$=K.length,H=0;H<$;H++)K[H]=K[H].clone();return U}})})(),(function(){var o=P,i=o.lib.WordArray;o.enc.Base64={stringify:function(d){var y=d.words,C=d.sigBytes,U=this._map;d.clamp(),d=[];for(var K=0;K<C;K+=3)for(var $=(y[K>>>2]>>>24-K%4*8&255)<<16|(y[K+1>>>2]>>>24-(K+1)%4*8&255)<<8|y[K+2>>>2]>>>24-(K+2)%4*8&255,H=0;4>H&&K+.75*H<C;H++)d.push(U.charAt($>>>6*(3-H)&63));if(y=U.charAt(64))for(;d.length%4;)d.push(y);return d.join("")},parse:function(d){var y=d.length,C=this._map;(U=C.charAt(64))&&(U=d.indexOf(U))!=-1&&(y=U);for(var U=[],K=0,$=0;$<y;$++)if($%4){var H=C.indexOf(d.charAt($-1))<<$%4*2,W=C.indexOf(d.charAt($))>>>6-$%4*2;U[K>>>2]|=(H|W)<<24-K%4*8,K++}return i.create(U,K)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})(),(function(o){for(var i=P,u=(y=i.lib).WordArray,d=y.Hasher,y=i.algo,C=[],U=[],K=function(fe){return 4294967296*(fe-(0|fe))|0},$=2,H=0;64>H;){var W;e:{W=$;for(var J=o.sqrt(W),te=2;te<=J;te++)if(!(W%te)){W=!1;break e}W=!0}W&&(8>H&&(C[H]=K(o.pow($,.5))),U[H]=K(o.pow($,1/3)),H++),$++}var oe=[];y=y.SHA256=d.extend({_doReset:function(){this._hash=new u.init(C.slice(0))},_doProcessBlock:function(fe,ye){for(var O=this._hash.words,z=O[0],Y=O[1],Z=O[2],de=O[3],be=O[4],Ve=O[5],Pe=O[6],Ye=O[7],$e=0;64>$e;$e++){if(16>$e)oe[$e]=0|fe[ye+$e];else{var We=oe[$e-15],lt=oe[$e-2];oe[$e]=((We<<25|We>>>7)^(We<<14|We>>>18)^We>>>3)+oe[$e-7]+((lt<<15|lt>>>17)^(lt<<13|lt>>>19)^lt>>>10)+oe[$e-16]}We=Ye+((be<<26|be>>>6)^(be<<21|be>>>11)^(be<<7|be>>>25))+(be&Ve^~be&Pe)+U[$e]+oe[$e],lt=((z<<30|z>>>2)^(z<<19|z>>>13)^(z<<10|z>>>22))+(z&Y^z&Z^Y&Z),Ye=Pe,Pe=Ve,Ve=be,be=de+We|0,de=Z,Z=Y,Y=z,z=We+lt|0}O[0]=O[0]+z|0,O[1]=O[1]+Y|0,O[2]=O[2]+Z|0,O[3]=O[3]+de|0,O[4]=O[4]+be|0,O[5]=O[5]+Ve|0,O[6]=O[6]+Pe|0,O[7]=O[7]+Ye|0},_doFinalize:function(){var fe=this._data,ye=fe.words,O=8*this._nDataBytes,z=8*fe.sigBytes;return ye[z>>>5]|=128<<24-z%32,ye[14+(z+64>>>9<<4)]=o.floor(O/4294967296),ye[15+(z+64>>>9<<4)]=O,fe.sigBytes=4*ye.length,this._process(),this._hash},clone:function(){var fe=d.clone.call(this);return fe._hash=this._hash.clone(),fe}}),i.SHA256=d._createHelper(y),i.HmacSHA256=d._createHmacHelper(y)})(Math),(function(){function o(){return d.create.apply(d,arguments)}for(var i=P,u=i.lib.Hasher,d=(C=i.x64).Word,y=C.WordArray,C=i.algo,U=[o(1116352408,3609767458),o(1899447441,602891725),o(3049323471,3964484399),o(3921009573,2173295548),o(961987163,4081628472),o(1508970993,3053834265),o(2453635748,2937671579),o(2870763221,3664609560),o(3624381080,2734883394),o(310598401,1164996542),o(607225278,1323610764),o(1426881987,3590304994),o(1925078388,4068182383),o(2162078206,991336113),o(2614888103,633803317),o(3248222580,3479774868),o(3835390401,2666613458),o(4022224774,944711139),o(264347078,2341262773),o(604807628,2007800933),o(770255983,1495990901),o(1249150122,1856431235),o(1555081692,3175218132),o(1996064986,2198950837),o(2554220882,3999719339),o(2821834349,766784016),o(2952996808,2566594879),o(3210313671,3203337956),o(3336571891,1034457026),o(3584528711,2466948901),o(113926993,3758326383),o(338241895,168717936),o(666307205,1188179964),o(773529912,1546045734),o(1294757372,1522805485),o(1396182291,2643833823),o(1695183700,2343527390),o(1986661051,1014477480),o(2177026350,1206759142),o(2456956037,344077627),o(2730485921,1290863460),o(2820302411,3158454273),o(3259730800,3505952657),o(3345764771,106217008),o(3516065817,3606008344),o(3600352804,1432725776),o(4094571909,1467031594),o(275423344,851169720),o(430227734,3100823752),o(506948616,1363258195),o(659060556,3750685593),o(883997877,3785050280),o(958139571,3318307427),o(1322822218,3812723403),o(1537002063,2003034995),o(1747873779,3602036899),o(1955562222,1575990012),o(2024104815,1125592928),o(2227730452,2716904306),o(2361852424,442776044),o(2428436474,593698344),o(2756734187,3733110249),o(3204031479,2999351573),o(3329325298,3815920427),o(3391569614,3928383900),o(3515267271,566280711),o(3940187606,3454069534),o(4118630271,4000239992),o(116418474,1914138554),o(174292421,2731055270),o(289380356,3203993006),o(460393269,320620315),o(685471733,587496836),o(852142971,1086792851),o(1017036298,365543100),o(1126000580,2618297676),o(1288033470,3409855158),o(1501505948,4234509866),o(1607167915,987167468),o(1816402316,1246189591)],K=[],$=0;80>$;$++)K[$]=o();C=C.SHA512=u.extend({_doReset:function(){this._hash=new y.init([new d.init(1779033703,4089235720),new d.init(3144134277,2227873595),new d.init(1013904242,4271175723),new d.init(2773480762,1595750129),new d.init(1359893119,2917565137),new d.init(2600822924,725511199),new d.init(528734635,4215389547),new d.init(1541459225,327033209)])},_doProcessBlock:function(W,J){for(var te=(Y=this._hash.words)[0],oe=Y[1],ue=Y[2],fe=Y[3],ye=Y[4],O=Y[5],z=Y[6],Y=Y[7],Z=te.high,de=te.low,be=oe.high,Ve=oe.low,Pe=ue.high,Ye=ue.low,$e=fe.high,We=fe.low,lt=ye.high,ht=ye.low,ct=O.high,Vt=O.low,Lt=z.high,Bt=z.low,bt=Y.high,xt=Y.low,Rt=Z,Mt=de,On=be,sn=Ve,Un=Pe,an=Ye,lo=$e,Bn=We,tr=lt,Qt=ht,yi=ct,Mn=Vt,wi=Lt,jn=Bt,uo=bt,$n=xt,rr=0;80>rr;rr++){var Hr=K[rr];if(16>rr)var gr=Hr.high=0|W[J+2*rr],dt=Hr.low=0|W[J+2*rr+1];else{gr=((dt=(gr=K[rr-15]).high)>>>1|(mr=gr.low)<<31)^(dt>>>8|mr<<24)^dt>>>7;var mr=(mr>>>1|dt<<31)^(mr>>>8|dt<<24)^(mr>>>7|dt<<25),ln=((dt=(ln=K[rr-2]).high)>>>19|(At=ln.low)<<13)^(dt<<3|At>>>29)^dt>>>6,At=(At>>>19|dt<<13)^(At<<3|dt>>>29)^(At>>>6|dt<<26),co=(dt=K[rr-7]).high,Vr=(Kr=K[rr-16]).high,Kr=Kr.low;gr=(gr=(gr=gr+co+((dt=mr+dt.low)>>>0<mr>>>0?1:0))+ln+((dt=dt+At)>>>0<At>>>0?1:0))+Vr+((dt=dt+Kr)>>>0<Kr>>>0?1:0),Hr.high=gr,Hr.low=dt}co=tr&yi^~tr&wi,Kr=Qt&Mn^~Qt&jn,Hr=Rt&On^Rt&Un^On&Un;var Pc=Mt&sn^Mt&an^sn&an,Nc=(mr=(Rt>>>28|Mt<<4)^(Rt<<30|Mt>>>2)^(Rt<<25|Mt>>>7),ln=(Mt>>>28|Rt<<4)^(Mt<<30|Rt>>>2)^(Mt<<25|Rt>>>7),(At=U[rr]).high),la=At.low;Vr=uo+((tr>>>14|Qt<<18)^(tr>>>18|Qt<<14)^(tr<<23|Qt>>>9))+((At=$n+((Qt>>>14|tr<<18)^(Qt>>>18|tr<<14)^(Qt<<23|tr>>>9)))>>>0<$n>>>0?1:0),uo=wi,$n=jn,wi=yi,jn=Mn,yi=tr,Mn=Qt,tr=lo+(Vr=(Vr=(Vr=Vr+co+((At=At+Kr)>>>0<Kr>>>0?1:0))+Nc+((At=At+la)>>>0<la>>>0?1:0))+gr+((At=At+dt)>>>0<dt>>>0?1:0))+((Qt=Bn+At|0)>>>0<Bn>>>0?1:0)|0,lo=Un,Bn=an,Un=On,an=sn,On=Rt,sn=Mt,Rt=Vr+(Hr=mr+Hr+((dt=ln+Pc)>>>0<ln>>>0?1:0))+((Mt=At+dt|0)>>>0<At>>>0?1:0)|0}de=te.low=de+Mt,te.high=Z+Rt+(de>>>0<Mt>>>0?1:0),Ve=oe.low=Ve+sn,oe.high=be+On+(Ve>>>0<sn>>>0?1:0),Ye=ue.low=Ye+an,ue.high=Pe+Un+(Ye>>>0<an>>>0?1:0),We=fe.low=We+Bn,fe.high=$e+lo+(We>>>0<Bn>>>0?1:0),ht=ye.low=ht+Qt,ye.high=lt+tr+(ht>>>0<Qt>>>0?1:0),Vt=O.low=Vt+Mn,O.high=ct+yi+(Vt>>>0<Mn>>>0?1:0),Bt=z.low=Bt+jn,z.high=Lt+wi+(Bt>>>0<jn>>>0?1:0),xt=Y.low=xt+$n,Y.high=bt+uo+(xt>>>0<$n>>>0?1:0)},_doFinalize:function(){var W=this._data,J=W.words,te=8*this._nDataBytes,oe=8*W.sigBytes;return J[oe>>>5]|=128<<24-oe%32,J[30+(oe+128>>>10<<5)]=Math.floor(te/4294967296),J[31+(oe+128>>>10<<5)]=te,W.sigBytes=4*J.length,this._process(),this._hash.toX32()},clone:function(){var W=u.clone.call(this);return W._hash=this._hash.clone(),W},blockSize:32}),i.SHA512=u._createHelper(C),i.HmacSHA512=u._createHmacHelper(C)})(),(function(){var o=P,i=(y=o.x64).Word,u=y.WordArray,d=(y=o.algo).SHA512,y=y.SHA384=d.extend({_doReset:function(){this._hash=new u.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var U=d._doFinalize.call(this);return U.sigBytes-=16,U}});o.SHA384=d._createHelper(y),o.HmacSHA384=d._createHmacHelper(y)})();var D,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function M(o){var i,u,d="";for(i=0;i+3<=o.length;i+=3)u=parseInt(o.substring(i,i+3),16),d+=j.charAt(u>>6)+j.charAt(63&u);for(i+1==o.length?(u=parseInt(o.substring(i,i+1),16),d+=j.charAt(u<<2)):i+2==o.length&&(u=parseInt(o.substring(i,i+2),16),d+=j.charAt(u>>2)+j.charAt((3&u)<<4)),"=";(3&d.length)>0;)d+="=";return d}function ne(o){var i,u,d,y="",C=0;for(i=0;i<o.length&&o.charAt(i)!="=";++i)(d=j.indexOf(o.charAt(i)))<0||(C==0?(y+=Ne(d>>2),u=3&d,C=1):C==1?(y+=Ne(u<<2|d>>4),u=15&d,C=2):C==2?(y+=Ne(u),y+=Ne(d>>2),u=3&d,C=3):(y+=Ne(u<<2|d>>4),y+=Ne(15&d),C=0));return C==1&&(y+=Ne(u<<2)),y}function ce(o){var i,u=ne(o),d=new Array;for(i=0;2*i<u.length;++i)d[i]=parseInt(u.substring(2*i,2*i+2),16);return d}function N(o,i,u){o!=null&&(typeof o=="number"?this.fromNumber(o,i,u):i==null&&typeof o!="string"?this.fromString(o,256):this.fromString(o,i))}function ee(){return new N(null)}A.appName=="Microsoft Internet Explorer"?(N.prototype.am=function(i,u,d,y,C,U){for(var K=32767&u,$=u>>15;--U>=0;){var H=32767&this[i],W=this[i++]>>15,J=$*H+W*K;C=((H=K*H+((32767&J)<<15)+d[y]+(1073741823&C))>>>30)+(J>>>15)+$*W+(C>>>30),d[y++]=1073741823&H}return C},D=30):A.appName!="Netscape"?(N.prototype.am=function(i,u,d,y,C,U){for(;--U>=0;){var K=u*this[i++]+d[y]+C;C=Math.floor(K/67108864),d[y++]=67108863&K}return C},D=26):(N.prototype.am=function(i,u,d,y,C,U){for(var K=16383&u,$=u>>14;--U>=0;){var H=16383&this[i],W=this[i++]>>14,J=$*H+W*K;C=((H=K*H+((16383&J)<<14)+d[y]+C)>>28)+(J>>14)+$*W,d[y++]=268435455&H}return C},D=28),N.prototype.DB=D,N.prototype.DM=(1<<D)-1,N.prototype.DV=1<<D,N.prototype.FV=Math.pow(2,52),N.prototype.F1=52-D,N.prototype.F2=2*D-52;var we,se,Re=new Array;for(we=48,se=0;se<=9;++se)Re[we++]=se;for(we=97,se=10;se<36;++se)Re[we++]=se;for(we=65,se=10;se<36;++se)Re[we++]=se;function Ne(o){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(o)}function Ue(o,i){var u=Re[o.charCodeAt(i)];return u??-1}function je(o){var i=ee();return i.fromInt(o),i}function me(o){var i,u=1;return(i=o>>>16)!=0&&(o=i,u+=16),(i=o>>8)!=0&&(o=i,u+=8),(i=o>>4)!=0&&(o=i,u+=4),(i=o>>2)!=0&&(o=i,u+=2),(i=o>>1)!=0&&(o=i,u+=1),u}function Ie(o){this.m=o}function G(o){this.m=o,this.mp=o.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<o.DB-15)-1,this.mt2=2*o.t}function pe(o,i){return o&i}function Ce(o,i){return o|i}function xe(o,i){return o^i}function Be(o,i){return o&~i}function He(o){if(o==0)return-1;var i=0;return(65535&o)==0&&(o>>=16,i+=16),(255&o)==0&&(o>>=8,i+=8),(15&o)==0&&(o>>=4,i+=4),(3&o)==0&&(o>>=2,i+=2),(1&o)==0&&++i,i}function ze(o){for(var i=0;o!=0;)o&=o-1,++i;return i}function Ke(){}function Ee(o){return o}function Ae(o){this.r2=ee(),this.q3=ee(),N.ONE.dlShiftTo(2*o.t,this.r2),this.mu=this.r2.divide(o),this.m=o}Ie.prototype.convert=function(i){return i.s<0||i.compareTo(this.m)>=0?i.mod(this.m):i},Ie.prototype.revert=function(i){return i},Ie.prototype.reduce=function(i){i.divRemTo(this.m,null,i)},Ie.prototype.mulTo=function(i,u,d){i.multiplyTo(u,d),this.reduce(d)},Ie.prototype.sqrTo=function(i,u){i.squareTo(u),this.reduce(u)},G.prototype.convert=function(i){var u=ee();return i.abs().dlShiftTo(this.m.t,u),u.divRemTo(this.m,null,u),i.s<0&&u.compareTo(N.ZERO)>0&&this.m.subTo(u,u),u},G.prototype.revert=function(i){var u=ee();return i.copyTo(u),this.reduce(u),u},G.prototype.reduce=function(i){for(;i.t<=this.mt2;)i[i.t++]=0;for(var u=0;u<this.m.t;++u){var d=32767&i[u],y=d*this.mpl+((d*this.mph+(i[u]>>15)*this.mpl&this.um)<<15)&i.DM;for(i[d=u+this.m.t]+=this.m.am(0,y,i,u,0,this.m.t);i[d]>=i.DV;)i[d]-=i.DV,i[++d]++}i.clamp(),i.drShiftTo(this.m.t,i),i.compareTo(this.m)>=0&&i.subTo(this.m,i)},G.prototype.mulTo=function(i,u,d){i.multiplyTo(u,d),this.reduce(d)},G.prototype.sqrTo=function(i,u){i.squareTo(u),this.reduce(u)},N.prototype.copyTo=function(i){for(var u=this.t-1;u>=0;--u)i[u]=this[u];i.t=this.t,i.s=this.s},N.prototype.fromInt=function(i){this.t=1,this.s=i<0?-1:0,i>0?this[0]=i:i<-1?this[0]=i+this.DV:this.t=0},N.prototype.fromString=function(i,u){var d;if(u==16)d=4;else if(u==8)d=3;else if(u==256)d=8;else if(u==2)d=1;else if(u==32)d=5;else{if(u!=4)return void this.fromRadix(i,u);d=2}this.t=0,this.s=0;for(var y=i.length,C=!1,U=0;--y>=0;){var K=d==8?255&i[y]:Ue(i,y);K<0?i.charAt(y)=="-"&&(C=!0):(C=!1,U==0?this[this.t++]=K:U+d>this.DB?(this[this.t-1]|=(K&(1<<this.DB-U)-1)<<U,this[this.t++]=K>>this.DB-U):this[this.t-1]|=K<<U,(U+=d)>=this.DB&&(U-=this.DB))}d==8&&(128&i[0])!=0&&(this.s=-1,U>0&&(this[this.t-1]|=(1<<this.DB-U)-1<<U)),this.clamp(),C&&N.ZERO.subTo(this,this)},N.prototype.clamp=function(){for(var i=this.s&this.DM;this.t>0&&this[this.t-1]==i;)--this.t},N.prototype.dlShiftTo=function(i,u){var d;for(d=this.t-1;d>=0;--d)u[d+i]=this[d];for(d=i-1;d>=0;--d)u[d]=0;u.t=this.t+i,u.s=this.s},N.prototype.drShiftTo=function(i,u){for(var d=i;d<this.t;++d)u[d-i]=this[d];u.t=Math.max(this.t-i,0),u.s=this.s},N.prototype.lShiftTo=function(i,u){var d,y=i%this.DB,C=this.DB-y,U=(1<<C)-1,K=Math.floor(i/this.DB),$=this.s<<y&this.DM;for(d=this.t-1;d>=0;--d)u[d+K+1]=this[d]>>C|$,$=(this[d]&U)<<y;for(d=K-1;d>=0;--d)u[d]=0;u[K]=$,u.t=this.t+K+1,u.s=this.s,u.clamp()},N.prototype.rShiftTo=function(i,u){u.s=this.s;var d=Math.floor(i/this.DB);if(d>=this.t)u.t=0;else{var y=i%this.DB,C=this.DB-y,U=(1<<y)-1;u[0]=this[d]>>y;for(var K=d+1;K<this.t;++K)u[K-d-1]|=(this[K]&U)<<C,u[K-d]=this[K]>>y;y>0&&(u[this.t-d-1]|=(this.s&U)<<C),u.t=this.t-d,u.clamp()}},N.prototype.subTo=function(i,u){for(var d=0,y=0,C=Math.min(i.t,this.t);d<C;)y+=this[d]-i[d],u[d++]=y&this.DM,y>>=this.DB;if(i.t<this.t){for(y-=i.s;d<this.t;)y+=this[d],u[d++]=y&this.DM,y>>=this.DB;y+=this.s}else{for(y+=this.s;d<i.t;)y-=i[d],u[d++]=y&this.DM,y>>=this.DB;y-=i.s}u.s=y<0?-1:0,y<-1?u[d++]=this.DV+y:y>0&&(u[d++]=y),u.t=d,u.clamp()},N.prototype.multiplyTo=function(i,u){var d=this.abs(),y=i.abs(),C=d.t;for(u.t=C+y.t;--C>=0;)u[C]=0;for(C=0;C<y.t;++C)u[C+d.t]=d.am(0,y[C],u,C,0,d.t);u.s=0,u.clamp(),this.s!=i.s&&N.ZERO.subTo(u,u)},N.prototype.squareTo=function(i){for(var u=this.abs(),d=i.t=2*u.t;--d>=0;)i[d]=0;for(d=0;d<u.t-1;++d){var y=u.am(d,u[d],i,2*d,0,1);(i[d+u.t]+=u.am(d+1,2*u[d],i,2*d+1,y,u.t-d-1))>=u.DV&&(i[d+u.t]-=u.DV,i[d+u.t+1]=1)}i.t>0&&(i[i.t-1]+=u.am(d,u[d],i,2*d,0,1)),i.s=0,i.clamp()},N.prototype.divRemTo=function(i,u,d){var y=i.abs();if(!(y.t<=0)){var C=this.abs();if(C.t<y.t)return u?.fromInt(0),void(d!=null&&this.copyTo(d));d==null&&(d=ee());var U=ee(),K=this.s,$=i.s,H=this.DB-me(y[y.t-1]);H>0?(y.lShiftTo(H,U),C.lShiftTo(H,d)):(y.copyTo(U),C.copyTo(d));var W=U.t,J=U[W-1];if(J!=0){var te=J*(1<<this.F1)+(W>1?U[W-2]>>this.F2:0),oe=this.FV/te,ue=(1<<this.F1)/te,fe=1<<this.F2,ye=d.t,O=ye-W,z=u??ee();for(U.dlShiftTo(O,z),d.compareTo(z)>=0&&(d[d.t++]=1,d.subTo(z,d)),N.ONE.dlShiftTo(W,z),z.subTo(U,U);U.t<W;)U[U.t++]=0;for(;--O>=0;){var Y=d[--ye]==J?this.DM:Math.floor(d[ye]*oe+(d[ye-1]+fe)*ue);if((d[ye]+=U.am(0,Y,d,O,0,W))<Y)for(U.dlShiftTo(O,z),d.subTo(z,d);d[ye]<--Y;)d.subTo(z,d)}u!=null&&(d.drShiftTo(W,u),K!=$&&N.ZERO.subTo(u,u)),d.t=W,d.clamp(),H>0&&d.rShiftTo(H,d),K<0&&N.ZERO.subTo(d,d)}}},N.prototype.invDigit=function(){if(this.t<1)return 0;var i=this[0];if((1&i)==0)return 0;var u=3&i;return(u=(u=(u=(u=u*(2-(15&i)*u)&15)*(2-(255&i)*u)&255)*(2-((65535&i)*u&65535))&65535)*(2-i*u%this.DV)%this.DV)>0?this.DV-u:-u},N.prototype.isEven=function(){return(this.t>0?1&this[0]:this.s)==0},N.prototype.exp=function(i,u){if(i>4294967295||i<1)return N.ONE;var d=ee(),y=ee(),C=u.convert(this),U=me(i)-1;for(C.copyTo(d);--U>=0;)if(u.sqrTo(d,y),(i&1<<U)>0)u.mulTo(y,C,d);else{var K=d;d=y,y=K}return u.revert(d)},N.prototype.toString=function(i){if(this.s<0)return"-"+this.negate().toString(i);var u;if(i==16)u=4;else if(i==8)u=3;else if(i==2)u=1;else if(i==32)u=5;else{if(i!=4)return this.toRadix(i);u=2}var d,y=(1<<u)-1,C=!1,U="",K=this.t,$=this.DB-K*this.DB%u;if(K-- >0)for($<this.DB&&(d=this[K]>>$)>0&&(C=!0,U=Ne(d));K>=0;)$<u?(d=(this[K]&(1<<$)-1)<<u-$,d|=this[--K]>>($+=this.DB-u)):(d=this[K]>>($-=u)&y,$<=0&&($+=this.DB,--K)),d>0&&(C=!0),C&&(U+=Ne(d));return C?U:"0"},N.prototype.negate=function(){var i=ee();return N.ZERO.subTo(this,i),i},N.prototype.abs=function(){return this.s<0?this.negate():this},N.prototype.compareTo=function(i){var u=this.s-i.s;if(u!=0)return u;var d=this.t;if((u=d-i.t)!=0)return this.s<0?-u:u;for(;--d>=0;)if((u=this[d]-i[d])!=0)return u;return 0},N.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+me(this[this.t-1]^this.s&this.DM)},N.prototype.mod=function(i){var u=ee();return this.abs().divRemTo(i,null,u),this.s<0&&u.compareTo(N.ZERO)>0&&i.subTo(u,u),u},N.prototype.modPowInt=function(i,u){var d;return d=i<256||u.isEven()?new Ie(u):new G(u),this.exp(i,d)},N.ZERO=je(0),N.ONE=je(1),Ke.prototype.convert=Ee,Ke.prototype.revert=Ee,Ke.prototype.mulTo=function(i,u,d){i.multiplyTo(u,d)},Ke.prototype.sqrTo=function(i,u){i.squareTo(u)},Ae.prototype.convert=function(i){if(i.s<0||i.t>2*this.m.t)return i.mod(this.m);if(i.compareTo(this.m)<0)return i;var u=ee();return i.copyTo(u),this.reduce(u),u},Ae.prototype.revert=function(i){return i},Ae.prototype.reduce=function(i){for(i.drShiftTo(this.m.t-1,this.r2),i.t>this.m.t+1&&(i.t=this.m.t+1,i.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);i.compareTo(this.r2)<0;)i.dAddOffset(1,this.m.t+1);for(i.subTo(this.r2,i);i.compareTo(this.m)>=0;)i.subTo(this.m,i)},Ae.prototype.mulTo=function(i,u,d){i.multiplyTo(u,d),this.reduce(d)},Ae.prototype.sqrTo=function(i,u){i.squareTo(u),this.reduce(u)};var ke=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],q=(1<<26)/ke[ke.length-1];function R(){this.i=0,this.j=0,this.S=new Array}N.prototype.chunkSize=function(i){return Math.floor(Math.LN2*this.DB/Math.log(i))},N.prototype.toRadix=function(i){if(i==null&&(i=10),this.signum()==0||i<2||i>36)return"0";var u=this.chunkSize(i),d=Math.pow(i,u),y=je(d),C=ee(),U=ee(),K="";for(this.divRemTo(y,C,U);C.signum()>0;)K=(d+U.intValue()).toString(i).substr(1)+K,C.divRemTo(y,C,U);return U.intValue().toString(i)+K},N.prototype.fromRadix=function(i,u){this.fromInt(0),u==null&&(u=10);for(var d=this.chunkSize(u),y=Math.pow(u,d),C=!1,U=0,K=0,$=0;$<i.length;++$){var H=Ue(i,$);H<0?i.charAt($)=="-"&&this.signum()==0&&(C=!0):(K=u*K+H,++U>=d&&(this.dMultiply(y),this.dAddOffset(K,0),U=0,K=0))}U>0&&(this.dMultiply(Math.pow(u,U)),this.dAddOffset(K,0)),C&&N.ZERO.subTo(this,this)},N.prototype.fromNumber=function(i,u,d){if(typeof u=="number")if(i<2)this.fromInt(1);else for(this.fromNumber(i,d),this.testBit(i-1)||this.bitwiseTo(N.ONE.shiftLeft(i-1),Ce,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(u);)this.dAddOffset(2,0),this.bitLength()>i&&this.subTo(N.ONE.shiftLeft(i-1),this);else{var y=new Array,C=7&i;y.length=1+(i>>3),u.nextBytes(y),C>0?y[0]&=(1<<C)-1:y[0]=0,this.fromString(y,256)}},N.prototype.bitwiseTo=function(i,u,d){var y,C,U=Math.min(i.t,this.t);for(y=0;y<U;++y)d[y]=u(this[y],i[y]);if(i.t<this.t){for(C=i.s&this.DM,y=U;y<this.t;++y)d[y]=u(this[y],C);d.t=this.t}else{for(C=this.s&this.DM,y=U;y<i.t;++y)d[y]=u(C,i[y]);d.t=i.t}d.s=u(this.s,i.s),d.clamp()},N.prototype.changeBit=function(i,u){var d=N.ONE.shiftLeft(i);return this.bitwiseTo(d,u,d),d},N.prototype.addTo=function(i,u){for(var d=0,y=0,C=Math.min(i.t,this.t);d<C;)y+=this[d]+i[d],u[d++]=y&this.DM,y>>=this.DB;if(i.t<this.t){for(y+=i.s;d<this.t;)y+=this[d],u[d++]=y&this.DM,y>>=this.DB;y+=this.s}else{for(y+=this.s;d<i.t;)y+=i[d],u[d++]=y&this.DM,y>>=this.DB;y+=i.s}u.s=y<0?-1:0,y>0?u[d++]=y:y<-1&&(u[d++]=this.DV+y),u.t=d,u.clamp()},N.prototype.dMultiply=function(i){this[this.t]=this.am(0,i-1,this,0,0,this.t),++this.t,this.clamp()},N.prototype.dAddOffset=function(i,u){if(i!=0){for(;this.t<=u;)this[this.t++]=0;for(this[u]+=i;this[u]>=this.DV;)this[u]-=this.DV,++u>=this.t&&(this[this.t++]=0),++this[u]}},N.prototype.multiplyLowerTo=function(i,u,d){var y,C=Math.min(this.t+i.t,u);for(d.s=0,d.t=C;C>0;)d[--C]=0;for(y=d.t-this.t;C<y;++C)d[C+this.t]=this.am(0,i[C],d,C,0,this.t);for(y=Math.min(i.t,u);C<y;++C)this.am(0,i[C],d,C,0,u-C);d.clamp()},N.prototype.multiplyUpperTo=function(i,u,d){--u;var y=d.t=this.t+i.t-u;for(d.s=0;--y>=0;)d[y]=0;for(y=Math.max(u-this.t,0);y<i.t;++y)d[this.t+y-u]=this.am(u-y,i[y],d,0,0,this.t+y-u);d.clamp(),d.drShiftTo(1,d)},N.prototype.modInt=function(i){if(i<=0)return 0;var u=this.DV%i,d=this.s<0?i-1:0;if(this.t>0)if(u==0)d=this[0]%i;else for(var y=this.t-1;y>=0;--y)d=(u*d+this[y])%i;return d},N.prototype.millerRabin=function(i){var u=this.subtract(N.ONE),d=u.getLowestSetBit();if(d<=0)return!1;var y=u.shiftRight(d);(i=i+1>>1)>ke.length&&(i=ke.length);for(var C=ee(),U=0;U<i;++U){C.fromInt(ke[Math.floor(Math.random()*ke.length)]);var K=C.modPow(y,this);if(K.compareTo(N.ONE)!=0&&K.compareTo(u)!=0){for(var $=1;$++<d&&K.compareTo(u)!=0;)if((K=K.modPowInt(2,this)).compareTo(N.ONE)==0)return!1;if(K.compareTo(u)!=0)return!1}}return!0},N.prototype.clone=function(){var i=ee();return this.copyTo(i),i},N.prototype.intValue=function(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},N.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24},N.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16},N.prototype.signum=function(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1},N.prototype.toByteArray=function(){var i=this.t,u=new Array;u[0]=this.s;var d,y=this.DB-i*this.DB%8,C=0;if(i-- >0)for(y<this.DB&&(d=this[i]>>y)!=(this.s&this.DM)>>y&&(u[C++]=d|this.s<<this.DB-y);i>=0;)y<8?(d=(this[i]&(1<<y)-1)<<8-y,d|=this[--i]>>(y+=this.DB-8)):(d=this[i]>>(y-=8)&255,y<=0&&(y+=this.DB,--i)),(128&d)!=0&&(d|=-256),C==0&&(128&this.s)!=(128&d)&&++C,(C>0||d!=this.s)&&(u[C++]=d);return u},N.prototype.equals=function(i){return this.compareTo(i)==0},N.prototype.min=function(i){return this.compareTo(i)<0?this:i},N.prototype.max=function(i){return this.compareTo(i)>0?this:i},N.prototype.and=function(i){var u=ee();return this.bitwiseTo(i,pe,u),u},N.prototype.or=function(i){var u=ee();return this.bitwiseTo(i,Ce,u),u},N.prototype.xor=function(i){var u=ee();return this.bitwiseTo(i,xe,u),u},N.prototype.andNot=function(i){var u=ee();return this.bitwiseTo(i,Be,u),u},N.prototype.not=function(){for(var i=ee(),u=0;u<this.t;++u)i[u]=this.DM&~this[u];return i.t=this.t,i.s=~this.s,i},N.prototype.shiftLeft=function(i){var u=ee();return i<0?this.rShiftTo(-i,u):this.lShiftTo(i,u),u},N.prototype.shiftRight=function(i){var u=ee();return i<0?this.lShiftTo(-i,u):this.rShiftTo(i,u),u},N.prototype.getLowestSetBit=function(){for(var i=0;i<this.t;++i)if(this[i]!=0)return i*this.DB+He(this[i]);return this.s<0?this.t*this.DB:-1},N.prototype.bitCount=function(){for(var i=0,u=this.s&this.DM,d=0;d<this.t;++d)i+=ze(this[d]^u);return i},N.prototype.testBit=function(i){var u=Math.floor(i/this.DB);return u>=this.t?this.s!=0:(this[u]&1<<i%this.DB)!=0},N.prototype.setBit=function(i){return this.changeBit(i,Ce)},N.prototype.clearBit=function(i){return this.changeBit(i,Be)},N.prototype.flipBit=function(i){return this.changeBit(i,xe)},N.prototype.add=function(i){var u=ee();return this.addTo(i,u),u},N.prototype.subtract=function(i){var u=ee();return this.subTo(i,u),u},N.prototype.multiply=function(i){var u=ee();return this.multiplyTo(i,u),u},N.prototype.divide=function(i){var u=ee();return this.divRemTo(i,u,null),u},N.prototype.remainder=function(i){var u=ee();return this.divRemTo(i,null,u),u},N.prototype.divideAndRemainder=function(i){var u=ee(),d=ee();return this.divRemTo(i,u,d),new Array(u,d)},N.prototype.modPow=function(i,u){var d,y,C=i.bitLength(),U=je(1);if(C<=0)return U;d=C<18?1:C<48?3:C<144?4:C<768?5:6,y=C<8?new Ie(u):u.isEven()?new Ae(u):new G(u);var K=new Array,$=3,H=d-1,W=(1<<d)-1;if(K[1]=y.convert(this),d>1){var J=ee();for(y.sqrTo(K[1],J);$<=W;)K[$]=ee(),y.mulTo(J,K[$-2],K[$]),$+=2}var te,oe,ue=i.t-1,fe=!0,ye=ee();for(C=me(i[ue])-1;ue>=0;){for(C>=H?te=i[ue]>>C-H&W:(te=(i[ue]&(1<<C+1)-1)<<H-C,ue>0&&(te|=i[ue-1]>>this.DB+C-H)),$=d;(1&te)==0;)te>>=1,--$;if((C-=$)<0&&(C+=this.DB,--ue),fe)K[te].copyTo(U),fe=!1;else{for(;$>1;)y.sqrTo(U,ye),y.sqrTo(ye,U),$-=2;$>0?y.sqrTo(U,ye):(oe=U,U=ye,ye=oe),y.mulTo(ye,K[te],U)}for(;ue>=0&&(i[ue]&1<<C)==0;)y.sqrTo(U,ye),oe=U,U=ye,ye=oe,--C<0&&(C=this.DB-1,--ue)}return y.revert(U)},N.prototype.modInverse=function(i){var u=i.isEven();if(this.isEven()&&u||i.signum()==0)return N.ZERO;for(var d=i.clone(),y=this.clone(),C=je(1),U=je(0),K=je(0),$=je(1);d.signum()!=0;){for(;d.isEven();)d.rShiftTo(1,d),u?(C.isEven()&&U.isEven()||(C.addTo(this,C),U.subTo(i,U)),C.rShiftTo(1,C)):U.isEven()||U.subTo(i,U),U.rShiftTo(1,U);for(;y.isEven();)y.rShiftTo(1,y),u?(K.isEven()&&$.isEven()||(K.addTo(this,K),$.subTo(i,$)),K.rShiftTo(1,K)):$.isEven()||$.subTo(i,$),$.rShiftTo(1,$);d.compareTo(y)>=0?(d.subTo(y,d),u&&C.subTo(K,C),U.subTo($,U)):(y.subTo(d,y),u&&K.subTo(C,K),$.subTo(U,$))}return y.compareTo(N.ONE)!=0?N.ZERO:$.compareTo(i)>=0?$.subtract(i):$.signum()<0?($.addTo(i,$),$.signum()<0?$.add(i):$):$},N.prototype.pow=function(i){return this.exp(i,new Ke)},N.prototype.gcd=function(i){var u=this.s<0?this.negate():this.clone(),d=i.s<0?i.negate():i.clone();if(u.compareTo(d)<0){var y=u;u=d,d=y}var C=u.getLowestSetBit(),U=d.getLowestSetBit();if(U<0)return u;for(C<U&&(U=C),U>0&&(u.rShiftTo(U,u),d.rShiftTo(U,d));u.signum()>0;)(C=u.getLowestSetBit())>0&&u.rShiftTo(C,u),(C=d.getLowestSetBit())>0&&d.rShiftTo(C,d),u.compareTo(d)>=0?(u.subTo(d,u),u.rShiftTo(1,u)):(d.subTo(u,d),d.rShiftTo(1,d));return U>0&&d.lShiftTo(U,d),d},N.prototype.isProbablePrime=function(i){var u,d=this.abs();if(d.t==1&&d[0]<=ke[ke.length-1]){for(u=0;u<ke.length;++u)if(d[0]==ke[u])return!0;return!1}if(d.isEven())return!1;for(u=1;u<ke.length;){for(var y=ke[u],C=u+1;C<ke.length&&y<q;)y*=ke[C++];for(y=d.modInt(y);u<C;)if(y%ke[u++]==0)return!1}return d.millerRabin(i)},N.prototype.square=function(){var i=ee();return this.squareTo(i),i},R.prototype.init=function(i){var u,d,y;for(u=0;u<256;++u)this.S[u]=u;for(d=0,u=0;u<256;++u)d=d+this.S[u]+i[u%i.length]&255,y=this.S[u],this.S[u]=this.S[d],this.S[d]=y;this.i=0,this.j=0},R.prototype.next=function(){var i;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,i=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=i,this.S[i+this.S[this.i]&255]};var m,k,B;function X(){(function(i){k[B++]^=255&i,k[B++]^=i>>8&255,k[B++]^=i>>16&255,k[B++]^=i>>24&255,B>=256&&(B-=256)})(new Date().getTime())}if(k==null){var ie;if(k=new Array,B=0,T!==void 0&&(T.crypto!==void 0||T.msCrypto!==void 0)){var ge=T.crypto||T.msCrypto;if(ge.getRandomValues){var re=new Uint8Array(32);for(ge.getRandomValues(re),ie=0;ie<32;++ie)k[B++]=re[ie]}else if(A.appName=="Netscape"&&A.appVersion<"5"){var ve=T.crypto.random(32);for(ie=0;ie<ve.length;++ie)k[B++]=255&ve.charCodeAt(ie)}}for(;B<256;)ie=Math.floor(65536*Math.random()),k[B++]=ie>>>8,k[B++]=255&ie;B=0,X()}function Fe(){if(m==null){for(X(),(m=(function(){return new R})()).init(k),B=0;B<k.length;++B)k[B]=0;B=0}return m.next()}function _e(){}function Me(o,i){return new N(o,i)}function et(o,i,u){for(var d="",y=0;d.length<i;)d+=u(String.fromCharCode.apply(String,o.concat([(4278190080&y)>>24,(16711680&y)>>16,(65280&y)>>8,255&y]))),y+=1;return d}function Oe(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Je(o,i){this.x=i,this.q=o}function L(o,i,u,d){this.curve=o,this.x=i,this.y=u,this.z=d??N.ONE,this.zinv=null}function w(o,i,u){this.q=o,this.a=this.fromBigInteger(i),this.b=this.fromBigInteger(u),this.infinity=new L(this,null,null)}_e.prototype.nextBytes=function(i){var u;for(u=0;u<i.length;++u)i[u]=Fe()},Oe.prototype.doPublic=function(i){return i.modPowInt(this.e,this.n)},Oe.prototype.setPublic=function(i,u){if(this.isPublic=!0,this.isPrivate=!1,typeof i!="string")this.n=i,this.e=u;else{if(!(i!=null&&u!=null&&i.length>0&&u.length>0))throw"Invalid RSA public key";this.n=Me(i,16),this.e=parseInt(u,16)}},Oe.prototype.encrypt=function(i){var u=(function(U,K){if(K<U.length+11)throw"Message too long for RSA";for(var $=new Array,H=U.length-1;H>=0&&K>0;){var W=U.charCodeAt(H--);W<128?$[--K]=W:W>127&&W<2048?($[--K]=63&W|128,$[--K]=W>>6|192):($[--K]=63&W|128,$[--K]=W>>6&63|128,$[--K]=W>>12|224)}$[--K]=0;for(var J=new _e,te=new Array;K>2;){for(te[0]=0;te[0]==0;)J.nextBytes(te);$[--K]=te[0]}return $[--K]=2,$[--K]=0,new N($)})(i,this.n.bitLength()+7>>3);if(u==null)return null;var d=this.doPublic(u);if(d==null)return null;var y=d.toString(16);return(1&y.length)==0?y:"0"+y},Oe.prototype.encryptOAEP=function(i,u,d){var y=(function($,H,W,J){var te=v.crypto.MessageDigest,oe=v.crypto.Util,ue=null;if(W||(W="sha1"),typeof W=="string"&&(ue=te.getCanonicalAlgName(W),J=te.getHashLength(ue),W=function(Pe){return $t(oe.hashHex(Ht(Pe),ue))}),$.length+2*J+2>H)throw"Message too long for RSA";var fe,ye="";for(fe=0;fe<H-$.length-2*J-2;fe+=1)ye+="\0";var O=W("")+ye+""+$,z=new Array(J);new _e().nextBytes(z);var Y=et(z,O.length,W),Z=[];for(fe=0;fe<O.length;fe+=1)Z[fe]=O.charCodeAt(fe)^Y.charCodeAt(fe);var de=et(Z,z.length,W),be=[0];for(fe=0;fe<z.length;fe+=1)be[fe+1]=z[fe]^de.charCodeAt(fe);return new N(be.concat(Z))})(i,this.n.bitLength()+7>>3,u,d);if(y==null)return null;var C=this.doPublic(y);if(C==null)return null;var U=C.toString(16);return(1&U.length)==0?U:"0"+U},Oe.prototype.type="RSA",Je.prototype.equals=function(i){return i==this||this.q.equals(i.q)&&this.x.equals(i.x)},Je.prototype.toBigInteger=function(){return this.x},Je.prototype.negate=function(){return new Je(this.q,this.x.negate().mod(this.q))},Je.prototype.add=function(i){return new Je(this.q,this.x.add(i.toBigInteger()).mod(this.q))},Je.prototype.subtract=function(i){return new Je(this.q,this.x.subtract(i.toBigInteger()).mod(this.q))},Je.prototype.multiply=function(i){return new Je(this.q,this.x.multiply(i.toBigInteger()).mod(this.q))},Je.prototype.square=function(){return new Je(this.q,this.x.square().mod(this.q))},Je.prototype.divide=function(i){return new Je(this.q,this.x.multiply(i.toBigInteger().modInverse(this.q)).mod(this.q))},L.prototype.getX=function(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},L.prototype.getY=function(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},L.prototype.equals=function(i){return i==this||(this.isInfinity()?i.isInfinity():i.isInfinity()?this.isInfinity():!!i.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(i.z)).mod(this.curve.q).equals(N.ZERO)&&i.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(i.z)).mod(this.curve.q).equals(N.ZERO))},L.prototype.isInfinity=function(){return this.x==null&&this.y==null||this.z.equals(N.ZERO)&&!this.y.toBigInteger().equals(N.ZERO)},L.prototype.negate=function(){return new L(this.curve,this.x,this.y.negate(),this.z)},L.prototype.add=function(i){if(this.isInfinity())return i;if(i.isInfinity())return this;var u=i.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(i.z)).mod(this.curve.q),d=i.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(i.z)).mod(this.curve.q);if(N.ZERO.equals(d))return N.ZERO.equals(u)?this.twice():this.curve.getInfinity();var y=new N("3"),C=this.x.toBigInteger(),U=this.y.toBigInteger(),K=(i.x.toBigInteger(),i.y.toBigInteger(),d.square()),$=K.multiply(d),H=C.multiply(K),W=u.square().multiply(this.z),J=W.subtract(H.shiftLeft(1)).multiply(i.z).subtract($).multiply(d).mod(this.curve.q),te=H.multiply(y).multiply(u).subtract(U.multiply($)).subtract(W.multiply(u)).multiply(i.z).add(u.multiply($)).mod(this.curve.q),oe=$.multiply(this.z).multiply(i.z).mod(this.curve.q);return new L(this.curve,this.curve.fromBigInteger(J),this.curve.fromBigInteger(te),oe)},L.prototype.twice=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var i=new N("3"),u=this.x.toBigInteger(),d=this.y.toBigInteger(),y=d.multiply(this.z),C=y.multiply(d).mod(this.curve.q),U=this.curve.a.toBigInteger(),K=u.square().multiply(i);N.ZERO.equals(U)||(K=K.add(this.z.square().multiply(U)));var $=(K=K.mod(this.curve.q)).square().subtract(u.shiftLeft(3).multiply(C)).shiftLeft(1).multiply(y).mod(this.curve.q),H=K.multiply(i).multiply(u).subtract(C.shiftLeft(1)).shiftLeft(2).multiply(C).subtract(K.square().multiply(K)).mod(this.curve.q),W=y.square().multiply(y).shiftLeft(3).mod(this.curve.q);return new L(this.curve,this.curve.fromBigInteger($),this.curve.fromBigInteger(H),W)},L.prototype.multiply=function(i){if(this.isInfinity())return this;if(i.signum()==0)return this.curve.getInfinity();var u,d=i,y=d.multiply(new N("3")),C=this.negate(),U=this,K=this.curve.q.subtract(i),$=K.multiply(new N("3")),H=new L(this.curve,this.x,this.y),W=H.negate();for(u=y.bitLength()-2;u>0;--u){U=U.twice();var J=y.testBit(u);J!=d.testBit(u)&&(U=U.add(J?this:C))}for(u=$.bitLength()-2;u>0;--u){H=H.twice();var te=$.testBit(u);te!=K.testBit(u)&&(H=H.add(te?H:W))}return U},L.prototype.multiplyTwo=function(i,u,d){var y;y=i.bitLength()>d.bitLength()?i.bitLength()-1:d.bitLength()-1;for(var C=this.curve.getInfinity(),U=this.add(u);y>=0;)C=C.twice(),i.testBit(y)?C=d.testBit(y)?C.add(U):C.add(this):d.testBit(y)&&(C=C.add(u)),--y;return C},w.prototype.getQ=function(){return this.q},w.prototype.getA=function(){return this.a},w.prototype.getB=function(){return this.b},w.prototype.equals=function(i){return i==this||this.q.equals(i.q)&&this.a.equals(i.a)&&this.b.equals(i.b)},w.prototype.getInfinity=function(){return this.infinity},w.prototype.fromBigInteger=function(i){return new Je(this.q,i)},w.prototype.decodePointHex=function(i){switch(parseInt(i.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var u=(i.length-2)/2,d=i.substr(2,u),y=i.substr(u+2,u);return new L(this,this.fromBigInteger(new N(d,16)),this.fromBigInteger(new N(y,16)));default:return null}},Je.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},L.prototype.getEncoded=function(o){var i=function(U,K){var $=U.toByteArrayUnsigned();if(K<$.length)$=$.slice($.length-K);else for(;K>$.length;)$.unshift(0);return $},u=this.getX().toBigInteger(),d=this.getY().toBigInteger(),y=i(u,32);return o?d.isEven()?y.unshift(2):y.unshift(3):(y.unshift(4),y=y.concat(i(d,32))),y},L.decodeFrom=function(o,i){i[0];var u=i.length-1,d=i.slice(1,1+u/2),y=i.slice(1+u/2,1+u);d.unshift(0),y.unshift(0);var C=new N(d),U=new N(y);return new L(o,o.fromBigInteger(C),o.fromBigInteger(U))},L.decodeFromHex=function(o,i){i.substr(0,2);var u=i.length-2,d=i.substr(2,u/2),y=i.substr(2+u/2,u/2),C=new N(d,16),U=new N(y,16);return new L(o,o.fromBigInteger(C),o.fromBigInteger(U))},L.prototype.add2D=function(o){if(this.isInfinity())return o;if(o.isInfinity())return this;if(this.x.equals(o.x))return this.y.equals(o.y)?this.twice():this.curve.getInfinity();var i=o.x.subtract(this.x),u=o.y.subtract(this.y).divide(i),d=u.square().subtract(this.x).subtract(o.x),y=u.multiply(this.x.subtract(d)).subtract(this.y);return new L(this.curve,d,y)},L.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var o=this.curve.fromBigInteger(N.valueOf(2)),i=this.curve.fromBigInteger(N.valueOf(3)),u=this.x.square().multiply(i).add(this.curve.a).divide(this.y.multiply(o)),d=u.square().subtract(this.x.multiply(o)),y=u.multiply(this.x.subtract(d)).subtract(this.y);return new L(this.curve,d,y)},L.prototype.multiply2D=function(o){if(this.isInfinity())return this;if(o.signum()==0)return this.curve.getInfinity();var i,u=o,d=u.multiply(new N("3")),y=this.negate(),C=this;for(i=d.bitLength()-2;i>0;--i){C=C.twice();var U=d.testBit(i);U!=u.testBit(i)&&(C=C.add2D(U?this:y))}return C},L.prototype.isOnCurve=function(){var o=this.getX().toBigInteger(),i=this.getY().toBigInteger(),u=this.curve.getA().toBigInteger(),d=this.curve.getB().toBigInteger(),y=this.curve.getQ(),C=i.multiply(i).mod(y),U=o.multiply(o).multiply(o).add(u.multiply(o)).add(d).mod(y);return C.equals(U)},L.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},L.prototype.validate=function(){var o=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var i=this.getX().toBigInteger(),u=this.getY().toBigInteger();if(i.compareTo(N.ONE)<0||i.compareTo(o.subtract(N.ONE))>0)throw new Error("x coordinate out of bounds");if(u.compareTo(N.ONE)<0||u.compareTo(o.subtract(N.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(o).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var E=(function(){var o=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),i=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),u={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function d(U,K,$){return K?u[K]:String.fromCharCode(parseInt($,16))}var y=new String(""),C=Object.hasOwnProperty;return function(U,K){var $,H,W=U.match(o),J=W[0],te=!1;J==="{"?$={}:J==="["?$=[]:($=[],te=!0);for(var oe=[$],ue=1-te,fe=W.length;ue<fe;++ue){var ye;switch((J=W[ue]).charCodeAt(0)){default:(ye=oe[0])[H||ye.length]=+J,H=void 0;break;case 34:if((J=J.substring(1,J.length-1)).indexOf("\\")!==-1&&(J=J.replace(i,d)),ye=oe[0],!H){if(!(ye instanceof Array)){H=J||y;break}H=ye.length}ye[H]=J,H=void 0;break;case 91:ye=oe[0],oe.unshift(ye[H||ye.length]=[]),H=void 0;break;case 93:oe.shift();break;case 102:(ye=oe[0])[H||ye.length]=!1,H=void 0;break;case 110:(ye=oe[0])[H||ye.length]=null,H=void 0;break;case 116:(ye=oe[0])[H||ye.length]=!0,H=void 0;break;case 123:ye=oe[0],oe.unshift(ye[H||ye.length]={}),H=void 0;break;case 125:oe.shift()}}if(te){if(oe.length!==1)throw new Error;$=$[0]}else if(oe.length)throw new Error;return K&&($=(function O(z,Y){var Z=z[Y];if(Z&&(Z===void 0?"undefined":b(Z))==="object"){var de=null;for(var be in Z)if(C.call(Z,be)&&Z!==z){var Ve=O(Z,be);Ve!==void 0?Z[be]=Ve:(de||(de=[]),de.push(be))}if(de)for(var Pe=de.length;--Pe>=0;)delete Z[de[Pe]]}return K.call(z,Y,Z)})({"":$},"")),$}})();v!==void 0&&v||(n.KJUR=v={}),v.asn1!==void 0&&v.asn1||(v.asn1={}),v.asn1.ASN1Util=new function(){this.integerToByteHex=function(o){var i=o.toString(16);return i.length%2==1&&(i="0"+i),i},this.bigIntToMinTwosComplementsHex=function(o){var i=o.toString(16);if(i.substr(0,1)!="-")i.length%2==1?i="0"+i:i.match(/^[0-7]/)||(i="00"+i);else{var u=i.substr(1).length;u%2==1?u+=1:i.match(/^[0-7]/)||(u+=2);for(var d="",y=0;y<u;y++)d+="f";i=new N(d,16).xor(o).add(N.ONE).toString(16).replace(/^-/,"")}return i},this.getPEMStringFromHex=function(o,i){return Le(o,i)},this.newObject=function(o){var i=v.asn1,u=i.ASN1Object,d=i.DERBoolean,y=i.DERInteger,C=i.DERBitString,U=i.DEROctetString,K=i.DERNull,$=i.DERObjectIdentifier,H=i.DEREnumerated,W=i.DERUTF8String,J=i.DERNumericString,te=i.DERPrintableString,oe=i.DERTeletexString,ue=i.DERIA5String,fe=i.DERUTCTime,ye=i.DERGeneralizedTime,O=i.DERVisibleString,z=i.DERBMPString,Y=i.DERSequence,Z=i.DERSet,de=i.DERTaggedObject,be=i.ASN1Util.newObject;if(o instanceof i.ASN1Object)return o;var Ve=Object.keys(o);if(Ve.length!=1)throw new Error("key of param shall be only one.");var Pe=Ve[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+Pe+":")==-1)throw new Error("undefined key: "+Pe);if(Pe=="bool")return new d(o[Pe]);if(Pe=="int")return new y(o[Pe]);if(Pe=="bitstr")return new C(o[Pe]);if(Pe=="octstr")return new U(o[Pe]);if(Pe=="null")return new K(o[Pe]);if(Pe=="oid")return new $(o[Pe]);if(Pe=="enum")return new H(o[Pe]);if(Pe=="utf8str")return new W(o[Pe]);if(Pe=="numstr")return new J(o[Pe]);if(Pe=="prnstr")return new te(o[Pe]);if(Pe=="telstr")return new oe(o[Pe]);if(Pe=="ia5str")return new ue(o[Pe]);if(Pe=="utctime")return new fe(o[Pe]);if(Pe=="gentime")return new ye(o[Pe]);if(Pe=="visstr")return new O(o[Pe]);if(Pe=="bmpstr")return new z(o[Pe]);if(Pe=="asn1")return new u(o[Pe]);if(Pe=="seq"){for(var Ye=o[Pe],$e=[],We=0;We<Ye.length;We++){var lt=be(Ye[We]);$e.push(lt)}return new Y({array:$e})}if(Pe=="set"){for(Ye=o[Pe],$e=[],We=0;We<Ye.length;We++)lt=be(Ye[We]),$e.push(lt);return new Z({array:$e})}if(Pe=="tag"){var ht=o[Pe];if(Object.prototype.toString.call(ht)==="[object Array]"&&ht.length==3){var ct=be(ht[2]);return new de({tag:ht[0],explicit:ht[1],obj:ct})}return new de(ht)}},this.jsonToASN1HEX=function(o){return this.newObject(o).getEncodedHex()}},v.asn1.ASN1Util.oidHexToInt=function(o){for(var i="",u=parseInt(o.substr(0,2),16),d=(i=Math.floor(u/40)+"."+u%40,""),y=2;y<o.length;y+=2){var C=("00000000"+parseInt(o.substr(y,2),16).toString(2)).slice(-8);d+=C.substr(1,7),C.substr(0,1)=="0"&&(i=i+"."+new N(d,2).toString(10),d="")}return i},v.asn1.ASN1Util.oidIntToHex=function(o){var i=function($){var H=$.toString(16);return H.length==1&&(H="0"+H),H},u=function($){var H="",W=new N($,10).toString(2),J=7-W.length%7;J==7&&(J=0);for(var te="",oe=0;oe<J;oe++)te+="0";for(W=te+W,oe=0;oe<W.length-1;oe+=7){var ue=W.substr(oe,7);oe!=W.length-7&&(ue="1"+ue),H+=i(parseInt(ue,2))}return H};if(!o.match(/^[0-9.]+$/))throw"malformed oid string: "+o;var d="",y=o.split("."),C=40*parseInt(y[0])+parseInt(y[1]);d+=i(C),y.splice(0,2);for(var U=0;U<y.length;U++)d+=u(y[U]);return d},v.asn1.ASN1Object=function(o){this.params=null,this.getLengthHexFromValue=function(){if(this.hV===void 0||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n=0,v="+this.hV);var i=this.hV.length/2,u=i.toString(16);if(u.length%2==1&&(u="0"+u),i<128)return u;var d=u.length/2;if(d>15)throw"ASN.1 length too long to represent by 8x: n = "+i.toString(16);return(128+d).toString(16)+u},this.getEncodedHex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(i){this.params=i},o!=null&&o.tlv!=null&&(this.hTLV=o.tlv,this.isModified=!1)},v.asn1.DERAbstractString=function(o){v.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(i){this.hTLV=null,this.isModified=!0,this.s=i,this.hV=Br(this.s).toLowerCase()},this.setStringHex=function(i){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=i},this.getFreshValueHex=function(){return this.hV},o!==void 0&&(typeof o=="string"?this.setString(o):o.str!==void 0?this.setString(o.str):o.hex!==void 0&&this.setStringHex(o.hex))},ot(v.asn1.DERAbstractString,v.asn1.ASN1Object),v.asn1.DERAbstractTime=function(o){v.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(i){var u=i.getTime()+6e4*i.getTimezoneOffset();return new Date(u)},this.formatDate=function(i,u,d){var y=this.zeroPadding,C=this.localDateToUTC(i),U=String(C.getFullYear());u=="utc"&&(U=U.substr(2,2));var K=U+y(String(C.getMonth()+1),2)+y(String(C.getDate()),2)+y(String(C.getHours()),2)+y(String(C.getMinutes()),2)+y(String(C.getSeconds()),2);if(d===!0){var $=C.getMilliseconds();if($!=0){var H=y(String($),3);K=K+"."+(H=H.replace(/[0]+$/,""))}}return K+"Z"},this.zeroPadding=function(i,u){return i.length>=u?i:new Array(u-i.length+1).join("0")+i},this.getString=function(){return this.s},this.setString=function(i){this.hTLV=null,this.isModified=!0,this.s=i,this.hV=Ze(i)},this.setByDateValue=function(i,u,d,y,C,U){var K=new Date(Date.UTC(i,u-1,d,y,C,U,0));this.setByDate(K)},this.getFreshValueHex=function(){return this.hV}},ot(v.asn1.DERAbstractTime,v.asn1.ASN1Object),v.asn1.DERAbstractStructured=function(o){v.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(i){this.hTLV=null,this.isModified=!0,this.asn1Array=i},this.appendASN1Object=function(i){this.hTLV=null,this.isModified=!0,this.asn1Array.push(i)},this.asn1Array=new Array,o!==void 0&&o.array!==void 0&&(this.asn1Array=o.array)},ot(v.asn1.DERAbstractStructured,v.asn1.ASN1Object),v.asn1.DERBoolean=function(o){v.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=o==0?"010100":"0101ff"},ot(v.asn1.DERBoolean,v.asn1.ASN1Object),v.asn1.DERInteger=function(o){v.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(i){this.hTLV=null,this.isModified=!0,this.hV=v.asn1.ASN1Util.bigIntToMinTwosComplementsHex(i)},this.setByInteger=function(i){var u=new N(String(i),10);this.setByBigInteger(u)},this.setValueHex=function(i){this.hV=i},this.getFreshValueHex=function(){return this.hV},o!==void 0&&(o.bigint!==void 0?this.setByBigInteger(o.bigint):o.int!==void 0?this.setByInteger(o.int):typeof o=="number"?this.setByInteger(o):o.hex!==void 0&&this.setValueHex(o.hex))},ot(v.asn1.DERInteger,v.asn1.ASN1Object),v.asn1.DERBitString=function(o){if(o!==void 0&&o.obj!==void 0){var i=v.asn1.ASN1Util.newObject(o.obj);o.hex="00"+i.getEncodedHex()}v.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(u){this.hTLV=null,this.isModified=!0,this.hV=u},this.setUnusedBitsAndHexValue=function(u,d){if(u<0||7<u)throw"unused bits shall be from 0 to 7: u = "+u;var y="0"+u;this.hTLV=null,this.isModified=!0,this.hV=y+d},this.setByBinaryString=function(u){var d=8-(u=u.replace(/0+$/,"")).length%8;d==8&&(d=0);for(var y=0;y<=d;y++)u+="0";var C="";for(y=0;y<u.length-1;y+=8){var U=u.substr(y,8),K=parseInt(U,2).toString(16);K.length==1&&(K="0"+K),C+=K}this.hTLV=null,this.isModified=!0,this.hV="0"+d+C},this.setByBooleanArray=function(u){for(var d="",y=0;y<u.length;y++)u[y]==1?d+="1":d+="0";this.setByBinaryString(d)},this.newFalseArray=function(u){for(var d=new Array(u),y=0;y<u;y++)d[y]=!1;return d},this.getFreshValueHex=function(){return this.hV},o!==void 0&&(typeof o=="string"&&o.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(o):o.hex!==void 0?this.setHexValueIncludingUnusedBits(o.hex):o.bin!==void 0?this.setByBinaryString(o.bin):o.array!==void 0&&this.setByBooleanArray(o.array))},ot(v.asn1.DERBitString,v.asn1.ASN1Object),v.asn1.DEROctetString=function(o){if(o!==void 0&&o.obj!==void 0){var i=v.asn1.ASN1Util.newObject(o.obj);o.hex=i.getEncodedHex()}v.asn1.DEROctetString.superclass.constructor.call(this,o),this.hT="04"},ot(v.asn1.DEROctetString,v.asn1.DERAbstractString),v.asn1.DERNull=function(){v.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},ot(v.asn1.DERNull,v.asn1.ASN1Object),v.asn1.DERObjectIdentifier=function(o){v.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(i){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=i},this.setValueOidString=function(i){var u=(function(y){var C=function(te){var oe=te.toString(16);return oe.length==1&&(oe="0"+oe),oe},U=function(te){var oe="",ue=parseInt(te,10).toString(2),fe=7-ue.length%7;fe==7&&(fe=0);for(var ye="",O=0;O<fe;O++)ye+="0";for(ue=ye+ue,O=0;O<ue.length-1;O+=7){var z=ue.substr(O,7);O!=ue.length-7&&(z="1"+z),oe+=C(parseInt(z,2))}return oe};try{if(!y.match(/^[0-9.]+$/))return null;var K="",$=y.split("."),H=40*parseInt($[0],10)+parseInt($[1],10);K+=C(H),$.splice(0,2);for(var W=0;W<$.length;W++)K+=U($[W]);return K}catch{return null}})(i);if(u==null)throw new Error("malformed oid string: "+i);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=u},this.setValueName=function(i){var u=v.asn1.x509.OID.name2oid(i);if(u==="")throw new Error("DERObjectIdentifier oidName undefined: "+i);this.setValueOidString(u)},this.setValueNameOrOid=function(i){i.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(i):this.setValueName(i)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(i){typeof i=="string"?this.setValueNameOrOid(i):i.oid!==void 0?this.setValueNameOrOid(i.oid):i.name!==void 0?this.setValueNameOrOid(i.name):i.hex!==void 0&&this.setValueHex(i.hex)},o!==void 0&&this.setByParam(o)},ot(v.asn1.DERObjectIdentifier,v.asn1.ASN1Object),v.asn1.DEREnumerated=function(o){v.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(i){this.hTLV=null,this.isModified=!0,this.hV=v.asn1.ASN1Util.bigIntToMinTwosComplementsHex(i)},this.setByInteger=function(i){var u=new N(String(i),10);this.setByBigInteger(u)},this.setValueHex=function(i){this.hV=i},this.getFreshValueHex=function(){return this.hV},o!==void 0&&(o.int!==void 0?this.setByInteger(o.int):typeof o=="number"?this.setByInteger(o):o.hex!==void 0&&this.setValueHex(o.hex))},ot(v.asn1.DEREnumerated,v.asn1.ASN1Object),v.asn1.DERUTF8String=function(o){v.asn1.DERUTF8String.superclass.constructor.call(this,o),this.hT="0c"},ot(v.asn1.DERUTF8String,v.asn1.DERAbstractString),v.asn1.DERNumericString=function(o){v.asn1.DERNumericString.superclass.constructor.call(this,o),this.hT="12"},ot(v.asn1.DERNumericString,v.asn1.DERAbstractString),v.asn1.DERPrintableString=function(o){v.asn1.DERPrintableString.superclass.constructor.call(this,o),this.hT="13"},ot(v.asn1.DERPrintableString,v.asn1.DERAbstractString),v.asn1.DERTeletexString=function(o){v.asn1.DERTeletexString.superclass.constructor.call(this,o),this.hT="14"},ot(v.asn1.DERTeletexString,v.asn1.DERAbstractString),v.asn1.DERIA5String=function(o){v.asn1.DERIA5String.superclass.constructor.call(this,o),this.hT="16"},ot(v.asn1.DERIA5String,v.asn1.DERAbstractString),v.asn1.DERVisibleString=function(o){v.asn1.DERIA5String.superclass.constructor.call(this,o),this.hT="1a"},ot(v.asn1.DERVisibleString,v.asn1.DERAbstractString),v.asn1.DERBMPString=function(o){v.asn1.DERBMPString.superclass.constructor.call(this,o),this.hT="1e"},ot(v.asn1.DERBMPString,v.asn1.DERAbstractString),v.asn1.DERUTCTime=function(o){v.asn1.DERUTCTime.superclass.constructor.call(this,o),this.hT="17",this.setByDate=function(i){this.hTLV=null,this.isModified=!0,this.date=i,this.s=this.formatDate(this.date,"utc"),this.hV=Ze(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=Ze(this.s)),this.hV},o!==void 0&&(o.str!==void 0?this.setString(o.str):typeof o=="string"&&o.match(/^[0-9]{12}Z$/)?this.setString(o):o.hex!==void 0?this.setStringHex(o.hex):o.date!==void 0&&this.setByDate(o.date))},ot(v.asn1.DERUTCTime,v.asn1.DERAbstractTime),v.asn1.DERGeneralizedTime=function(o){v.asn1.DERGeneralizedTime.superclass.constructor.call(this,o),this.hT="18",this.withMillis=!1,this.setByDate=function(i){this.hTLV=null,this.isModified=!0,this.date=i,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=Ze(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=Ze(this.s)),this.hV},o!==void 0&&(o.str!==void 0?this.setString(o.str):typeof o=="string"&&o.match(/^[0-9]{14}Z$/)?this.setString(o):o.hex!==void 0?this.setStringHex(o.hex):o.date!==void 0&&this.setByDate(o.date),o.millis===!0&&(this.withMillis=!0))},ot(v.asn1.DERGeneralizedTime,v.asn1.DERAbstractTime),v.asn1.DERSequence=function(o){v.asn1.DERSequence.superclass.constructor.call(this,o),this.hT="30",this.getFreshValueHex=function(){for(var i="",u=0;u<this.asn1Array.length;u++)i+=this.asn1Array[u].getEncodedHex();return this.hV=i,this.hV}},ot(v.asn1.DERSequence,v.asn1.DERAbstractStructured),v.asn1.DERSet=function(o){v.asn1.DERSet.superclass.constructor.call(this,o),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var i=new Array,u=0;u<this.asn1Array.length;u++){var d=this.asn1Array[u];i.push(d.getEncodedHex())}return this.sortFlag==1&&i.sort(),this.hV=i.join(""),this.hV},o!==void 0&&o.sortflag!==void 0&&o.sortflag==0&&(this.sortFlag=!1)},ot(v.asn1.DERSet,v.asn1.DERAbstractStructured),v.asn1.DERTaggedObject=function(o){v.asn1.DERTaggedObject.superclass.constructor.call(this);var i=v.asn1;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(u,d,y){this.hT=d,this.isExplicit=u,this.asn1Object=y,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=y.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,d),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(u){u.tag!=null&&(this.hT=u.tag),u.explicit!=null&&(this.isExplicit=u.explicit),u.tage!=null&&(this.hT=u.tage,this.isExplicit=!0),u.tagi!=null&&(this.hT=u.tagi,this.isExplicit=!1),u.obj!=null&&(u.obj instanceof i.ASN1Object?(this.asn1Object=u.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)):b(u.obj)=="object"&&(this.asn1Object=i.ASN1Util.newObject(u.obj),this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},o!=null&&this.setByParam(o)},ot(v.asn1.DERTaggedObject,v.asn1.ASN1Object);var v,ae,he,le=new function(){};function Ge(o){for(var i=new Array,u=0;u<o.length;u++)i[u]=o.charCodeAt(u);return i}function at(o){for(var i="",u=0;u<o.length;u++)i+=String.fromCharCode(o[u]);return i}function tt(o){for(var i="",u=0;u<o.length;u++){var d=o[u].toString(16);d.length==1&&(d="0"+d),i+=d}return i}function Ze(o){return tt(Ge(o))}function Xe(o){return o=(o=(o=o.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function Rr(o){return o.length%4==2?o+="==":o.length%4==3&&(o+="="),o=(o=o.replace(/-/g,"+")).replace(/_/g,"/")}function wt(o){return o.length%2==1&&(o="0"+o),Xe(M(o))}function it(o){return ne(Rr(o))}function Br(o){return Ft(jr(o))}function vt(o){return decodeURIComponent(Mr(o))}function $t(o){for(var i="",u=0;u<o.length-1;u+=2)i+=String.fromCharCode(parseInt(o.substr(u,2),16));return i}function Ht(o){for(var i="",u=0;u<o.length;u++)i+=("0"+o.charCodeAt(u).toString(16)).slice(-2);return i}function Pn(o){return M(o)}function V(o){var i=Pn(o).replace(/(.{64})/g,`$1\r
`);return i=i.replace(/\r\n$/,"")}function Q(o){return ne(o.replace(/[^0-9A-Za-z\/+=]*/g,""))}function Le(o,i){return"-----BEGIN "+i+`-----\r
`+V(o)+`\r
-----END `+i+`-----\r
`}function De(o,i){if(o.indexOf("-----BEGIN ")==-1)throw"can't find PEM header: "+i;return Q(o=i!==void 0?(o=o.replace(new RegExp("^[^]*-----BEGIN "+i+"-----"),"")).replace(new RegExp("-----END "+i+"-----[^]*$"),""):(o=o.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function qe(o){var i,u,d,y,C,U,K,$,H,W,J;if(J=o.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return $=J[1],i=parseInt($),$.length===2&&(50<=i&&i<100?i=1900+i:0<=i&&i<50&&(i=2e3+i)),u=parseInt(J[2])-1,d=parseInt(J[3]),y=parseInt(J[4]),C=parseInt(J[5]),U=parseInt(J[6]),K=0,(H=J[7])!==""&&(W=(H.substr(1)+"00").substr(0,3),K=parseInt(W)),Date.UTC(i,u,d,y,C,U,K);throw"unsupported zulu format: "+o}function St(o){return~~(qe(o)/1e3)}function Ft(o){return o.replace(/%/g,"")}function Mr(o){return o.replace(/(..)/g,"%$1")}function ar(o){var i="malformed IPv6 address";if(!o.match(/^[0-9A-Fa-f:]+$/))throw i;var u=(o=o.toLowerCase()).split(":").length-1;if(u<2)throw i;var d=":".repeat(7-u+2),y=(o=o.replace("::",d)).split(":");if(y.length!=8)throw i;for(var C=0;C<8;C++)y[C]=("0000"+y[C]).slice(-4);return y.join("")}function Nn(o){if(!o.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var i=(o=o.toLowerCase()).match(/.{1,4}/g),u=0;u<8;u++)i[u]=i[u].replace(/^0+/,""),i[u]==""&&(i[u]="0");var d=(o=":"+i.join(":")+":").match(/:(0:){2,}/g);if(d===null)return o.slice(1,-1);var y="";for(u=0;u<d.length;u++)d[u].length>y.length&&(y=d[u]);return(o=o.replace(y,"::")).slice(1,-1)}function Ln(o){var i="malformed hex value";if(!o.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw i;if(o.length!=8)return o.length==32?Nn(o):o;try{return parseInt(o.substr(0,2),16)+"."+parseInt(o.substr(2,2),16)+"."+parseInt(o.substr(4,2),16)+"."+parseInt(o.substr(6,2),16)}catch{throw i}}function Dn(o){return o.match(/.{4}/g).map((function(u){var d=parseInt(u.substr(0,2),16),y=parseInt(u.substr(2),16);if(d==0&y<128)return String.fromCharCode(y);if(d<8){var C=128|63&y;return vt((192|(7&d)<<3|(192&y)>>6).toString(16)+C.toString(16))}C=128|(15&d)<<2|(192&y)>>6;var U=128|63&y;return vt((224|(240&d)>>4).toString(16)+C.toString(16)+U.toString(16))})).join("")}function jr(o){for(var i=encodeURIComponent(o),u="",d=0;d<i.length;d++)i[d]=="%"?(u+=i.substr(d,3),d+=2):u=u+"%"+Ze(i[d]);return u}function nn(o){return!(o.length%2!=0||!o.match(/^[0-9a-f]+$/)&&!o.match(/^[0-9A-F]+$/))}function $r(o){return o.length%2==1?"0"+o:o.substr(0,1)>"7"?"00"+o:o}le.getLblen=function(o,i){if(o.substr(i+2,1)!="8")return 1;var u=parseInt(o.substr(i+3,1));return u==0?-1:0<u&&u<10?u+1:-2},le.getL=function(o,i){var u=le.getLblen(o,i);return u<1?"":o.substr(i+2,2*u)},le.getVblen=function(o,i){var u;return(u=le.getL(o,i))==""?-1:(u.substr(0,1)==="8"?new N(u.substr(2),16):new N(u,16)).intValue()},le.getVidx=function(o,i){var u=le.getLblen(o,i);return u<0?u:i+2*(u+1)},le.getV=function(o,i){var u=le.getVidx(o,i),d=le.getVblen(o,i);return o.substr(u,2*d)},le.getTLV=function(o,i){return o.substr(i,2)+le.getL(o,i)+le.getV(o,i)},le.getTLVblen=function(o,i){return 2+2*le.getLblen(o,i)+2*le.getVblen(o,i)},le.getNextSiblingIdx=function(o,i){return le.getVidx(o,i)+2*le.getVblen(o,i)},le.getChildIdx=function(o,i){var u,d,y,C=le,U=[];u=C.getVidx(o,i),d=2*C.getVblen(o,i),o.substr(i,2)=="03"&&(u+=2,d-=2),y=0;for(var K=u;y<=d;){var $=C.getTLVblen(o,K);if((y+=$)<=d&&U.push(K),K+=$,y>=d)break}return U},le.getNthChildIdx=function(o,i,u){return le.getChildIdx(o,i)[u]},le.getIdxbyList=function(o,i,u,d){var y,C,U=le;return u.length==0?d!==void 0&&o.substr(i,2)!==d?-1:i:(y=u.shift())>=(C=U.getChildIdx(o,i)).length?-1:U.getIdxbyList(o,C[y],u,d)},le.getIdxbyListEx=function(o,i,u,d){var y,C,U=le;if(u.length==0)return d!==void 0&&o.substr(i,2)!==d?-1:i;y=u.shift(),C=U.getChildIdx(o,i);for(var K=0,$=0;$<C.length;$++){var H=o.substr(C[$],2);if(typeof y=="number"&&!U.isContextTag(H)&&K==y||typeof y=="string"&&U.isContextTag(H,y))return U.getIdxbyListEx(o,C[$],u,d);U.isContextTag(H)||K++}return-1},le.getTLVbyList=function(o,i,u,d){var y=le,C=y.getIdxbyList(o,i,u,d);return C==-1||C>=o.length?null:y.getTLV(o,C)},le.getTLVbyListEx=function(o,i,u,d){var y=le,C=y.getIdxbyListEx(o,i,u,d);return C==-1?null:y.getTLV(o,C)},le.getVbyList=function(o,i,u,d,y){var C,U,K=le;return(C=K.getIdxbyList(o,i,u,d))==-1||C>=o.length?null:(U=K.getV(o,C),y===!0&&(U=U.substr(2)),U)},le.getVbyListEx=function(o,i,u,d,y){var C,U,K=le;return(C=K.getIdxbyListEx(o,i,u,d))==-1?null:(U=K.getV(o,C),o.substr(C,2)=="03"&&y!==!1&&(U=U.substr(2)),U)},le.getInt=function(o,i,u){u==null&&(u=-1);try{var d=o.substr(i,2);if(d!="02"&&d!="03")return u;var y=le.getV(o,i);return d=="02"?parseInt(y,16):(function(U){try{var K=U.substr(0,2);if(K=="00")return parseInt(U.substr(2),16);var $=parseInt(K,16),H=U.substr(2),W=parseInt(H,16).toString(2);return W=="0"&&(W="00000000"),W=W.slice(0,0-$),parseInt(W,2)}catch{return-1}})(y)}catch{return u}},le.getOID=function(o,i,u){u==null&&(u=null);try{return o.substr(i,2)!="06"?u:(function(y){if(!nn(y))return null;try{var C=[],U=y.substr(0,2),K=parseInt(U,16);C[0]=new String(Math.floor(K/40)),C[1]=new String(K%40);for(var $=y.substr(2),H=[],W=0;W<$.length/2;W++)H.push(parseInt($.substr(2*W,2),16));var J=[],te="";for(W=0;W<H.length;W++)128&H[W]?te+=on((127&H[W]).toString(2),7):(te+=on((127&H[W]).toString(2),7),J.push(new String(parseInt(te,2))),te="");var oe=C.join(".");return J.length>0&&(oe=oe+"."+J.join(".")),oe}catch{return null}})(le.getV(o,i))}catch{return u}},le.getOIDName=function(o,i,u){u==null&&(u=null);try{var d=le.getOID(o,i,u);if(d==u)return u;var y=v.asn1.x509.OID.oid2name(d);return y==""?d:y}catch{return u}},le.getString=function(o,i,u){u==null&&(u=null);try{return $t(le.getV(o,i))}catch{return u}},le.hextooidstr=function(o){var i=function(te,oe){return te.length>=oe?te:new Array(oe-te.length+1).join("0")+te},u=[],d=o.substr(0,2),y=parseInt(d,16);u[0]=new String(Math.floor(y/40)),u[1]=new String(y%40);for(var C=o.substr(2),U=[],K=0;K<C.length/2;K++)U.push(parseInt(C.substr(2*K,2),16));var $=[],H="";for(K=0;K<U.length;K++)128&U[K]?H+=i((127&U[K]).toString(2),7):(H+=i((127&U[K]).toString(2),7),$.push(new String(parseInt(H,2))),H="");var W=u.join(".");return $.length>0&&(W=W+"."+$.join(".")),W},le.dump=function(o,i,u,d){var y=le,C=y.getV,U=y.dump,K=y.getChildIdx,$=o;o instanceof v.asn1.ASN1Object&&($=o.getEncodedHex());var H=function(Pe,Ye){return Pe.length<=2*Ye?Pe:Pe.substr(0,Ye)+"..(total "+Pe.length/2+"bytes).."+Pe.substr(Pe.length-Ye,Ye)};i===void 0&&(i={ommit_long_octet:32}),u===void 0&&(u=0),d===void 0&&(d="");var W,J=i.ommit_long_octet;if((W=$.substr(u,2))=="01")return(te=C($,u))=="00"?d+`BOOLEAN FALSE
`:d+`BOOLEAN TRUE
`;if(W=="02")return d+"INTEGER "+H(te=C($,u),J)+`
`;if(W=="03"){var te=C($,u);if(y.isASN1HEX(te.substr(2))){var oe=d+`BITSTRING, encapsulates
`;return oe+=U(te.substr(2),i,0,d+"  ")}return d+"BITSTRING "+H(te,J)+`
`}if(W=="04")return te=C($,u),y.isASN1HEX(te)?(oe=d+`OCTETSTRING, encapsulates
`,oe+=U(te,i,0,d+"  ")):d+"OCTETSTRING "+H(te,J)+`
`;if(W=="05")return d+`NULL
`;if(W=="06"){var ue=C($,u),fe=v.asn1.ASN1Util.oidHexToInt(ue),ye=v.asn1.x509.OID.oid2name(fe),O=fe.replace(/\./g," ");return ye!=""?d+"ObjectIdentifier "+ye+" ("+O+`)
`:d+"ObjectIdentifier ("+O+`)
`}if(W=="0a")return d+"ENUMERATED "+parseInt(C($,u))+`
`;if(W=="0c")return d+"UTF8String '"+vt(C($,u))+`'
`;if(W=="13")return d+"PrintableString '"+vt(C($,u))+`'
`;if(W=="14")return d+"TeletexString '"+vt(C($,u))+`'
`;if(W=="16")return d+"IA5String '"+vt(C($,u))+`'
`;if(W=="17")return d+"UTCTime "+vt(C($,u))+`
`;if(W=="18")return d+"GeneralizedTime "+vt(C($,u))+`
`;if(W=="1a")return d+"VisualString '"+vt(C($,u))+`'
`;if(W=="1e")return d+"BMPString '"+Dn(C($,u))+`'
`;if(W=="30"){if($.substr(u,4)=="3000")return d+`SEQUENCE {}
`;oe=d+`SEQUENCE
`;var z=i;if(((de=K($,u)).length==2||de.length==3)&&$.substr(de[0],2)=="06"&&$.substr(de[de.length-1],2)=="04"){ye=y.oidname(C($,de[0]));var Y=JSON.parse(JSON.stringify(i));Y.x509ExtName=ye,z=Y}for(var Z=0;Z<de.length;Z++)oe+=U($,z,de[Z],d+"  ");return oe}if(W=="31"){oe=d+`SET
`;var de=K($,u);for(Z=0;Z<de.length;Z++)oe+=U($,i,de[Z],d+"  ");return oe}if((128&(W=parseInt(W,16)))!=0){var be=31&W;if((32&W)!=0){for(oe=d+"["+be+`]
`,de=K($,u),Z=0;Z<de.length;Z++)oe+=U($,i,de[Z],d+"  ");return oe}if(te=C($,u),le.isASN1HEX(te)){var oe=d+"["+be+`]
`;return oe+=U(te,i,0,d+"  ")}return(te.substr(0,8)=="68747470"||i.x509ExtName==="subjectAltName"&&be==2)&&(te=vt(te)),oe=d+"["+be+"] "+te+`
`}return d+"UNKNOWN("+W+") "+C($,u)+`
`},le.isContextTag=function(o,i){var u,d;o=o.toLowerCase();try{u=parseInt(o,16)}catch{return-1}if(i===void 0)return(192&u)==128;try{return i.match(/^\[[0-9]+\]$/)!=null&&!((d=parseInt(i.substr(1,i.length-1),10))>31)&&(192&u)==128&&(31&u)==d}catch{return!1}},le.isASN1HEX=function(o){var i=le;if(o.length%2==1)return!1;var u=i.getVblen(o,0),d=o.substr(0,2),y=i.getL(o,0);return o.length-d.length-y.length==2*u},le.checkStrictDER=function(o,i,u,d,y){var C=le;if(u===void 0){if(typeof o!="string")throw new Error("not hex string");if(o=o.toLowerCase(),!v.lang.String.isHex(o))throw new Error("not hex string");u=o.length,y=(d=o.length/2)<128?1:Math.ceil(d.toString(16))+1}if(C.getL(o,i).length>2*y)throw new Error("L of TLV too long: idx="+i);var U=C.getVblen(o,i);if(U>d)throw new Error("value of L too long than hex: idx="+i);var K=C.getTLV(o,i),$=K.length-2-C.getL(o,i).length;if($!==2*U)throw new Error("V string length and L's value not the same:"+$+"/"+2*U);if(i===0&&o.length!=K.length)throw new Error("total length and TLV length unmatch:"+o.length+"!="+K.length);var H=o.substr(i,2);if(H==="02"){var W=C.getVidx(o,i);if(o.substr(W,2)=="00"&&o.charCodeAt(W+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(H,16)){for(var J=C.getVblen(o,i),te=0,oe=C.getChildIdx(o,i),ue=0;ue<oe.length;ue++)te+=C.getTLV(o,oe[ue]).length,C.checkStrictDER(o,oe[ue],u,d,y);if(2*J!=te)throw new Error("sum of children's TLV length and L unmatch: "+2*J+"!="+te)}},le.oidname=function(o){var i=v.asn1;v.lang.String.isHex(o)&&(o=i.ASN1Util.oidHexToInt(o));var u=i.x509.OID.oid2name(o);return u===""&&(u=o),u},v!==void 0&&v||(n.KJUR=v={}),v.lang!==void 0&&v.lang||(v.lang={}),v.lang.String=function(){},typeof a=="function"?(n.utf8tob64u=ae=function(i){return Xe(a.from(i,"utf8").toString("base64"))},n.b64utoutf8=he=function(i){return a.from(Rr(i),"base64").toString("utf8")}):(n.utf8tob64u=ae=function(i){return wt(Ft(jr(i)))},n.b64utoutf8=he=function(i){return decodeURIComponent(Mr(it(i)))}),v.lang.String.isInteger=function(o){return!!o.match(/^[0-9]+$/)||!!o.match(/^-[0-9]+$/)},v.lang.String.isHex=function(o){return nn(o)},v.lang.String.isBase64=function(o){return!(!(o=o.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||o.length%4!=0)},v.lang.String.isBase64URL=function(o){return!o.match(/[+/=]/)&&(o=Rr(o),v.lang.String.isBase64(o))},v.lang.String.isIntegerArray=function(o){return!!(o=o.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},v.lang.String.isPrintable=function(o){return o.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null},v.lang.String.isIA5=function(o){return o.match(/^[\x20-\x21\x23-\x7f]*$/)!==null},v.lang.String.isMail=function(o){return o.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};var on=function(i,u,d){return d==null&&(d="0"),i.length>=u?i:new Array(u-i.length+1).join(d)+i};function ot(o,i){var u=function(){};u.prototype=i.prototype,o.prototype=new u,o.prototype.constructor=o,o.superclass=i.prototype,i.prototype.constructor==Object.prototype.constructor&&(i.prototype.constructor=i)}v!==void 0&&v||(n.KJUR=v={}),v.crypto!==void 0&&v.crypto||(v.crypto={}),v.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:P.algo.MD5,sha1:P.algo.SHA1,sha224:P.algo.SHA224,sha256:P.algo.SHA256,sha384:P.algo.SHA384,sha512:P.algo.SHA512,ripemd160:P.algo.RIPEMD160},this.getDigestInfoHex=function(o,i){if(this.DIGESTINFOHEAD[i]===void 0)throw"alg not supported in Util.DIGESTINFOHEAD: "+i;return this.DIGESTINFOHEAD[i]+o},this.getPaddedDigestInfoHex=function(o,i,u){var d=this.getDigestInfoHex(o,i),y=u/4;if(d.length+22>y)throw"key is too short for SigAlg: keylen="+u+","+i;for(var C="0001",U="00"+d,K="",$=y-C.length-U.length,H=0;H<$;H+=2)K+="ff";return C+K+U},this.hashString=function(o,i){return new v.crypto.MessageDigest({alg:i}).digestString(o)},this.hashHex=function(o,i){return new v.crypto.MessageDigest({alg:i}).digestHex(o)},this.sha1=function(o){return this.hashString(o,"sha1")},this.sha256=function(o){return this.hashString(o,"sha256")},this.sha256Hex=function(o){return this.hashHex(o,"sha256")},this.sha512=function(o){return this.hashString(o,"sha512")},this.sha512Hex=function(o){return this.hashHex(o,"sha512")},this.isKey=function(o){return o instanceof Oe||o instanceof v.crypto.DSA||o instanceof v.crypto.ECDSA}},v.crypto.Util.md5=function(o){return new v.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(o)},v.crypto.Util.ripemd160=function(o){return new v.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(o)},v.crypto.Util.SECURERANDOMGEN=new _e,v.crypto.Util.getRandomHexOfNbytes=function(o){var i=new Array(o);return v.crypto.Util.SECURERANDOMGEN.nextBytes(i),tt(i)},v.crypto.Util.getRandomBigIntegerOfNbytes=function(o){return new N(v.crypto.Util.getRandomHexOfNbytes(o),16)},v.crypto.Util.getRandomHexOfNbits=function(o){var i=o%8,u=new Array((o-i)/8+1);return v.crypto.Util.SECURERANDOMGEN.nextBytes(u),u[0]=(255<<i&255^255)&u[0],tt(u)},v.crypto.Util.getRandomBigIntegerOfNbits=function(o){return new N(v.crypto.Util.getRandomHexOfNbits(o),16)},v.crypto.Util.getRandomBigIntegerZeroToMax=function(o){for(var i=o.bitLength();;){var u=v.crypto.Util.getRandomBigIntegerOfNbits(i);if(o.compareTo(u)!=-1)return u}},v.crypto.Util.getRandomBigIntegerMinToMax=function(o,i){var u=o.compareTo(i);if(u==1)throw"biMin is greater than biMax";if(u==0)return o;var d=i.subtract(o);return v.crypto.Util.getRandomBigIntegerZeroToMax(d).add(o)},v.crypto.MessageDigest=function(o){this.setAlgAndProvider=function(i,u){if((i=v.crypto.MessageDigest.getCanonicalAlgName(i))!==null&&u===void 0&&(u=v.crypto.Util.DEFAULTPROVIDER[i]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)!=-1&&u=="cryptojs"){try{this.md=v.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[i].create()}catch(d){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+d}this.updateString=function(d){this.md.update(d)},this.updateHex=function(d){var y=P.enc.Hex.parse(d);this.md.update(y)},this.digest=function(){return this.md.finalize().toString(P.enc.Hex)},this.digestString=function(d){return this.updateString(d),this.digest()},this.digestHex=function(d){return this.updateHex(d),this.digest()}}if(":sha256:".indexOf(i)!=-1&&u=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(d){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+d}this.updateString=function(d){this.md.update(d)},this.updateHex=function(d){var y=sjcl.codec.hex.toBits(d);this.md.update(y)},this.digest=function(){var d=this.md.finalize();return sjcl.codec.hex.fromBits(d)},this.digestString=function(d){return this.updateString(d),this.digest()},this.digestHex=function(d){return this.updateHex(d),this.digest()}}},this.updateString=function(i){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(i){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(i){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(i){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},o!==void 0&&o.alg!==void 0&&(this.algName=o.alg,o.prov===void 0&&(this.provName=v.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},v.crypto.MessageDigest.getCanonicalAlgName=function(o){return typeof o=="string"&&(o=(o=o.toLowerCase()).replace(/-/,"")),o},v.crypto.MessageDigest.getHashLength=function(o){var i=v.crypto.MessageDigest,u=i.getCanonicalAlgName(o);if(i.HASHLENGTH[u]===void 0)throw"not supported algorithm: "+o;return i.HASHLENGTH[u]},v.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},v.crypto.Mac=function(o){this.setAlgAndProvider=function(i,u){if((i=i.toLowerCase())==null&&(i="hmacsha1"),(i=i.toLowerCase()).substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+i;u===void 0&&(u=v.crypto.Util.DEFAULTPROVIDER[i]),this.algProv=i+"/"+u;var d=i.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(d)!=-1&&u=="cryptojs"){try{var y=v.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[d];this.mac=P.algo.HMAC.create(y,this.pass)}catch(C){throw"setAlgAndProvider hash alg set fail hashAlg="+d+"/"+C}this.updateString=function(C){this.mac.update(C)},this.updateHex=function(C){var U=P.enc.Hex.parse(C);this.mac.update(U)},this.doFinal=function(){return this.mac.finalize().toString(P.enc.Hex)},this.doFinalString=function(C){return this.updateString(C),this.doFinal()},this.doFinalHex=function(C){return this.updateHex(C),this.doFinal()}}},this.updateString=function(i){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(i){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(i){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(i){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(i){if(typeof i=="string"){var u=i;return i.length%2!=1&&i.match(/^[0-9A-Fa-f]+$/)||(u=Ht(i)),void(this.pass=P.enc.Hex.parse(u))}if((i===void 0?"undefined":b(i))!="object")throw"KJUR.crypto.Mac unsupported password type: "+i;if(u=null,i.hex!==void 0){if(i.hex.length%2!=0||!i.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+i.hex;u=i.hex}if(i.utf8!==void 0&&(u=Br(i.utf8)),i.rstr!==void 0&&(u=Ht(i.rstr)),i.b64!==void 0&&(u=ne(i.b64)),i.b64u!==void 0&&(u=it(i.b64u)),u==null)throw"KJUR.crypto.Mac unsupported password type: "+i;this.pass=P.enc.Hex.parse(u)},o!==void 0&&(o.pass!==void 0&&this.setPassword(o.pass),o.alg!==void 0&&(this.algName=o.alg,o.prov===void 0&&(this.provName=v.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},v.crypto.Signature=function(o){var i=null;if(this._setAlgNames=function(){var u=this.algName.match(/^(.+)with(.+)$/);u&&(this.mdAlgName=u[1].toLowerCase(),this.pubkeyAlgName=u[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(u,d){for(var y="",C=d/4-u.length,U=0;U<C;U++)y+="0";return y+u},this.setAlgAndProvider=function(u,d){if(this._setAlgNames(),d!="cryptojs/jsrsa")throw new Error("provider not supported: "+d);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new v.crypto.MessageDigest({alg:this.mdAlgName})}catch(y){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+y)}this.init=function(y,C){var U=null;try{U=C===void 0?st.getKey(y):st.getKey(y,C)}catch(K){throw"init failed:"+K}if(U.isPrivate===!0)this.prvKey=U,this.state="SIGN";else{if(U.isPublic!==!0)throw"init failed.:"+U;this.pubKey=U,this.state="VERIFY"}},this.updateString=function(y){this.md.updateString(y)},this.updateHex=function(y){this.md.updateHex(y)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&v.crypto.ECDSA!==void 0&&(this.prvKey=new v.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof Oe&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof Oe&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof v.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof v.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(y){return this.updateString(y),this.sign()},this.signHex=function(y){return this.updateHex(y),this.sign()},this.verify=function(y){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&v.crypto.ECDSA!==void 0&&(this.pubKey=new v.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof Oe&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,y,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof Oe&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,y);if(v.crypto.ECDSA!==void 0&&this.pubKey instanceof v.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,y);if(v.crypto.DSA!==void 0&&this.pubKey instanceof v.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,y);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(u,d){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(u){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(u){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(u){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(u){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(u){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=o,o!==void 0&&(o.alg!==void 0&&(this.algName=o.alg,o.prov===void 0?this.provName=v.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=o.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),o.psssaltlen!==void 0&&(this.pssSaltLen=o.psssaltlen),o.prvkeypem!==void 0)){if(o.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{i=st.getKey(o.prvkeypem),this.init(i)}catch(u){throw"fatal error to load pem private key: "+u}}},v.crypto.Cipher=function(o){},v.crypto.Cipher.encrypt=function(o,i,u){if(i instanceof Oe&&i.isPublic){var d=v.crypto.Cipher.getAlgByKeyAndName(i,u);if(d==="RSA")return i.encrypt(o);if(d==="RSAOAEP")return i.encryptOAEP(o,"sha1");var y=d.match(/^RSAOAEP(\d+)$/);if(y!==null)return i.encryptOAEP(o,"sha"+y[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+u}throw"Cipher.encrypt: unsupported key or algorithm"},v.crypto.Cipher.decrypt=function(o,i,u){if(i instanceof Oe&&i.isPrivate){var d=v.crypto.Cipher.getAlgByKeyAndName(i,u);if(d==="RSA")return i.decrypt(o);if(d==="RSAOAEP")return i.decryptOAEP(o,"sha1");var y=d.match(/^RSAOAEP(\d+)$/);if(y!==null)return i.decryptOAEP(o,"sha"+y[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+u}throw"Cipher.decrypt: unsupported key or algorithm"},v.crypto.Cipher.getAlgByKeyAndName=function(o,i){if(o instanceof Oe){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(i)!=-1)return i;if(i==null)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+i}throw"getAlgByKeyAndName: not supported algorithm name: "+i},v.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},v!==void 0&&v||(n.KJUR=v={}),v.crypto!==void 0&&v.crypto||(v.crypto={}),v.crypto.ECDSA=function(o){var i=Error,u=N,d=L,y=v.crypto.ECDSA,C=v.crypto.ECParameterDB,U=y.getName,K=le,$=K.getVbyListEx,H=K.isASN1HEX,W=new _e;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(J){return new u(J.bitLength(),W).mod(J.subtract(u.ONE)).add(u.ONE)},this.setNamedCurve=function(J){this.ecparams=C.getByName(J),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=J},this.setPrivateKeyHex=function(J){this.isPrivate=!0,this.prvKeyHex=J},this.setPublicKeyHex=function(J){this.isPublic=!0,this.pubKeyHex=J},this.getPublicKeyXYHex=function(){var J=this.pubKeyHex;if(J.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var te=this.ecparams.keylen/4;if(J.length!==2+2*te)throw"malformed public key hex length";var oe={};return oe.x=J.substr(2,te),oe.y=J.substr(2+te),oe},this.getShortNISTPCurveName=function(){var J=this.curveName;return J==="secp256r1"||J==="NIST P-256"||J==="P-256"||J==="prime256v1"?"P-256":J==="secp384r1"||J==="NIST P-384"||J==="P-384"?"P-384":null},this.generateKeyPairHex=function(){var J=this.ecparams.n,te=this.getBigRandom(J),oe=this.ecparams.G.multiply(te),ue=oe.getX().toBigInteger(),fe=oe.getY().toBigInteger(),ye=this.ecparams.keylen/4,O=("0000000000"+te.toString(16)).slice(-ye),z="04"+("0000000000"+ue.toString(16)).slice(-ye)+("0000000000"+fe.toString(16)).slice(-ye);return this.setPrivateKeyHex(O),this.setPublicKeyHex(z),{ecprvhex:O,ecpubhex:z}},this.signWithMessageHash=function(J){return this.signHex(J,this.prvKeyHex)},this.signHex=function(J,te){var oe=new u(te,16),ue=this.ecparams.n,fe=new u(J.substring(0,this.ecparams.keylen/4),16);do var ye=this.getBigRandom(ue),O=this.ecparams.G.multiply(ye).getX().toBigInteger().mod(ue);while(O.compareTo(u.ZERO)<=0);var z=ye.modInverse(ue).multiply(fe.add(oe.multiply(O))).mod(ue);return y.biRSSigToASN1Sig(O,z)},this.sign=function(J,te){var oe=te,ue=this.ecparams.n,fe=u.fromByteArrayUnsigned(J);do var ye=this.getBigRandom(ue),O=this.ecparams.G.multiply(ye).getX().toBigInteger().mod(ue);while(O.compareTo(N.ZERO)<=0);var z=ye.modInverse(ue).multiply(fe.add(oe.multiply(O))).mod(ue);return this.serializeSig(O,z)},this.verifyWithMessageHash=function(J,te){return this.verifyHex(J,te,this.pubKeyHex)},this.verifyHex=function(J,te,oe){try{var ue,fe,ye=y.parseSigHex(te);ue=ye.r,fe=ye.s;var O=d.decodeFromHex(this.ecparams.curve,oe),z=new u(J.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(z,ue,fe,O)}catch{return!1}},this.verify=function(J,te,oe){var ue,fe,ye;if(Bitcoin.Util.isArray(te)){var O=this.parseSig(te);ue=O.r,fe=O.s}else{if((te===void 0?"undefined":b(te))!=="object"||!te.r||!te.s)throw"Invalid value for signature";ue=te.r,fe=te.s}if(oe instanceof L)ye=oe;else{if(!Bitcoin.Util.isArray(oe))throw"Invalid format for pubkey value, must be byte array or ECPointFp";ye=d.decodeFrom(this.ecparams.curve,oe)}var z=u.fromByteArrayUnsigned(J);return this.verifyRaw(z,ue,fe,ye)},this.verifyRaw=function(J,te,oe,ue){var fe=this.ecparams.n,ye=this.ecparams.G;if(te.compareTo(u.ONE)<0||te.compareTo(fe)>=0||oe.compareTo(u.ONE)<0||oe.compareTo(fe)>=0)return!1;var O=oe.modInverse(fe),z=J.multiply(O).mod(fe),Y=te.multiply(O).mod(fe);return ye.multiply(z).add(ue.multiply(Y)).getX().toBigInteger().mod(fe).equals(te)},this.serializeSig=function(J,te){var oe=J.toByteArraySigned(),ue=te.toByteArraySigned(),fe=[];return fe.push(2),fe.push(oe.length),(fe=fe.concat(oe)).push(2),fe.push(ue.length),(fe=fe.concat(ue)).unshift(fe.length),fe.unshift(48),fe},this.parseSig=function(J){var te;if(J[0]!=48)throw new Error("Signature not a valid DERSequence");if(J[te=2]!=2)throw new Error("First element in signature must be a DERInteger");var oe=J.slice(te+2,te+2+J[te+1]);if(J[te+=2+J[te+1]]!=2)throw new Error("Second element in signature must be a DERInteger");var ue=J.slice(te+2,te+2+J[te+1]);return te+=2+J[te+1],{r:u.fromByteArrayUnsigned(oe),s:u.fromByteArrayUnsigned(ue)}},this.parseSigCompact=function(J){if(J.length!==65)throw"Signature has the wrong length";var te=J[0]-27;if(te<0||te>7)throw"Invalid signature type";var oe=this.ecparams.n;return{r:u.fromByteArrayUnsigned(J.slice(1,33)).mod(oe),s:u.fromByteArrayUnsigned(J.slice(33,65)).mod(oe),i:te}},this.readPKCS5PrvKeyHex=function(J){if(H(J)===!1)throw new Error("not ASN.1 hex string");var te,oe,ue;try{te=$(J,0,["[0]",0],"06"),oe=$(J,0,[1],"04");try{ue=$(J,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=U(te),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(ue),this.setPrivateKeyHex(oe),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(J){if(H(J)===!1)throw new i("not ASN.1 hex string");var te,oe,ue;try{$(J,0,[1,0],"06"),te=$(J,0,[1,1],"06"),oe=$(J,0,[2,0,1],"04");try{ue=$(J,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new i("malformed PKCS#8 plain ECC private key")}if(this.curveName=U(te),this.curveName===void 0)throw new i("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(ue),this.setPrivateKeyHex(oe),this.isPublic=!1},this.readPKCS8PubKeyHex=function(J){if(H(J)===!1)throw new i("not ASN.1 hex string");var te,oe;try{$(J,0,[0,0],"06"),te=$(J,0,[0,1],"06"),oe=$(J,0,[1],"03")}catch{throw new i("malformed PKCS#8 ECC public key")}if(this.curveName=U(te),this.curveName===null)throw new i("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(oe)},this.readCertPubKeyHex=function(J,te){if(H(J)===!1)throw new i("not ASN.1 hex string");var oe,ue;try{oe=$(J,0,[0,5,0,1],"06"),ue=$(J,0,[0,5,1],"03")}catch{throw new i("malformed X.509 certificate ECC public key")}if(this.curveName=U(oe),this.curveName===null)throw new i("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(ue)},o!==void 0&&o.curve!==void 0&&(this.curveName=o.curve),this.curveName===void 0&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),o!==void 0&&(o.prv!==void 0&&this.setPrivateKeyHex(o.prv),o.pub!==void 0&&this.setPublicKeyHex(o.pub))},v.crypto.ECDSA.parseSigHex=function(o){var i=v.crypto.ECDSA.parseSigHexInHexRS(o);return{r:new N(i.r,16),s:new N(i.s,16)}},v.crypto.ECDSA.parseSigHexInHexRS=function(o){var i=le,u=i.getChildIdx,d=i.getV;if(i.checkStrictDER(o,0),o.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var y=u(o,0);if(y.length!=2)throw new Error("signature shall have two elements");var C=y[0],U=y[1];if(o.substr(C,2)!="02")throw new Error("1st item not ASN.1 integer");if(o.substr(U,2)!="02")throw new Error("2nd item not ASN.1 integer");return{r:d(o,C),s:d(o,U)}},v.crypto.ECDSA.asn1SigToConcatSig=function(o){var i=v.crypto.ECDSA.parseSigHexInHexRS(o),u=i.r,d=i.s;if(u.substr(0,2)=="00"&&u.length%32==2&&(u=u.substr(2)),d.substr(0,2)=="00"&&d.length%32==2&&(d=d.substr(2)),u.length%32==30&&(u="00"+u),d.length%32==30&&(d="00"+d),u.length%32!=0)throw"unknown ECDSA sig r length error";if(d.length%32!=0)throw"unknown ECDSA sig s length error";return u+d},v.crypto.ECDSA.concatSigToASN1Sig=function(o){if(o.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var i=o.substr(0,o.length/2),u=o.substr(o.length/2);return v.crypto.ECDSA.hexRSSigToASN1Sig(i,u)},v.crypto.ECDSA.hexRSSigToASN1Sig=function(o,i){var u=new N(o,16),d=new N(i,16);return v.crypto.ECDSA.biRSSigToASN1Sig(u,d)},v.crypto.ECDSA.biRSSigToASN1Sig=function(o,i){var u=v.asn1,d=new u.DERInteger({bigint:o}),y=new u.DERInteger({bigint:i});return new u.DERSequence({array:[d,y]}).getEncodedHex()},v.crypto.ECDSA.getName=function(o){return o==="2b8104001f"?"secp192k1":o==="2a8648ce3d030107"?"secp256r1":o==="2b8104000a"?"secp256k1":o==="2b81040021"?"secp224r1":o==="2b81040022"?"secp384r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(o)!==-1?"secp256r1":"|secp256k1|".indexOf(o)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(o)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(o)!==-1?"secp384r1":null},v!==void 0&&v||(n.KJUR=v={}),v.crypto!==void 0&&v.crypto||(v.crypto={}),v.crypto.ECParameterDB=new function(){var o={},i={};function u(d){return new N(d,16)}this.getByName=function(d){var y=d;if(i[y]!==void 0&&(y=i[d]),o[y]!==void 0)return o[y];throw"unregistered EC curve name: "+y},this.regist=function(d,y,C,U,K,$,H,W,J,te,oe,ue){o[d]={};var fe=u(C),ye=u(U),O=u(K),z=u($),Y=u(H),Z=new w(fe,ye,O),de=Z.decodePointHex("04"+W+J);o[d].name=d,o[d].keylen=y,o[d].curve=Z,o[d].G=de,o[d].n=z,o[d].h=Y,o[d].oid=oe,o[d].info=ue;for(var be=0;be<te.length;be++)i[te[be]]=d}},v.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),v.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),v.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),v.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),v.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),v.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),v.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),v.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),v.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),v.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var st=(function(){var o=function(H,W,J){return i(P.AES,H,W,J)},i=function(H,W,J,te){var oe=P.enc.Hex.parse(W),ue=P.enc.Hex.parse(J),fe=P.enc.Hex.parse(te),ye={};ye.key=ue,ye.iv=fe,ye.ciphertext=oe;var O=H.decrypt(ye,ue,{iv:fe});return P.enc.Hex.stringify(O)},u=function(H,W,J){return d(P.AES,H,W,J)},d=function(H,W,J,te){var oe=P.enc.Hex.parse(W),ue=P.enc.Hex.parse(J),fe=P.enc.Hex.parse(te),ye=H.encrypt(oe,ue,{iv:fe}),O=P.enc.Hex.parse(ye.toString());return P.enc.Base64.stringify(O)},y={"AES-256-CBC":{proc:o,eproc:u,keylen:32,ivlen:16},"AES-192-CBC":{proc:o,eproc:u,keylen:24,ivlen:16},"AES-128-CBC":{proc:o,eproc:u,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(H,W,J){return i(P.TripleDES,H,W,J)},eproc:function(H,W,J){return d(P.TripleDES,H,W,J)},keylen:24,ivlen:8},"DES-CBC":{proc:function(H,W,J){return i(P.DES,H,W,J)},eproc:function(H,W,J){return d(P.DES,H,W,J)},keylen:8,ivlen:8}},C=function(H){var W={},J=H.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));J&&(W.cipher=J[1],W.ivsalt=J[2]);var te=H.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));te&&(W.type=te[1]);var oe=-1,ue=0;H.indexOf(`\r
\r
`)!=-1&&(oe=H.indexOf(`\r
\r
`),ue=2),H.indexOf(`

`)!=-1&&(oe=H.indexOf(`

`),ue=1);var fe=H.indexOf("-----END");if(oe!=-1&&fe!=-1){var ye=H.substring(oe+2*ue,fe-ue);ye=ye.replace(/\s+/g,""),W.data=ye}return W},U=function(H,W,J){for(var te=J.substring(0,16),oe=P.enc.Hex.parse(te),ue=P.enc.Utf8.parse(W),fe=y[H].keylen+y[H].ivlen,ye="",O=null;;){var z=P.algo.MD5.create();if(O!=null&&z.update(O),z.update(ue),z.update(oe),O=z.finalize(),(ye+=P.enc.Hex.stringify(O)).length>=2*fe)break}var Y={};return Y.keyhex=ye.substr(0,2*y[H].keylen),Y.ivhex=ye.substr(2*y[H].keylen,2*y[H].ivlen),Y},K=function(H,W,J,te){var oe=P.enc.Base64.parse(H),ue=P.enc.Hex.stringify(oe);return(0,y[W].proc)(ue,J,te)};return{version:"1.0.0",parsePKCS5PEM:function(H){return C(H)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(H,W,J){return U(H,W,J)},decryptKeyB64:function(H,W,J,te){return K(H,W,J,te)},getDecryptedKeyHex:function(H,W){var J=C(H),te=(J.type,J.cipher),oe=J.ivsalt,ue=J.data,fe=U(te,W,oe).keyhex;return K(ue,te,fe,oe)},getEncryptedPKCS5PEMFromPrvKeyHex:function(H,W,J,te,oe){var ue="";if(te!==void 0&&te!=null||(te="AES-256-CBC"),y[te]===void 0)throw new Error("KEYUTIL unsupported algorithm: "+te);oe!==void 0&&oe!=null||(oe=(function(O){var z=P.lib.WordArray.random(O);return P.enc.Hex.stringify(z)})(y[te].ivlen).toUpperCase());var fe=(function(O,z,Y,Z){return(0,y[z].eproc)(O,Y,Z)})(W,te,U(te,J,oe).keyhex,oe);return ue="-----BEGIN "+H+` PRIVATE KEY-----\r
`,ue+=`Proc-Type: 4,ENCRYPTED\r
`,ue+="DEK-Info: "+te+","+oe+`\r
`,ue+=`\r
`,ue+=fe.replace(/(.{64})/g,`$1\r
`),ue+=`\r
-----END `+H+` PRIVATE KEY-----\r
`},parseHexOfEncryptedPKCS8:function(H){var W=le,J=W.getChildIdx,te=W.getV,oe={},ue=J(H,0);if(ue.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+ue.length);oe.ciphertext=te(H,ue[1]);var fe=J(H,ue[0]);if(fe.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+fe.length);if(te(H,fe[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var ye=J(H,fe[1]);if(fe.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+ye.length);var O=J(H,ye[1]);if(O.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+O.length);if(te(H,O[0])!="2a864886f70d0307")throw"this only supports TripleDES";oe.encryptionSchemeAlg="TripleDES",oe.encryptionSchemeIV=te(H,O[1]);var z=J(H,ye[0]);if(z.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+z.length);if(te(H,z[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var Y=J(H,z[1]);if(Y.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+Y.length);oe.pbkdf2Salt=te(H,Y[0]);var Z=te(H,Y[1]);try{oe.pbkdf2Iter=parseInt(Z,16)}catch{throw new Error("malformed format pbkdf2Iter: "+Z)}return oe},getPBKDF2KeyHexFromParam:function(H,W){var J=P.enc.Hex.parse(H.pbkdf2Salt),te=H.pbkdf2Iter,oe=P.PBKDF2(W,J,{keySize:6,iterations:te});return P.enc.Hex.stringify(oe)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(H,W){var J=De(H,"ENCRYPTED PRIVATE KEY"),te=this.parseHexOfEncryptedPKCS8(J),oe=st.getPBKDF2KeyHexFromParam(te,W),ue={};ue.ciphertext=P.enc.Hex.parse(te.ciphertext);var fe=P.enc.Hex.parse(oe),ye=P.enc.Hex.parse(te.encryptionSchemeIV),O=P.TripleDES.decrypt(ue,fe,{iv:ye});return P.enc.Hex.stringify(O)},getKeyFromEncryptedPKCS8PEM:function(H,W){var J=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(H,W);return this.getKeyFromPlainPrivatePKCS8Hex(J)},parsePlainPrivatePKCS8Hex:function(H){var W=le,J=W.getChildIdx,te=W.getV,oe={algparam:null};if(H.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var ue=J(H,0);if(ue.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(H.substr(ue[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var fe=J(H,ue[1]);if(fe.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(H.substr(fe[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(oe.algoid=te(H,fe[0]),H.substr(fe[1],2)=="06"&&(oe.algparam=te(H,fe[1])),H.substr(ue[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return oe.keyidx=W.getVidx(H,ue[2]),oe},getKeyFromPlainPrivatePKCS8PEM:function(H){var W=De(H,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(W)},getKeyFromPlainPrivatePKCS8Hex:function(H){var W,J=this.parsePlainPrivatePKCS8Hex(H);if(J.algoid=="2a864886f70d010101")W=new Oe;else if(J.algoid=="2a8648ce380401")W=new v.crypto.DSA;else{if(J.algoid!="2a8648ce3d0201")throw new Error("unsupported private key algorithm");W=new v.crypto.ECDSA}return W.readPKCS8PrvKeyHex(H),W},_getKeyFromPublicPKCS8Hex:function(H){var W,J=le.getVbyList(H,0,[0,0],"06");if(J==="2a864886f70d010101")W=new Oe;else if(J==="2a8648ce380401")W=new v.crypto.DSA;else{if(J!=="2a8648ce3d0201")throw new Error("unsupported PKCS#8 public key hex");W=new v.crypto.ECDSA}return W.readPKCS8PubKeyHex(H),W},parsePublicRawRSAKeyHex:function(H){var W=le,J=W.getChildIdx,te=W.getV,oe={};if(H.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var ue=J(H,0);if(ue.length!=2)throw new Error("malformed RSA key(code:002)");if(H.substr(ue[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(oe.n=te(H,ue[0]),H.substr(ue[1],2)!="02")throw new Error("malformed RSA key(code:004)");return oe.e=te(H,ue[1]),oe},parsePublicPKCS8Hex:function(H){var W=le,J=W.getChildIdx,te=W.getV,oe={algparam:null},ue=J(H,0);if(ue.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+ue.length);var fe=ue[0];if(H.substr(fe,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var ye=J(H,fe);if(ye.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(H.substr(ye[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(oe.algoid=te(H,ye[0]),H.substr(ye[1],2)=="06"?oe.algparam=te(H,ye[1]):H.substr(ye[1],2)=="30"&&(oe.algparam={},oe.algparam.p=W.getVbyList(H,ye[1],[0],"02"),oe.algparam.q=W.getVbyList(H,ye[1],[1],"02"),oe.algparam.g=W.getVbyList(H,ye[1],[2],"02")),H.substr(ue[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return oe.key=te(H,ue[1]).substr(2),oe}}})();st.getKey=function(o,i,u){var d=(ye=le).getChildIdx,y=(ye.getV,ye.getVbyList),C=v.crypto,U=C.ECDSA,K=C.DSA,$=Oe,H=De,W=st;if($!==void 0&&o instanceof $||U!==void 0&&o instanceof U||K!==void 0&&o instanceof K)return o;if(o.curve!==void 0&&o.xy!==void 0&&o.d===void 0)return new U({pub:o.xy,curve:o.curve});if(o.curve!==void 0&&o.d!==void 0)return new U({prv:o.d,curve:o.curve});if(o.kty===void 0&&o.n!==void 0&&o.e!==void 0&&o.d===void 0)return(We=new $).setPublic(o.n,o.e),We;if(o.kty===void 0&&o.n!==void 0&&o.e!==void 0&&o.d!==void 0&&o.p!==void 0&&o.q!==void 0&&o.dp!==void 0&&o.dq!==void 0&&o.co!==void 0&&o.qi===void 0)return(We=new $).setPrivateEx(o.n,o.e,o.d,o.p,o.q,o.dp,o.dq,o.co),We;if(o.kty===void 0&&o.n!==void 0&&o.e!==void 0&&o.d!==void 0&&o.p===void 0)return(We=new $).setPrivate(o.n,o.e,o.d),We;if(o.p!==void 0&&o.q!==void 0&&o.g!==void 0&&o.y!==void 0&&o.x===void 0)return(We=new K).setPublic(o.p,o.q,o.g,o.y),We;if(o.p!==void 0&&o.q!==void 0&&o.g!==void 0&&o.y!==void 0&&o.x!==void 0)return(We=new K).setPrivate(o.p,o.q,o.g,o.y,o.x),We;if(o.kty==="RSA"&&o.n!==void 0&&o.e!==void 0&&o.d===void 0)return(We=new $).setPublic(it(o.n),it(o.e)),We;if(o.kty==="RSA"&&o.n!==void 0&&o.e!==void 0&&o.d!==void 0&&o.p!==void 0&&o.q!==void 0&&o.dp!==void 0&&o.dq!==void 0&&o.qi!==void 0)return(We=new $).setPrivateEx(it(o.n),it(o.e),it(o.d),it(o.p),it(o.q),it(o.dp),it(o.dq),it(o.qi)),We;if(o.kty==="RSA"&&o.n!==void 0&&o.e!==void 0&&o.d!==void 0)return(We=new $).setPrivate(it(o.n),it(o.e),it(o.d)),We;if(o.kty==="EC"&&o.crv!==void 0&&o.x!==void 0&&o.y!==void 0&&o.d===void 0){var J=($e=new U({curve:o.crv})).ecparams.keylen/4,te="04"+("0000000000"+it(o.x)).slice(-J)+("0000000000"+it(o.y)).slice(-J);return $e.setPublicKeyHex(te),$e}if(o.kty==="EC"&&o.crv!==void 0&&o.x!==void 0&&o.y!==void 0&&o.d!==void 0){J=($e=new U({curve:o.crv})).ecparams.keylen/4,te="04"+("0000000000"+it(o.x)).slice(-J)+("0000000000"+it(o.y)).slice(-J);var oe=("0000000000"+it(o.d)).slice(-J);return $e.setPublicKeyHex(te),$e.setPrivateKeyHex(oe),$e}if(u==="pkcs5prv"){var ue,fe=o,ye=le;if((ue=d(fe,0)).length===9)(We=new $).readPKCS5PrvKeyHex(fe);else if(ue.length===6)(We=new K).readPKCS5PrvKeyHex(fe);else{if(!(ue.length>2&&fe.substr(ue[1],2)==="04"))throw new Error("unsupported PKCS#1/5 hexadecimal key");(We=new U).readPKCS5PrvKeyHex(fe)}return We}if(u==="pkcs8prv")return We=W.getKeyFromPlainPrivatePKCS8Hex(o);if(u==="pkcs8pub")return W._getKeyFromPublicPKCS8Hex(o);if(u==="x509pub")return Et.getPublicKeyFromCertHex(o);if(o.indexOf("-END CERTIFICATE-",0)!=-1||o.indexOf("-END X509 CERTIFICATE-",0)!=-1||o.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return Et.getPublicKeyFromCertPEM(o);if(o.indexOf("-END PUBLIC KEY-")!=-1){var O=De(o,"PUBLIC KEY");return W._getKeyFromPublicPKCS8Hex(O)}if(o.indexOf("-END RSA PRIVATE KEY-")!=-1&&o.indexOf("4,ENCRYPTED")==-1){var z=H(o,"RSA PRIVATE KEY");return W.getKey(z,null,"pkcs5prv")}if(o.indexOf("-END DSA PRIVATE KEY-")!=-1&&o.indexOf("4,ENCRYPTED")==-1){var Y=y(ct=H(o,"DSA PRIVATE KEY"),0,[1],"02"),Z=y(ct,0,[2],"02"),de=y(ct,0,[3],"02"),be=y(ct,0,[4],"02"),Ve=y(ct,0,[5],"02");return(We=new K).setPrivate(new N(Y,16),new N(Z,16),new N(de,16),new N(be,16),new N(Ve,16)),We}if(o.indexOf("-END EC PRIVATE KEY-")!=-1&&o.indexOf("4,ENCRYPTED")==-1)return z=H(o,"EC PRIVATE KEY"),W.getKey(z,null,"pkcs5prv");if(o.indexOf("-END PRIVATE KEY-")!=-1)return W.getKeyFromPlainPrivatePKCS8PEM(o);if(o.indexOf("-END RSA PRIVATE KEY-")!=-1&&o.indexOf("4,ENCRYPTED")!=-1){var Pe=W.getDecryptedKeyHex(o,i),Ye=new Oe;return Ye.readPKCS5PrvKeyHex(Pe),Ye}if(o.indexOf("-END EC PRIVATE KEY-")!=-1&&o.indexOf("4,ENCRYPTED")!=-1){var $e,We=y(ct=W.getDecryptedKeyHex(o,i),0,[1],"04"),lt=y(ct,0,[2,0],"06"),ht=y(ct,0,[3,0],"03").substr(2);if(v.crypto.OID.oidhex2name[lt]===void 0)throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+lt);return($e=new U({curve:v.crypto.OID.oidhex2name[lt]})).setPublicKeyHex(ht),$e.setPrivateKeyHex(We),$e.isPublic=!1,$e}if(o.indexOf("-END DSA PRIVATE KEY-")!=-1&&o.indexOf("4,ENCRYPTED")!=-1){var ct;return Y=y(ct=W.getDecryptedKeyHex(o,i),0,[1],"02"),Z=y(ct,0,[2],"02"),de=y(ct,0,[3],"02"),be=y(ct,0,[4],"02"),Ve=y(ct,0,[5],"02"),(We=new K).setPrivate(new N(Y,16),new N(Z,16),new N(de,16),new N(be,16),new N(Ve,16)),We}if(o.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return W.getKeyFromEncryptedPKCS8PEM(o,i);throw new Error("not supported argument")},st.generateKeypair=function(o,i){if(o=="RSA"){var u=i;(U=new Oe).generate(u,"10001"),U.isPrivate=!0,U.isPublic=!0;var d=new Oe,y=U.n.toString(16),C=U.e.toString(16);return d.setPublic(y,C),d.isPrivate=!1,d.isPublic=!0,(K={}).prvKeyObj=U,K.pubKeyObj=d,K}if(o=="EC"){var U,K,$=i,H=new v.crypto.ECDSA({curve:$}).generateKeyPairHex();return(U=new v.crypto.ECDSA({curve:$})).setPublicKeyHex(H.ecpubhex),U.setPrivateKeyHex(H.ecprvhex),U.isPrivate=!0,U.isPublic=!1,(d=new v.crypto.ECDSA({curve:$})).setPublicKeyHex(H.ecpubhex),d.isPrivate=!1,d.isPublic=!0,(K={}).prvKeyObj=U,K.pubKeyObj=d,K}throw new Error("unknown algorithm: "+o)},st.getPEM=function(o,i,u,d,y,C){var U=v,K=U.asn1,$=K.DERObjectIdentifier,H=K.DERInteger,W=K.ASN1Util.newObject,J=K.x509.SubjectPublicKeyInfo,te=U.crypto,oe=te.DSA,ue=te.ECDSA,fe=Oe;function ye($e){return W({seq:[{int:0},{int:{bigint:$e.n}},{int:$e.e},{int:{bigint:$e.d}},{int:{bigint:$e.p}},{int:{bigint:$e.q}},{int:{bigint:$e.dmp1}},{int:{bigint:$e.dmq1}},{int:{bigint:$e.coeff}}]})}function O($e){return W({seq:[{int:1},{octstr:{hex:$e.prvKeyHex}},{tag:["a0",!0,{oid:{name:$e.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+$e.pubKeyHex}}]}]})}function z($e){return W({seq:[{int:0},{int:{bigint:$e.p}},{int:{bigint:$e.q}},{int:{bigint:$e.g}},{int:{bigint:$e.y}},{int:{bigint:$e.x}}]})}if((fe!==void 0&&o instanceof fe||oe!==void 0&&o instanceof oe||ue!==void 0&&o instanceof ue)&&o.isPublic==1&&(i===void 0||i=="PKCS8PUB"))return Le(be=new J(o).getEncodedHex(),"PUBLIC KEY");if(i=="PKCS1PRV"&&fe!==void 0&&o instanceof fe&&(u===void 0||u==null)&&o.isPrivate==1)return Le(be=ye(o).getEncodedHex(),"RSA PRIVATE KEY");if(i=="PKCS1PRV"&&ue!==void 0&&o instanceof ue&&(u===void 0||u==null)&&o.isPrivate==1){var Y=new $({name:o.curveName}).getEncodedHex(),Z=O(o).getEncodedHex(),de="";return de+=Le(Y,"EC PARAMETERS"),de+=Le(Z,"EC PRIVATE KEY")}if(i=="PKCS1PRV"&&oe!==void 0&&o instanceof oe&&(u===void 0||u==null)&&o.isPrivate==1)return Le(be=z(o).getEncodedHex(),"DSA PRIVATE KEY");if(i=="PKCS5PRV"&&fe!==void 0&&o instanceof fe&&u!==void 0&&u!=null&&o.isPrivate==1){var be=ye(o).getEncodedHex();return d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",be,u,d,C)}if(i=="PKCS5PRV"&&ue!==void 0&&o instanceof ue&&u!==void 0&&u!=null&&o.isPrivate==1)return be=O(o).getEncodedHex(),d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",be,u,d,C);if(i=="PKCS5PRV"&&oe!==void 0&&o instanceof oe&&u!==void 0&&u!=null&&o.isPrivate==1)return be=z(o).getEncodedHex(),d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",be,u,d,C);var Ve=function(We,lt){var ht=Pe(We,lt);return new W({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:ht.pbkdf2Salt}},{int:ht.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:ht.encryptionSchemeIV}}]}]}]},{octstr:{hex:ht.ciphertext}}]}).getEncodedHex()},Pe=function(We,lt){var ht=P.lib.WordArray.random(8),ct=P.lib.WordArray.random(8),Vt=P.PBKDF2(lt,ht,{keySize:6,iterations:100}),Lt=P.enc.Hex.parse(We),Bt=P.TripleDES.encrypt(Lt,Vt,{iv:ct})+"",bt={};return bt.ciphertext=Bt,bt.pbkdf2Salt=P.enc.Hex.stringify(ht),bt.pbkdf2Iter=100,bt.encryptionSchemeAlg="DES-EDE3-CBC",bt.encryptionSchemeIV=P.enc.Hex.stringify(ct),bt};if(i=="PKCS8PRV"&&fe!=null&&o instanceof fe&&o.isPrivate==1){var Ye=ye(o).getEncodedHex();return be=W({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:Ye}}]}).getEncodedHex(),u===void 0||u==null?Le(be,"PRIVATE KEY"):Le(Z=Ve(be,u),"ENCRYPTED PRIVATE KEY")}if(i=="PKCS8PRV"&&ue!==void 0&&o instanceof ue&&o.isPrivate==1)return Ye=new W({seq:[{int:1},{octstr:{hex:o.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+o.pubKeyHex}}]}]}).getEncodedHex(),be=W({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:o.curveName}}]},{octstr:{hex:Ye}}]}).getEncodedHex(),u===void 0||u==null?Le(be,"PRIVATE KEY"):Le(Z=Ve(be,u),"ENCRYPTED PRIVATE KEY");if(i=="PKCS8PRV"&&oe!==void 0&&o instanceof oe&&o.isPrivate==1)return Ye=new H({bigint:o.x}).getEncodedHex(),be=W({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:o.p}},{int:{bigint:o.q}},{int:{bigint:o.g}}]}]},{octstr:{hex:Ye}}]}).getEncodedHex(),u===void 0||u==null?Le(be,"PRIVATE KEY"):Le(Z=Ve(be,u),"ENCRYPTED PRIVATE KEY");throw new Error("unsupported object nor format")},st.getKeyFromCSRPEM=function(o){var i=De(o,"CERTIFICATE REQUEST");return st.getKeyFromCSRHex(i)},st.getKeyFromCSRHex=function(o){var i=st.parseCSRHex(o);return st.getKey(i.p8pubkeyhex,null,"pkcs8pub")},st.parseCSRHex=function(o){var i=le,u=i.getChildIdx,d=i.getTLV,y={},C=o;if(C.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var U=u(C,0);if(U.length<1)throw new Error("malformed CSR(code:002)");if(C.substr(U[0],2)!="30")throw new Error("malformed CSR(code:003)");var K=u(C,U[0]);if(K.length<3)throw new Error("malformed CSR(code:004)");return y.p8pubkeyhex=d(C,K[2]),y},st.getKeyID=function(o){var i=st,u=le;typeof o=="string"&&o.indexOf("BEGIN ")!=-1&&(o=i.getKey(o));var d=De(i.getPEM(o)),y=u.getIdxbyList(d,0,[1]),C=u.getV(d,y).substring(2);return v.crypto.Util.hashHex(C,"sha1")},st.getJWKFromKey=function(o){var i={};if(o instanceof Oe&&o.isPrivate)return i.kty="RSA",i.n=wt(o.n.toString(16)),i.e=wt(o.e.toString(16)),i.d=wt(o.d.toString(16)),i.p=wt(o.p.toString(16)),i.q=wt(o.q.toString(16)),i.dp=wt(o.dmp1.toString(16)),i.dq=wt(o.dmq1.toString(16)),i.qi=wt(o.coeff.toString(16)),i;if(o instanceof Oe&&o.isPublic)return i.kty="RSA",i.n=wt(o.n.toString(16)),i.e=wt(o.e.toString(16)),i;if(o instanceof v.crypto.ECDSA&&o.isPrivate){if((d=o.getShortNISTPCurveName())!=="P-256"&&d!=="P-384")throw new Error("unsupported curve name for JWT: "+d);var u=o.getPublicKeyXYHex();return i.kty="EC",i.crv=d,i.x=wt(u.x),i.y=wt(u.y),i.d=wt(o.prvKeyHex),i}if(o instanceof v.crypto.ECDSA&&o.isPublic){var d;if((d=o.getShortNISTPCurveName())!=="P-256"&&d!=="P-384")throw new Error("unsupported curve name for JWT: "+d);return u=o.getPublicKeyXYHex(),i.kty="EC",i.crv=d,i.x=wt(u.x),i.y=wt(u.y),i}throw new Error("not supported key object")},Oe.getPosArrayOfChildrenFromHex=function(o){return le.getChildIdx(o,0)},Oe.getHexValueArrayOfChildrenFromHex=function(o){var i,u=le.getV,d=u(o,(i=Oe.getPosArrayOfChildrenFromHex(o))[0]),y=u(o,i[1]),C=u(o,i[2]),U=u(o,i[3]),K=u(o,i[4]),$=u(o,i[5]),H=u(o,i[6]),W=u(o,i[7]),J=u(o,i[8]);return(i=new Array).push(d,y,C,U,K,$,H,W,J),i},Oe.prototype.readPrivateKeyFromPEMString=function(o){var i=De(o),u=Oe.getHexValueArrayOfChildrenFromHex(i);this.setPrivateEx(u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8])},Oe.prototype.readPKCS5PrvKeyHex=function(o){var i=Oe.getHexValueArrayOfChildrenFromHex(o);this.setPrivateEx(i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])},Oe.prototype.readPKCS8PrvKeyHex=function(o){var i,u,d,y,C,U,K,$,H=le,W=H.getVbyListEx;if(H.isASN1HEX(o)===!1)throw new Error("not ASN.1 hex string");try{i=W(o,0,[2,0,1],"02"),u=W(o,0,[2,0,2],"02"),d=W(o,0,[2,0,3],"02"),y=W(o,0,[2,0,4],"02"),C=W(o,0,[2,0,5],"02"),U=W(o,0,[2,0,6],"02"),K=W(o,0,[2,0,7],"02"),$=W(o,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(i,u,d,y,C,U,K,$)},Oe.prototype.readPKCS5PubKeyHex=function(o){var i=le,u=i.getV;if(i.isASN1HEX(o)===!1)throw new Error("keyHex is not ASN.1 hex string");var d=i.getChildIdx(o,0);if(d.length!==2||o.substr(d[0],2)!=="02"||o.substr(d[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var y=u(o,d[0]),C=u(o,d[1]);this.setPublic(y,C)},Oe.prototype.readPKCS8PubKeyHex=function(o){var i=le;if(i.isASN1HEX(o)===!1)throw new Error("not ASN.1 hex string");if(i.getTLVbyListEx(o,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var u=i.getTLVbyListEx(o,0,[1,0]);this.readPKCS5PubKeyHex(u)},Oe.prototype.readCertPubKeyHex=function(o,i){var u,d;(u=new Et).readCertHex(o),d=u.getPublicKeyHex(),this.readPKCS8PubKeyHex(d)};function Yt(o,i){for(var u="",d=i/4-o.length,y=0;y<d;y++)u+="0";return u+o}function sa(o,i,u){for(var d="",y=0;d.length<i;)d+=$t(u(Ht(o+String.fromCharCode.apply(String,[(4278190080&y)>>24,(16711680&y)>>16,(65280&y)>>8,255&y])))),y+=1;return d}function aa(o){for(var i in v.crypto.Util.DIGESTINFOHEAD){var u=v.crypto.Util.DIGESTINFOHEAD[i],d=u.length;if(o.substring(0,d)==u)return[i,o.substring(d)]}return[]}function Et(o){var i,u=le,d=u.getChildIdx,y=u.getV,C=u.getTLV,U=u.getVbyList,K=u.getVbyListEx,$=u.getTLVbyList,H=u.getTLVbyListEx,W=u.getIdxbyList,J=u.getIdxbyListEx,te=u.getVidx,oe=u.getInt,ue=u.oidname,fe=u.hextooidstr,ye=De;try{i=v.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var O=$(this.hex,0,[0,0]);if(O.substr(0,2)=="a0"){var z=$(O,0,[0]),Y=oe(z,0);if(Y<0||2<Y)throw new Error("malformed version field");return this.version=Y+1,this.version}return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return K(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var O=H(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(O)},this.getAlgorithmIdentifierName=function(O){for(var z in i)if(O===i[z])return z;return ue(K(O,0,[0],"06"))},this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return $(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(){return this.getX500Name(this.getSubjectHex())},this.getSubjectHex=function(){return $(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var O=U(this.hex,0,[0,4+this.foffset,0]);return O=O.replace(/(..)/g,"%$1"),O=decodeURIComponent(O)},this.getNotAfter=function(){var O=U(this.hex,0,[0,4+this.foffset,1]);return O=O.replace(/(..)/g,"%$1"),O=decodeURIComponent(O)},this.getPublicKeyHex=function(){return u.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return W(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var O=this.getPublicKeyIdx();return W(this.hex,O,[1,0],"30")},this.getPublicKey=function(){return st.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var O=$(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(O)},this.getSignatureValueHex=function(){return U(this.hex,0,[2],"03",!0)},this.verifySignature=function(O){var z=this.getSignatureAlgorithmField(),Y=this.getSignatureValueHex(),Z=$(this.hex,0,[0],"30"),de=new v.crypto.Signature({alg:z});return de.init(O),de.updateHex(Z),de.verify(Y)},this.parseExt=function(O){var z,Y,Z;if(O===void 0){if(Z=this.hex,this.version!==3)return-1;z=W(Z,0,[0,7,0],"30"),Y=d(Z,z)}else{Z=De(O);var de=W(Z,0,[0,3,0,0],"06");if(y(Z,de)!="2a864886f70d01090e")return void(this.aExtInfo=new Array);z=W(Z,0,[0,3,0,1,0],"30"),Y=d(Z,z),this.hex=Z}this.aExtInfo=new Array;for(var be=0;be<Y.length;be++){var Ve={critical:!1},Pe=0;d(Z,Y[be]).length===3&&(Ve.critical=!0,Pe=1),Ve.oid=u.hextooidstr(U(Z,Y[be],[0],"06"));var Ye=W(Z,Y[be],[1+Pe]);Ve.vidx=te(Z,Ye),this.aExtInfo.push(Ve)}},this.getExtInfo=function(O){var z=this.aExtInfo,Y=O;if(O.match(/^[0-9.]+$/)||(Y=v.asn1.x509.OID.name2oid(O)),Y!==""){for(var Z=0;Z<z.length;Z++)if(z[Z].oid===Y)return z[Z]}},this.getExtBasicConstraints=function(O,z){if(O===void 0&&z===void 0){var Y=this.getExtInfo("basicConstraints");if(Y===void 0)return;O=C(this.hex,Y.vidx),z=Y.critical}var Z={extname:"basicConstraints"};if(z&&(Z.critical=!0),O==="3000")return Z;if(O==="30030101ff")return Z.cA=!0,Z;if(O.substr(0,12)==="30060101ff02"){var de=y(O,10),be=parseInt(de,16);return Z.cA=!0,Z.pathLen=be,Z}throw new Error("hExtV parse error: "+O)},this.getExtKeyUsage=function(O,z){if(O===void 0&&z===void 0){var Y=this.getExtInfo("keyUsage");if(Y===void 0)return;O=C(this.hex,Y.vidx),z=Y.critical}var Z={extname:"keyUsage"};return z&&(Z.critical=!0),Z.names=this.getExtKeyUsageString(O).split(","),Z},this.getExtKeyUsageBin=function(O){if(O===void 0){var z=this.getExtInfo("keyUsage");if(z===void 0)return"";O=C(this.hex,z.vidx)}if(O.length!=8&&O.length!=10)throw new Error("malformed key usage value: "+O);var Y="000000000000000"+parseInt(O.substr(6),16).toString(2);return O.length==8&&(Y=Y.slice(-8)),O.length==10&&(Y=Y.slice(-16)),(Y=Y.replace(/0+$/,""))==""&&(Y="0"),Y},this.getExtKeyUsageString=function(O){for(var z=this.getExtKeyUsageBin(O),Y=new Array,Z=0;Z<z.length;Z++)z.substr(Z,1)=="1"&&Y.push(Et.KEYUSAGE_NAME[Z]);return Y.join(",")},this.getExtSubjectKeyIdentifier=function(O,z){if(O===void 0&&z===void 0){var Y=this.getExtInfo("subjectKeyIdentifier");if(Y===void 0)return;O=C(this.hex,Y.vidx),z=Y.critical}var Z={extname:"subjectKeyIdentifier"};z&&(Z.critical=!0);var de=y(O,0);return Z.kid={hex:de},Z},this.getExtAuthorityKeyIdentifier=function(O,z){if(O===void 0&&z===void 0){var Y=this.getExtInfo("authorityKeyIdentifier");if(Y===void 0)return;O=C(this.hex,Y.vidx),z=Y.critical}var Z={extname:"authorityKeyIdentifier"};z&&(Z.critical=!0);for(var de=d(O,0),be=0;be<de.length;be++){var Ve=O.substr(de[be],2);if(Ve==="80"&&(Z.kid={hex:y(O,de[be])}),Ve==="a1"){var Pe=C(O,de[be]),Ye=this.getGeneralNames(Pe);Z.issuer=Ye[0].dn}Ve==="82"&&(Z.sn={hex:y(O,de[be])})}return Z},this.getExtExtKeyUsage=function(O,z){if(O===void 0&&z===void 0){var Y=this.getExtInfo("extKeyUsage");if(Y===void 0)return;O=C(this.hex,Y.vidx),z=Y.critical}var Z={extname:"extKeyUsage",array:[]};z&&(Z.critical=!0);for(var de=d(O,0),be=0;be<de.length;be++)Z.array.push(ue(y(O,de[be])));return Z},this.getExtExtKeyUsageName=function(){var O=this.getExtInfo("extKeyUsage");if(O===void 0)return O;var z=new Array,Y=C(this.hex,O.vidx);if(Y==="")return z;for(var Z=d(Y,0),de=0;de<Z.length;de++)z.push(ue(y(Y,Z[de])));return z},this.getExtSubjectAltName=function(O,z){if(O===void 0&&z===void 0){var Y=this.getExtInfo("subjectAltName");if(Y===void 0)return;O=C(this.hex,Y.vidx),z=Y.critical}var Z={extname:"subjectAltName",array:[]};return z&&(Z.critical=!0),Z.array=this.getGeneralNames(O),Z},this.getExtIssuerAltName=function(O,z){if(O===void 0&&z===void 0){var Y=this.getExtInfo("issuerAltName");if(Y===void 0)return;O=C(this.hex,Y.vidx),z=Y.critical}var Z={extname:"issuerAltName",array:[]};return z&&(Z.critical=!0),Z.array=this.getGeneralNames(O),Z},this.getGeneralNames=function(O){for(var z=d(O,0),Y=[],Z=0;Z<z.length;Z++){var de=this.getGeneralName(C(O,z[Z]));de!==void 0&&Y.push(de)}return Y},this.getGeneralName=function(O){var z=O.substr(0,2),Y=y(O,0),Z=$t(Y);return z=="81"?{rfc822:Z}:z=="82"?{dns:Z}:z=="86"?{uri:Z}:z=="87"?{ip:Ln(Y)}:z=="a4"?{dn:this.getX500Name(Y)}:void 0},this.getExtSubjectAltName2=function(){var O,z,Y,Z=this.getExtInfo("subjectAltName");if(Z===void 0)return Z;for(var de=new Array,be=C(this.hex,Z.vidx),Ve=d(be,0),Pe=0;Pe<Ve.length;Pe++)Y=be.substr(Ve[Pe],2),O=y(be,Ve[Pe]),Y==="81"&&(z=vt(O),de.push(["MAIL",z])),Y==="82"&&(z=vt(O),de.push(["DNS",z])),Y==="84"&&(z=Et.hex2dn(O,0),de.push(["DN",z])),Y==="86"&&(z=vt(O),de.push(["URI",z])),Y==="87"&&(z=Ln(O),de.push(["IP",z]));return de},this.getExtCRLDistributionPoints=function(O,z){if(O===void 0&&z===void 0){var Y=this.getExtInfo("cRLDistributionPoints");if(Y===void 0)return;O=C(this.hex,Y.vidx),z=Y.critical}var Z={extname:"cRLDistributionPoints",array:[]};z&&(Z.critical=!0);for(var de=d(O,0),be=0;be<de.length;be++){var Ve=C(O,de[be]);Z.array.push(this.getDistributionPoint(Ve))}return Z},this.getDistributionPoint=function(O){for(var z={},Y=d(O,0),Z=0;Z<Y.length;Z++){var de=O.substr(Y[Z],2),be=C(O,Y[Z]);de=="a0"&&(z.dpname=this.getDistributionPointName(be))}return z},this.getDistributionPointName=function(O){for(var z={},Y=d(O,0),Z=0;Z<Y.length;Z++){var de=O.substr(Y[Z],2),be=C(O,Y[Z]);de=="a0"&&(z.full=this.getGeneralNames(be))}return z},this.getExtCRLDistributionPointsURI=function(){var O=this.getExtInfo("cRLDistributionPoints");if(O===void 0)return O;for(var z=new Array,Y=d(this.hex,O.vidx),Z=0;Z<Y.length;Z++)try{var de=vt(U(this.hex,Y[Z],[0,0,0],"86"));z.push(de)}catch{}return z},this.getExtAIAInfo=function(){var O=this.getExtInfo("authorityInfoAccess");if(O===void 0)return O;for(var z={ocsp:[],caissuer:[]},Y=d(this.hex,O.vidx),Z=0;Z<Y.length;Z++){var de=U(this.hex,Y[Z],[0],"06"),be=U(this.hex,Y[Z],[1],"86");de==="2b06010505073001"&&z.ocsp.push(vt(be)),de==="2b06010505073002"&&z.caissuer.push(vt(be))}return z},this.getExtAuthorityInfoAccess=function(O,z){if(O===void 0&&z===void 0){var Y=this.getExtInfo("authorityInfoAccess");if(Y===void 0)return;O=C(this.hex,Y.vidx),z=Y.critical}var Z={extname:"authorityInfoAccess",array:[]};z&&(Z.critical=!0);for(var de=d(O,0),be=0;be<de.length;be++){var Ve=K(O,de[be],[0],"06"),Pe=vt(U(O,de[be],[1],"86"));if(Ve=="2b06010505073001")Z.array.push({ocsp:Pe});else{if(Ve!="2b06010505073002")throw new Error("unknown method: "+Ve);Z.array.push({caissuer:Pe})}}return Z},this.getExtCertificatePolicies=function(O,z){if(O===void 0&&z===void 0){var Y=this.getExtInfo("certificatePolicies");if(Y===void 0)return;O=C(this.hex,Y.vidx),z=Y.critical}var Z={extname:"certificatePolicies",array:[]};z&&(Z.critical=!0);for(var de=d(O,0),be=0;be<de.length;be++){var Ve=C(O,de[be]),Pe=this.getPolicyInformation(Ve);Z.array.push(Pe)}return Z},this.getPolicyInformation=function(O){var z={},Y=U(O,0,[0],"06");z.policyoid=ue(Y);var Z=J(O,0,[1],"30");if(Z!=-1){z.array=[];for(var de=d(O,Z),be=0;be<de.length;be++){var Ve=C(O,de[be]),Pe=this.getPolicyQualifierInfo(Ve);z.array.push(Pe)}}return z},this.getPolicyQualifierInfo=function(O){var z={},Y=U(O,0,[0],"06");if(Y==="2b06010505070201"){var Z=K(O,0,[1],"16");z.cps=$t(Z)}else if(Y==="2b06010505070202"){var de=$(O,0,[1],"30");z.unotice=this.getUserNotice(de)}return z},this.getUserNotice=function(O){for(var z={},Y=d(O,0),Z=0;Z<Y.length;Z++){var de=C(O,Y[Z]);de.substr(0,2)!="30"&&(z.exptext=this.getDisplayText(de))}return z},this.getDisplayText=function(O){var z={};return z.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[O.substr(0,2)],z.str=$t(y(O,0)),z},this.getExtCRLNumber=function(O,z){var Y={extname:"cRLNumber"};if(z&&(Y.critical=!0),O.substr(0,2)=="02")return Y.num={hex:y(O,0)},Y;throw new Error("hExtV parse error: "+O)},this.getExtCRLReason=function(O,z){var Y={extname:"cRLReason"};if(z&&(Y.critical=!0),O.substr(0,2)=="0a")return Y.code=parseInt(y(O,0),16),Y;throw new Error("hExtV parse error: "+O)},this.getExtOcspNonce=function(O,z){var Y={extname:"ocspNonce"};z&&(Y.critical=!0);var Z=y(O,0);return Y.hex=Z,Y},this.getExtOcspNoCheck=function(O,z){var Y={extname:"ocspNoCheck"};return z&&(Y.critical=!0),Y},this.getExtAdobeTimeStamp=function(O,z){if(O===void 0&&z===void 0){var Y=this.getExtInfo("adobeTimeStamp");if(Y===void 0)return;O=C(this.hex,Y.vidx),z=Y.critical}var Z={extname:"adobeTimeStamp"};z&&(Z.critical=!0);var de=d(O,0);if(de.length>1){var be=C(O,de[1]),Ve=this.getGeneralName(be);Ve.uri!=null&&(Z.uri=Ve.uri)}if(de.length>2){var Pe=C(O,de[2]);Pe=="0101ff"&&(Z.reqauth=!0),Pe=="010100"&&(Z.reqauth=!1)}return Z},this.getX500NameRule=function(O){for(var z=null,Y=[],Z=0;Z<O.length;Z++)for(var de=O[Z],be=0;be<de.length;be++)Y.push(de[be]);for(Z=0;Z<Y.length;Z++){var Ve=Y[Z],Pe=Ve.ds,Ye=Ve.value,$e=Ve.type;if(Pe!="prn"&&Pe!="utf8"&&Pe!="ia5")return"mixed";if(Pe=="ia5"){if($e!="CN")return"mixed";if(v.lang.String.isMail(Ye))continue;return"mixed"}if($e=="C"){if(Pe=="prn")continue;return"mixed"}if(z==null)z=Pe;else if(z!==Pe)return"mixed"}return z??"prn"},this.getX500Name=function(O){var z=this.getX500NameArray(O);return{array:z,str:this.dnarraytostr(z)}},this.getX500NameArray=function(O){for(var z=[],Y=d(O,0),Z=0;Z<Y.length;Z++)z.push(this.getRDN(C(O,Y[Z])));return z},this.getRDN=function(O){for(var z=[],Y=d(O,0),Z=0;Z<Y.length;Z++)z.push(this.getAttrTypeAndValue(C(O,Y[Z])));return z},this.getAttrTypeAndValue=function(O){var z={type:null,value:null,ds:null},Y=d(O,0),Z=U(O,Y[0],[],"06"),de=U(O,Y[1],[]),be=v.asn1.ASN1Util.oidHexToInt(Z);return z.type=v.asn1.x509.OID.oid2atype(be),z.ds=this.HEX2STAG[O.substr(Y[1],2)],z.ds!="bmp"?z.value=vt(de):z.value=Dn(de),z},this.readCertPEM=function(O){this.readCertHex(ye(O))},this.readCertHex=function(O){this.hex=O,this.getVersion();try{W(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(){var O={};return O.version=this.getVersion(),O.serial={hex:this.getSerialNumberHex()},O.sigalg=this.getSignatureAlgorithmField(),O.issuer=this.getIssuer(),O.notbefore=this.getNotBefore(),O.notafter=this.getNotAfter(),O.subject=this.getSubject(),O.sbjpubkey=Le(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo.length>0&&(O.ext=this.getExtParamArray()),O.sighex=this.getSignatureValueHex(),O},this.getExtParamArray=function(O){O==null&&J(this.hex,0,[0,"[3]"])!=-1&&(O=H(this.hex,0,[0,"[3]",0],"30"));for(var z=[],Y=d(O,0),Z=0;Z<Y.length;Z++){var de=C(O,Y[Z]),be=this.getExtParam(de);be!=null&&z.push(be)}return z},this.getExtParam=function(O){var z=d(O,0).length;if(z!=2&&z!=3)throw new Error("wrong number elements in Extension: "+z+" "+O);var Y=fe(U(O,0,[0],"06")),Z=!1;z==3&&$(O,0,[1])=="0101ff"&&(Z=!0);var de=$(O,0,[z-1,0]),be=void 0;if(Y=="2.5.29.14"?be=this.getExtSubjectKeyIdentifier(de,Z):Y=="2.5.29.15"?be=this.getExtKeyUsage(de,Z):Y=="2.5.29.17"?be=this.getExtSubjectAltName(de,Z):Y=="2.5.29.18"?be=this.getExtIssuerAltName(de,Z):Y=="2.5.29.19"?be=this.getExtBasicConstraints(de,Z):Y=="2.5.29.31"?be=this.getExtCRLDistributionPoints(de,Z):Y=="2.5.29.32"?be=this.getExtCertificatePolicies(de,Z):Y=="2.5.29.35"?be=this.getExtAuthorityKeyIdentifier(de,Z):Y=="2.5.29.37"?be=this.getExtExtKeyUsage(de,Z):Y=="1.3.6.1.5.5.7.1.1"?be=this.getExtAuthorityInfoAccess(de,Z):Y=="2.5.29.20"?be=this.getExtCRLNumber(de,Z):Y=="2.5.29.21"?be=this.getExtCRLReason(de,Z):Y=="1.3.6.1.5.5.7.48.1.2"?be=this.getExtOcspNonce(de,Z):Y=="1.3.6.1.5.5.7.48.1.5"?be=this.getExtOcspNoCheck(de,Z):Y=="1.2.840.113583.1.1.9.1"&&(be=this.getExtAdobeTimeStamp(de,Z)),be!=null)return be;var Ve={extname:Y,extn:de};return Z&&(Ve.critical=!0),Ve},this.findExt=function(O,z){for(var Y=0;Y<O.length;Y++)if(O[Y].extname==z)return O[Y];return null},this.updateExtCDPFullURI=function(O,z){var Y=this.findExt(O,"cRLDistributionPoints");if(Y!=null&&Y.array!=null){for(var Z=Y.array,de=0;de<Z.length;de++)if(Z[de].dpname!=null&&Z[de].dpname.full!=null)for(var be=Z[de].dpname.full,Ve=0;Ve<be.length;Ve++){var Pe=be[de];Pe.uri!=null&&(Pe.uri=z)}}},this.updateExtAIAOCSP=function(O,z){var Y=this.findExt(O,"authorityInfoAccess");if(Y!=null&&Y.array!=null)for(var Z=Y.array,de=0;de<Z.length;de++)Z[de].ocsp!=null&&(Z[de].ocsp=z)},this.updateExtAIACAIssuer=function(O,z){var Y=this.findExt(O,"authorityInfoAccess");if(Y!=null&&Y.array!=null)for(var Z=Y.array,de=0;de<Z.length;de++)Z[de].caissuer!=null&&(Z[de].caissuer=z)},this.dnarraytostr=function(O){return"/"+O.map((function(z){return(function(Z){return Z.map((function(de){return(function(Ve){return Ve.type+"="+Ve.value})(de).replace(/\+/,"\\+")})).join("+")})(z).replace(/\//,"\\/")})).join("/")},this.getInfo=function(){var O,z,Y,Z=function(Vt){return JSON.stringify(Vt.array).replace(/[\[\]\{\}\"]/g,"")},de=function(Vt){for(var Lt="",Bt=Vt.array,bt=0;bt<Bt.length;bt++){var xt=Bt[bt];if(Lt+="    policy oid: "+xt.policyoid+`
`,xt.array!==void 0)for(var Rt=0;Rt<xt.array.length;Rt++){var Mt=xt.array[Rt];Mt.cps!==void 0&&(Lt+="    cps: "+Mt.cps+`
`)}}return Lt},be=function(Vt){for(var Lt="",Bt=Vt.array,bt=0;bt<Bt.length;bt++){var xt=Bt[bt];try{xt.dpname.full[0].uri!==void 0&&(Lt+="    "+xt.dpname.full[0].uri+`
`)}catch{}try{xt.dname.full[0].dn.hex!==void 0&&(Lt+="    "+Et.hex2dn(xt.dpname.full[0].dn.hex)+`
`)}catch{}}return Lt},Ve=function(Vt){for(var Lt="",Bt=Vt.array,bt=0;bt<Bt.length;bt++){var xt=Bt[bt];xt.caissuer!==void 0&&(Lt+="    caissuer: "+xt.caissuer+`
`),xt.ocsp!==void 0&&(Lt+="    ocsp: "+xt.ocsp+`
`)}return Lt};if(O=`Basic Fields
`,O+="  serial number: "+this.getSerialNumberHex()+`
`,O+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,O+="  issuer: "+this.getIssuerString()+`
`,O+="  notBefore: "+this.getNotBefore()+`
`,O+="  notAfter: "+this.getNotAfter()+`
`,O+="  subject: "+this.getSubjectString()+`
`,O+=`  subject public key info: 
`,O+="    key algorithm: "+(z=this.getPublicKey()).type+`
`,z.type==="RSA"&&(O+="    n="+$r(z.n.toString(16)).substr(0,16)+`...
`,O+="    e="+$r(z.e.toString(16))+`
`),(Y=this.aExtInfo)!=null){O+=`X509v3 Extensions:
`;for(var Pe=0;Pe<Y.length;Pe++){var Ye=Y[Pe],$e=v.asn1.x509.OID.oid2name(Ye.oid);$e===""&&($e=Ye.oid);var We="";if(Ye.critical===!0&&(We="CRITICAL"),O+="  "+$e+" "+We+`:
`,$e==="basicConstraints"){var lt=this.getExtBasicConstraints();lt.cA===void 0?O+=`    {}
`:(O+="    cA=true",lt.pathLen!==void 0&&(O+=", pathLen="+lt.pathLen),O+=`
`)}else if($e==="keyUsage")O+="    "+this.getExtKeyUsageString()+`
`;else if($e==="subjectKeyIdentifier")O+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if($e==="authorityKeyIdentifier"){var ht=this.getExtAuthorityKeyIdentifier();ht.kid!==void 0&&(O+="    kid="+ht.kid.hex+`
`)}else $e==="extKeyUsage"?O+="    "+this.getExtExtKeyUsage().array.join(", ")+`
`:$e==="subjectAltName"?O+="    "+Z(this.getExtSubjectAltName())+`
`:$e==="cRLDistributionPoints"?O+=be(this.getExtCRLDistributionPoints()):$e==="authorityInfoAccess"?O+=Ve(this.getExtAuthorityInfoAccess()):$e==="certificatePolicies"&&(O+=de(this.getExtCertificatePolicies()))}}return O+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,O+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`},typeof o=="string"&&(o.indexOf("-----BEGIN")!=-1?this.readCertPEM(o):v.lang.String.isHex(o)&&this.readCertHex(o))}Oe.prototype.sign=function(o,i){var u=(function(y){return v.crypto.Util.hashString(y,i)})(o);return this.signWithMessageHash(u,i)},Oe.prototype.signWithMessageHash=function(o,i){var u=Me(v.crypto.Util.getPaddedDigestInfoHex(o,i,this.n.bitLength()),16);return Yt(this.doPrivate(u).toString(16),this.n.bitLength())},Oe.prototype.signPSS=function(o,i,u){var d=(function(C){return v.crypto.Util.hashHex(C,i)})(Ht(o));return u===void 0&&(u=-1),this.signWithMessageHashPSS(d,i,u)},Oe.prototype.signWithMessageHashPSS=function(o,i,u){var d,y=$t(o),C=y.length,U=this.n.bitLength()-1,K=Math.ceil(U/8),$=function(O){return v.crypto.Util.hashHex(O,i)};if(u===-1||u===void 0)u=C;else if(u===-2)u=K-C-2;else if(u<-2)throw new Error("invalid salt length");if(K<C+u+2)throw new Error("data too long");var H="";u>0&&(H=new Array(u),new _e().nextBytes(H),H=String.fromCharCode.apply(String,H));var W=$t($(Ht("\0\0\0\0\0\0\0\0"+y+H))),J=[];for(d=0;d<K-u-C-2;d+=1)J[d]=0;var te=String.fromCharCode.apply(String,J)+""+H,oe=sa(W,te.length,$),ue=[];for(d=0;d<te.length;d+=1)ue[d]=te.charCodeAt(d)^oe.charCodeAt(d);var fe=65280>>8*K-U&255;for(ue[0]&=~fe,d=0;d<C;d++)ue.push(W.charCodeAt(d));return ue.push(188),Yt(this.doPrivate(new N(ue)).toString(16),this.n.bitLength())},Oe.prototype.verify=function(o,i){if((i=i.toLowerCase()).match(/^[0-9a-f]+$/)==null)return!1;var u=Me(i,16),d=this.n.bitLength();if(u.bitLength()>d)return!1;var y=this.doPublic(u).toString(16);if(y.length+3!=d/4)return!1;var C=aa(y.replace(/^1f+00/,""));if(C.length==0)return!1;var U=C[0];return C[1]==(function($){return v.crypto.Util.hashString($,U)})(o)},Oe.prototype.verifyWithMessageHash=function(o,i){if(i.length!=Math.ceil(this.n.bitLength()/4))return!1;var u=Me(i,16);if(u.bitLength()>this.n.bitLength())return 0;var d=aa(this.doPublic(u).toString(16).replace(/^1f+00/,""));return d.length==0?!1:(d[0],d[1]==o)},Oe.prototype.verifyPSS=function(o,i,u,d){var y=(function(U){return v.crypto.Util.hashHex(U,u)})(Ht(o));return d===void 0&&(d=-1),this.verifyWithMessageHashPSS(y,i,u,d)},Oe.prototype.verifyWithMessageHashPSS=function(o,i,u,d){if(i.length!=Math.ceil(this.n.bitLength()/4))return!1;var y,C=new N(i,16),U=function(Y){return v.crypto.Util.hashHex(Y,u)},K=$t(o),$=K.length,H=this.n.bitLength()-1,W=Math.ceil(H/8);if(d===-1||d===void 0)d=$;else if(d===-2)d=W-$-2;else if(d<-2)throw new Error("invalid salt length");if(W<$+d+2)throw new Error("data too long");var J=this.doPublic(C).toByteArray();for(y=0;y<J.length;y+=1)J[y]&=255;for(;J.length<W;)J.unshift(0);if(J[W-1]!==188)throw new Error("encoded message does not end in 0xbc");var te=(J=String.fromCharCode.apply(String,J)).substr(0,W-$-1),oe=J.substr(te.length,$),ue=65280>>8*W-H&255;if((te.charCodeAt(0)&ue)!=0)throw new Error("bits beyond keysize not zero");var fe=sa(oe,te.length,U),ye=[];for(y=0;y<te.length;y+=1)ye[y]=te.charCodeAt(y)^fe.charCodeAt(y);ye[0]&=~ue;var O=W-$-d-2;for(y=0;y<O;y+=1)if(ye[y]!==0)throw new Error("leftmost octets not zero");if(ye[O]!==1)throw new Error("0x01 marker not found");return oe===$t(U(Ht("\0\0\0\0\0\0\0\0"+K+String.fromCharCode.apply(String,ye.slice(-d)))))},Oe.SALT_LEN_HLEN=-1,Oe.SALT_LEN_MAX=-2,Oe.SALT_LEN_RECOVER=-2,Et.hex2dn=function(o,i){i===void 0&&(i=0);var u=new Et;return le.getTLV(o,i),u.getX500Name(o).str},Et.hex2rdn=function(o,i){if(i===void 0&&(i=0),o.substr(i,2)!=="31")throw new Error("malformed RDN");for(var u=new Array,d=le.getChildIdx(o,i),y=0;y<d.length;y++)u.push(Et.hex2attrTypeValue(o,d[y]));return(u=u.map((function(C){return C.replace("+","\\+")}))).join("+")},Et.hex2attrTypeValue=function(o,i){var u=le,d=u.getV;if(i===void 0&&(i=0),o.substr(i,2)!=="30")throw new Error("malformed attribute type and value");var y=u.getChildIdx(o,i);y.length!==2||o.substr(y[0],2);var C=d(o,y[0]),U=v.asn1.ASN1Util.oidHexToInt(C);return v.asn1.x509.OID.oid2atype(U)+"="+$t(d(o,y[1]))},Et.getPublicKeyFromCertHex=function(o){var i=new Et;return i.readCertHex(o),i.getPublicKey()},Et.getPublicKeyFromCertPEM=function(o){var i=new Et;return i.readCertPEM(o),i.getPublicKey()},Et.getPublicKeyInfoPropOfCertPEM=function(o){var i,u,d=le.getVbyList,y={};return y.algparam=null,(i=new Et).readCertPEM(o),u=i.getPublicKeyHex(),y.keyhex=d(u,0,[1],"03").substr(2),y.algoid=d(u,0,[0,0],"06"),y.algoid==="2a8648ce3d0201"&&(y.algparam=d(u,0,[0,1],"06")),y},Et.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],v!==void 0&&v||(n.KJUR=v={}),v.jws!==void 0&&v.jws||(v.jws={}),v.jws.JWS=function(){var o=v.jws.JWS.isSafeJSONString;this.parseJWS=function(i,u){if(this.parsedJWS===void 0||!u&&this.parsedJWS.sigvalH===void 0){var d=i.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(d==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var y=d[1],C=d[2],U=d[3],K=y+"."+C;if(this.parsedJWS={},this.parsedJWS.headB64U=y,this.parsedJWS.payloadB64U=C,this.parsedJWS.sigvalB64U=U,this.parsedJWS.si=K,!u){var $=it(U),H=Me($,16);this.parsedJWS.sigvalH=$,this.parsedJWS.sigvalBI=H}var W=he(y),J=he(C);if(this.parsedJWS.headS=W,this.parsedJWS.payloadS=J,!o(W,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+W}}},v.jws.JWS.sign=function(o,i,u,d,y){var C,U,K,$=v,H=$.jws.JWS,W=H.readSafeJSONString,J=H.isSafeJSONString,te=$.crypto,oe=(te.ECDSA,te.Mac),ue=te.Signature,fe=JSON;if(typeof i!="string"&&(i===void 0?"undefined":b(i))!="object")throw"spHeader must be JSON string or object: "+i;if((i===void 0?"undefined":b(i))=="object"&&(U=i,C=fe.stringify(U)),typeof i=="string"){if(!J(C=i))throw"JWS Head is not safe JSON string: "+C;U=W(C)}if(K=u,(u===void 0?"undefined":b(u))=="object"&&(K=fe.stringify(u)),o!=""&&o!=null||U.alg===void 0||(o=U.alg),o!=""&&o!=null&&U.alg===void 0&&(U.alg=o,C=fe.stringify(U)),o!==U.alg)throw"alg and sHeader.alg doesn't match: "+o+"!="+U.alg;var ye=null;if(H.jwsalg2sigalg[o]===void 0)throw"unsupported alg name: "+o;ye=H.jwsalg2sigalg[o];var O=ae(C)+"."+ae(K),z="";if(ye.substr(0,4)=="Hmac"){if(d===void 0)throw"mac key shall be specified for HS* alg";var Y=new oe({alg:ye,prov:"cryptojs",pass:d});Y.updateString(O),z=Y.doFinal()}else if(ye.indexOf("withECDSA")!=-1){(de=new ue({alg:ye})).init(d,y),de.updateString(O);var Z=de.sign();z=v.crypto.ECDSA.asn1SigToConcatSig(Z)}else{var de;ye!="none"&&((de=new ue({alg:ye})).init(d,y),de.updateString(O),z=de.sign())}return O+"."+wt(z)},v.jws.JWS.verify=function(o,i,u){var d,y=v,C=y.jws.JWS,U=C.readSafeJSONString,K=y.crypto,$=K.ECDSA,H=K.Mac,W=K.Signature;b(Oe)!==void 0&&(d=Oe);var J=o.split(".");if(J.length!==3)return!1;var te=J[0]+"."+J[1],oe=it(J[2]),ue=U(he(J[0])),fe=null,ye=null;if(ue.alg===void 0)throw"algorithm not specified in header";if(ye=(fe=ue.alg).substr(0,2),u!=null&&Object.prototype.toString.call(u)==="[object Array]"&&u.length>0&&(":"+u.join(":")+":").indexOf(":"+fe+":")==-1)throw"algorithm '"+fe+"' not accepted in the list";if(fe!="none"&&i===null)throw"key shall be specified to verify.";if(typeof i=="string"&&i.indexOf("-----BEGIN ")!=-1&&(i=st.getKey(i)),!(ye!="RS"&&ye!="PS"||i instanceof d))throw"key shall be a RSAKey obj for RS* and PS* algs";if(ye=="ES"&&!(i instanceof $))throw"key shall be a ECDSA obj for ES* algs";var O=null;if(C.jwsalg2sigalg[ue.alg]===void 0)throw"unsupported alg name: "+fe;if((O=C.jwsalg2sigalg[fe])=="none")throw"not supported";if(O.substr(0,4)=="Hmac"){if(i===void 0)throw"hexadecimal key shall be specified for HMAC";var z=new H({alg:O,pass:i});return z.updateString(te),oe==z.doFinal()}if(O.indexOf("withECDSA")!=-1){var Y,Z=null;try{Z=$.concatSigToASN1Sig(oe)}catch{return!1}return(Y=new W({alg:O})).init(i),Y.updateString(te),Y.verify(Z)}return(Y=new W({alg:O})).init(i),Y.updateString(te),Y.verify(oe)},v.jws.JWS.parse=function(o){var i,u,d,y=o.split("."),C={};if(y.length!=2&&y.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return i=y[0],u=y[1],y.length==3&&(d=y[2]),C.headerObj=v.jws.JWS.readSafeJSONString(he(i)),C.payloadObj=v.jws.JWS.readSafeJSONString(he(u)),C.headerPP=JSON.stringify(C.headerObj,null,"  "),C.payloadObj==null?C.payloadPP=he(u):C.payloadPP=JSON.stringify(C.payloadObj,null,"  "),d!==void 0&&(C.sigHex=it(d)),C},v.jws.JWS.verifyJWT=function(o,i,u){var d=v.jws,y=d.JWS,C=y.readSafeJSONString,U=y.inArray,K=y.includedArray,$=o.split("."),H=$[0],W=$[1],J=(it($[2]),C(he(H))),te=C(he(W));if(J.alg===void 0)return!1;if(u.alg===void 0)throw"acceptField.alg shall be specified";if(!U(J.alg,u.alg)||te.iss!==void 0&&b(u.iss)==="object"&&!U(te.iss,u.iss)||te.sub!==void 0&&b(u.sub)==="object"&&!U(te.sub,u.sub))return!1;if(te.aud!==void 0&&b(u.aud)==="object"){if(typeof te.aud=="string"){if(!U(te.aud,u.aud))return!1}else if(b(te.aud)=="object"&&!K(te.aud,u.aud))return!1}var oe=d.IntDate.getNow();return u.verifyAt!==void 0&&typeof u.verifyAt=="number"&&(oe=u.verifyAt),u.gracePeriod!==void 0&&typeof u.gracePeriod=="number"||(u.gracePeriod=0),!(te.exp!==void 0&&typeof te.exp=="number"&&te.exp+u.gracePeriod<oe)&&!(te.nbf!==void 0&&typeof te.nbf=="number"&&oe<te.nbf-u.gracePeriod)&&!(te.iat!==void 0&&typeof te.iat=="number"&&oe<te.iat-u.gracePeriod)&&(te.jti===void 0||u.jti===void 0||te.jti===u.jti)&&!!y.verify(o,i,u.alg)},v.jws.JWS.includedArray=function(o,i){var u=v.jws.JWS.inArray;if(o===null||(o===void 0?"undefined":b(o))!=="object"||typeof o.length!="number")return!1;for(var d=0;d<o.length;d++)if(!u(o[d],i))return!1;return!0},v.jws.JWS.inArray=function(o,i){if(i===null||(i===void 0?"undefined":b(i))!=="object"||typeof i.length!="number")return!1;for(var u=0;u<i.length;u++)if(i[u]==o)return!0;return!1},v.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},v.jws.JWS.isSafeJSONString=function(o,i,u){var d=null;try{return((d=E(o))===void 0?"undefined":b(d))!="object"||d.constructor===Array?0:(i&&(i[u]=d),1)}catch{return 0}},v.jws.JWS.readSafeJSONString=function(o){var i=null;try{return((i=E(o))===void 0?"undefined":b(i))!="object"||i.constructor===Array?null:i}catch{return null}},v.jws.JWS.getEncodedSignatureValueFromJWS=function(o){var i=o.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(i==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return i[1]},v.jws.JWS.getJWKthumbprint=function(o){if(o.kty!=="RSA"&&o.kty!=="EC"&&o.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var i="{";if(o.kty==="RSA"){if(typeof o.n!="string"||typeof o.e!="string")throw"wrong n and e value for RSA key";i+='"e":"'+o.e+'",',i+='"kty":"'+o.kty+'",',i+='"n":"'+o.n+'"}'}else if(o.kty==="EC"){if(typeof o.crv!="string"||typeof o.x!="string"||typeof o.y!="string")throw"wrong crv, x and y value for EC key";i+='"crv":"'+o.crv+'",',i+='"kty":"'+o.kty+'",',i+='"x":"'+o.x+'",',i+='"y":"'+o.y+'"}'}else if(o.kty==="oct"){if(typeof o.k!="string")throw"wrong k value for oct(symmetric) key";i+='"kty":"'+o.kty+'",',i+='"k":"'+o.k+'"}'}var u=Ht(i);return wt(v.crypto.Util.hashHex(u,"sha256"))},v.jws.IntDate={},v.jws.IntDate.get=function(o){var i=v.jws.IntDate,u=i.getNow,d=i.getZulu;if(o=="now")return u();if(o=="now + 1hour")return u()+3600;if(o=="now + 1day")return u()+86400;if(o=="now + 1month")return u()+2592e3;if(o=="now + 1year")return u()+31536e3;if(o.match(/Z$/))return d(o);if(o.match(/^[0-9]+$/))return parseInt(o);throw"unsupported format: "+o},v.jws.IntDate.getZulu=function(o){return St(o)},v.jws.IntDate.getNow=function(){return~~(new Date/1e3)},v.jws.IntDate.intDate2UTCString=function(o){return new Date(1e3*o).toUTCString()},v.jws.IntDate.intDate2Zulu=function(o){var i=new Date(1e3*o);return("0000"+i.getUTCFullYear()).slice(-4)+("00"+(i.getUTCMonth()+1)).slice(-2)+("00"+i.getUTCDate()).slice(-2)+("00"+i.getUTCHours()).slice(-2)+("00"+i.getUTCMinutes()).slice(-2)+("00"+i.getUTCSeconds()).slice(-2)+"Z"},n.SecureRandom=_e,n.rng_seed_time=X,n.BigInteger=N,n.RSAKey=Oe;var Sc=v.crypto.EDSA;n.EDSA=Sc;var Ec=v.crypto.DSA;n.DSA=Ec;var xc=v.crypto.Signature;n.Signature=xc;var Ac=v.crypto.MessageDigest;n.MessageDigest=Ac;var Fc=v.crypto.Mac;n.Mac=Fc;var Rc=v.crypto.Cipher;n.Cipher=Rc,n.KEYUTIL=st,n.ASN1HEX=le,n.X509=Et,n.CryptoJS=P,n.b64tohex=ne,n.b64toBA=ce,n.stoBA=Ge,n.BAtos=at,n.BAtohex=tt,n.stohex=Ze,n.stob64=function(i){return M(Ze(i))},n.stob64u=function(i){return Xe(M(Ze(i)))},n.b64utos=function(i){return at(ce(Rr(i)))},n.b64tob64u=Xe,n.b64utob64=Rr,n.hex2b64=M,n.hextob64u=wt,n.b64utohex=it,n.utf8tob64u=ae,n.b64utoutf8=he,n.utf8tob64=function(i){return M(Ft(jr(i)))},n.b64toutf8=function(i){return decodeURIComponent(Mr(ne(i)))},n.utf8tohex=Br,n.hextoutf8=vt,n.hextorstr=$t,n.rstrtohex=Ht,n.hextob64=Pn,n.hextob64nl=V,n.b64nltohex=Q,n.hextopem=Le,n.pemtohex=De,n.hextoArrayBuffer=function(i){if(i.length%2!=0)throw"input is not even length";if(i.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var u=new ArrayBuffer(i.length/2),d=new DataView(u),y=0;y<i.length/2;y++)d.setUint8(y,parseInt(i.substr(2*y,2),16));return u},n.ArrayBuffertohex=function(i){for(var u="",d=new DataView(i),y=0;y<i.byteLength;y++)u+=("00"+d.getUint8(y).toString(16)).slice(-2);return u},n.zulutomsec=qe,n.zulutosec=St,n.zulutodate=function(i){return new Date(qe(i))},n.datetozulu=function(i,u,d){var y,C=i.getUTCFullYear();if(u){if(C<1950||2049<C)throw"not proper year for UTCTime: "+C;y=(""+C).slice(-2)}else y=("000"+C).slice(-4);if(y+=("0"+(i.getUTCMonth()+1)).slice(-2),y+=("0"+i.getUTCDate()).slice(-2),y+=("0"+i.getUTCHours()).slice(-2),y+=("0"+i.getUTCMinutes()).slice(-2),y+=("0"+i.getUTCSeconds()).slice(-2),d){var U=i.getUTCMilliseconds();U!==0&&(y+="."+(U=(U=("00"+U).slice(-3)).replace(/0+$/g,"")))}return y+="Z"},n.uricmptohex=Ft,n.hextouricmp=Mr,n.ipv6tohex=ar,n.hextoipv6=Nn,n.hextoip=Ln,n.iptohex=function(i){var u="malformed IP address";if(!(i=i.toLowerCase(i)).match(/^[0-9.]+$/)){if(i.match(/^[0-9a-f:]+$/)&&i.indexOf(":")!==-1)return ar(i);throw u}var d=i.split(".");if(d.length!==4)throw u;var y="";try{for(var C=0;C<4;C++)y+=("0"+parseInt(d[C]).toString(16)).slice(-2);return y}catch{throw u}},n.encodeURIComponentAll=jr,n.newline_toUnix=function(i){return i=i.replace(/\r\n/gm,`
`)},n.newline_toDos=function(i){return i=(i=i.replace(/\r\n/gm,`
`)).replace(/\n/gm,`\r
`)},n.hextoposhex=$r,n.intarystrtohex=function(i){i=(i=(i=i.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return i.split(/,/).map((function(u,d,y){var C=parseInt(u);if(C<0||255<C)throw"integer not in range 0-255";return("00"+C.toString(16)).slice(-2)})).join("")}catch(u){throw"malformed integer array string: "+u}},n.strdiffidx=function(i,u){var d=i.length;i.length>u.length&&(d=u.length);for(var y=0;y<d;y++)if(i.charCodeAt(y)!=u.charCodeAt(y))return y;return i.length!=u.length?d:-1},n.KJUR=v;var Ic=v.crypto;n.crypto=Ic;var Tc=v.asn1;n.asn1=Tc;var Cc=v.jws;n.jws=Cc;var kc=v.lang;n.lang=kc}).call(this,s(28).Buffer)},function(r,n,s){(function(a){var l=s(30),c=s(31),g=s(32);function h(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function p(q,R){if(h()<R)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(q=new Uint8Array(R)).__proto__=f.prototype:(q===null&&(q=new f(R)),q.length=R),q}function f(q,R,m){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(q,R,m);if(typeof q=="number"){if(typeof R=="string")throw new Error("If encoding is specified then the first argument must be a string");return S(this,q)}return _(this,q,R,m)}function _(q,R,m,k){if(typeof R=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&R instanceof ArrayBuffer?(function(X,ie,ge,re){if(ie.byteLength,ge<0||ie.byteLength<ge)throw new RangeError("'offset' is out of bounds");if(ie.byteLength<ge+(re||0))throw new RangeError("'length' is out of bounds");return ie=ge===void 0&&re===void 0?new Uint8Array(ie):re===void 0?new Uint8Array(ie,ge):new Uint8Array(ie,ge,re),f.TYPED_ARRAY_SUPPORT?(X=ie).__proto__=f.prototype:X=I(X,ie),X})(q,R,m,k):typeof R=="string"?(function(X,ie,ge){if(typeof ge=="string"&&ge!==""||(ge="utf8"),!f.isEncoding(ge))throw new TypeError('"encoding" must be a valid string encoding');var re=0|b(ie,ge),ve=(X=p(X,re)).write(ie,ge);return ve!==re&&(X=X.slice(0,ve)),X})(q,R,m):(function(X,ie){if(f.isBuffer(ie)){var ge=0|F(ie.length);return(X=p(X,ge)).length===0||ie.copy(X,0,0,ge),X}if(ie){if(typeof ArrayBuffer<"u"&&ie.buffer instanceof ArrayBuffer||"length"in ie)return typeof ie.length!="number"||(function(ve){return ve!=ve})(ie.length)?p(X,0):I(X,ie);if(ie.type==="Buffer"&&g(ie.data))return I(X,ie.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")})(q,R)}function x(q){if(typeof q!="number")throw new TypeError('"size" argument must be a number');if(q<0)throw new RangeError('"size" argument must not be negative')}function S(q,R){if(x(R),q=p(q,R<0?0:0|F(R)),!f.TYPED_ARRAY_SUPPORT)for(var m=0;m<R;++m)q[m]=0;return q}function I(q,R){var m=R.length<0?0:0|F(R.length);q=p(q,m);for(var k=0;k<m;k+=1)q[k]=255&R[k];return q}function F(q){if(q>=h())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h().toString(16)+" bytes");return 0|q}function b(q,R){if(f.isBuffer(q))return q.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(q)||q instanceof ArrayBuffer))return q.byteLength;typeof q!="string"&&(q=""+q);var m=q.length;if(m===0)return 0;for(var k=!1;;)switch(R){case"ascii":case"latin1":case"binary":return m;case"utf8":case"utf-8":case void 0:return Ee(q).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*m;case"hex":return m>>>1;case"base64":return Ae(q).length;default:if(k)return Ee(q).length;R=(""+R).toLowerCase(),k=!0}}function A(q,R,m){var k=!1;if((R===void 0||R<0)&&(R=0),R>this.length||((m===void 0||m>this.length)&&(m=this.length),m<=0)||(m>>>=0)<=(R>>>=0))return"";for(q||(q="utf8");;)switch(q){case"hex":return je(this,R,m);case"utf8":case"utf-8":return se(this,R,m);case"ascii":return Ne(this,R,m);case"latin1":case"binary":return Ue(this,R,m);case"base64":return we(this,R,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return me(this,R,m);default:if(k)throw new TypeError("Unknown encoding: "+q);q=(q+"").toLowerCase(),k=!0}}function T(q,R,m){var k=q[R];q[R]=q[m],q[m]=k}function P(q,R,m,k,B){if(q.length===0)return-1;if(typeof m=="string"?(k=m,m=0):m>2147483647?m=2147483647:m<-2147483648&&(m=-2147483648),m=+m,isNaN(m)&&(m=B?0:q.length-1),m<0&&(m=q.length+m),m>=q.length){if(B)return-1;m=q.length-1}else if(m<0){if(!B)return-1;m=0}if(typeof R=="string"&&(R=f.from(R,k)),f.isBuffer(R))return R.length===0?-1:D(q,R,m,k,B);if(typeof R=="number")return R&=255,f.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(q,R,m):Uint8Array.prototype.lastIndexOf.call(q,R,m):D(q,[R],m,k,B);throw new TypeError("val must be string, number or Buffer")}function D(q,R,m,k,B){var X,ie=1,ge=q.length,re=R.length;if(k!==void 0&&((k=String(k).toLowerCase())==="ucs2"||k==="ucs-2"||k==="utf16le"||k==="utf-16le")){if(q.length<2||R.length<2)return-1;ie=2,ge/=2,re/=2,m/=2}function ve(et,Oe){return ie===1?et[Oe]:et.readUInt16BE(Oe*ie)}if(B){var Fe=-1;for(X=m;X<ge;X++)if(ve(q,X)===ve(R,Fe===-1?0:X-Fe)){if(Fe===-1&&(Fe=X),X-Fe+1===re)return Fe*ie}else Fe!==-1&&(X-=X-Fe),Fe=-1}else for(m+re>ge&&(m=ge-re),X=m;X>=0;X--){for(var _e=!0,Me=0;Me<re;Me++)if(ve(q,X+Me)!==ve(R,Me)){_e=!1;break}if(_e)return X}return-1}function j(q,R,m,k){m=Number(m)||0;var B=q.length-m;k?(k=Number(k))>B&&(k=B):k=B;var X=R.length;if(X%2!=0)throw new TypeError("Invalid hex string");k>X/2&&(k=X/2);for(var ie=0;ie<k;++ie){var ge=parseInt(R.substr(2*ie,2),16);if(isNaN(ge))return ie;q[m+ie]=ge}return ie}function M(q,R,m,k){return ke(Ee(R,q.length-m),q,m,k)}function ne(q,R,m,k){return ke((function(X){for(var ie=[],ge=0;ge<X.length;++ge)ie.push(255&X.charCodeAt(ge));return ie})(R),q,m,k)}function ce(q,R,m,k){return ne(q,R,m,k)}function N(q,R,m,k){return ke(Ae(R),q,m,k)}function ee(q,R,m,k){return ke((function(X,ie){for(var ge,re,ve,Fe=[],_e=0;_e<X.length&&!((ie-=2)<0);++_e)re=(ge=X.charCodeAt(_e))>>8,ve=ge%256,Fe.push(ve),Fe.push(re);return Fe})(R,q.length-m),q,m,k)}function we(q,R,m){return R===0&&m===q.length?l.fromByteArray(q):l.fromByteArray(q.slice(R,m))}function se(q,R,m){m=Math.min(q.length,m);for(var k=[],B=R;B<m;){var X,ie,ge,re,ve=q[B],Fe=null,_e=ve>239?4:ve>223?3:ve>191?2:1;if(B+_e<=m)switch(_e){case 1:ve<128&&(Fe=ve);break;case 2:(192&(X=q[B+1]))==128&&(re=(31&ve)<<6|63&X)>127&&(Fe=re);break;case 3:X=q[B+1],ie=q[B+2],(192&X)==128&&(192&ie)==128&&(re=(15&ve)<<12|(63&X)<<6|63&ie)>2047&&(re<55296||re>57343)&&(Fe=re);break;case 4:X=q[B+1],ie=q[B+2],ge=q[B+3],(192&X)==128&&(192&ie)==128&&(192&ge)==128&&(re=(15&ve)<<18|(63&X)<<12|(63&ie)<<6|63&ge)>65535&&re<1114112&&(Fe=re)}Fe===null?(Fe=65533,_e=1):Fe>65535&&(Fe-=65536,k.push(Fe>>>10&1023|55296),Fe=56320|1023&Fe),k.push(Fe),B+=_e}return(function(et){var Oe=et.length;if(Oe<=Re)return String.fromCharCode.apply(String,et);for(var Je="",L=0;L<Oe;)Je+=String.fromCharCode.apply(String,et.slice(L,L+=Re));return Je})(k)}n.Buffer=f,n.SlowBuffer=function(R){return+R!=R&&(R=0),f.alloc(+R)},n.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=a.TYPED_ARRAY_SUPPORT!==void 0?a.TYPED_ARRAY_SUPPORT:(function(){try{var R=new Uint8Array(1);return R.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},R.foo()===42&&typeof R.subarray=="function"&&R.subarray(1,1).byteLength===0}catch{return!1}})(),n.kMaxLength=h(),f.poolSize=8192,f._augment=function(q){return q.__proto__=f.prototype,q},f.from=function(q,R,m){return _(null,q,R,m)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(q,R,m){return(function(B,X,ie,ge){return x(X),X<=0?p(B,X):ie!==void 0?typeof ge=="string"?p(B,X).fill(ie,ge):p(B,X).fill(ie):p(B,X)})(null,q,R,m)},f.allocUnsafe=function(q){return S(null,q)},f.allocUnsafeSlow=function(q){return S(null,q)},f.isBuffer=function(R){return!(R==null||!R._isBuffer)},f.compare=function(R,m){if(!f.isBuffer(R)||!f.isBuffer(m))throw new TypeError("Arguments must be Buffers");if(R===m)return 0;for(var k=R.length,B=m.length,X=0,ie=Math.min(k,B);X<ie;++X)if(R[X]!==m[X]){k=R[X],B=m[X];break}return k<B?-1:B<k?1:0},f.isEncoding=function(R){switch(String(R).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(R,m){if(!g(R))throw new TypeError('"list" argument must be an Array of Buffers');if(R.length===0)return f.alloc(0);var k;if(m===void 0)for(m=0,k=0;k<R.length;++k)m+=R[k].length;var B=f.allocUnsafe(m),X=0;for(k=0;k<R.length;++k){var ie=R[k];if(!f.isBuffer(ie))throw new TypeError('"list" argument must be an Array of Buffers');ie.copy(B,X),X+=ie.length}return B},f.byteLength=b,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var R=this.length;if(R%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var m=0;m<R;m+=2)T(this,m,m+1);return this},f.prototype.swap32=function(){var R=this.length;if(R%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var m=0;m<R;m+=4)T(this,m,m+3),T(this,m+1,m+2);return this},f.prototype.swap64=function(){var R=this.length;if(R%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var m=0;m<R;m+=8)T(this,m,m+7),T(this,m+1,m+6),T(this,m+2,m+5),T(this,m+3,m+4);return this},f.prototype.toString=function(){var R=0|this.length;return R===0?"":arguments.length===0?se(this,0,R):A.apply(this,arguments)},f.prototype.equals=function(R){if(!f.isBuffer(R))throw new TypeError("Argument must be a Buffer");return this===R||f.compare(this,R)===0},f.prototype.inspect=function(){var R="",m=n.INSPECT_MAX_BYTES;return this.length>0&&(R=this.toString("hex",0,m).match(/.{2}/g).join(" "),this.length>m&&(R+=" ... ")),"<Buffer "+R+">"},f.prototype.compare=function(R,m,k,B,X){if(!f.isBuffer(R))throw new TypeError("Argument must be a Buffer");if(m===void 0&&(m=0),k===void 0&&(k=R?R.length:0),B===void 0&&(B=0),X===void 0&&(X=this.length),m<0||k>R.length||B<0||X>this.length)throw new RangeError("out of range index");if(B>=X&&m>=k)return 0;if(B>=X)return-1;if(m>=k)return 1;if(this===R)return 0;for(var ie=(X>>>=0)-(B>>>=0),ge=(k>>>=0)-(m>>>=0),re=Math.min(ie,ge),ve=this.slice(B,X),Fe=R.slice(m,k),_e=0;_e<re;++_e)if(ve[_e]!==Fe[_e]){ie=ve[_e],ge=Fe[_e];break}return ie<ge?-1:ge<ie?1:0},f.prototype.includes=function(R,m,k){return this.indexOf(R,m,k)!==-1},f.prototype.indexOf=function(R,m,k){return P(this,R,m,k,!0)},f.prototype.lastIndexOf=function(R,m,k){return P(this,R,m,k,!1)},f.prototype.write=function(R,m,k,B){if(m===void 0)B="utf8",k=this.length,m=0;else if(k===void 0&&typeof m=="string")B=m,k=this.length,m=0;else{if(!isFinite(m))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");m|=0,isFinite(k)?(k|=0,B===void 0&&(B="utf8")):(B=k,k=void 0)}var X=this.length-m;if((k===void 0||k>X)&&(k=X),R.length>0&&(k<0||m<0)||m>this.length)throw new RangeError("Attempt to write outside buffer bounds");B||(B="utf8");for(var ie=!1;;)switch(B){case"hex":return j(this,R,m,k);case"utf8":case"utf-8":return M(this,R,m,k);case"ascii":return ne(this,R,m,k);case"latin1":case"binary":return ce(this,R,m,k);case"base64":return N(this,R,m,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ee(this,R,m,k);default:if(ie)throw new TypeError("Unknown encoding: "+B);B=(""+B).toLowerCase(),ie=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Re=4096;function Ne(q,R,m){var k="";m=Math.min(q.length,m);for(var B=R;B<m;++B)k+=String.fromCharCode(127&q[B]);return k}function Ue(q,R,m){var k="";m=Math.min(q.length,m);for(var B=R;B<m;++B)k+=String.fromCharCode(q[B]);return k}function je(q,R,m){var k=q.length;(!R||R<0)&&(R=0),(!m||m<0||m>k)&&(m=k);for(var B="",X=R;X<m;++X)B+=Ke(q[X]);return B}function me(q,R,m){for(var k=q.slice(R,m),B="",X=0;X<k.length;X+=2)B+=String.fromCharCode(k[X]+256*k[X+1]);return B}function Ie(q,R,m){if(q%1!=0||q<0)throw new RangeError("offset is not uint");if(q+R>m)throw new RangeError("Trying to access beyond buffer length")}function G(q,R,m,k,B,X){if(!f.isBuffer(q))throw new TypeError('"buffer" argument must be a Buffer instance');if(R>B||R<X)throw new RangeError('"value" argument is out of bounds');if(m+k>q.length)throw new RangeError("Index out of range")}function pe(q,R,m,k){R<0&&(R=65535+R+1);for(var B=0,X=Math.min(q.length-m,2);B<X;++B)q[m+B]=(R&255<<8*(k?B:1-B))>>>8*(k?B:1-B)}function Ce(q,R,m,k){R<0&&(R=4294967295+R+1);for(var B=0,X=Math.min(q.length-m,4);B<X;++B)q[m+B]=R>>>8*(k?B:3-B)&255}function xe(q,R,m,k,B,X){if(m+k>q.length)throw new RangeError("Index out of range");if(m<0)throw new RangeError("Index out of range")}function Be(q,R,m,k,B){return B||xe(q,0,m,4),c.write(q,R,m,k,23,4),m+4}function He(q,R,m,k,B){return B||xe(q,0,m,8),c.write(q,R,m,k,52,8),m+8}f.prototype.slice=function(R,m){var k,B=this.length;if((R=~~R)<0?(R+=B)<0&&(R=0):R>B&&(R=B),(m=m===void 0?B:~~m)<0?(m+=B)<0&&(m=0):m>B&&(m=B),m<R&&(m=R),f.TYPED_ARRAY_SUPPORT)(k=this.subarray(R,m)).__proto__=f.prototype;else{var X=m-R;k=new f(X,void 0);for(var ie=0;ie<X;++ie)k[ie]=this[ie+R]}return k},f.prototype.readUIntLE=function(R,m,k){R|=0,m|=0,k||Ie(R,m,this.length);for(var B=this[R],X=1,ie=0;++ie<m&&(X*=256);)B+=this[R+ie]*X;return B},f.prototype.readUIntBE=function(R,m,k){R|=0,m|=0,k||Ie(R,m,this.length);for(var B=this[R+--m],X=1;m>0&&(X*=256);)B+=this[R+--m]*X;return B},f.prototype.readUInt8=function(R,m){return m||Ie(R,1,this.length),this[R]},f.prototype.readUInt16LE=function(R,m){return m||Ie(R,2,this.length),this[R]|this[R+1]<<8},f.prototype.readUInt16BE=function(R,m){return m||Ie(R,2,this.length),this[R]<<8|this[R+1]},f.prototype.readUInt32LE=function(R,m){return m||Ie(R,4,this.length),(this[R]|this[R+1]<<8|this[R+2]<<16)+16777216*this[R+3]},f.prototype.readUInt32BE=function(R,m){return m||Ie(R,4,this.length),16777216*this[R]+(this[R+1]<<16|this[R+2]<<8|this[R+3])},f.prototype.readIntLE=function(R,m,k){R|=0,m|=0,k||Ie(R,m,this.length);for(var B=this[R],X=1,ie=0;++ie<m&&(X*=256);)B+=this[R+ie]*X;return B>=(X*=128)&&(B-=Math.pow(2,8*m)),B},f.prototype.readIntBE=function(R,m,k){R|=0,m|=0,k||Ie(R,m,this.length);for(var B=m,X=1,ie=this[R+--B];B>0&&(X*=256);)ie+=this[R+--B]*X;return ie>=(X*=128)&&(ie-=Math.pow(2,8*m)),ie},f.prototype.readInt8=function(R,m){return m||Ie(R,1,this.length),128&this[R]?-1*(255-this[R]+1):this[R]},f.prototype.readInt16LE=function(R,m){m||Ie(R,2,this.length);var k=this[R]|this[R+1]<<8;return 32768&k?4294901760|k:k},f.prototype.readInt16BE=function(R,m){m||Ie(R,2,this.length);var k=this[R+1]|this[R]<<8;return 32768&k?4294901760|k:k},f.prototype.readInt32LE=function(R,m){return m||Ie(R,4,this.length),this[R]|this[R+1]<<8|this[R+2]<<16|this[R+3]<<24},f.prototype.readInt32BE=function(R,m){return m||Ie(R,4,this.length),this[R]<<24|this[R+1]<<16|this[R+2]<<8|this[R+3]},f.prototype.readFloatLE=function(R,m){return m||Ie(R,4,this.length),c.read(this,R,!0,23,4)},f.prototype.readFloatBE=function(R,m){return m||Ie(R,4,this.length),c.read(this,R,!1,23,4)},f.prototype.readDoubleLE=function(R,m){return m||Ie(R,8,this.length),c.read(this,R,!0,52,8)},f.prototype.readDoubleBE=function(R,m){return m||Ie(R,8,this.length),c.read(this,R,!1,52,8)},f.prototype.writeUIntLE=function(R,m,k,B){R=+R,m|=0,k|=0,B||G(this,R,m,k,Math.pow(2,8*k)-1,0);var X=1,ie=0;for(this[m]=255&R;++ie<k&&(X*=256);)this[m+ie]=R/X&255;return m+k},f.prototype.writeUIntBE=function(R,m,k,B){R=+R,m|=0,k|=0,B||G(this,R,m,k,Math.pow(2,8*k)-1,0);var X=k-1,ie=1;for(this[m+X]=255&R;--X>=0&&(ie*=256);)this[m+X]=R/ie&255;return m+k},f.prototype.writeUInt8=function(R,m,k){return R=+R,m|=0,k||G(this,R,m,1,255,0),f.TYPED_ARRAY_SUPPORT||(R=Math.floor(R)),this[m]=255&R,m+1},f.prototype.writeUInt16LE=function(R,m,k){return R=+R,m|=0,k||G(this,R,m,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[m]=255&R,this[m+1]=R>>>8):pe(this,R,m,!0),m+2},f.prototype.writeUInt16BE=function(R,m,k){return R=+R,m|=0,k||G(this,R,m,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[m]=R>>>8,this[m+1]=255&R):pe(this,R,m,!1),m+2},f.prototype.writeUInt32LE=function(R,m,k){return R=+R,m|=0,k||G(this,R,m,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[m+3]=R>>>24,this[m+2]=R>>>16,this[m+1]=R>>>8,this[m]=255&R):Ce(this,R,m,!0),m+4},f.prototype.writeUInt32BE=function(R,m,k){return R=+R,m|=0,k||G(this,R,m,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[m]=R>>>24,this[m+1]=R>>>16,this[m+2]=R>>>8,this[m+3]=255&R):Ce(this,R,m,!1),m+4},f.prototype.writeIntLE=function(R,m,k,B){if(R=+R,m|=0,!B){var X=Math.pow(2,8*k-1);G(this,R,m,k,X-1,-X)}var ie=0,ge=1,re=0;for(this[m]=255&R;++ie<k&&(ge*=256);)R<0&&re===0&&this[m+ie-1]!==0&&(re=1),this[m+ie]=(R/ge>>0)-re&255;return m+k},f.prototype.writeIntBE=function(R,m,k,B){if(R=+R,m|=0,!B){var X=Math.pow(2,8*k-1);G(this,R,m,k,X-1,-X)}var ie=k-1,ge=1,re=0;for(this[m+ie]=255&R;--ie>=0&&(ge*=256);)R<0&&re===0&&this[m+ie+1]!==0&&(re=1),this[m+ie]=(R/ge>>0)-re&255;return m+k},f.prototype.writeInt8=function(R,m,k){return R=+R,m|=0,k||G(this,R,m,1,127,-128),f.TYPED_ARRAY_SUPPORT||(R=Math.floor(R)),R<0&&(R=255+R+1),this[m]=255&R,m+1},f.prototype.writeInt16LE=function(R,m,k){return R=+R,m|=0,k||G(this,R,m,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[m]=255&R,this[m+1]=R>>>8):pe(this,R,m,!0),m+2},f.prototype.writeInt16BE=function(R,m,k){return R=+R,m|=0,k||G(this,R,m,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[m]=R>>>8,this[m+1]=255&R):pe(this,R,m,!1),m+2},f.prototype.writeInt32LE=function(R,m,k){return R=+R,m|=0,k||G(this,R,m,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[m]=255&R,this[m+1]=R>>>8,this[m+2]=R>>>16,this[m+3]=R>>>24):Ce(this,R,m,!0),m+4},f.prototype.writeInt32BE=function(R,m,k){return R=+R,m|=0,k||G(this,R,m,4,2147483647,-2147483648),R<0&&(R=4294967295+R+1),f.TYPED_ARRAY_SUPPORT?(this[m]=R>>>24,this[m+1]=R>>>16,this[m+2]=R>>>8,this[m+3]=255&R):Ce(this,R,m,!1),m+4},f.prototype.writeFloatLE=function(R,m,k){return Be(this,R,m,!0,k)},f.prototype.writeFloatBE=function(R,m,k){return Be(this,R,m,!1,k)},f.prototype.writeDoubleLE=function(R,m,k){return He(this,R,m,!0,k)},f.prototype.writeDoubleBE=function(R,m,k){return He(this,R,m,!1,k)},f.prototype.copy=function(R,m,k,B){if(k||(k=0),B||B===0||(B=this.length),m>=R.length&&(m=R.length),m||(m=0),B>0&&B<k&&(B=k),B===k||R.length===0||this.length===0)return 0;if(m<0)throw new RangeError("targetStart out of bounds");if(k<0||k>=this.length)throw new RangeError("sourceStart out of bounds");if(B<0)throw new RangeError("sourceEnd out of bounds");B>this.length&&(B=this.length),R.length-m<B-k&&(B=R.length-m+k);var X,ie=B-k;if(this===R&&k<m&&m<B)for(X=ie-1;X>=0;--X)R[X+m]=this[X+k];else if(ie<1e3||!f.TYPED_ARRAY_SUPPORT)for(X=0;X<ie;++X)R[X+m]=this[X+k];else Uint8Array.prototype.set.call(R,this.subarray(k,k+ie),m);return ie},f.prototype.fill=function(R,m,k,B){if(typeof R=="string"){if(typeof m=="string"?(B=m,m=0,k=this.length):typeof k=="string"&&(B=k,k=this.length),R.length===1){var X=R.charCodeAt(0);X<256&&(R=X)}if(B!==void 0&&typeof B!="string")throw new TypeError("encoding must be a string");if(typeof B=="string"&&!f.isEncoding(B))throw new TypeError("Unknown encoding: "+B)}else typeof R=="number"&&(R&=255);if(m<0||this.length<m||this.length<k)throw new RangeError("Out of range index");if(k<=m)return this;var ie;if(m>>>=0,k=k===void 0?this.length:k>>>0,R||(R=0),typeof R=="number")for(ie=m;ie<k;++ie)this[ie]=R;else{var ge=f.isBuffer(R)?R:Ee(new f(R,B).toString()),re=ge.length;for(ie=0;ie<k-m;++ie)this[ie+m]=ge[ie%re]}return this};var ze=/[^+\/0-9A-Za-z-_]/g;function Ke(q){return q<16?"0"+q.toString(16):q.toString(16)}function Ee(q,R){var m;R=R||1/0;for(var k=q.length,B=null,X=[],ie=0;ie<k;++ie){if((m=q.charCodeAt(ie))>55295&&m<57344){if(!B){if(m>56319){(R-=3)>-1&&X.push(239,191,189);continue}if(ie+1===k){(R-=3)>-1&&X.push(239,191,189);continue}B=m;continue}if(m<56320){(R-=3)>-1&&X.push(239,191,189),B=m;continue}m=65536+(B-55296<<10|m-56320)}else B&&(R-=3)>-1&&X.push(239,191,189);if(B=null,m<128){if((R-=1)<0)break;X.push(m)}else if(m<2048){if((R-=2)<0)break;X.push(m>>6|192,63&m|128)}else if(m<65536){if((R-=3)<0)break;X.push(m>>12|224,m>>6&63|128,63&m|128)}else{if(!(m<1114112))throw new Error("Invalid code point");if((R-=4)<0)break;X.push(m>>18|240,m>>12&63|128,m>>6&63|128,63&m|128)}}return X}function Ae(q){return l.toByteArray((function(m){if((m=(function(B){return B.trim?B.trim():B.replace(/^\s+|\s+$/g,"")})(m).replace(ze,"")).length<2)return"";for(;m.length%4!=0;)m+="=";return m})(q))}function ke(q,R,m,k){for(var B=0;B<k&&!(B+m>=R.length||B>=q.length);++B)R[B+m]=q[B];return B}}).call(this,s(29))},function(r,n){var s;s=(function(){return this})();try{s=s||new Function("return this")()}catch{typeof window=="object"&&(s=window)}r.exports=s},function(r,n,s){n.byteLength=function(S){var I=f(S),F=I[0],b=I[1];return 3*(F+b)/4-b},n.toByteArray=function(S){var I,F,b=f(S),A=b[0],T=b[1],P=new c((function(ne,ce,N){return 3*(ce+N)/4-N})(0,A,T)),D=0,j=T>0?A-4:A;for(F=0;F<j;F+=4)I=l[S.charCodeAt(F)]<<18|l[S.charCodeAt(F+1)]<<12|l[S.charCodeAt(F+2)]<<6|l[S.charCodeAt(F+3)],P[D++]=I>>16&255,P[D++]=I>>8&255,P[D++]=255&I;return T===2&&(I=l[S.charCodeAt(F)]<<2|l[S.charCodeAt(F+1)]>>4,P[D++]=255&I),T===1&&(I=l[S.charCodeAt(F)]<<10|l[S.charCodeAt(F+1)]<<4|l[S.charCodeAt(F+2)]>>2,P[D++]=I>>8&255,P[D++]=255&I),P},n.fromByteArray=function(S){for(var I,F=S.length,b=F%3,A=[],T=16383,P=0,D=F-b;P<D;P+=T)A.push(_(S,P,P+T>D?D:P+T));return b===1?(I=S[F-1],A.push(a[I>>2]+a[I<<4&63]+"==")):b===2&&(I=(S[F-2]<<8)+S[F-1],A.push(a[I>>10]+a[I>>4&63]+a[I<<2&63]+"=")),A.join("")};for(var a=[],l=[],c=typeof Uint8Array<"u"?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,p=g.length;h<p;++h)a[h]=g[h],l[g.charCodeAt(h)]=h;function f(x){var S=x.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var I=x.indexOf("=");return I===-1&&(I=S),[I,I===S?0:4-I%4]}function _(x,S,I){for(var F,b,A=[],T=S;T<I;T+=3)F=(x[T]<<16&16711680)+(x[T+1]<<8&65280)+(255&x[T+2]),A.push(a[(b=F)>>18&63]+a[b>>12&63]+a[b>>6&63]+a[63&b]);return A.join("")}l[45]=62,l[95]=63},function(r,n){n.read=function(s,a,l,c,g){var h,p,f=8*g-c-1,_=(1<<f)-1,x=_>>1,S=-7,I=l?g-1:0,F=l?-1:1,b=s[a+I];for(I+=F,h=b&(1<<-S)-1,b>>=-S,S+=f;S>0;h=256*h+s[a+I],I+=F,S-=8);for(p=h&(1<<-S)-1,h>>=-S,S+=c;S>0;p=256*p+s[a+I],I+=F,S-=8);if(h===0)h=1-x;else{if(h===_)return p?NaN:1/0*(b?-1:1);p+=Math.pow(2,c),h-=x}return(b?-1:1)*p*Math.pow(2,h-c)},n.write=function(s,a,l,c,g,h){var p,f,_,x=8*h-g-1,S=(1<<x)-1,I=S>>1,F=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=c?0:h-1,A=c?1:-1,T=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(f=isNaN(a)?1:0,p=S):(p=Math.floor(Math.log(a)/Math.LN2),a*(_=Math.pow(2,-p))<1&&(p--,_*=2),(a+=p+I>=1?F/_:F*Math.pow(2,1-I))*_>=2&&(p++,_/=2),p+I>=S?(f=0,p=S):p+I>=1?(f=(a*_-1)*Math.pow(2,g),p+=I):(f=a*Math.pow(2,I-1)*Math.pow(2,g),p=0));g>=8;s[l+b]=255&f,b+=A,f/=256,g-=8);for(p=p<<g|f,x+=g;x>0;s[l+b]=255&p,b+=A,p/=256,x-=8);s[l+b-A]|=128*T}},function(r,n){var s={}.toString;r.exports=Array.isArray||function(a){return s.call(a)=="[object Array]"}},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(c){var g=c.jws,h=c.KeyUtil,p=c.X509,f=c.crypto,_=c.hextob64u,x=c.b64tohex,S=c.AllowedSigningAlgs;return(function(){function I(){(function(b,A){if(!(b instanceof A))throw new TypeError("Cannot call a class as a function")})(this,I)}return I.parseJwt=function(b){a.Log.debug("JoseUtil.parseJwt");try{var A=g.JWS.parse(b);return{header:A.headerObj,payload:A.payloadObj}}catch(T){a.Log.error(T)}},I.validateJwt=function(b,A,T,P,D,j,M){a.Log.debug("JoseUtil.validateJwt");try{if(A.kty==="RSA")if(A.e&&A.n)A=h.getKey(A);else{if(!A.x5c||!A.x5c.length)return a.Log.error("JoseUtil.validateJwt: RSA key missing key material",A),Promise.reject(new Error("RSA key missing key material"));var ne=x(A.x5c[0]);A=p.getPublicKeyFromCertHex(ne)}else{if(A.kty!=="EC")return a.Log.error("JoseUtil.validateJwt: Unsupported key type",A&&A.kty),Promise.reject(new Error(A.kty));if(!(A.crv&&A.x&&A.y))return a.Log.error("JoseUtil.validateJwt: EC key missing key material",A),Promise.reject(new Error("EC key missing key material"));A=h.getKey(A)}return I._validateJwt(b,A,T,P,D,j,M)}catch(ce){return a.Log.error(ce&&ce.message||ce),Promise.reject("JWT validation failed")}},I.validateJwtAttributes=function(b,A,T,P,D,j){P||(P=0),D||(D=parseInt(Date.now()/1e3));var M=I.parseJwt(b).payload;if(!M.iss)return a.Log.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(M.iss!==A)return a.Log.error("JoseUtil._validateJwt: Invalid issuer in token",M.iss),Promise.reject(new Error("Invalid issuer in token: "+M.iss));if(!M.aud)return a.Log.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(M.aud===T||Array.isArray(M.aud)&&M.aud.indexOf(T)>=0))return a.Log.error("JoseUtil._validateJwt: Invalid audience in token",M.aud),Promise.reject(new Error("Invalid audience in token: "+M.aud));if(M.azp&&M.azp!==T)return a.Log.error("JoseUtil._validateJwt: Invalid azp in token",M.azp),Promise.reject(new Error("Invalid azp in token: "+M.azp));if(!j){var ne=D+P,ce=D-P;if(!M.iat)return a.Log.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(ne<M.iat)return a.Log.error("JoseUtil._validateJwt: iat is in the future",M.iat),Promise.reject(new Error("iat is in the future: "+M.iat));if(M.nbf&&ne<M.nbf)return a.Log.error("JoseUtil._validateJwt: nbf is in the future",M.nbf),Promise.reject(new Error("nbf is in the future: "+M.nbf));if(!M.exp)return a.Log.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(M.exp<ce)return a.Log.error("JoseUtil._validateJwt: exp is in the past",M.exp),Promise.reject(new Error("exp is in the past:"+M.exp))}return Promise.resolve(M)},I._validateJwt=function(b,A,T,P,D,j,M){return I.validateJwtAttributes(b,T,P,D,j,M).then((function(ne){try{return g.JWS.verify(b,A,S)?ne:(a.Log.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed")))}catch(ce){return a.Log.error(ce&&ce.message||ce),Promise.reject(new Error("signature validation failed"))}}))},I.hashString=function(b,A){try{return f.Util.hashString(b,A)}catch(T){a.Log.error(T)}},I.hexToBase64Url=function(b){try{return _(b)}catch(A){a.Log.error(A)}},I})()};var a=s(0);r.exports=n.default},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.SigninResponse=void 0;var a=(function(){function g(h,p){for(var f=0;f<p.length;f++){var _=p[f];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(h,_.key,_)}}return function(h,p,f){return p&&g(h.prototype,p),f&&g(h,f),h}})(),l=s(3);function c(g,h){if(!(g instanceof h))throw new TypeError("Cannot call a class as a function")}n.SigninResponse=(function(){function g(h){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#";c(this,g);var f=l.UrlUtility.parseUrlFragment(h,p);this.error=f.error,this.error_description=f.error_description,this.error_uri=f.error_uri,this.code=f.code,this.state=f.state,this.id_token=f.id_token,this.session_state=f.session_state,this.access_token=f.access_token,this.token_type=f.token_type,this.scope=f.scope,this.profile=void 0,this.expires_in=f.expires_in}return a(g,[{key:"expires_in",get:function(){if(this.expires_at){var p=parseInt(Date.now()/1e3);return this.expires_at-p}},set:function(p){var f=parseInt(p);if(typeof f=="number"&&f>0){var _=parseInt(Date.now()/1e3);this.expires_at=_+f}}},{key:"expired",get:function(){var p=this.expires_in;if(p!==void 0)return p<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}},{key:"isOpenIdConnect",get:function(){return this.scopes.indexOf("openid")>=0||!!this.id_token}}]),g})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.SignoutRequest=void 0;var a=s(0),l=s(3),c=s(9);n.SignoutRequest=function g(h){var p=h.url,f=h.id_token_hint,_=h.post_logout_redirect_uri,x=h.data,S=h.extraQueryParams,I=h.request_type;if((function(A,T){if(!(A instanceof T))throw new TypeError("Cannot call a class as a function")})(this,g),!p)throw a.Log.error("SignoutRequest.ctor: No url passed"),new Error("url");for(var F in f&&(p=l.UrlUtility.addQueryParam(p,"id_token_hint",f)),_&&(p=l.UrlUtility.addQueryParam(p,"post_logout_redirect_uri",_),x&&(this.state=new c.State({data:x,request_type:I}),p=l.UrlUtility.addQueryParam(p,"state",this.state.id))),S)p=l.UrlUtility.addQueryParam(p,F,S[F]);this.url=p}},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.SignoutResponse=void 0;var a=s(3);n.SignoutResponse=function l(c){(function(p,f){if(!(p instanceof f))throw new TypeError("Cannot call a class as a function")})(this,l);var g=a.UrlUtility.parseUrlFragment(c,"?");this.error=g.error,this.error_description=g.error_description,this.error_uri=g.error_uri,this.state=g.state}},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.InMemoryWebStorage=void 0;var a=(function(){function c(g,h){for(var p=0;p<h.length;p++){var f=h[p];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(g,f.key,f)}}return function(g,h,p){return h&&c(g.prototype,h),p&&c(g,p),g}})(),l=s(0);n.InMemoryWebStorage=(function(){function c(){(function(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")})(this,c),this._data={}}return c.prototype.getItem=function(h){return l.Log.debug("InMemoryWebStorage.getItem",h),this._data[h]},c.prototype.setItem=function(h,p){l.Log.debug("InMemoryWebStorage.setItem",h),this._data[h]=p},c.prototype.removeItem=function(h){l.Log.debug("InMemoryWebStorage.removeItem",h),delete this._data[h]},c.prototype.key=function(h){return Object.getOwnPropertyNames(this._data)[h]},a(c,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),c})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.UserManager=void 0;var a=(function(){function T(P,D){for(var j=0;j<D.length;j++){var M=D[j];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(P,M.key,M)}}return function(P,D,j){return D&&T(P.prototype,D),j&&T(P,j),P}})(),l=s(0),c=s(10),g=s(39),h=s(15),p=s(45),f=s(47),_=s(18),x=s(8),S=s(20),I=s(11),F=s(4);function b(T,P){if(!(T instanceof P))throw new TypeError("Cannot call a class as a function")}function A(T,P){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!P||typeof P!="object"&&typeof P!="function"?T:P}n.UserManager=(function(T){function P(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f.SilentRenewService,M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_.SessionMonitor,ne=arguments.length>3&&arguments[3]!==void 0?arguments[3]:S.TokenRevocationClient,ce=arguments.length>4&&arguments[4]!==void 0?arguments[4]:I.TokenClient,N=arguments.length>5&&arguments[5]!==void 0?arguments[5]:F.JoseUtil;b(this,P),D instanceof g.UserManagerSettings||(D=new g.UserManagerSettings(D));var ee=A(this,T.call(this,D));return ee._events=new p.UserManagerEvents(D),ee._silentRenewService=new j(ee),ee.settings.automaticSilentRenew&&(l.Log.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),ee.startSilentRenew()),ee.settings.monitorSession&&(l.Log.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),ee._sessionMonitor=new M(ee)),ee._tokenRevocationClient=new ne(ee._settings),ee._tokenClient=new ce(ee._settings),ee._joseUtil=N,ee}return(function(j,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof M);j.prototype=Object.create(M&&M.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(j,M):j.__proto__=M)})(P,T),P.prototype.getUser=function(){var j=this;return this._loadUser().then((function(M){return M?(l.Log.info("UserManager.getUser: user loaded"),j._events.load(M,!1),M):(l.Log.info("UserManager.getUser: user not found in storage"),null)}))},P.prototype.removeUser=function(){var j=this;return this.storeUser(null).then((function(){l.Log.info("UserManager.removeUser: user removed from storage"),j._events.unload()}))},P.prototype.signinRedirect=function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(j=Object.assign({},j)).request_type="si:r";var M={useReplaceToNavigate:j.useReplaceToNavigate};return this._signinStart(j,this._redirectNavigator,M).then((function(){l.Log.info("UserManager.signinRedirect: successful")}))},P.prototype.signinRedirectCallback=function(j){return this._signinEnd(j||this._redirectNavigator.url).then((function(M){return M.profile&&M.profile.sub?l.Log.info("UserManager.signinRedirectCallback: successful, signed in sub: ",M.profile.sub):l.Log.info("UserManager.signinRedirectCallback: no sub"),M}))},P.prototype.signinPopup=function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(j=Object.assign({},j)).request_type="si:p";var M=j.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return M?(j.redirect_uri=M,j.display="popup",this._signin(j,this._popupNavigator,{startUrl:M,popupWindowFeatures:j.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:j.popupWindowTarget||this.settings.popupWindowTarget}).then((function(ne){return ne&&(ne.profile&&ne.profile.sub?l.Log.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",ne.profile.sub):l.Log.info("UserManager.signinPopup: no sub")),ne}))):(l.Log.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))},P.prototype.signinPopupCallback=function(j){return this._signinCallback(j,this._popupNavigator).then((function(M){return M&&(M.profile&&M.profile.sub?l.Log.info("UserManager.signinPopupCallback: successful, signed in sub: ",M.profile.sub):l.Log.info("UserManager.signinPopupCallback: no sub")),M})).catch((function(M){l.Log.error(M.message)}))},P.prototype.signinSilent=function(){var j=this,M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return M=Object.assign({},M),this._loadUser().then((function(ne){return ne&&ne.refresh_token?(M.refresh_token=ne.refresh_token,j._useRefreshToken(M)):(M.request_type="si:s",M.id_token_hint=M.id_token_hint||j.settings.includeIdTokenInSilentRenew&&ne&&ne.id_token,ne&&j._settings.validateSubOnSilentRenew&&(l.Log.debug("UserManager.signinSilent, subject prior to silent renew: ",ne.profile.sub),M.current_sub=ne.profile.sub),j._signinSilentIframe(M))}))},P.prototype._useRefreshToken=function(){var j=this,M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._tokenClient.exchangeRefreshToken(M).then((function(ne){return ne?ne.access_token?j._loadUser().then((function(ce){if(ce){var N=Promise.resolve();return ne.id_token&&(N=j._validateIdTokenFromTokenRefreshToken(ce.profile,ne.id_token)),N.then((function(){return l.Log.debug("UserManager._useRefreshToken: refresh token response success"),ce.id_token=ne.id_token||ce.id_token,ce.access_token=ne.access_token,ce.refresh_token=ne.refresh_token||ce.refresh_token,ce.expires_in=ne.expires_in,j.storeUser(ce).then((function(){return j._events.load(ce),ce}))}))}return null})):(l.Log.error("UserManager._useRefreshToken: No access token returned from token endpoint"),Promise.reject("No access token returned from token endpoint")):(l.Log.error("UserManager._useRefreshToken: No response returned from token endpoint"),Promise.reject("No response returned from token endpoint"))}))},P.prototype._validateIdTokenFromTokenRefreshToken=function(j,M){var ne=this;return this._metadataService.getIssuer().then((function(ce){return ne.settings.getEpochTime().then((function(N){return ne._joseUtil.validateJwtAttributes(M,ce,ne._settings.client_id,ne._settings.clockSkew,N).then((function(ee){return ee?ee.sub!==j.sub?(l.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: sub in id_token does not match current sub"),Promise.reject(new Error("sub in id_token does not match current sub"))):ee.auth_time&&ee.auth_time!==j.auth_time?(l.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: auth_time in id_token does not match original auth_time"),Promise.reject(new Error("auth_time in id_token does not match original auth_time"))):ee.azp&&ee.azp!==j.azp?(l.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp in id_token does not match original azp"),Promise.reject(new Error("azp in id_token does not match original azp"))):!ee.azp&&j.azp?(l.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp not in id_token, but present in original id_token"),Promise.reject(new Error("azp not in id_token, but present in original id_token"))):void 0:(l.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: Failed to validate id_token"),Promise.reject(new Error("Failed to validate id_token")))}))}))}))},P.prototype._signinSilentIframe=function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},M=j.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return M?(j.redirect_uri=M,j.prompt=j.prompt||"none",this._signin(j,this._iframeNavigator,{startUrl:M,silentRequestTimeout:j.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(ne){return ne&&(ne.profile&&ne.profile.sub?l.Log.info("UserManager.signinSilent: successful, signed in sub: ",ne.profile.sub):l.Log.info("UserManager.signinSilent: no sub")),ne}))):(l.Log.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},P.prototype.signinSilentCallback=function(j){return this._signinCallback(j,this._iframeNavigator).then((function(M){return M&&(M.profile&&M.profile.sub?l.Log.info("UserManager.signinSilentCallback: successful, signed in sub: ",M.profile.sub):l.Log.info("UserManager.signinSilentCallback: no sub")),M}))},P.prototype.signinCallback=function(j){var M=this;return this.readSigninResponseState(j).then((function(ne){var ce=ne.state;return ne.response,ce.request_type==="si:r"?M.signinRedirectCallback(j):ce.request_type==="si:p"?M.signinPopupCallback(j):ce.request_type==="si:s"?M.signinSilentCallback(j):Promise.reject(new Error("invalid response_type in state"))}))},P.prototype.signoutCallback=function(j,M){var ne=this;return this.readSignoutResponseState(j).then((function(ce){var N=ce.state,ee=ce.response;return N?N.request_type==="so:r"?ne.signoutRedirectCallback(j):N.request_type==="so:p"?ne.signoutPopupCallback(j,M):Promise.reject(new Error("invalid response_type in state")):ee}))},P.prototype.querySessionStatus=function(){var j=this,M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(M=Object.assign({},M)).request_type="si:s";var ne=M.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return ne?(M.redirect_uri=ne,M.prompt="none",M.response_type=M.response_type||this.settings.query_status_response_type,M.scope=M.scope||"openid",M.skipUserInfo=!0,this._signinStart(M,this._iframeNavigator,{startUrl:ne,silentRequestTimeout:M.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(ce){return j.processSigninResponse(ce.url).then((function(N){if(l.Log.debug("UserManager.querySessionStatus: got signin response"),N.session_state&&N.profile.sub)return l.Log.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",N.profile.sub),{session_state:N.session_state,sub:N.profile.sub,sid:N.profile.sid};l.Log.info("querySessionStatus successful, user not authenticated")})).catch((function(N){if(N.session_state&&j.settings.monitorAnonymousSession&&(N.message=="login_required"||N.message=="consent_required"||N.message=="interaction_required"||N.message=="account_selection_required"))return l.Log.info("UserManager.querySessionStatus: querySessionStatus success for anonymous user"),{session_state:N.session_state};throw N}))}))):(l.Log.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},P.prototype._signin=function(j,M){var ne=this,ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._signinStart(j,M,ce).then((function(N){return ne._signinEnd(N.url,j)}))},P.prototype._signinStart=function(j,M){var ne=this,ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return M.prepare(ce).then((function(N){return l.Log.debug("UserManager._signinStart: got navigator window handle"),ne.createSigninRequest(j).then((function(ee){return l.Log.debug("UserManager._signinStart: got signin request"),ce.url=ee.url,ce.id=ee.state.id,N.navigate(ce)})).catch((function(ee){throw N.close&&(l.Log.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),N.close()),ee}))}))},P.prototype._signinEnd=function(j){var M=this,ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.processSigninResponse(j).then((function(ce){l.Log.debug("UserManager._signinEnd: got signin response");var N=new h.User(ce);if(ne.current_sub){if(ne.current_sub!==N.profile.sub)return l.Log.debug("UserManager._signinEnd: current user does not match user returned from signin. sub from signin: ",N.profile.sub),Promise.reject(new Error("login_required"));l.Log.debug("UserManager._signinEnd: current user matches user returned from signin")}return M.storeUser(N).then((function(){return l.Log.debug("UserManager._signinEnd: user stored"),M._events.load(N),N}))}))},P.prototype._signinCallback=function(j,M){l.Log.debug("UserManager._signinCallback");var ne=this._settings.response_mode==="query"||!this._settings.response_mode&&x.SigninRequest.isCode(this._settings.response_type)?"?":"#";return M.callback(j,void 0,ne)},P.prototype.signoutRedirect=function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(j=Object.assign({},j)).request_type="so:r";var M=j.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;M&&(j.post_logout_redirect_uri=M);var ne={useReplaceToNavigate:j.useReplaceToNavigate};return this._signoutStart(j,this._redirectNavigator,ne).then((function(){l.Log.info("UserManager.signoutRedirect: successful")}))},P.prototype.signoutRedirectCallback=function(j){return this._signoutEnd(j||this._redirectNavigator.url).then((function(M){return l.Log.info("UserManager.signoutRedirectCallback: successful"),M}))},P.prototype.signoutPopup=function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(j=Object.assign({},j)).request_type="so:p";var M=j.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return j.post_logout_redirect_uri=M,j.display="popup",j.post_logout_redirect_uri&&(j.state=j.state||{}),this._signout(j,this._popupNavigator,{startUrl:M,popupWindowFeatures:j.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:j.popupWindowTarget||this.settings.popupWindowTarget}).then((function(){l.Log.info("UserManager.signoutPopup: successful")}))},P.prototype.signoutPopupCallback=function(j,M){return M===void 0&&typeof j=="boolean"&&(M=j,j=null),this._popupNavigator.callback(j,M,"?").then((function(){l.Log.info("UserManager.signoutPopupCallback: successful")}))},P.prototype._signout=function(j,M){var ne=this,ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._signoutStart(j,M,ce).then((function(N){return ne._signoutEnd(N.url)}))},P.prototype._signoutStart=function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},M=this,ne=arguments[1],ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ne.prepare(ce).then((function(N){return l.Log.debug("UserManager._signoutStart: got navigator window handle"),M._loadUser().then((function(ee){return l.Log.debug("UserManager._signoutStart: loaded current user from storage"),(M._settings.revokeAccessTokenOnSignout?M._revokeInternal(ee):Promise.resolve()).then((function(){var we=j.id_token_hint||ee&&ee.id_token;return we&&(l.Log.debug("UserManager._signoutStart: Setting id_token into signout request"),j.id_token_hint=we),M.removeUser().then((function(){return l.Log.debug("UserManager._signoutStart: user removed, creating signout request"),M.createSignoutRequest(j).then((function(se){return l.Log.debug("UserManager._signoutStart: got signout request"),ce.url=se.url,se.state&&(ce.id=se.state.id),N.navigate(ce)}))}))}))})).catch((function(ee){throw N.close&&(l.Log.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),N.close()),ee}))}))},P.prototype._signoutEnd=function(j){return this.processSignoutResponse(j).then((function(M){return l.Log.debug("UserManager._signoutEnd: got signout response"),M}))},P.prototype.revokeAccessToken=function(){var j=this;return this._loadUser().then((function(M){return j._revokeInternal(M,!0).then((function(ne){if(ne)return l.Log.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),M.access_token=null,M.refresh_token=null,M.expires_at=null,M.token_type=null,j.storeUser(M).then((function(){l.Log.debug("UserManager.revokeAccessToken: user stored"),j._events.load(M)}))}))})).then((function(){l.Log.info("UserManager.revokeAccessToken: access token revoked successfully")}))},P.prototype._revokeInternal=function(j,M){var ne=this;if(j){var ce=j.access_token,N=j.refresh_token;return this._revokeAccessTokenInternal(ce,M).then((function(ee){return ne._revokeRefreshTokenInternal(N,M).then((function(we){return ee||we||l.Log.debug("UserManager.revokeAccessToken: no need to revoke due to no token(s), or JWT format"),ee||we}))}))}return Promise.resolve(!1)},P.prototype._revokeAccessTokenInternal=function(j,M){return!j||j.indexOf(".")>=0?Promise.resolve(!1):this._tokenRevocationClient.revoke(j,M).then((function(){return!0}))},P.prototype._revokeRefreshTokenInternal=function(j,M){return j?this._tokenRevocationClient.revoke(j,M,"refresh_token").then((function(){return!0})):Promise.resolve(!1)},P.prototype.startSilentRenew=function(){this._silentRenewService.start()},P.prototype.stopSilentRenew=function(){this._silentRenewService.stop()},P.prototype._loadUser=function(){return this._userStore.get(this._userStoreKey).then((function(j){return j?(l.Log.debug("UserManager._loadUser: user storageString loaded"),h.User.fromStorageString(j)):(l.Log.debug("UserManager._loadUser: no user storageString"),null)}))},P.prototype.storeUser=function(j){if(j){l.Log.debug("UserManager.storeUser: storing user");var M=j.toStorageString();return this._userStore.set(this._userStoreKey,M)}return l.Log.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)},a(P,[{key:"_redirectNavigator",get:function(){return this.settings.redirectNavigator}},{key:"_popupNavigator",get:function(){return this.settings.popupNavigator}},{key:"_iframeNavigator",get:function(){return this.settings.iframeNavigator}},{key:"_userStore",get:function(){return this.settings.userStore}},{key:"events",get:function(){return this._events}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),P})(c.OidcClient)},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.UserManagerSettings=void 0;var a=(function(){function I(F,b){for(var A=0;A<b.length;A++){var T=b[A];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(F,T.key,T)}}return function(F,b,A){return b&&I(F.prototype,b),A&&I(F,A),F}})(),l=(s(0),s(5)),c=s(40),g=s(41),h=s(43),p=s(6),f=s(1),_=s(8);function x(I,F){if(!(I instanceof F))throw new TypeError("Cannot call a class as a function")}function S(I,F){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!F||typeof F!="object"&&typeof F!="function"?I:F}n.UserManagerSettings=(function(I){function F(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},A=b.popup_redirect_uri,T=b.popup_post_logout_redirect_uri,P=b.popupWindowFeatures,D=b.popupWindowTarget,j=b.silent_redirect_uri,M=b.silentRequestTimeout,ne=b.automaticSilentRenew,ce=ne!==void 0&&ne,N=b.validateSubOnSilentRenew,ee=N!==void 0&&N,we=b.includeIdTokenInSilentRenew,se=we===void 0||we,Re=b.monitorSession,Ne=Re===void 0||Re,Ue=b.monitorAnonymousSession,je=Ue!==void 0&&Ue,me=b.checkSessionInterval,Ie=me===void 0?2e3:me,G=b.stopCheckSessionOnError,pe=G===void 0||G,Ce=b.query_status_response_type,xe=b.revokeAccessTokenOnSignout,Be=xe!==void 0&&xe,He=b.accessTokenExpiringNotificationTime,ze=He===void 0?60:He,Ke=b.redirectNavigator,Ee=Ke===void 0?new c.RedirectNavigator:Ke,Ae=b.popupNavigator,ke=Ae===void 0?new g.PopupNavigator:Ae,q=b.iframeNavigator,R=q===void 0?new h.IFrameNavigator:q,m=b.userStore,k=m===void 0?new p.WebStorageStateStore({store:f.Global.sessionStorage}):m;x(this,F);var B=S(this,I.call(this,arguments[0]));return B._popup_redirect_uri=A,B._popup_post_logout_redirect_uri=T,B._popupWindowFeatures=P,B._popupWindowTarget=D,B._silent_redirect_uri=j,B._silentRequestTimeout=M,B._automaticSilentRenew=ce,B._validateSubOnSilentRenew=ee,B._includeIdTokenInSilentRenew=se,B._accessTokenExpiringNotificationTime=ze,B._monitorSession=Ne,B._monitorAnonymousSession=je,B._checkSessionInterval=Ie,B._stopCheckSessionOnError=pe,Ce?B._query_status_response_type=Ce:arguments[0]&&arguments[0].response_type?B._query_status_response_type=_.SigninRequest.isOidc(arguments[0].response_type)?"id_token":"code":B._query_status_response_type="id_token",B._revokeAccessTokenOnSignout=Be,B._redirectNavigator=Ee,B._popupNavigator=ke,B._iframeNavigator=R,B._userStore=k,B}return(function(A,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);A.prototype=Object.create(T&&T.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(A,T):A.__proto__=T)})(F,I),a(F,[{key:"popup_redirect_uri",get:function(){return this._popup_redirect_uri}},{key:"popup_post_logout_redirect_uri",get:function(){return this._popup_post_logout_redirect_uri}},{key:"popupWindowFeatures",get:function(){return this._popupWindowFeatures}},{key:"popupWindowTarget",get:function(){return this._popupWindowTarget}},{key:"silent_redirect_uri",get:function(){return this._silent_redirect_uri}},{key:"silentRequestTimeout",get:function(){return this._silentRequestTimeout}},{key:"automaticSilentRenew",get:function(){return this._automaticSilentRenew}},{key:"validateSubOnSilentRenew",get:function(){return this._validateSubOnSilentRenew}},{key:"includeIdTokenInSilentRenew",get:function(){return this._includeIdTokenInSilentRenew}},{key:"accessTokenExpiringNotificationTime",get:function(){return this._accessTokenExpiringNotificationTime}},{key:"monitorSession",get:function(){return this._monitorSession}},{key:"monitorAnonymousSession",get:function(){return this._monitorAnonymousSession}},{key:"checkSessionInterval",get:function(){return this._checkSessionInterval}},{key:"stopCheckSessionOnError",get:function(){return this._stopCheckSessionOnError}},{key:"query_status_response_type",get:function(){return this._query_status_response_type}},{key:"revokeAccessTokenOnSignout",get:function(){return this._revokeAccessTokenOnSignout}},{key:"redirectNavigator",get:function(){return this._redirectNavigator}},{key:"popupNavigator",get:function(){return this._popupNavigator}},{key:"iframeNavigator",get:function(){return this._iframeNavigator}},{key:"userStore",get:function(){return this._userStore}}]),F})(l.OidcClientSettings)},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.RedirectNavigator=void 0;var a=(function(){function c(g,h){for(var p=0;p<h.length;p++){var f=h[p];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(g,f.key,f)}}return function(g,h,p){return h&&c(g.prototype,h),p&&c(g,p),g}})(),l=s(0);n.RedirectNavigator=(function(){function c(){(function(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")})(this,c)}return c.prototype.prepare=function(){return Promise.resolve(this)},c.prototype.navigate=function(h){return h&&h.url?(h.useReplaceToNavigate?window.location.replace(h.url):window.location=h.url,Promise.resolve()):(l.Log.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))},a(c,[{key:"url",get:function(){return window.location.href}}]),c})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.PopupNavigator=void 0;var a=s(0),l=s(42);n.PopupNavigator=(function(){function c(){(function(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")})(this,c)}return c.prototype.prepare=function(h){var p=new l.PopupWindow(h);return Promise.resolve(p)},c.prototype.callback=function(h,p,f){a.Log.debug("PopupNavigator.callback");try{return l.PopupWindow.notifyOpener(h,p,f),Promise.resolve()}catch(_){return Promise.reject(_)}},c})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.PopupWindow=void 0;var a=(function(){function g(h,p){for(var f=0;f<p.length;f++){var _=p[f];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(h,_.key,_)}}return function(h,p,f){return p&&g(h.prototype,p),f&&g(h,f),h}})(),l=s(0),c=s(3);n.PopupWindow=(function(){function g(h){var p=this;(function(S,I){if(!(S instanceof I))throw new TypeError("Cannot call a class as a function")})(this,g),this._promise=new Promise((function(x,S){p._resolve=x,p._reject=S}));var f=h.popupWindowTarget||"_blank",_=h.popupWindowFeatures||"location=no,toolbar=no,width=500,height=500,left=100,top=100;";this._popup=window.open("",f,_),this._popup&&(l.Log.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),500))}return g.prototype.navigate=function(p){return this._popup?p&&p.url?(l.Log.debug("PopupWindow.navigate: Setting URL in popup"),this._id=p.id,this._id&&(window["popupCallback_"+p.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=p.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise},g.prototype._success=function(p){l.Log.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(p)},g.prototype._error=function(p){l.Log.error("PopupWindow.error: ",p),this._cleanup(),this._reject(new Error(p))},g.prototype.close=function(){this._cleanup(!1)},g.prototype._cleanup=function(p){l.Log.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!p&&this._popup.close(),this._popup=null},g.prototype._checkForPopupClosed=function(){this._popup&&!this._popup.closed||this._error("Popup window closed")},g.prototype._callback=function(p,f){this._cleanup(f),p?(l.Log.debug("PopupWindow.callback success"),this._success({url:p})):(l.Log.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))},g.notifyOpener=function(p,f,_){if(window.opener){if(p=p||window.location.href){var x=c.UrlUtility.parseUrlFragment(p,_);if(x.state){var S="popupCallback_"+x.state,I=window.opener[S];I?(l.Log.debug("PopupWindow.notifyOpener: passing url message to opener"),I(p,f)):l.Log.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else l.Log.warn("PopupWindow.notifyOpener: no state found in response url")}}else l.Log.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")},a(g,[{key:"promise",get:function(){return this._promise}}]),g})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.IFrameNavigator=void 0;var a=s(0),l=s(44);n.IFrameNavigator=(function(){function c(){(function(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")})(this,c)}return c.prototype.prepare=function(h){var p=new l.IFrameWindow(h);return Promise.resolve(p)},c.prototype.callback=function(h){a.Log.debug("IFrameNavigator.callback");try{return l.IFrameWindow.notifyParent(h),Promise.resolve()}catch(p){return Promise.reject(p)}},c})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.IFrameWindow=void 0;var a=(function(){function c(g,h){for(var p=0;p<h.length;p++){var f=h[p];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(g,f.key,f)}}return function(g,h,p){return h&&c(g.prototype,h),p&&c(g,p),g}})(),l=s(0);n.IFrameWindow=(function(){function c(g){var h=this;(function(f,_){if(!(f instanceof _))throw new TypeError("Cannot call a class as a function")})(this,c),this._promise=new Promise((function(p,f){h._resolve=p,h._reject=f})),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.width=0,this._frame.height=0,window.document.body.appendChild(this._frame)}return c.prototype.navigate=function(h){if(h&&h.url){var p=h.silentRequestTimeout||1e4;l.Log.debug("IFrameWindow.navigate: Using timeout of:",p),this._timer=window.setTimeout(this._timeout.bind(this),p),this._frame.src=h.url}else this._error("No url provided");return this.promise},c.prototype._success=function(h){this._cleanup(),l.Log.debug("IFrameWindow: Successful response from frame window"),this._resolve(h)},c.prototype._error=function(h){this._cleanup(),l.Log.error(h),this._reject(new Error(h))},c.prototype.close=function(){this._cleanup()},c.prototype._cleanup=function(){this._frame&&(l.Log.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)},c.prototype._timeout=function(){l.Log.debug("IFrameWindow.timeout"),this._error("Frame window timed out")},c.prototype._message=function(h){if(l.Log.debug("IFrameWindow.message"),this._timer&&h.origin===this._origin&&h.source===this._frame.contentWindow&&typeof h.data=="string"&&(h.data.startsWith("http://")||h.data.startsWith("https://"))){var p=h.data;p?this._success({url:p}):this._error("Invalid response from frame")}},c.notifyParent=function(h){l.Log.debug("IFrameWindow.notifyParent"),(h=h||window.location.href)&&(l.Log.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(h,location.protocol+"//"+location.host))},a(c,[{key:"promise",get:function(){return this._promise}},{key:"_origin",get:function(){return location.protocol+"//"+location.host}}]),c})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.UserManagerEvents=void 0;var a=s(0),l=s(16),c=s(17);n.UserManagerEvents=(function(g){function h(p){(function(x,S){if(!(x instanceof S))throw new TypeError("Cannot call a class as a function")})(this,h);var f=(function(x,S){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!S||typeof S!="object"&&typeof S!="function"?x:S})(this,g.call(this,p));return f._userLoaded=new c.Event("User loaded"),f._userUnloaded=new c.Event("User unloaded"),f._silentRenewError=new c.Event("Silent renew error"),f._userSignedIn=new c.Event("User signed in"),f._userSignedOut=new c.Event("User signed out"),f._userSessionChanged=new c.Event("User session changed"),f}return(function(f,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);f.prototype=Object.create(_&&_.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(f,_):f.__proto__=_)})(h,g),h.prototype.load=function(f){var _=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];a.Log.debug("UserManagerEvents.load"),g.prototype.load.call(this,f),_&&this._userLoaded.raise(f)},h.prototype.unload=function(){a.Log.debug("UserManagerEvents.unload"),g.prototype.unload.call(this),this._userUnloaded.raise()},h.prototype.addUserLoaded=function(f){this._userLoaded.addHandler(f)},h.prototype.removeUserLoaded=function(f){this._userLoaded.removeHandler(f)},h.prototype.addUserUnloaded=function(f){this._userUnloaded.addHandler(f)},h.prototype.removeUserUnloaded=function(f){this._userUnloaded.removeHandler(f)},h.prototype.addSilentRenewError=function(f){this._silentRenewError.addHandler(f)},h.prototype.removeSilentRenewError=function(f){this._silentRenewError.removeHandler(f)},h.prototype._raiseSilentRenewError=function(f){a.Log.debug("UserManagerEvents._raiseSilentRenewError",f.message),this._silentRenewError.raise(f)},h.prototype.addUserSignedIn=function(f){this._userSignedIn.addHandler(f)},h.prototype.removeUserSignedIn=function(f){this._userSignedIn.removeHandler(f)},h.prototype._raiseUserSignedIn=function(){a.Log.debug("UserManagerEvents._raiseUserSignedIn"),this._userSignedIn.raise()},h.prototype.addUserSignedOut=function(f){this._userSignedOut.addHandler(f)},h.prototype.removeUserSignedOut=function(f){this._userSignedOut.removeHandler(f)},h.prototype._raiseUserSignedOut=function(){a.Log.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise()},h.prototype.addUserSessionChanged=function(f){this._userSessionChanged.addHandler(f)},h.prototype.removeUserSessionChanged=function(f){this._userSessionChanged.removeHandler(f)},h.prototype._raiseUserSessionChanged=function(){a.Log.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise()},h})(l.AccessTokenEvents)},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.Timer=void 0;var a=(function(){function f(_,x){for(var S=0;S<x.length;S++){var I=x[S];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(_,I.key,I)}}return function(_,x,S){return x&&f(_.prototype,x),S&&f(_,S),_}})(),l=s(0),c=s(1),g=s(17);function h(f,_){if(!(f instanceof _))throw new TypeError("Cannot call a class as a function")}function p(f,_){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!_||typeof _!="object"&&typeof _!="function"?f:_}n.Timer=(function(f){function _(x){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c.Global.timer,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;h(this,_);var F=p(this,f.call(this,x));return F._timer=S,F._nowFunc=I||function(){return Date.now()/1e3},F}return(function(S,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);S.prototype=Object.create(I&&I.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(S,I):S.__proto__=I)})(_,f),_.prototype.init=function(S){S<=0&&(S=1),S=parseInt(S);var I=this.now+S;if(this.expiration===I&&this._timerHandle)l.Log.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);else{this.cancel(),l.Log.debug("Timer.init timer "+this._name+" for duration:",S),this._expiration=I;var F=5;S<F&&(F=S),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*F)}},_.prototype.cancel=function(){this._timerHandle&&(l.Log.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)},_.prototype._callback=function(){var S=this._expiration-this.now;l.Log.debug("Timer.callback; "+this._name+" timer expires in:",S),this._expiration<=this.now&&(this.cancel(),f.prototype.raise.call(this))},a(_,[{key:"now",get:function(){return parseInt(this._nowFunc())}},{key:"expiration",get:function(){return this._expiration}}]),_})(g.Event)},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.SilentRenewService=void 0;var a=s(0);n.SilentRenewService=(function(){function l(c){(function(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")})(this,l),this._userManager=c}return l.prototype.start=function(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then((function(g){})).catch((function(g){a.Log.error("SilentRenewService.start: Error from getUser:",g.message)})))},l.prototype.stop=function(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)},l.prototype._tokenExpiring=function(){var g=this;this._userManager.signinSilent().then((function(h){a.Log.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")}),(function(h){a.Log.error("SilentRenewService._tokenExpiring: Error from signinSilent:",h.message),g._userManager.events._raiseSilentRenewError(h)}))},l})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.CordovaPopupNavigator=void 0;var a=s(21);n.CordovaPopupNavigator=(function(){function l(){(function(g,h){if(!(g instanceof h))throw new TypeError("Cannot call a class as a function")})(this,l)}return l.prototype.prepare=function(g){var h=new a.CordovaPopupWindow(g);return Promise.resolve(h)},l})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.CordovaIFrameNavigator=void 0;var a=s(21);n.CordovaIFrameNavigator=(function(){function l(){(function(g,h){if(!(g instanceof h))throw new TypeError("Cannot call a class as a function")})(this,l)}return l.prototype.prepare=function(g){g.popupWindowFeatures="hidden=yes";var h=new a.CordovaPopupWindow(g);return Promise.resolve(h)},l})()},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.Version="1.11.6"}])}))})(Ni)),Ni.exports}var hs=$d();function Hd(t,e){throw t.error==="invalid_redirect_uri"?new Error(`Dynamic client registration failed: the provided redirect uri [${e.redirectUrl?.toString()}] is invalid - ${t.error_description??""}`):t.error==="invalid_client_metadata"?new Error(`Dynamic client registration failed: the provided client metadata ${JSON.stringify(e)} is invalid - ${t.error_description??""}`):new Error(`Dynamic client registration failed: ${t.error} - ${t.error_description??""}`)}function Vd(t){return typeof t.client_id=="string"}function Kd(t){return Array.isArray(t.redirect_uris)&&t.redirect_uris.every(e=>typeof e=="string")}function qd(t,e){if(!Vd(t))throw new Error(`Dynamic client registration failed: no client_id has been found on ${JSON.stringify(t)}`);if(e.redirectUrl&&Kd(t)&&t.redirect_uris[0]!==e.redirectUrl.toString())throw new Error(`Dynamic client registration failed: the returned redirect URIs ${JSON.stringify(t.redirect_uris)} don't match the provided ${JSON.stringify([e.redirectUrl.toString()])}`);return!0}async function Wd(t,e){if(!e.registrationEndpoint)throw new Error("Dynamic Registration could not be completed because the issuer has no registration endpoint.");if(!Array.isArray(e.idTokenSigningAlgValuesSupported))throw new Error("The OIDC issuer discovery profile is missing the 'id_token_signing_alg_values_supported' value, which is mandatory.");const r=Sd(e.idTokenSigningAlgValuesSupported,Hi),n={client_name:t.clientName,application_type:"web",redirect_uris:[t.redirectUrl?.toString()],subject_type:"public",token_endpoint_auth_method:"client_secret_basic",id_token_signed_response_alg:r,grant_types:["authorization_code","refresh_token"]},s={"Content-Type":"application/json"},a=await fetch(e.registrationEndpoint.toString(),{method:"POST",headers:s,body:JSON.stringify(n)});if(a.ok){const l=await a.json();return qd(l,t),{clientId:l.client_id,clientSecret:l.client_secret,expiresAt:l.client_secret_expires_at,idTokenSignedResponseAlg:l.id_token_signed_response_alg,clientType:"dynamic"}}throw a.status===400&&Hd(await a.json(),t),new Error(`Dynamic client registration failed: the server returned ${a.status} ${a.statusText} - ${await a.text()}`)}function zd(t){return t.error!==void 0&&typeof t.error=="string"}function Ca(t){return t.error_description!==void 0&&typeof t.error_description=="string"}function Jd(t){return t.error_uri!==void 0&&typeof t.error_uri=="string"}function Gd(t){return t.access_token!==void 0&&typeof t.access_token=="string"}function Yd(t){return t.id_token!==void 0&&typeof t.id_token=="string"}function Qd(t){return t.refresh_token!==void 0&&typeof t.refresh_token=="string"}function Xd(t){return t.token_type!==void 0&&typeof t.token_type=="string"}function Zd(t){return t.expires_in===void 0||typeof t.expires_in=="number"}function ef(t,e){if(e.grantType&&(!t.grantTypesSupported||!t.grantTypesSupported.includes(e.grantType)))throw new Error(`The issuer [${t.issuer}] does not support the [${e.grantType}] grant`);if(!t.tokenEndpoint)throw new Error(`This issuer [${t.issuer}] does not have a token endpoint`)}function ku(t,e){if(zd(t))throw new Iu(`Token endpoint returned error [${t.error}]${Ca(t)?`: ${t.error_description}`:""}${Jd(t)?` (see ${t.error_uri})`:""}`,t.error,Ca(t)?t.error_description:void 0);if(!Gd(t))throw new Zn(["access_token"]);if(!Yd(t))throw new Zn(["id_token"]);if(!Xd(t))throw new Zn(["token_type"]);if(!Zd(t))throw new Zn(["expires_in"]);if(!e&&t.token_type.toLowerCase()!=="bearer")throw new Error(`Invalid token endpoint response: requested a [Bearer] token, but got a 'token_type' value of [${t.token_type}].`);return t}async function tf(t,e,r,n){ef(t,r);const s={"content-type":"application/x-www-form-urlencoded"};let a;n&&(a=await Pd(),s.DPoP=await js(t.tokenEndpoint,"POST",a)),e.clientSecret&&(s.Authorization=`Basic ${btoa(`${e.clientId}:${e.clientSecret}`)}`);const l={grant_type:r.grantType,redirect_uri:r.redirectUrl,code:r.code,code_verifier:r.codeVerifier,client_id:e.clientId},c={method:"POST",headers:s,body:new URLSearchParams(l).toString()},h=await(await fetch(t.tokenEndpoint,c)).json(),p=ku(h,n),{webId:f,clientId:_}=await _u(p.id_token,t.jwksUri,t.issuer,e.clientId);return{accessToken:p.access_token,idToken:p.id_token,refreshToken:Qd(p)?p.refresh_token:void 0,webId:f,clientId:_,dpopKey:a,expiresIn:p.expires_in}}const rf=t=>{try{return new URL(t),!0}catch{return!1}};async function nf(t,e,r,n){if(r.clientId===void 0)throw new Error("No client ID available when trying to refresh the access token.");const s={grant_type:"refresh_token",refresh_token:t};let a={};n!==void 0&&(a={DPoP:await js(e.tokenEndpoint,"POST",n)});let l={};r.clientSecret!==void 0?l={Authorization:`Basic ${btoa(`${r.clientId}:${r.clientSecret}`)}`}:rf(r.clientId)&&(s.client_id=r.clientId);const c=await fetch(e.tokenEndpoint,{method:"POST",body:new URLSearchParams(s).toString(),headers:{...a,...l,"Content-Type":"application/x-www-form-urlencoded"}});let g;try{g=await c.json()}catch{throw new Error(`The token endpoint of issuer ${e.issuer} returned a malformed response.`)}const h=ku(g,n!==void 0),{webId:p}=await _u(h.id_token,e.jwksUri,e.issuer,r.clientId);return{accessToken:h.access_token,idToken:h.id_token,refreshToken:typeof h.refresh_token=="string"?h.refresh_token:void 0,webId:p,dpopKey:n,expiresIn:h.expires_in}}function of(t){const e=Eu(t);return e.hash="",t.includes(`${e.origin}/`)?e.href:`${e.origin}${e.href.substring(e.origin.length+1)}`}async function sf(){await new hs.OidcClient({response_mode:"query"}).clearStaleState(new hs.WebStorageStateStore({}));const e=window.localStorage,r=[];for(let n=0;n<=e.length;n+=1){const s=e.key(n);s&&(s.match(/^oidc\..+$/)||s.match(/^solidClientAuthenticationUser:.+$/))&&r.push(s)}r.forEach(n=>e.removeItem(n))}class af extends Td{constructor(e,r){super(e,r)}}class lf extends Rd{login=async(e,r)=>{e.prompt!=="none"&&await this.sessionInfoManager.clear(e.sessionId);const n=e.redirectUrl??of(window.location.href);if(!Su(n))throw new Error(`${n} is not a valid redirect URL, it is either a malformed IRI, includes a hash fragment, or reserved query parameters ('code' or 'state').`);await this.loginHandler.handle({...e,redirectUrl:n,clientName:e.clientName??e.clientId,eventEmitter:r})};validateCurrentSession=async e=>{const r=await this.sessionInfoManager.get(e);return r===void 0||r.clientAppId===void 0||r.issuer===void 0?null:r};handleIncomingRedirect=async(e,r)=>{try{const n=await this.redirectHandler.handle(e,r,void 0);return this.fetch=n.fetch.bind(window),this.boundLogout=n.getLogoutUrl,await this.cleanUrlAfterRedirect(e),{isLoggedIn:n.isLoggedIn,webId:n.webId,sessionId:n.sessionId,expirationDate:n.expirationDate,clientAppId:n.clientAppId}}catch(n){await this.cleanUrlAfterRedirect(e),r.emit(ut.ERROR,"redirect",n);return}};async cleanUrlAfterRedirect(e){const r=Eu(e).href;for(window.history.replaceState(null,"",r);window.location.href!==r;)await new Promise(n=>{setTimeout(()=>n(),1)})}}function ka(t){return typeof t.oidcIssuer=="string"}function Pa(t){return typeof t.redirectUrl=="string"}class uf{storageUtility;oidcHandler;issuerConfigFetcher;clientRegistrar;constructor(e,r,n,s){this.storageUtility=e,this.oidcHandler=r,this.issuerConfigFetcher=n,this.clientRegistrar=s,this.storageUtility=e,this.oidcHandler=r,this.issuerConfigFetcher=n,this.clientRegistrar=s}async canHandle(e){return ka(e)&&Pa(e)}async handle(e){if(!ka(e))throw new cs(`OidcLoginHandler requires an OIDC issuer: missing property 'oidcIssuer' in ${JSON.stringify(e)}`);if(!Pa(e))throw new cs(`OidcLoginHandler requires a redirect URL: missing property 'redirectUrl' in ${JSON.stringify(e)}`);const r=await this.issuerConfigFetcher.fetchConfig(e.oidcIssuer),n=await Fd(e,r,this.storageUtility,this.clientRegistrar),s={issuer:r.issuer,dpop:e.tokenType.toLowerCase()==="dpop",...e,issuerConfiguration:r,client:n,scopes:dd(e.customScopes)};return this.oidcHandler.handle(s)}}class cf extends pd{async handle(e){const r={authority:e.issuer.toString(),client_id:e.client.clientId,client_secret:e.client.clientSecret,redirect_uri:e.redirectUrl,response_type:"code",scope:e.scopes.join(" "),filterProtocolClaims:!0,loadUserInfo:!1,code_verifier:!0,prompt:e.prompt??"consent"},n=new hs.OidcClient(r);try{const s=await n.createSigninRequest();return await this.setupRedirectHandler({oidcLoginOptions:e,state:s.state._id,codeVerifier:s.state._code_verifier,targetUrl:s.url.toString()})}catch(s){console.error(s)}}}const hf=".well-known/openid-configuration",Na={issuer:{toKey:"issuer",convertToUrl:!0},authorization_endpoint:{toKey:"authorizationEndpoint",convertToUrl:!0},token_endpoint:{toKey:"tokenEndpoint",convertToUrl:!0},userinfo_endpoint:{toKey:"userinfoEndpoint",convertToUrl:!0},jwks_uri:{toKey:"jwksUri",convertToUrl:!0},registration_endpoint:{toKey:"registrationEndpoint",convertToUrl:!0},end_session_endpoint:{toKey:"endSessionEndpoint",convertToUrl:!0},scopes_supported:{toKey:"scopesSupported"},response_types_supported:{toKey:"responseTypesSupported"},response_modes_supported:{toKey:"responseModesSupported"},grant_types_supported:{toKey:"grantTypesSupported"},acr_values_supported:{toKey:"acrValuesSupported"},subject_types_supported:{toKey:"subjectTypesSupported"},id_token_signing_alg_values_supported:{toKey:"idTokenSigningAlgValuesSupported"},id_token_encryption_alg_values_supported:{toKey:"idTokenEncryptionAlgValuesSupported"},id_token_encryption_enc_values_supported:{toKey:"idTokenEncryptionEncValuesSupported"},userinfo_signing_alg_values_supported:{toKey:"userinfoSigningAlgValuesSupported"},userinfo_encryption_alg_values_supported:{toKey:"userinfoEncryptionAlgValuesSupported"},userinfo_encryption_enc_values_supported:{toKey:"userinfoEncryptionEncValuesSupported"},request_object_signing_alg_values_supported:{toKey:"requestObjectSigningAlgValuesSupported"},request_object_encryption_alg_values_supported:{toKey:"requestObjectEncryptionAlgValuesSupported"},request_object_encryption_enc_values_supported:{toKey:"requestObjectEncryptionEncValuesSupported"},token_endpoint_auth_methods_supported:{toKey:"tokenEndpointAuthMethodsSupported"},token_endpoint_auth_signing_alg_values_supported:{toKey:"tokenEndpointAuthSigningAlgValuesSupported"},display_values_supported:{toKey:"displayValuesSupported"},claim_types_supported:{toKey:"claimTypesSupported"},claims_supported:{toKey:"claimsSupported"},service_documentation:{toKey:"serviceDocumentation"},claims_locales_supported:{toKey:"claimsLocalesSupported"},ui_locales_supported:{toKey:"uiLocalesSupported"},claims_parameter_supported:{toKey:"claimsParameterSupported"},request_parameter_supported:{toKey:"requestParameterSupported"},request_uri_parameter_supported:{toKey:"requestUriParameterSupported"},require_request_uri_registration:{toKey:"requireRequestUriRegistration"},op_policy_uri:{toKey:"opPolicyUri",convertToUrl:!0},op_tos_uri:{toKey:"opTosUri",convertToUrl:!0}};function df(t){const e={};return Object.keys(t).forEach(r=>{Na[r]&&(e[Na[r].toKey]=t[r])}),Array.isArray(e.scopesSupported)||(e.scopesSupported=["openid"]),e}class $s{storageUtility;constructor(e){this.storageUtility=e,this.storageUtility=e}static getLocalStorageKey(e){return`issuerConfig:${e}`}async fetchConfig(e){let r;const n=new URL(hf,e.endsWith("/")?e:`${e}/`).href,s=await fetch(n);try{r=df(await s.json())}catch(a){throw new cs(`[${e.toString()}] has an invalid configuration: ${a.message}`)}return await this.storageUtility.set($s.getLocalStorageKey(e),JSON.stringify(r)),r}}async function ff(t,e){await Au(t,e),await sf()}class pf extends wd{async get(e){const[r,n,s,a,l,c,g,h]=await Promise.all([this.storageUtility.getForUser(e,"isLoggedIn",{secure:!0}),this.storageUtility.getForUser(e,"webId",{secure:!0}),this.storageUtility.getForUser(e,"clientId",{secure:!1}),this.storageUtility.getForUser(e,"clientSecret",{secure:!1}),this.storageUtility.getForUser(e,"redirectUrl",{secure:!1}),this.storageUtility.getForUser(e,"refreshToken",{secure:!0}),this.storageUtility.getForUser(e,"issuer",{secure:!1}),this.storageUtility.getForUser(e,"tokenType",{secure:!1})]);if(typeof l=="string"&&!Su(l)){await Promise.all([this.storageUtility.deleteAllUserData(e,{secure:!1}),this.storageUtility.deleteAllUserData(e,{secure:!0})]);return}if(h!==void 0&&!_d(h))throw new Error(`Tokens of type [${h}] are not supported.`);if(!(s===void 0&&r===void 0&&n===void 0&&c===void 0))return{sessionId:e,webId:n,isLoggedIn:r==="true",redirectUrl:l,refreshToken:c,issuer:g,clientAppId:s,clientAppSecret:a,tokenType:h??"DPoP"}}async clear(e){return ff(e,this.storageUtility)}}class gf{async canHandle(e){try{return new URL(e),!0}catch(r){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${r}`)}}async handle(e){return xu()}}class mf{storageUtility;sessionInfoManager;issuerConfigFetcher;clientRegistrar;tokerRefresher;constructor(e,r,n,s,a){this.storageUtility=e,this.sessionInfoManager=r,this.issuerConfigFetcher=n,this.clientRegistrar=s,this.tokerRefresher=a,this.storageUtility=e,this.sessionInfoManager=r,this.issuerConfigFetcher=n,this.clientRegistrar=s,this.tokerRefresher=a}async canHandle(e){try{const r=new URL(e);return r.searchParams.get("code")!==null&&r.searchParams.get("state")!==null}catch(r){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${r}`)}}async handle(e,r){if(!await this.canHandle(e))throw new Error(`AuthCodeRedirectHandler cannot handle [${e}]: it is missing one of [code, state].`);const n=new URL(e),s=n.searchParams.get("state"),a=await this.storageUtility.getForUser(s,"sessionId",{errorIfNull:!0}),{issuerConfig:l,codeVerifier:c,redirectUrl:g,dpop:h}=await Ru(a,this.storageUtility,this.issuerConfigFetcher),p=n.searchParams.get("iss");if(typeof p=="string"&&p!==l.issuer)throw new Error(`The value of the iss parameter (${p}) does not match the issuer identifier of the authorization server (${l.issuer}). See [rfc9207](https://www.rfc-editor.org/rfc/rfc9207.html#section-2.3-3.1.1)`);if(c===void 0)throw new Error(`The code verifier for session ${a} is missing from storage.`);if(g===void 0)throw new Error(`The redirect URL for session ${a} is missing from storage.`);const f=await this.clientRegistrar.getClient({sessionId:a},l),_=Date.now(),x=await tf(l,f,{grantType:"authorization_code",code:n.searchParams.get("code"),codeVerifier:c,redirectUrl:g},h);window.localStorage.removeItem(`oidc.${s}`);let S;x.refreshToken!==void 0&&(S={sessionId:a,refreshToken:x.refreshToken,tokenRefresher:this.tokerRefresher});const I=Ud(x.accessToken,{dpopKey:x.dpopKey,refreshOptions:S,eventEmitter:r,expiresIn:x.expiresIn});await Id(this.storageUtility,a,x.webId,x.clientId,"true",void 0,!0);const F=await this.sessionInfoManager.get(a);if(!F)throw new Error(`Could not retrieve session: [${a}].`);return Object.assign(F,{fetch:I,getLogoutUrl:bd({idTokenHint:x.idToken,endSessionEndpoint:l.endSessionEndpoint}),expirationDate:typeof x.expiresIn=="number"?_+x.expiresIn*1e3:void 0})}}class yf extends hd{constructor(e){super(e)}}class wf{get storage(){return window.localStorage}async get(e){return this.storage.getItem(e)||void 0}async set(e,r){this.storage.setItem(e,r)}async delete(e){this.storage.removeItem(e)}}class vf{redirect(e,r){r&&r.handleRedirect?r.handleRedirect(e):r&&r.redirectByReplacingState?window.history.replaceState({},"",e):window.location.href=e}}class bf{storageUtility;constructor(e){this.storageUtility=e,this.storageUtility=e}async getClient(e,r){const[n,s,a,l,c]=await Promise.all([this.storageUtility.getForUser(e.sessionId,"clientId",{secure:!1}),this.storageUtility.getForUser(e.sessionId,"clientSecret",{secure:!1}),this.storageUtility.getForUser(e.sessionId,"expiresAt",{secure:!1}),this.storageUtility.getForUser(e.sessionId,"clientName",{secure:!1}),this.storageUtility.getForUser(e.sessionId,"clientType",{secure:!1})]),g=a!==void 0?Number.parseInt(a,10):-1,h=s!==void 0&&g!==0&&Math.floor(Date.now()/1e3)>g;if(n&&Ad(c)&&!h)return s!==void 0?{clientId:n,clientSecret:s,clientName:l,clientType:"dynamic",expiresAt:g}:{clientId:n,clientName:l,clientType:c};try{const p=await Wd(e,r),f={clientId:p.clientId,clientType:"dynamic"};return p.clientSecret!==void 0&&(f.clientSecret=p.clientSecret,f.expiresAt=String(p.expiresAt)),p.idTokenSignedResponseAlg&&(f.idTokenSignedResponseAlg=p.idTokenSignedResponseAlg),await this.storageUtility.setForUser(e.sessionId,f,{secure:!1}),p}catch(p){throw new Error("Client registration failed.",{cause:p})}}}class _f{async canHandle(e){try{return new URL(e).searchParams.has("error")}catch(r){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${r}`)}}async handle(e,r){if(r!==void 0){const n=new URL(e),s=n.searchParams.get("error"),a=n.searchParams.get("error_description");r.emit(ut.ERROR,s,a)}return xu()}}class Sf{storageUtility;issuerConfigFetcher;clientRegistrar;constructor(e,r,n){this.storageUtility=e,this.issuerConfigFetcher=r,this.clientRegistrar=n,this.storageUtility=e,this.issuerConfigFetcher=r,this.clientRegistrar=n}async refresh(e,r,n,s){const a=await Ru(e,this.storageUtility,this.issuerConfigFetcher),l=await this.clientRegistrar.getClient({sessionId:e},a.issuerConfig);if(r===void 0)throw new Error(`Session [${e}] has no refresh token to allow it to refresh its access token.`);if(a.dpop&&n===void 0)throw new Error(`For session [${e}], the key bound to the DPoP access token must be provided to refresh said access token.`);const c=await nf(r,a.issuerConfig,l,n);return c.refreshToken!==void 0&&s?.emit(ut.NEW_REFRESH_TOKEN,c.refreshToken),c}}function La(t){const e=new Cd,r=t.secureStorage||e,n=t.insecureStorage||new wf,s=new af(r,n),a=new $s(s),l=new bf(s),c=new pf(s),g=new Sf(s,a,l),h=new vf,p=new uf(s,new cf(s,h),a,l),f=new yf([new _f,new mf(s,c,a,l,g),new gf]);return new lf(p,f,new yd(c,h),c,a)}const wo=`${bu}currentSession`,ds=`${bu}currentUrl`;async function Ef(t,e,r){const n=await e.validateCurrentSession(t);return n!==null?(window.localStorage.setItem(ds,window.location.href),await e.login({sessionId:t,prompt:"none",oidcIssuer:n.issuer,redirectUrl:n.redirectUrl,clientId:n.clientAppId,clientSecret:n.clientAppSecret,tokenType:n.tokenType??"DPoP"},r.events),!0):!1}function xf(t){return!!t?.isLoggedIn}class Af{info;events;clientAuthentication;tokenRequestInProgress=!1;constructor(e={},r=void 0){this.events=new Md,e.clientAuthentication?this.clientAuthentication=e.clientAuthentication:e.secureStorage&&e.insecureStorage?this.clientAuthentication=La({secureStorage:e.secureStorage,insecureStorage:e.insecureStorage}):this.clientAuthentication=La({}),e.sessionInfo?this.info={sessionId:e.sessionInfo.sessionId,isLoggedIn:!1,webId:e.sessionInfo.webId,clientAppId:e.sessionInfo.clientAppId}:this.info={sessionId:r??Ms(),isLoggedIn:!1},this.events.on(ut.LOGIN,()=>window.localStorage.setItem(wo,this.info.sessionId)),this.events.on(ut.SESSION_EXPIRED,()=>this.internalLogout(!1)),this.events.on(ut.ERROR,()=>this.internalLogout(!1))}login=async e=>(await this.clientAuthentication.login({sessionId:this.info.sessionId,...e,tokenType:e.tokenType??"DPoP"},this.events),new Promise(()=>{}));fetch=(e,r)=>this.clientAuthentication.fetch(e,r);internalLogout=async(e,r)=>{window.localStorage.removeItem(wo),await this.clientAuthentication.logout(this.info.sessionId,r),this.info.isLoggedIn=!1,e&&this.events.emit(ut.LOGOUT)};logout=async e=>this.internalLogout(!0,e);handleIncomingRedirect=async(e={})=>{if(this.info.isLoggedIn)return this.info;if(this.tokenRequestInProgress)return;const r=typeof e=="string"?{url:e}:e,n=r.url??window.location.href;this.tokenRequestInProgress=!0;const s=await this.clientAuthentication.handleIncomingRedirect(n,this.events);if(xf(s)){this.setSessionInfo(s);const a=window.localStorage.getItem(ds);a===null?this.events.emit(ut.LOGIN):(window.localStorage.removeItem(ds),this.events.emit(ut.SESSION_RESTORED,a))}else if(r.restorePreviousSession===!0){const a=window.localStorage.getItem(wo);if(a!==null&&await Ef(a,this.clientAuthentication,this))return new Promise(()=>{})}return this.tokenRequestInProgress=!1,s};setSessionInfo(e){this.info.isLoggedIn=e.isLoggedIn,this.info.webId=e.webId,this.info.sessionId=e.sessionId,this.info.clientAppId=e.clientAppId,this.info.expirationDate=e.expirationDate,this.events.on(ut.SESSION_EXTENDED,r=>{this.info.expirationDate=Date.now()+r*1e3})}}let vo;function bn(){return typeof vo>"u"&&(vo=new Af),vo}function Ff(...t){return bn().fetch(...t)}function Rf(...t){return bn().login(...t)}function If(...t){return bn().logout(...t)}function Tf(...t){return bn().handleIncomingRedirect(...t)}const mt=t=>t??pt;var fs=new Set;function Cf(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}function kf(){const t=Number(getComputedStyle(document.body).paddingRight.replace(/px/,""));return isNaN(t)||!t?0:t}function Da(t){if(fs.add(t),!document.documentElement.classList.contains("wa-scroll-lock")){const e=Cf()+kf();let r=getComputedStyle(document.documentElement).scrollbarGutter;(!r||r==="auto")&&(r="stable"),e<2&&(r=""),document.documentElement.style.setProperty("--wa-scroll-lock-gutter",r),document.documentElement.classList.add("wa-scroll-lock"),document.documentElement.style.setProperty("--wa-scroll-lock-size",`${e}px`)}}function Oa(t){fs.delete(t),fs.size===0&&(document.documentElement.classList.remove("wa-scroll-lock"),document.documentElement.style.removeProperty("--wa-scroll-lock-size"))}function Pf(t){return t.split(" ").map(e=>e.trim()).filter(e=>e!=="")}var Hs=class extends Event{constructor(){super("wa-after-hide",{bubbles:!0,cancelable:!1,composed:!0})}},Vs=class extends Event{constructor(){super("wa-after-show",{bubbles:!0,cancelable:!1,composed:!0})}},Ks=class extends Event{constructor(t){super("wa-hide",{bubbles:!0,cancelable:!0,composed:!0}),this.detail=t}},qs=class extends Event{constructor(){super("wa-show",{bubbles:!0,cancelable:!0,composed:!0})}};var Pu=class{constructor(t,...e){this.slotNames=[],this.handleSlotChange=r=>{const n=r.target;(this.slotNames.includes("[default]")&&!n.name||n.name&&this.slotNames.includes(n.name))&&this.host.requestUpdate()},(this.host=t).addController(this),this.slotNames=e}hasDefaultSlot(){return[...this.host.childNodes].some(t=>{if(t.nodeType===Node.TEXT_NODE&&t.textContent.trim()!=="")return!0;if(t.nodeType===Node.ELEMENT_NODE){const e=t;if(e.tagName.toLowerCase()==="wa-visually-hidden")return!1;if(!e.hasAttribute("slot"))return!0}return!1})}hasNamedSlot(t){return this.host.querySelector(`:scope > [slot="${t}"]`)!==null}test(t){return t==="[default]"?this.hasDefaultSlot():this.hasNamedSlot(t)}hostConnected(){this.host.shadowRoot.addEventListener("slotchange",this.handleSlotChange)}hostDisconnected(){this.host.shadowRoot.removeEventListener("slotchange",this.handleSlotChange)}};function Xt(t,e){return new Promise(r=>{const n=new AbortController,{signal:s}=n;if(t.classList.contains(e))return;t.classList.remove(e),t.classList.add(e);let a=()=>{t.classList.remove(e),r(),n.abort()};t.addEventListener("animationend",a,{once:!0,signal:s}),t.addEventListener("animationcancel",a,{once:!0,signal:s})})}function er(t,e){const r={waitUntilFirstUpdate:!1,...e};return(n,s)=>{const{update:a}=n,l=Array.isArray(t)?t:[t];n.update=function(c){l.forEach(g=>{const h=g;if(c.has(h)){const p=c.get(h),f=this[h];p!==f&&(!r.waitUntilFirstUpdate||this.hasUpdated)&&this[s](p,f)}}),a.call(this,c)}}}const Nu={ATTRIBUTE:1,CHILD:2},Lu=t=>(...e)=>({_$litDirective$:t,values:e});let Du=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,r,n){this._$Ct=e,this._$AM=r,this._$Ci=n}_$AS(e,r){return this.update(e,r)}update(e,r){return this.render(...r)}};const Xr=Lu(class extends Du{constructor(t){if(super(t),t.type!==Nu.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((e=>t[e])).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter((n=>n!==""))));for(const n in e)e[n]&&!this.nt?.has(n)&&this.st.add(n);return this.render(e)}const r=t.element.classList;for(const n of this.st)n in e||(r.remove(n),this.st.delete(n));for(const n in e){const s=!!e[n];s===this.st.has(n)||this.nt?.has(n)||(s?(r.add(n),this.st.add(n)):(r.remove(n),this.st.delete(n)))}return Pr}});var Nf=`:host {
  --width: 31rem;
  --spacing: var(--wa-space-l);
  --show-duration: 200ms;
  --hide-duration: 200ms;

  display: none;
}

:host([open]) {
  display: block;
}

.dialog {
  display: flex;
  flex-direction: column;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  width: var(--width);
  max-width: calc(100% - var(--wa-space-2xl));
  max-height: calc(100% - var(--wa-space-2xl));
  background-color: var(--wa-color-surface-raised);
  border-radius: var(--wa-panel-border-radius);
  border: none;
  box-shadow: var(--wa-shadow-l);
  padding: 0;
  margin: auto;

  &.show {
    animation: show-dialog var(--show-duration) ease;

    &::backdrop {
      animation: show-backdrop var(--show-duration, 200ms) ease;
    }
  }

  &.hide {
    animation: show-dialog var(--hide-duration) ease reverse;

    &::backdrop {
      animation: show-backdrop var(--hide-duration, 200ms) ease reverse;
    }
  }

  &.pulse {
    animation: pulse 250ms ease;
  }
}

.dialog:focus {
  outline: none;
}

/* Ensure there's enough vertical padding for phones that don't update vh when chrome appears (e.g. iPhone) */
@media screen and (max-width: 420px) {
  .dialog {
    max-height: 80vh;
  }
}

.open {
  display: flex;
  opacity: 1;
}

.header {
  flex: 0 0 auto;
  display: flex;
  flex-wrap: nowrap;

  padding-inline-start: var(--spacing);
  padding-block-end: 0;

  /* Subtract the close button's padding so that the X is visually aligned with the edges of the dialog content */
  padding-inline-end: calc(var(--spacing) - var(--wa-form-control-padding-block));
  padding-block-start: calc(var(--spacing) - var(--wa-form-control-padding-block));
}

.title {
  align-self: center;
  flex: 1 1 auto;
  font-family: inherit;
  font-size: var(--wa-font-size-l);
  font-weight: var(--wa-font-weight-heading);
  line-height: var(--wa-line-height-condensed);
  margin: 0;
}

.header-actions {
  align-self: start;
  display: flex;
  flex-shrink: 0;
  flex-wrap: wrap;
  justify-content: end;
  gap: var(--wa-space-2xs);
  padding-inline-start: var(--spacing);
}

.header-actions wa-button,
.header-actions ::slotted(wa-button) {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
}

.body {
  flex: 1 1 auto;
  display: block;
  padding: var(--spacing);
  overflow: auto;
  -webkit-overflow-scrolling: touch;

  &:focus {
    outline: none;
  }

  &:focus-visible {
    outline: var(--wa-focus-ring);
    outline-offset: var(--wa-focus-ring-offset);
  }
}

.footer {
  flex: 0 0 auto;
  display: flex;
  flex-wrap: wrap;
  gap: var(--wa-space-xs);
  justify-content: end;
  padding: var(--spacing);
  padding-block-start: 0;
}

.footer ::slotted(wa-button:not(:first-of-type)) {
  margin-inline-start: var(--wa-spacing-xs);
}

.dialog::backdrop {
  /*
    NOTE: the ::backdrop element doesn't inherit properly in Safari yet, but it will in 17.4! At that time, we can
    remove the fallback values here.
  */
  background-color: var(--wa-color-overlay-modal, rgb(0 0 0 / 0.25));
}

@keyframes pulse {
  0% {
    scale: 1;
  }
  50% {
    scale: 1.02;
  }
  100% {
    scale: 1;
  }
}

@keyframes show-dialog {
  from {
    opacity: 0;
    scale: 0.8;
  }
  to {
    opacity: 1;
    scale: 1;
  }
}

@keyframes show-backdrop {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@media (forced-colors: active) {
  .dialog {
    border: solid 1px white;
  }
}
`,br=class extends Zt{constructor(){super(...arguments),this.localize=new di(this),this.hasSlotController=new Pu(this,"footer","header-actions","label"),this.open=!1,this.label="",this.withoutHeader=!1,this.lightDismiss=!1,this.handleDocumentKeyDown=t=>{t.key==="Escape"&&this.open&&(t.preventDefault(),t.stopPropagation(),this.requestClose(this.dialog))}}firstUpdated(){this.open&&(this.addOpenListeners(),this.dialog.showModal(),Da(this))}disconnectedCallback(){super.disconnectedCallback(),Oa(this),this.removeOpenListeners()}async requestClose(t){const e=new Ks({source:t});if(this.dispatchEvent(e),e.defaultPrevented){this.open=!0,Xt(this.dialog,"pulse");return}this.removeOpenListeners(),await Xt(this.dialog,"hide"),this.open=!1,this.dialog.close(),Oa(this);const r=this.originalTrigger;typeof r?.focus=="function"&&setTimeout(()=>r.focus()),this.dispatchEvent(new Hs)}addOpenListeners(){document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){document.removeEventListener("keydown",this.handleDocumentKeyDown)}handleDialogCancel(t){t.preventDefault(),!this.dialog.classList.contains("hide")&&t.target===this.dialog&&this.requestClose(this.dialog)}handleDialogClick(t){const r=t.target.closest('[data-dialog="close"]');r&&(t.stopPropagation(),this.requestClose(r))}async handleDialogPointerDown(t){t.target===this.dialog&&(this.lightDismiss?this.requestClose(this.dialog):await Xt(this.dialog,"pulse"))}handleOpenChange(){this.open&&!this.dialog.open?this.show():!this.open&&this.dialog.open&&(this.open=!0,this.requestClose(this.dialog))}async show(){const t=new qs;if(this.dispatchEvent(t),t.defaultPrevented){this.open=!1;return}this.addOpenListeners(),this.originalTrigger=document.activeElement,this.open=!0,this.dialog.showModal(),Da(this),requestAnimationFrame(()=>{const e=this.querySelector("[autofocus]");e&&typeof e.focus=="function"?e.focus():this.dialog.focus()}),await Xt(this.dialog,"show"),this.dispatchEvent(new Vs)}render(){const t=!this.withoutHeader,e=this.hasSlotController.test("footer");return Qe`
      <dialog
        part="dialog"
        class=${Xr({dialog:!0,open:this.open})}
        @cancel=${this.handleDialogCancel}
        @click=${this.handleDialogClick}
        @pointerdown=${this.handleDialogPointerDown}
      >
        ${t?Qe`
              <header part="header" class="header">
                <h2 part="title" class="title" id="title">
                  <!-- If there's no label, use an invisible character to prevent the header from collapsing -->
                  <slot name="label"> ${this.label.length>0?this.label:""} </slot>
                </h2>
                <div part="header-actions" class="header-actions">
                  <slot name="header-actions"></slot>
                  <wa-button
                    part="close-button"
                    exportparts="base:close-button__base"
                    class="close"
                    appearance="plain"
                    @click="${r=>this.requestClose(r.target)}"
                  >
                    <wa-icon
                      name="xmark"
                      label=${this.localize.term("close")}
                      library="system"
                      variant="solid"
                    ></wa-icon>
                  </wa-button>
                </div>
              </header>
            `:""}

        <div part="body" class="body"><slot></slot></div>

        ${e?Qe`
              <footer part="footer" class="footer">
                <slot name="footer"></slot>
              </footer>
            `:""}
      </dialog>
    `}};br.css=Nf;Se([Ut(".dialog")],br.prototype,"dialog",2);Se([Te({type:Boolean,reflect:!0})],br.prototype,"open",2);Se([Te({reflect:!0})],br.prototype,"label",2);Se([Te({attribute:"without-header",type:Boolean,reflect:!0})],br.prototype,"withoutHeader",2);Se([Te({attribute:"light-dismiss",type:Boolean})],br.prototype,"lightDismiss",2);Se([er("open",{waitUntilFirstUpdate:!0})],br.prototype,"handleOpenChange",1);br=Se([_t("wa-dialog")],br);document.addEventListener("click",t=>{const e=t.target.closest("[data-dialog]");if(e instanceof Element){const[r,n]=Pf(e.getAttribute("data-dialog")||"");if(r==="open"&&n?.length){const a=e.getRootNode().getElementById(n);a?.localName==="wa-dialog"?a.open=!0:console.warn(`A dialog with an ID of "${n}" could not be found in this document.`)}}});document.addEventListener("pointerdown",()=>{});var Lf=()=>({checkValidity(t){const e=t.input,r={message:"",isValid:!0,invalidKeys:[]};if(!e)return r;let n=!0;if("checkValidity"in e&&(n=e.checkValidity()),n)return r;if(r.isValid=!1,"validationMessage"in e&&(r.message=e.validationMessage),!("validity"in e))return r.invalidKeys.push("customError"),r;for(const s in e.validity){if(s==="valid")continue;const a=s;e.validity[a]&&r.invalidKeys.push(a)}return r}});var Ou=class extends Event{constructor(){super("wa-invalid",{bubbles:!0,cancelable:!1,composed:!0})}},Df=()=>({observedAttributes:["custom-error"],checkValidity(t){const e={message:"",isValid:!0,invalidKeys:[]};return t.customError&&(e.message=t.customError,e.isValid=!1,e.invalidKeys=["customError"]),e}}),Er=class extends Zt{constructor(){super(),this.name=null,this.disabled=!1,this.required=!1,this.assumeInteractionOn=["input"],this.validators=[],this.valueHasChanged=!1,this.hasInteracted=!1,this.customError=null,this.emittedEvents=[],this.emitInvalid=t=>{t.target===this&&(this.hasInteracted=!0,this.dispatchEvent(new Ou))},this.handleInteraction=t=>{const e=this.emittedEvents;e.includes(t.type)||e.push(t.type),e.length===this.assumeInteractionOn?.length&&(this.hasInteracted=!0)},this.addEventListener("invalid",this.emitInvalid)}static get validators(){return[Df()]}static get observedAttributes(){const t=new Set(super.observedAttributes||[]);for(const e of this.validators)if(e.observedAttributes)for(const r of e.observedAttributes)t.add(r);return[...t]}connectedCallback(){super.connectedCallback(),this.updateValidity(),this.assumeInteractionOn.forEach(t=>{this.addEventListener(t,this.handleInteraction)})}firstUpdated(...t){super.firstUpdated(...t),this.updateValidity()}willUpdate(t){if(t.has("customError")&&(this.customError||(this.customError=null),this.setCustomValidity(this.customError||"")),t.has("value")||t.has("disabled")){const e=this.value;if(Array.isArray(e)){if(this.name){const r=new FormData;for(const n of e)r.append(this.name,n);this.setValue(r,r)}}else this.setValue(e,e)}t.has("disabled")&&(this.customStates.set("disabled",this.disabled),(this.hasAttribute("disabled")||!this.matches(":disabled"))&&this.toggleAttribute("disabled",this.disabled)),this.updateValidity(),super.willUpdate(t)}get labels(){return this.internals.labels}getForm(){return this.internals.form}get validity(){return this.internals.validity}get willValidate(){return this.internals.willValidate}get validationMessage(){return this.internals.validationMessage}checkValidity(){return this.updateValidity(),this.internals.checkValidity()}reportValidity(){return this.updateValidity(),this.hasInteracted=!0,this.internals.reportValidity()}get validationTarget(){return this.input||void 0}setValidity(...t){const e=t[0],r=t[1];let n=t[2];n||(n=this.validationTarget),this.internals.setValidity(e,r,n||void 0),this.requestUpdate("validity"),this.setCustomStates()}setCustomStates(){const t=!!this.required,e=this.internals.validity.valid,r=this.hasInteracted;this.customStates.set("required",t),this.customStates.set("optional",!t),this.customStates.set("invalid",!e),this.customStates.set("valid",e),this.customStates.set("user-invalid",!e&&r),this.customStates.set("user-valid",e&&r)}setCustomValidity(t){if(!t){this.customError=null,this.setValidity({});return}this.customError=t,this.setValidity({customError:!0},t,this.validationTarget)}formResetCallback(){this.resetValidity(),this.hasInteracted=!1,this.valueHasChanged=!1,this.emittedEvents=[],this.updateValidity()}formDisabledCallback(t){this.disabled=t,this.updateValidity()}formStateRestoreCallback(t,e){this.value=t,e==="restore"&&this.resetValidity(),this.updateValidity()}setValue(...t){const[e,r]=t;this.internals.setFormValue(e,r)}get allValidators(){const t=this.constructor.validators||[],e=this.validators||[];return[...t,...e]}resetValidity(){this.setCustomValidity(""),this.setValidity({})}updateValidity(){if(this.disabled||this.hasAttribute("disabled")||!this.willValidate){this.resetValidity();return}const t=this.allValidators;if(!t?.length)return;const e={customError:!!this.customError},r=this.validationTarget||this.input||void 0;let n="";for(const s of t){const{isValid:a,message:l,invalidKeys:c}=s.checkValidity(this);a||(n||(n=l),c?.length>=0&&c.forEach(g=>e[g]=!0))}n||(n=this.validationMessage),this.setValidity(e,n,r)}};Er.formAssociated=!0;Se([Te({reflect:!0})],Er.prototype,"name",2);Se([Te({type:Boolean})],Er.prototype,"disabled",2);Se([Te({state:!0,attribute:!1})],Er.prototype,"valueHasChanged",2);Se([Te({state:!0,attribute:!1})],Er.prototype,"hasInteracted",2);Se([Te({attribute:"custom-error",reflect:!0})],Er.prototype,"customError",2);Se([Te({attribute:!1,state:!0,type:Object})],Er.prototype,"validity",1);var Of=`@layer wa-utilities {
  :where(:root),
  .wa-neutral,
  :host([variant='neutral']) {
    --wa-color-fill-loud: var(--wa-color-neutral-fill-loud);
    --wa-color-fill-normal: var(--wa-color-neutral-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-neutral-fill-quiet);
    --wa-color-border-loud: var(--wa-color-neutral-border-loud);
    --wa-color-border-normal: var(--wa-color-neutral-border-normal);
    --wa-color-border-quiet: var(--wa-color-neutral-border-quiet);
    --wa-color-on-loud: var(--wa-color-neutral-on-loud);
    --wa-color-on-normal: var(--wa-color-neutral-on-normal);
    --wa-color-on-quiet: var(--wa-color-neutral-on-quiet);
  }

  .wa-brand,
  :host([variant='brand']) {
    --wa-color-fill-loud: var(--wa-color-brand-fill-loud);
    --wa-color-fill-normal: var(--wa-color-brand-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-brand-fill-quiet);
    --wa-color-border-loud: var(--wa-color-brand-border-loud);
    --wa-color-border-normal: var(--wa-color-brand-border-normal);
    --wa-color-border-quiet: var(--wa-color-brand-border-quiet);
    --wa-color-on-loud: var(--wa-color-brand-on-loud);
    --wa-color-on-normal: var(--wa-color-brand-on-normal);
    --wa-color-on-quiet: var(--wa-color-brand-on-quiet);
  }

  .wa-success,
  :host([variant='success']) {
    --wa-color-fill-loud: var(--wa-color-success-fill-loud);
    --wa-color-fill-normal: var(--wa-color-success-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-success-fill-quiet);
    --wa-color-border-loud: var(--wa-color-success-border-loud);
    --wa-color-border-normal: var(--wa-color-success-border-normal);
    --wa-color-border-quiet: var(--wa-color-success-border-quiet);
    --wa-color-on-loud: var(--wa-color-success-on-loud);
    --wa-color-on-normal: var(--wa-color-success-on-normal);
    --wa-color-on-quiet: var(--wa-color-success-on-quiet);
  }

  .wa-warning,
  :host([variant='warning']) {
    --wa-color-fill-loud: var(--wa-color-warning-fill-loud);
    --wa-color-fill-normal: var(--wa-color-warning-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-warning-fill-quiet);
    --wa-color-border-loud: var(--wa-color-warning-border-loud);
    --wa-color-border-normal: var(--wa-color-warning-border-normal);
    --wa-color-border-quiet: var(--wa-color-warning-border-quiet);
    --wa-color-on-loud: var(--wa-color-warning-on-loud);
    --wa-color-on-normal: var(--wa-color-warning-on-normal);
    --wa-color-on-quiet: var(--wa-color-warning-on-quiet);
  }

  .wa-danger,
  :host([variant='danger']) {
    --wa-color-fill-loud: var(--wa-color-danger-fill-loud);
    --wa-color-fill-normal: var(--wa-color-danger-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-danger-fill-quiet);
    --wa-color-border-loud: var(--wa-color-danger-border-loud);
    --wa-color-border-normal: var(--wa-color-danger-border-normal);
    --wa-color-border-quiet: var(--wa-color-danger-border-quiet);
    --wa-color-on-loud: var(--wa-color-danger-on-loud);
    --wa-color-on-normal: var(--wa-color-danger-on-normal);
    --wa-color-on-quiet: var(--wa-color-danger-on-quiet);
  }
}
`;var Uf=`@layer wa-utilities {
  :host([size='small']),
  .wa-size-s {
    font-size: var(--wa-font-size-s);
  }

  :host([size='medium']),
  .wa-size-m {
    font-size: var(--wa-font-size-m);
  }

  :host([size='large']),
  .wa-size-l {
    font-size: var(--wa-font-size-l);
  }
}
`;const Uu=Symbol.for(""),Bf=t=>{if(t?.r===Uu)return t?._$litStatic$},Ua=(t,...e)=>({_$litStatic$:e.reduce(((r,n,s)=>r+(a=>{if(a._$litStatic$!==void 0)return a._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${a}. Use 'unsafeStatic' to pass non-literal values, but
            take care to ensure page security.`)})(n)+t[s+1]),t[0]),r:Uu}),Ba=new Map,Mf=t=>(e,...r)=>{const n=r.length;let s,a;const l=[],c=[];let g,h=0,p=!1;for(;h<n;){for(g=e[h];h<n&&(a=r[h],(s=Bf(a))!==void 0);)g+=s+e[++h],p=!0;h!==n&&c.push(a),l.push(g),h++}if(h===n&&l.push(e[n]),p){const f=l.join("$$lit$$");(e=Ba.get(f))===void 0&&(l.raw=l,Ba.set(f,e=l)),r=c}return t(e,...r)},bo=Mf(Qe);var jf=`@layer wa-component {
  :host {
    display: inline-block;

    /* Workaround because Chrome doesn't like :host(:has()) below
     * https://issues.chromium.org/issues/40062355
     * Firefox doesn't like this nested rule, so both are needed */
    &:has(wa-badge) {
      position: relative;
    }
  }

  /* Apply relative positioning only when needed to position wa-badge
   * This avoids creating a new stacking context for every button */
  :host(:has(wa-badge)) {
    position: relative;
  }
}

.button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  user-select: none;
  -webkit-user-select: none;
  white-space: nowrap;
  vertical-align: middle;
  transition-property: background, border, box-shadow, color;
  transition-duration: var(--wa-transition-fast);
  transition-timing-function: var(--wa-transition-easing);
  cursor: pointer;
  padding: 0 var(--wa-form-control-padding-inline);
  font-family: inherit;
  font-size: inherit;
  font-weight: var(--wa-font-weight-action);
  line-height: calc(var(--wa-form-control-height) - var(--border-width) * 2);
  height: var(--wa-form-control-height);
  width: 100%;

  background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
  border-color: transparent;
  color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
  border-radius: var(--wa-form-control-border-radius);
  border-style: var(--wa-border-style);
  border-width: var(--wa-border-width-s);
}

/* Appearance modifiers */
:host([appearance='plain']) {
  .button {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: transparent;
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='outlined']) {
  .button {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: transparent;
    border-color: var(--wa-color-border-loud, var(--wa-color-neutral-border-loud));
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='filled']) {
  .button {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='filled-outlined']) {
  .button {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
    border-color: var(--wa-color-border-normal, var(--wa-color-neutral-border-normal));
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='accent']) {
  .button {
    color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
    background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
      var(--wa-color-mix-active)
    );
  }
}

/* Focus states */
.button:focus {
  outline: none;
}

.button:focus-visible {
  outline: var(--wa-focus-ring);
  outline-offset: var(--wa-focus-ring-offset);
}

/* Disabled state */
.button.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* When disabled, prevent mouse events from bubbling up from children */
.button.disabled * {
  pointer-events: none;
}

/* Keep it last so Safari doesn't stop parsing this block */
.button::-moz-focus-inner {
  border: 0;
}

/* Icon buttons */
.button.is-icon-button {
  outline-offset: 2px;
  width: var(--wa-form-control-height);
  aspect-ratio: 1;
}

.button.is-icon-button:has(wa-icon) {
  width: auto;
}

/* Pill modifier */
:host([pill]) .button {
  border-radius: var(--wa-border-radius-pill);
}

/*
 * Label
 */

.start,
.end {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  pointer-events: none;
}

.label {
  display: inline-block;
}

.is-icon-button .label {
  display: flex;
}

.label::slotted(wa-icon) {
  align-self: center;
}

/*
 * Caret modifier
 */

wa-icon[part='caret'] {
  display: flex;
  align-self: center;
  align-items: center;

  &::part(svg) {
    width: 0.875em;
    height: 0.875em;
  }

  .button:has(&) .end {
    display: none;
  }
}

/*
 * Loading modifier
 */

.loading {
  position: relative;
  cursor: wait;

  .start,
  .label,
  .end,
  .caret {
    visibility: hidden;
  }

  wa-spinner {
    --indicator-color: currentColor;
    --track-color: color-mix(in oklab, currentColor, transparent 90%);

    position: absolute;
    font-size: 1em;
    height: 1em;
    width: 1em;
    top: calc(50% - 0.5em);
    left: calc(50% - 0.5em);
  }
}

/*
 * Badges
 */

.button ::slotted(wa-badge) {
  border-color: var(--wa-color-surface-default);
  position: absolute;
  inset-block-start: 0;
  inset-inline-end: 0;
  translate: 50% -50%;
  pointer-events: none;
}

:host(:dir(rtl)) ::slotted(wa-badge) {
  translate: -50% -50%;
}

/*
* Button spacing
*/

slot[name='start']::slotted(*) {
  margin-inline-end: 0.75em;
}

slot[name='end']::slotted(*),
.button:not(.visually-hidden-label) [part='caret'] {
  margin-inline-start: 0.75em;
}

/*
 * Button group border radius modifications
 */

/* Remove border radius from all grouped buttons by default */
:host(.wa-button-group__button) .button {
  border-radius: 0;
}

/* Horizontal orientation */
:host(.wa-button-group__horizontal.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-form-control-border-radius);
  border-end-start-radius: var(--wa-form-control-border-radius);
}

:host(.wa-button-group__horizontal.wa-button-group__button-last) .button {
  border-start-end-radius: var(--wa-form-control-border-radius);
  border-end-end-radius: var(--wa-form-control-border-radius);
}

/* Vertical orientation */
:host(.wa-button-group__vertical) {
  flex: 1 1 auto;
}

:host(.wa-button-group__vertical) .button {
  width: 100%;
  justify-content: start;
}

:host(.wa-button-group__vertical.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-form-control-border-radius);
  border-start-end-radius: var(--wa-form-control-border-radius);
}

:host(.wa-button-group__vertical.wa-button-group__button-last) .button {
  border-end-start-radius: var(--wa-form-control-border-radius);
  border-end-end-radius: var(--wa-form-control-border-radius);
}

/* Handle pill modifier for button groups */
:host([pill].wa-button-group__horizontal.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-border-radius-pill);
  border-end-start-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__horizontal.wa-button-group__button-last) .button {
  border-start-end-radius: var(--wa-border-radius-pill);
  border-end-end-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__vertical.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-border-radius-pill);
  border-start-end-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__vertical.wa-button-group__button-last) .button {
  border-end-start-radius: var(--wa-border-radius-pill);
  border-end-end-radius: var(--wa-border-radius-pill);
}
`,rt=class extends Er{constructor(){super(...arguments),this.assumeInteractionOn=["click"],this.hasSlotController=new Pu(this,"[default]","start","end"),this.localize=new di(this),this.invalid=!1,this.isIconButton=!1,this.title="",this.variant="neutral",this.appearance="accent",this.size="medium",this.withCaret=!1,this.disabled=!1,this.loading=!1,this.pill=!1,this.type="button",this.form=null}static get validators(){return[...super.validators,Lf()]}constructLightDOMButton(){const t=document.createElement("button");return t.type=this.type,t.style.position="absolute",t.style.width="0",t.style.height="0",t.style.clipPath="inset(50%)",t.style.overflow="hidden",t.style.whiteSpace="nowrap",this.name&&(t.name=this.name),t.value=this.value||"",["form","formaction","formenctype","formmethod","formnovalidate","formtarget"].forEach(e=>{this.hasAttribute(e)&&t.setAttribute(e,this.getAttribute(e))}),t}handleClick(){if(!this.getForm())return;const e=this.constructLightDOMButton();this.parentElement?.append(e),e.click(),e.remove()}handleInvalid(){this.dispatchEvent(new Ou)}handleLabelSlotChange(){const t=this.labelSlot.assignedNodes({flatten:!0});let e=!1,r=!1,n=!1,s=!1;[...t].forEach(a=>{if(a.nodeType===Node.ELEMENT_NODE){const l=a;l.localName==="wa-icon"?(r=!0,e||(e=l.label!==void 0)):s=!0}else a.nodeType===Node.TEXT_NODE&&(a.textContent?.trim()||"").length>0&&(n=!0)}),this.isIconButton=r&&!n&&!s,this.isIconButton&&!e&&console.warn('Icon buttons must have a label for screen readers. Add <wa-icon label="..."> to remove this warning.',this)}isButton(){return!this.href}isLink(){return!!this.href}handleDisabledChange(){this.updateValidity()}setValue(...t){}click(){this.button.click()}focus(t){this.button.focus(t)}blur(){this.button.blur()}render(){const t=this.isLink(),e=t?Ua`a`:Ua`button`;return bo`
      <${e}
        part="base"
        class=${Xr({button:!0,caret:this.withCaret,disabled:this.disabled,loading:this.loading,rtl:this.localize.dir()==="rtl","has-label":this.hasSlotController.test("[default]"),"has-start":this.hasSlotController.test("start"),"has-end":this.hasSlotController.test("end"),"is-icon-button":this.isIconButton})}
        ?disabled=${mt(t?void 0:this.disabled)}
        type=${mt(t?void 0:this.type)}
        title=${this.title}
        name=${mt(t?void 0:this.name)}
        value=${mt(t?void 0:this.value)}
        href=${mt(t?this.href:void 0)}
        target=${mt(t?this.target:void 0)}
        download=${mt(t?this.download:void 0)}
        rel=${mt(t&&this.rel?this.rel:void 0)}
        role=${mt(t?void 0:"button")}
        aria-disabled=${this.disabled?"true":"false"}
        tabindex=${this.disabled?"-1":"0"}
        @invalid=${this.isButton()?this.handleInvalid:null}
        @click=${this.handleClick}
      >
        <slot name="start" part="start" class="start"></slot>
        <slot part="label" class="label" @slotchange=${this.handleLabelSlotChange}></slot>
        <slot name="end" part="end" class="end"></slot>
        ${this.withCaret?bo`
                <wa-icon part="caret" class="caret" library="system" name="chevron-down" variant="solid"></wa-icon>
              `:""}
        ${this.loading?bo`<wa-spinner part="spinner"></wa-spinner>`:""}
      </${e}>
    `}};rt.shadowRootOptions={...Er.shadowRootOptions,delegatesFocus:!0};rt.css=[jf,Of,Uf];Se([Ut(".button")],rt.prototype,"button",2);Se([Ut("slot:not([name])")],rt.prototype,"labelSlot",2);Se([Ot()],rt.prototype,"invalid",2);Se([Ot()],rt.prototype,"isIconButton",2);Se([Te()],rt.prototype,"title",2);Se([Te({reflect:!0})],rt.prototype,"variant",2);Se([Te({reflect:!0})],rt.prototype,"appearance",2);Se([Te({reflect:!0})],rt.prototype,"size",2);Se([Te({attribute:"with-caret",type:Boolean,reflect:!0})],rt.prototype,"withCaret",2);Se([Te({type:Boolean})],rt.prototype,"disabled",2);Se([Te({type:Boolean,reflect:!0})],rt.prototype,"loading",2);Se([Te({type:Boolean,reflect:!0})],rt.prototype,"pill",2);Se([Te()],rt.prototype,"type",2);Se([Te({reflect:!0})],rt.prototype,"name",2);Se([Te({reflect:!0})],rt.prototype,"value",2);Se([Te({reflect:!0})],rt.prototype,"href",2);Se([Te()],rt.prototype,"target",2);Se([Te()],rt.prototype,"rel",2);Se([Te()],rt.prototype,"download",2);Se([Te({reflect:!0})],rt.prototype,"form",2);Se([Te({attribute:"formaction"})],rt.prototype,"formAction",2);Se([Te({attribute:"formenctype"})],rt.prototype,"formEnctype",2);Se([Te({attribute:"formmethod"})],rt.prototype,"formMethod",2);Se([Te({attribute:"formnovalidate",type:Boolean})],rt.prototype,"formNoValidate",2);Se([Te({attribute:"formtarget"})],rt.prototype,"formTarget",2);Se([er("disabled",{waitUntilFirstUpdate:!0})],rt.prototype,"handleDisabledChange",1);rt=Se([_t("wa-button")],rt);var $f=class extends Event{constructor(){super("wa-load",{bubbles:!0,cancelable:!1,composed:!0})}};var ps="";function Hf(t){ps=t}function Vf(){if(!ps){const t=document.querySelector("[data-fa-kit-code]");t&&Hf(t.getAttribute("data-fa-kit-code")||"")}return ps}var yr="7.0.1";function Kf(t,e,r){const n=Vf(),s=n.length>0;let a="solid";return e==="notdog"?(r==="solid"&&(a="solid"),r==="duo-solid"&&(a="duo-solid"),`https://ka-p.fontawesome.com/releases/v${yr}/svgs/notdog-${a}/${t}.svg?token=${encodeURIComponent(n)}`):e==="chisel"?`https://ka-p.fontawesome.com/releases/v${yr}/svgs/chisel-regular/${t}.svg?token=${encodeURIComponent(n)}`:e==="etch"?`https://ka-p.fontawesome.com/releases/v${yr}/svgs/etch-solid/${t}.svg?token=${encodeURIComponent(n)}`:e==="jelly"?(r==="regular"&&(a="regular"),r==="duo-regular"&&(a="duo-regular"),r==="fill-regular"&&(a="fill-regular"),`https://ka-p.fontawesome.com/releases/v${yr}/svgs/jelly-${a}/${t}.svg?token=${encodeURIComponent(n)}`):e==="slab"?((r==="solid"||r==="regular")&&(a="regular"),r==="press-regular"&&(a="press-regular"),`https://ka-p.fontawesome.com/releases/v${yr}/svgs/slab-${a}/${t}.svg?token=${encodeURIComponent(n)}`):e==="thumbprint"?`https://ka-p.fontawesome.com/releases/v${yr}/svgs/thumbprint-light/${t}.svg?token=${encodeURIComponent(n)}`:e==="whiteboard"?`https://ka-p.fontawesome.com/releases/v${yr}/svgs/whiteboard-semibold/${t}.svg?token=${encodeURIComponent(n)}`:(e==="classic"&&(r==="thin"&&(a="thin"),r==="light"&&(a="light"),r==="regular"&&(a="regular"),r==="solid"&&(a="solid")),e==="sharp"&&(r==="thin"&&(a="sharp-thin"),r==="light"&&(a="sharp-light"),r==="regular"&&(a="sharp-regular"),r==="solid"&&(a="sharp-solid")),e==="duotone"&&(r==="thin"&&(a="duotone-thin"),r==="light"&&(a="duotone-light"),r==="regular"&&(a="duotone-regular"),r==="solid"&&(a="duotone")),e==="sharp-duotone"&&(r==="thin"&&(a="sharp-duotone-thin"),r==="light"&&(a="sharp-duotone-light"),r==="regular"&&(a="sharp-duotone-regular"),r==="solid"&&(a="sharp-duotone-solid")),e==="brands"&&(a="brands"),s?`https://ka-p.fontawesome.com/releases/v${yr}/svgs/${a}/${t}.svg?token=${encodeURIComponent(n)}`:`https://ka-f.fontawesome.com/releases/v${yr}/svgs/${a}/${t}.svg`)}var qf={name:"default",resolver:(t,e="classic",r="solid")=>Kf(t,e,r),mutator:(t,e)=>{if(e?.family&&!t.hasAttribute("data-duotone-initialized")){const{family:r,variant:n}=e;if(r==="duotone"||r==="sharp-duotone"||r==="notdog"&&n==="duo-solid"||r==="jelly"&&n==="duo-regular"||r==="thumbprint"){const s=[...t.querySelectorAll("path")],a=s.find(c=>!c.hasAttribute("opacity")),l=s.find(c=>c.hasAttribute("opacity"));if(!a||!l)return;if(a.setAttribute("data-duotone-primary",""),l.setAttribute("data-duotone-secondary",""),e.swapOpacity&&a&&l){const c=l.getAttribute("opacity")||"0.4";a.style.setProperty("--path-opacity",c),l.style.setProperty("--path-opacity","1")}t.setAttribute("data-duotone-initialized","")}}}},Wf=qf;function zf(t){return`data:image/svg+xml,${encodeURIComponent(t)}`}var _o={solid:{check:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M434.8 70.1c14.3 10.4 17.5 30.4 7.1 44.7l-256 352c-5.5 7.6-14 12.3-23.4 13.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l101.5 101.5 234-321.7c10.4-14.3 30.4-17.5 44.7-7.1z"/></svg>',"chevron-down":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M201.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 338.7 54.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>',"chevron-left":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/></svg>',"chevron-right":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M311.1 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L243.2 256 73.9 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/></svg>',circle:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0z"/></svg>',eyedropper:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M341.6 29.2l-101.6 101.6-9.4-9.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-9.4-9.4 101.6-101.6c39-39 39-102.2 0-141.1s-102.2-39-141.1 0zM55.4 323.3c-15 15-23.4 35.4-23.4 56.6l0 42.4-26.6 39.9c-8.5 12.7-6.8 29.6 4 40.4s27.7 12.5 40.4 4l39.9-26.6 42.4 0c21.2 0 41.6-8.4 56.6-23.4l109.4-109.4-45.3-45.3-109.4 109.4c-3 3-7.1 4.7-11.3 4.7l-36.1 0 0-36.1c0-4.2 1.7-8.3 4.7-11.3l109.4-109.4-45.3-45.3-109.4 109.4z"/></svg>',"grip-vertical":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M128 40c0-22.1-17.9-40-40-40L40 0C17.9 0 0 17.9 0 40L0 88c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zm0 192c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM0 424l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 40c0-22.1-17.9-40-40-40L232 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM192 232l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 424c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48z"/></svg>',indeterminate:'<svg part="indeterminate-icon" class="icon" viewBox="0 0 16 16"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"><g stroke="currentColor" stroke-width="2"><g transform="translate(2.285714 6.857143)"><path d="M10.2857143,1.14285714 L1.14285714,1.14285714"/></g></g></g></svg>',minus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32z"/></svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M48 32C21.5 32 0 53.5 0 80L0 432c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48L48 32zm224 0c-26.5 0-48 21.5-48 48l0 352c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48l-64 0z"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M91.2 36.9c-12.4-6.8-27.4-6.5-39.6 .7S32 57.9 32 72l0 368c0 14.1 7.5 27.2 19.6 34.4s27.2 7.5 39.6 .7l336-184c12.8-7 20.8-20.5 20.8-35.1s-8-28.1-20.8-35.1l-336-184z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M309.5-18.9c-4.1-8-12.4-13.1-21.4-13.1s-17.3 5.1-21.4 13.1L193.1 125.3 33.2 150.7c-8.9 1.4-16.3 7.7-19.1 16.3s-.5 18 5.8 24.4l114.4 114.5-25.2 159.9c-1.4 8.9 2.3 17.9 9.6 23.2s16.9 6.1 25 2L288.1 417.6 432.4 491c8 4.1 17.7 3.3 25-2s11-14.2 9.6-23.2L441.7 305.9 556.1 191.4c6.4-6.4 8.6-15.8 5.8-24.4s-10.1-14.9-19.1-16.3L383 125.3 309.5-18.9z"/></svg>',user:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M224 248a120 120 0 1 0 0-240 120 120 0 1 0 0 240zm-29.7 56C95.8 304 16 383.8 16 482.3 16 498.7 29.3 512 45.7 512l356.6 0c16.4 0 29.7-13.3 29.7-29.7 0-98.5-79.8-178.3-178.3-178.3l-59.4 0z"/></svg>',xmark:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M55.1 73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L147.2 256 9.9 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192.5 301.3 329.9 438.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.8 256 375.1 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192.5 210.7 55.1 73.4z"/></svg>'},regular:{"circle-question":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M464 256a208 208 0 1 0 -416 0 208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0zm256-80c-17.7 0-32 14.3-32 32 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-44.2 35.8-80 80-80s80 35.8 80 80c0 47.2-36 67.2-56 74.5l0 3.8c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-8.1c0-20.5 14.8-35.2 30.1-40.2 6.4-2.1 13.2-5.5 18.2-10.3 4.3-4.2 7.7-10 7.7-19.6 0-17.7-14.3-32-32-32zM224 368a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/></svg>',"circle-xmark":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464a256 256 0 1 0 0-512 256 256 0 1 0 0 512zM167 167c-9.4 9.4-9.4 24.6 0 33.9l55 55-55 55c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l55-55 55 55c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-55-55 55-55c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-55 55-55-55c-9.4-9.4-24.6-9.4-33.9 0z"/></svg>',copy:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M384 336l-192 0c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l133.5 0c4.2 0 8.3 1.7 11.3 4.7l58.5 58.5c3 3 4.7 7.1 4.7 11.3L400 320c0 8.8-7.2 16-16 16zM192 384l192 0c35.3 0 64-28.7 64-64l0-197.5c0-17-6.7-33.3-18.7-45.3L370.7 18.7C358.7 6.7 342.5 0 325.5 0L192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-48 0 0 16c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l16 0 0-48-16 0z"/></svg>',eye:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288 80C222.8 80 169.2 109.6 128.1 147.7 89.6 183.5 63 226 49.4 256 63 286 89.6 328.5 128.1 364.3 169.2 402.4 222.8 432 288 432s118.8-29.6 159.9-67.7C486.4 328.5 513 286 526.6 256 513 226 486.4 183.5 447.9 147.7 406.8 109.6 353.2 80 288 80zM95.4 112.6C142.5 68.8 207.2 32 288 32s145.5 36.8 192.6 80.6c46.8 43.5 78.1 95.4 93 131.1 3.3 7.9 3.3 16.7 0 24.6-14.9 35.7-46.2 87.7-93 131.1-47.1 43.7-111.8 80.6-192.6 80.6S142.5 443.2 95.4 399.4c-46.8-43.5-78.1-95.4-93-131.1-3.3-7.9-3.3-16.7 0-24.6 14.9-35.7 46.2-87.7 93-131.1zM288 336c44.2 0 80-35.8 80-80 0-29.6-16.1-55.5-40-69.3-1.4 59.7-49.6 107.9-109.3 109.3 13.8 23.9 39.7 40 69.3 40zm-79.6-88.4c2.5 .3 5 .4 7.6 .4 35.3 0 64-28.7 64-64 0-2.6-.2-5.1-.4-7.6-37.4 3.9-67.2 33.7-71.1 71.1zm45.6-115c10.8-3 22.2-4.5 33.9-4.5 8.8 0 17.5 .9 25.8 2.6 .3 .1 .5 .1 .8 .2 57.9 12.2 101.4 63.7 101.4 125.2 0 70.7-57.3 128-128 128-61.6 0-113-43.5-125.2-101.4-1.8-8.6-2.8-17.5-2.8-26.6 0-11 1.4-21.8 4-32 .2-.7 .3-1.3 .5-1.9 11.9-43.4 46.1-77.6 89.5-89.5z"/></svg>',"eye-slash":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M41-24.9c-9.4-9.4-24.6-9.4-33.9 0S-2.3-.3 7 9.1l528 528c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-96.4-96.4c2.7-2.4 5.4-4.8 8-7.2 46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7 0-24.6-14.9-35.7-46.2-87.7-93-131.1-47.1-43.7-111.8-80.6-192.6-80.6-56.8 0-105.6 18.2-146 44.2L41-24.9zM176.9 111.1c32.1-18.9 69.2-31.1 111.1-31.1 65.2 0 118.8 29.6 159.9 67.7 38.5 35.7 65.1 78.3 78.6 108.3-13.6 30-40.2 72.5-78.6 108.3-3.1 2.8-6.2 5.6-9.4 8.4L393.8 328c14-20.5 22.2-45.3 22.2-72 0-70.7-57.3-128-128-128-26.7 0-51.5 8.2-72 22.2l-39.1-39.1zm182 182l-108-108c11.1-5.8 23.7-9.1 37.1-9.1 44.2 0 80 35.8 80 80 0 13.4-3.3 26-9.1 37.1zM103.4 173.2l-34-34c-32.6 36.8-55 75.8-66.9 104.5-3.3 7.9-3.3 16.7 0 24.6 14.9 35.7 46.2 87.7 93 131.1 47.1 43.7 111.8 80.6 192.6 80.6 37.3 0 71.2-7.9 101.5-20.6L352.2 422c-20 6.4-41.4 10-64.2 10-65.2 0-118.8-29.6-159.9-67.7-38.5-35.7-65.1-78.3-78.6-108.3 10.4-23.1 28.6-53.6 54-82.8z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288.1-32c9 0 17.3 5.1 21.4 13.1L383 125.3 542.9 150.7c8.9 1.4 16.3 7.7 19.1 16.3s.5 18-5.8 24.4L441.7 305.9 467 465.8c1.4 8.9-2.3 17.9-9.6 23.2s-17 6.1-25 2L288.1 417.6 143.8 491c-8 4.1-17.7 3.3-25-2s-11-14.2-9.6-23.2L134.4 305.9 20 191.4c-6.4-6.4-8.6-15.8-5.8-24.4s10.1-14.9 19.1-16.3l159.9-25.4 73.6-144.2c4.1-8 12.4-13.1 21.4-13.1zm0 76.8L230.3 158c-3.5 6.8-10 11.6-17.6 12.8l-125.5 20 89.8 89.9c5.4 5.4 7.9 13.1 6.7 20.7l-19.8 125.5 113.3-57.6c6.8-3.5 14.9-3.5 21.8 0l113.3 57.6-19.8-125.5c-1.2-7.6 1.3-15.3 6.7-20.7l89.8-89.9-125.5-20c-7.6-1.2-14.1-6-17.6-12.8L288.1 44.8z"/></svg>'}},Jf={name:"system",resolver:(t,e="classic",r="solid")=>{let s=_o[r][t]??_o.regular[t]??_o.regular["circle-question"];return s?zf(s):""}},Gf=Jf;var Yf="classic",Qf=[Wf,Gf],gs=[];function Xf(t){gs.push(t)}function Zf(t){gs=gs.filter(e=>e!==t)}function So(t){return Qf.find(e=>e.name===t)}function ep(){return Yf}const tp=(t,e)=>t?._$litType$!==void 0;var ii=class extends Event{constructor(){super("wa-error",{bubbles:!0,cancelable:!1,composed:!0})}},rp=`:host {
  --primary-color: currentColor;
  --primary-opacity: 1;
  --secondary-color: currentColor;
  --secondary-opacity: 0.4;

  box-sizing: content-box;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  vertical-align: -0.125em;
}

/* Standard */
:host(:not([auto-width])) {
  width: 1.25em;
  height: 1em;
}

/* Auto-width */
:host([auto-width]) {
  width: auto;
  height: 1em;
}

svg {
  height: 1em;
  fill: currentColor;
  overflow: visible;

  /* Duotone colors with path-specific opacity fallback */
  path[data-duotone-primary] {
    color: var(--primary-color);
    opacity: var(--path-opacity, var(--primary-opacity));
  }

  path[data-duotone-secondary] {
    color: var(--secondary-color);
    opacity: var(--path-opacity, var(--secondary-opacity));
  }
}
`,Kn=Symbol(),bi=Symbol(),Eo,xo=new Map,zt=class extends Zt{constructor(){super(...arguments),this.svg=null,this.autoWidth=!1,this.swapOpacity=!1,this.label="",this.library="default",this.resolveIcon=async(t,e)=>{let r;if(e?.spriteSheet){this.hasUpdated||await this.updateComplete,this.svg=Qe`<svg part="svg">
        <use part="use" href="${t}"></use>
      </svg>`,await this.updateComplete;const n=this.shadowRoot.querySelector("[part='svg']");return typeof e.mutator=="function"&&e.mutator(n,this),this.svg}try{if(r=await fetch(t,{mode:"cors"}),!r.ok)return r.status===410?Kn:bi}catch{return bi}try{const n=document.createElement("div");n.innerHTML=await r.text();const s=n.firstElementChild;if(s?.tagName?.toLowerCase()!=="svg")return Kn;Eo||(Eo=new DOMParser);const l=Eo.parseFromString(s.outerHTML,"text/html").body.querySelector("svg");return l?(l.part.add("svg"),document.adoptNode(l)):Kn}catch{return Kn}}}connectedCallback(){super.connectedCallback(),Xf(this)}firstUpdated(t){super.firstUpdated(t),this.setIcon()}disconnectedCallback(){super.disconnectedCallback(),Zf(this)}getIconSource(){const t=So(this.library),e=this.family||ep();return this.name&&t?{url:t.resolver(this.name,e,this.variant,this.autoWidth),fromLibrary:!0}:{url:this.src,fromLibrary:!1}}handleLabelChange(){typeof this.label=="string"&&this.label.length>0?(this.setAttribute("role","img"),this.setAttribute("aria-label",this.label),this.removeAttribute("aria-hidden")):(this.removeAttribute("role"),this.removeAttribute("aria-label"),this.setAttribute("aria-hidden","true"))}async setIcon(){const{url:t,fromLibrary:e}=this.getIconSource(),r=e?So(this.library):void 0;if(!t){this.svg=null;return}let n=xo.get(t);n||(n=this.resolveIcon(t,r),xo.set(t,n));const s=await n;if(s===bi&&xo.delete(t),t===this.getIconSource().url){if(tp(s)){this.svg=s;return}switch(s){case bi:case Kn:this.svg=null,this.dispatchEvent(new ii);break;default:this.svg=s.cloneNode(!0),r?.mutator?.(this.svg,this),this.dispatchEvent(new $f)}}}updated(t){super.updated(t);const e=So(this.library),r=this.shadowRoot?.querySelector("svg");r&&e?.mutator?.(r,this)}render(){return this.hasUpdated?this.svg:Qe`<svg part="svg" fill="currentColor" width="16" height="16"></svg>`}};zt.css=rp;Se([Ot()],zt.prototype,"svg",2);Se([Te({reflect:!0})],zt.prototype,"name",2);Se([Te({reflect:!0})],zt.prototype,"family",2);Se([Te({reflect:!0})],zt.prototype,"variant",2);Se([Te({attribute:"auto-width",type:Boolean,reflect:!0})],zt.prototype,"autoWidth",2);Se([Te({attribute:"swap-opacity",type:Boolean,reflect:!0})],zt.prototype,"swapOpacity",2);Se([Te()],zt.prototype,"src",2);Se([Te()],zt.prototype,"label",2);Se([Te({reflect:!0})],zt.prototype,"library",2);Se([er("label")],zt.prototype,"handleLabelChange",1);Se([er(["family","name","library","variant","src","autoWidth","swapOpacity"])],zt.prototype,"setIcon",1);zt=Se([_t("wa-icon")],zt);let ms=class extends Du{constructor(e){if(super(e),this.it=pt,e.type!==Nu.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(e){if(e===pt||e==null)return this._t=void 0,this.it=e;if(e===Pr)return e;if(typeof e!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(e===this.it)return this._t;this.it=e;const r=[e];return r.raw=r,this._t={_$litType$:this.constructor.resultType,strings:r,values:[]}}};ms.directiveName="unsafeHTML",ms.resultType=1;const np=Lu(ms),ip=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
  viewBox="0 0 164.98936 240.00001"
  version="1.1"
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
  xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  xmlns:cc="http://creativecommons.org/ns#"
  xmlns:dc="http://purl.org/dc/elements/1.1/"
>
  <metadata>
    <rdf:RDF>
      <cc:Work rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g transform="translate(-317.40707,-420.21956)">
    <g transform="matrix(0.89526548,0,0,0.89526548,-11.212902,63.476514)">
      <path
        id="stalk"
        d="m 520.62695,590.04102 c 0.0953,-6.07416 0.70828,-18.58321 0.5918,-31.9629 -0.11369,-13.05772 -0.94675,-26.94319 -1.58984,-36.48437 -0.38151,-5.66028 -1.57307,-6.04267 -4.39649,-6.03516 -2.82342,0.008 -4.66066,1.25838 -4.68945,6.17188 -0.0504,8.60421 0.89605,21.43369 0.74805,34.5625 -0.13089,11.61039 -1.32712,23.33898 -1.48047,34.28125 -0.21838,15.58279 -11.47455,20.36575 -17.24219,20.73024 -10.04624,0.63487 -20.0913,-12.53202 -21.05664,-34.07399 -1.10596,-24.67974 -3.85922,-55.26933 -7.84375,-77.93164 -0.24039,-1.36722 -3.29551,-32.43398 -1.33203,-42.79688 0.64336,-3.39556 3.36845,-9.00219 -3.78906,-9.59961 -6.5191,-0.54414 -4.36743,7.41117 -5.32422,11.5293 -2.20573,9.49367 0.0775,33.05609 1.52539,47.75391 2.09454,21.26158 8.28525,44.39928 5.61328,80.52929 -1.43137,19.3548 -8.95104,24.74208 -22.67144,24.94655 -10.76892,0.16048 -20.97804,-5.92655 -26.67377,-21.48316 -1.93578,-5.28716 -0.94595,-17.18737 -5.03174,-38.58448 -3.47796,-18.21397 -4.47557,-41.26337 -4.09376,-48.46094 0.22371,-4.21726 -0.14667,-6.09224 -4.18164,-5.88867 -4.03497,0.20358 -4.20852,0.62542 -4.21679,5.3418 -0.0185,10.52527 1.78815,31.06074 4.30273,49.74414 2.57288,19.11649 1.14337,36.49684 0.35891,37.74219 -3.78843,6.01421 -18.01528,10.84255 -25.178,19.91468 -9.99006,12.65318 -6.50591,29.8061 5.24506,40.61459 3.5424,2.87674 12.02408,9.74058 22.36724,8.74308 9.87888,-0.95273 21.45587,-9.74176 32.04932,-8.33619 14.08082,1.86828 22.58994,16.03079 36.11801,15.47117 16.07163,-0.66483 30.61051,-10.79421 37.05584,-10.34788 25.76735,4.56347 44.66475,-10.64623 45.41428,-24.2109 1.64417,-29.7555 -25.69561,-22.11809 -30.59863,-41.8798 z m -117.0957,18.24023 c 5.1278,-0.29706 6.56217,7.10509 8.25391,12.65234 4.12408,13.52295 0.46732,14.9713 -8.21289,13.57227 -11.24829,-1.81294 -17.35537,-5.1681 -16.11329,-11.95898 1.26269,-6.90356 5.52562,-8.22448 10.8086,-11.9961 2.10139,-1.50022 3.82789,-2.18635 5.26367,-2.26953 z m 114.68359,3.72461 c 4.92594,-0.22589 14.62313,5.31318 14.64258,11.42773 0.0115,3.60503 -0.12924,6.95497 -11.42969,11.07227 -4.63317,1.68809 -13.92773,1.82748 -13.92773,-4.28711 0,-6.11458 2.92658,-17.85576 10.71484,-18.21289 z m -47.61328,5.0918 c 6.4484,0.38679 11.8835,12.13573 13.6836,17.4082 3.30013,9.66608 -6.2352,14.28516 -13.92774,14.28516 -7.69254,0 -16.78515,-2.26045 -16.78515,-8.57227 -10e-6,-6.31183 7.30745,-20.35741 15,-22.85742 0.68586,-0.2229 1.36222,-0.30369 2.02929,-0.26367 z"
      />
      <g id="caps">
        <path
          d="m 425.52675,498.54606 c 0.84637,5.4724 -7.01336,6.06091 -20.70812,6.06091 -0.48563,0 -3.73186,-1.06843 1.75423,-1.59317 3.51626,-0.33633 14.51824,-1.34096 14.59237,-2.71118 0.14789,-2.73369 -21.23411,-5.12155 -22.65996,-5.16004 -4.0146,-0.10838 -16.48086,-0.0665 -16.39507,3.28729 0.0437,1.70839 5.03248,3.33269 8.15007,4.38687 3.1176,1.05419 1.66148,1.84278 1.42364,1.81032 -7.4534,-1.01731 -11.45875,-4.29192 -12.62417,-7.34369 -5.27669,-13.81756 8.27891,-40.48529 21.46574,-40.15357 13.69304,0.34445 22.22805,23.48532 25.00127,41.41626 z"
        />
        <path
          d="m 496.57469,455.5282 c -0.39638,6.78103 -4.68667,4.34013 -24.19376,4.34013 -5.74251,0 -10.11397,-3.54219 -0.0266,-3.78457 5.03003,-0.12086 17.64961,1.37291 17.7552,-1.33648 0.15186,-3.89666 -30.24629,-9.56808 -32.2773,-9.62291 -5.71847,-0.15438 -35.34495,-2.87262 -35.22275,1.90456 0.0623,2.43347 18.28003,6.76746 22.72079,8.26906 4.44077,1.50161 2.36665,2.62489 2.02786,2.57866 -10.61677,-1.44908 -29.45387,-3.3351 -29.8291,-12.31801 -0.13897,-3.32684 11.33018,-21.33152 22.85821,-36.45096 5.72227,-7.50499 14.69089,-10.71405 21.08023,-10.55333 6.69795,0.16849 15.6453,6.40023 20.48814,14.55822 5.04761,8.50294 14.99949,35.90812 14.6191,42.41563 z"
        />
        <path
          d="m 548.26371,518.84668 c 0.13739,4.19673 -13.76959,4.51867 -22.13522,5.05438 -0.61834,0.0396 -6.72567,-2.07746 0.27388,-2.74696 4.4863,-0.42911 17.09486,-0.10375 17.01087,-2.74484 -0.11102,-3.49117 -20.48488,-4.74873 -28.55409,-4.97641 -5.12194,-0.14453 -30.49176,0.27234 -30.3823,3.47988 0.0744,2.17913 15.88508,3.00209 19.86273,4.34709 3.97766,1.34501 3.90556,3.42258 0.56638,3.02403 -9.53011,-1.13749 -25.47105,-3.59576 -25.57111,-7.76248 -0.15199,-6.32924 12.3886,-35.47992 19.38145,-42.94839 4.50982,-4.81655 11.21654,-7.76839 15.86324,-7.74675 6.08165,0.0283 16.46627,6.33051 21.03239,16.31168 6.88311,15.04589 12.49491,31.91748 12.65178,36.70877 z"
        />
      </g>
    </g>
  </g>
</svg>
`;var op=Object.getOwnPropertyDescriptor,sp=(t,e,r,n)=>{for(var s=n>1?void 0:n?op(e,r):e,a=t.length-1,l;a>=0;a--)(l=t[a])&&(s=l(s)||s);return s};let ys=class extends Ct{render(){return Qe`<div class="logo">${np(ip)}</div> `}};ys.styles=en`
    :host {
      --size: 150px;
    }

    .logo svg {
      height: var(--size);
      fill: var(--color-text);
    }

    .logo svg #caps {
      fill: var(--color-primary);
    }
  `;ys=sp([_t("dtp-logo")],ys);var ap=Object.getOwnPropertyDescriptor,Bu=(t,e,r,n)=>{for(var s=n>1?void 0:n?ap(e,r):e,a=t.length-1,l;a>=0;a--)(l=t[a])&&(s=l(s)||s);return s};let Ma=class extends Ct{render(){return Qe`
      <form @submit=${this._submit}>
        <input required type="url" name="webidOrIdp" />
        <button type="submit">continue</button>
      </form>
    `}_submit(t){t.preventDefault();const e=t.target,r=new FormData(e),n=Object.fromEntries(r.entries()),s=new CustomEvent("confirm",{detail:{data:n}});this.dispatchEvent(s)}};Ma=Bu([_t("dtp-signin-ui")],Ma);let ja=class extends Ct{render(){return Qe`<dtp-signin-ui @confirm=${this._confirm}></dtp-signin-ui>`}async _confirm(t){globalThis.sessionStorage.setItem("previousUrl",window.location.href),await Rf({oidcIssuer:t.detail.data.webidOrIdp,redirectUrl:new URL("/",window.location.href).toString(),clientName:"ditup",clientId:new URL("/clientid.jsonld",window.location.href).toJSON()})}};ja=Bu([_t("dtp-signin")],ja);const lp=en`
  /*
https://github.com/tailwindlabs/tailwindcss/blob/a1f533a0e04ab7f94a31ced50843e638dc99ecac/packages/tailwindcss/preflight.css

MIT License

Copyright (c) Tailwind Labs, Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/

  /*
  1. Prevent padding and border from affecting element width. (https://github.com/mozdevs/cssremedy/issues/4)
  2. Remove default margins and padding
  3. Reset all borders.
*/

  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    box-sizing: border-box; /* 1 */
    margin: 0; /* 2 */
    padding: 0; /* 2 */
    border: 0 solid; /* 3 */
  }

  /*
  1. Use a consistent sensible line-height in all browsers.
  2. Prevent adjustments of font size after orientation changes in iOS.
  3. Use a more readable tab size.
  4. Use the user's configured \`sans\` font-family by default.
  5. Use the user's configured \`sans\` font-feature-settings by default.
  6. Use the user's configured \`sans\` font-variation-settings by default.
  7. Disable tap highlights on iOS.
*/

  html,
  :host {
    line-height: 1.5; /* 1 */
    -webkit-text-size-adjust: 100%; /* 2 */
    tab-size: 4; /* 3 */
    font-family: --theme(
      --default-font-family,
      ui-sans-serif,
      system-ui,
      sans-serif,
      "Apple Color Emoji",
      "Segoe UI Emoji",
      "Segoe UI Symbol",
      "Noto Color Emoji"
    ); /* 4 */
    font-feature-settings: --theme(
      --default-font-feature-settings,
      normal
    ); /* 5 */
    font-variation-settings: --theme(
      --default-font-variation-settings,
      normal
    ); /* 6 */
    -webkit-tap-highlight-color: transparent; /* 7 */
  }

  /*
  1. Add the correct height in Firefox.
  2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)
  3. Reset the default border style to a 1px solid border.
*/

  hr {
    height: 0; /* 1 */
    color: inherit; /* 2 */
    border-top-width: 1px; /* 3 */
  }

  /*
  Add the correct text decoration in Chrome, Edge, and Safari.
*/

  abbr:where([title]) {
    -webkit-text-decoration: underline dotted;
    text-decoration: underline dotted;
  }

  /*
  Remove the default font size and weight for headings.
*/

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-size: inherit;
    font-weight: inherit;
  }

  /*
  Reset links to optimize for opt-in styling instead of opt-out.
*/

  a {
    color: inherit;
    -webkit-text-decoration: inherit;
    text-decoration: inherit;
  }

  /*
  Add the correct font weight in Edge and Safari.
*/

  b,
  strong {
    font-weight: bolder;
  }

  /*
  1. Use the user's configured \`mono\` font-family by default.
  2. Use the user's configured \`mono\` font-feature-settings by default.
  3. Use the user's configured \`mono\` font-variation-settings by default.
  4. Correct the odd \`em\` font sizing in all browsers.
*/

  code,
  kbd,
  samp,
  pre {
    font-family: --theme(
      --default-mono-font-family,
      ui-monospace,
      SFMono-Regular,
      Menlo,
      Monaco,
      Consolas,
      "Liberation Mono",
      "Courier New",
      monospace
    ); /* 1 */
    font-feature-settings: --theme(
      --default-mono-font-feature-settings,
      normal
    ); /* 2 */
    font-variation-settings: --theme(
      --default-mono-font-variation-settings,
      normal
    ); /* 3 */
    font-size: 1em; /* 4 */
  }

  /*
  Add the correct font size in all browsers.
*/

  small {
    font-size: 80%;
  }

  /*
  Prevent \`sub\` and \`sup\` elements from affecting the line height in all browsers.
*/

  sub,
  sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
  }

  sub {
    bottom: -0.25em;
  }

  sup {
    top: -0.5em;
  }

  /*
  1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)
  2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)
  3. Remove gaps between table borders by default.
*/

  table {
    text-indent: 0; /* 1 */
    border-color: inherit; /* 2 */
    border-collapse: collapse; /* 3 */
  }

  /*
  Use the modern Firefox focus style for all focusable elements.
*/

  :-moz-focusring {
    outline: auto;
  }

  /*
  Add the correct vertical alignment in Chrome and Firefox.
*/

  progress {
    vertical-align: baseline;
  }

  /*
  Add the correct display in Chrome and Safari.
*/

  summary {
    display: list-item;
  }

  /*
  Make lists unstyled by default.
*/

  ol,
  ul,
  menu {
    list-style: none;
  }

  /*
  1. Make replaced elements \`display: block\` by default. (https://github.com/mozdevs/cssremedy/issues/14)
  2. Add \`vertical-align: middle\` to align replaced elements more sensibly by default. (https://github.com/jensimmons/cssremedy/issues/14#issuecomment-634934210)
      This can trigger a poorly considered lint error in some tools but is included by design.
*/

  img,
  svg,
  video,
  canvas,
  audio,
  iframe,
  embed,
  object {
    display: block; /* 1 */
    vertical-align: middle; /* 2 */
  }

  /*
  Constrain images and videos to the parent width and preserve their intrinsic aspect ratio. (https://github.com/mozdevs/cssremedy/issues/14)
*/

  img,
  video {
    max-width: 100%;
    height: auto;
  }

  /*
  1. Inherit font styles in all browsers.
  2. Remove border radius in all browsers.
  3. Remove background color in all browsers.
  4. Ensure consistent opacity for disabled states in all browsers.
*/

  button,
  input,
  select,
  optgroup,
  textarea,
  ::file-selector-button {
    font: inherit; /* 1 */
    font-feature-settings: inherit; /* 1 */
    font-variation-settings: inherit; /* 1 */
    letter-spacing: inherit; /* 1 */
    color: inherit; /* 1 */
    border-radius: 0; /* 2 */
    background-color: transparent; /* 3 */
    opacity: 1; /* 4 */
  }

  /*
  Restore default font weight.
*/

  :where(select:is([multiple], [size])) optgroup {
    font-weight: bolder;
  }

  /*
  Restore indentation.
*/

  :where(select:is([multiple], [size])) optgroup option {
    padding-inline-start: 20px;
  }

  /*
  Restore space after button.
*/

  ::file-selector-button {
    margin-inline-end: 4px;
  }

  /*
  Reset the default placeholder opacity in Firefox. (https://github.com/tailwindlabs/tailwindcss/issues/3300)
*/

  ::placeholder {
    opacity: 1;
  }

  /*
  Set the default placeholder color to a semi-transparent version of the current text color in browsers that do not
  crash when using \`color-mix()\` with \`currentcolor\`. (https://github.com/tailwindlabs/tailwindcss/issues/17194)
*/

  @supports (not (-webkit-appearance: -apple-pay-button)) /* Not Safari */ or
    (contain-intrinsic-size: 1px) /* Safari 17+ */ {
    ::placeholder {
      color: color-mix(in oklab, currentcolor 50%, transparent);
    }
  }

  /*
  Prevent resizing textareas horizontally by default.
*/

  textarea {
    resize: vertical;
  }

  /*
  Remove the inner padding in Chrome and Safari on macOS.
*/

  ::-webkit-search-decoration {
    -webkit-appearance: none;
  }

  /*
  1. Ensure date/time inputs have the same height when empty in iOS Safari.
  2. Ensure text alignment can be changed on date/time inputs in iOS Safari.
*/

  ::-webkit-date-and-time-value {
    min-height: 1lh; /* 1 */
    text-align: inherit; /* 2 */
  }

  /*
  Prevent height from changing on date/time inputs in macOS Safari when the input is set to \`display: block\`.
*/

  ::-webkit-datetime-edit {
    display: inline-flex;
  }

  /*
  Remove excess padding from pseudo-elements in date/time inputs to ensure consistent height across browsers.
*/

  ::-webkit-datetime-edit-fields-wrapper {
    padding: 0;
  }

  ::-webkit-datetime-edit,
  ::-webkit-datetime-edit-year-field,
  ::-webkit-datetime-edit-month-field,
  ::-webkit-datetime-edit-day-field,
  ::-webkit-datetime-edit-hour-field,
  ::-webkit-datetime-edit-minute-field,
  ::-webkit-datetime-edit-second-field,
  ::-webkit-datetime-edit-millisecond-field,
  ::-webkit-datetime-edit-meridiem-field {
    padding-block: 0;
  }

  /*
  Center dropdown marker shown on inputs with paired \`<datalist>\`s in Chrome. (https://github.com/tailwindlabs/tailwindcss/issues/18499)
*/

  ::-webkit-calendar-picker-indicator {
    line-height: 1;
  }

  /*
  Remove the additional \`:invalid\` styles in Firefox. (https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737)
*/

  :-moz-ui-invalid {
    box-shadow: none;
  }

  /*
  Correct the inability to style the border radius in iOS Safari.
*/

  button,
  input:where([type="button"], [type="reset"], [type="submit"]),
  ::file-selector-button {
    appearance: button;
  }

  /*
  Correct the cursor style of increment and decrement buttons in Safari.
*/

  ::-webkit-inner-spin-button,
  ::-webkit-outer-spin-button {
    height: auto;
  }

  /*
  Make elements with the HTML hidden attribute stay hidden by default.
*/

  [hidden]:where(:not([hidden="until-found"])) {
    display: none !important;
  }
`;var up=Object.defineProperty,cp=Object.getOwnPropertyDescriptor,Mu=(t,e,r,n)=>{for(var s=n>1?void 0:n?cp(e,r):e,a=t.length-1,l;a>=0;a--)(l=t[a])&&(s=(n?l(e,r,s):l(s))||s);return n&&s&&up(e,r,s),s};let Vi=class extends Ct{render(){return Qe`
      <h1>ditup</h1>
      <p class="subtitle">do it together</p>
      <p class="tagline">turn ideas into collaborative action</p>
      <dtp-logo></dtp-logo>
      <a class="button primary" href="https://docs.ditup.org">learn more</a>
      <button class="button" @click=${this._startSignin}>sign in</button>

      <wa-dialog label="Sign in" id="signin-dialog">
        <dtp-signin></dtp-signin>
      </wa-dialog>
    `}_startSignin(){this._signinDialog&&(this._signinDialog.open=!0)}};Vi.styles=[lp,en`
      #signin-dialog,
      ::part(dialog) {
        color: var(--color-text);
      }

      :host {
        /* margin: 0 auto; */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        min-height: 100vh;
      }

      h1 {
        font-size: 2rem;
        color: var(--color-primary);
      }

      .subtitle,
      .tagline {
        font-size: 1.25rem;
      }

      .logo svg {
        height: 150px;
        fill: var(--color-text);
      }

      .logo svg #caps {
        fill: var(--color-primary);
      }

      .button {
        padding: 0.5rem 1rem;
        background-color: var(--color-surface);
        border-radius: var(--border-radius);
        font-size: 1.25rem;
        cursor: pointer;
      }

      .button:hover {
        filter: brightness(0.9);
      }

      .button.primary {
        background-color: var(--color-primary);
      }
    `];Mu([Ut("#signin-dialog")],Vi.prototype,"_signinDialog",2);Vi=Mu([_t("dtp-landing")],Vi);var Ao,$a;function hp(){return $a||($a=1,Ao=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)),Ao}var dp=hp();const fp=Cu(dp);class ju{constructor(e){this.cache=new Map,this.subscribers=new Map,this.inflight=new Set,this.redirectsTo=new Map,this.redirectsFrom=new Map,this.fetch=e}_key(e,r){return`${e}|${r}`}subscribe(e,r,n){const s=this._key(e,r.accept??"");this.subscribers.has(s)||this.subscribers.set(s,new Set),this.subscribers.get(s).add(n);const a=this.cache.get(s);return a?n(a):this.inflight.has(s)?n({loading:!0}):this._fetch(e,r.accept??"",s),()=>{this.subscribers.get(s)?.delete(n)}}async _fetch(e,r,n){this.inflight.add(n);const s=this.subscribers.get(n)||new Set;for(const a of s)a({loading:!0});try{const a=await this.fetch(e,{headers:{Accept:r}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const l=a.headers.get("content-type")||"text/plain";let c;l.includes("application/json")||l.includes("application/ld+json")?c=await a.json():l.includes("image/")?c=await a.blob():c=await a.text();const g=a.url;g!==e&&(this.redirectsTo.set(e,g),this.redirectsFrom.has(g)||this.redirectsFrom.set(g,new Set),this.redirectsFrom.get(g).add(e));const h={loading:!1,finalUrl:g,headers:a.headers,contentType:l,data:c};this.cache.set(n,h),this.inflight.delete(n);for(const p of s)p(h)}catch(a){const l={loading:!1,error:a instanceof Error?a:new Error(String(a))};this.cache.set(n,l),this.inflight.delete(n);for(const c of s)c(l)}}_findRelatedUrls(e){const r=new Set([e]),n=this.redirectsTo.get(e);n&&r.add(n);const s=this.redirectsFrom.get(e);if(s)for(const a of s)r.add(a);return r}invalidate(e,r){const n=this._findRelatedUrls(e);for(const s of n)if(r){const a=this._key(s,r.accept??"");this.cache.delete(a),this.subscribers.has(a)&&!this.inflight.has(a)&&this._fetch(s,r.accept??"",a)}else{const a=Array.from(this.cache.keys()).filter(l=>l.startsWith(s+"|"));for(const l of a){this.cache.delete(l);const[,c]=l.split("|");c&&this.subscribers.has(l)&&!this.inflight.has(l)&&this._fetch(s,c,l)}}}}const Li=new ju(Ff),pp=new ju(globalThis.fetch.bind(globalThis));var gp=`:host {
  --size: 3rem;

  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
  width: var(--size);
  height: var(--size);
  color: var(--wa-color-neutral-on-normal);
  font: inherit;
  font-size: calc(var(--size) * 0.4);
  vertical-align: middle;
  background-color: var(--wa-color-neutral-fill-normal);
  border-radius: var(--wa-border-radius-circle);
  user-select: none;
  -webkit-user-select: none;
}

:host([shape='square']) {
  border-radius: 0;
}

:host([shape='rounded']) {
  border-radius: var(--wa-border-radius-m);
}

.icon {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.initials {
  line-height: 1;
  text-transform: uppercase;
}

.image {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  overflow: hidden;
  border-radius: inherit;
}
`,dr=class extends Zt{constructor(){super(...arguments),this.hasError=!1,this.image="",this.label="",this.initials="",this.loading="eager",this.shape="circle"}handleImageChange(){this.hasError=!1}handleImageLoadError(){this.hasError=!0,this.dispatchEvent(new ii)}render(){const t=Qe`
      <img
        part="image"
        class="image"
        src="${this.image}"
        loading="${this.loading}"
        role="img"
        aria-label=${this.label}
        @error="${this.handleImageLoadError}"
      />
    `;let e=Qe``;return this.initials?e=Qe`<div part="initials" class="initials" role="img" aria-label=${this.label}>
        ${this.initials}
      </div>`:e=Qe`
        <slot name="icon" part="icon" class="icon" role="img" aria-label=${this.label}>
          <wa-icon name="user" library="system" variant="solid"></wa-icon>
        </slot>
      `,Qe` ${this.image&&!this.hasError?t:e} `}};dr.css=gp;Se([Ot()],dr.prototype,"hasError",2);Se([Te()],dr.prototype,"image",2);Se([Te()],dr.prototype,"label",2);Se([Te()],dr.prototype,"initials",2);Se([Te()],dr.prototype,"loading",2);Se([Te({reflect:!0})],dr.prototype,"shape",2);Se([er("image")],dr.prototype,"handleImageChange",1);dr=Se([_t("wa-avatar")],dr);var Fo={},qn={},Ha;function mp(){if(Ha)return qn;Ha=1,qn.byteLength=c,qn.toByteArray=h,qn.fromByteArray=_;for(var t=[],e=[],r=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=n.length;s<a;++s)t[s]=n[s],e[n.charCodeAt(s)]=s;e[45]=62,e[95]=63;function l(x){var S=x.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var I=x.indexOf("=");I===-1&&(I=S);var F=I===S?0:4-I%4;return[I,F]}function c(x){var S=l(x),I=S[0],F=S[1];return(I+F)*3/4-F}function g(x,S,I){return(S+I)*3/4-I}function h(x){var S,I=l(x),F=I[0],b=I[1],A=new r(g(x,F,b)),T=0,P=b>0?F-4:F,D;for(D=0;D<P;D+=4)S=e[x.charCodeAt(D)]<<18|e[x.charCodeAt(D+1)]<<12|e[x.charCodeAt(D+2)]<<6|e[x.charCodeAt(D+3)],A[T++]=S>>16&255,A[T++]=S>>8&255,A[T++]=S&255;return b===2&&(S=e[x.charCodeAt(D)]<<2|e[x.charCodeAt(D+1)]>>4,A[T++]=S&255),b===1&&(S=e[x.charCodeAt(D)]<<10|e[x.charCodeAt(D+1)]<<4|e[x.charCodeAt(D+2)]>>2,A[T++]=S>>8&255,A[T++]=S&255),A}function p(x){return t[x>>18&63]+t[x>>12&63]+t[x>>6&63]+t[x&63]}function f(x,S,I){for(var F,b=[],A=S;A<I;A+=3)F=(x[A]<<16&16711680)+(x[A+1]<<8&65280)+(x[A+2]&255),b.push(p(F));return b.join("")}function _(x){for(var S,I=x.length,F=I%3,b=[],A=16383,T=0,P=I-F;T<P;T+=A)b.push(f(x,T,T+A>P?P:T+A));return F===1?(S=x[I-1],b.push(t[S>>2]+t[S<<4&63]+"==")):F===2&&(S=(x[I-2]<<8)+x[I-1],b.push(t[S>>10]+t[S>>4&63]+t[S<<2&63]+"=")),b.join("")}return qn}var _i={};var Va;function yp(){return Va||(Va=1,_i.read=function(t,e,r,n,s){var a,l,c=s*8-n-1,g=(1<<c)-1,h=g>>1,p=-7,f=r?s-1:0,_=r?-1:1,x=t[e+f];for(f+=_,a=x&(1<<-p)-1,x>>=-p,p+=c;p>0;a=a*256+t[e+f],f+=_,p-=8);for(l=a&(1<<-p)-1,a>>=-p,p+=n;p>0;l=l*256+t[e+f],f+=_,p-=8);if(a===0)a=1-h;else{if(a===g)return l?NaN:(x?-1:1)*(1/0);l=l+Math.pow(2,n),a=a-h}return(x?-1:1)*l*Math.pow(2,a-n)},_i.write=function(t,e,r,n,s,a){var l,c,g,h=a*8-s-1,p=(1<<h)-1,f=p>>1,_=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,x=n?0:a-1,S=n?1:-1,I=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,l=p):(l=Math.floor(Math.log(e)/Math.LN2),e*(g=Math.pow(2,-l))<1&&(l--,g*=2),l+f>=1?e+=_/g:e+=_*Math.pow(2,1-f),e*g>=2&&(l++,g/=2),l+f>=p?(c=0,l=p):l+f>=1?(c=(e*g-1)*Math.pow(2,s),l=l+f):(c=e*Math.pow(2,f-1)*Math.pow(2,s),l=0));s>=8;t[r+x]=c&255,x+=S,c/=256,s-=8);for(l=l<<s|c,h+=s;h>0;t[r+x]=l&255,x+=S,l/=256,h-=8);t[r+x-S]|=I*128}),_i}var Ka;function xr(){return Ka||(Ka=1,(function(t){const e=mp(),r=yp(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=A,t.INSPECT_MAX_BYTES=50;const s=2147483647;t.kMaxLength=s,c.TYPED_ARRAY_SUPPORT=a(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const L=new Uint8Array(1),w={foo:function(){return 42}};return Object.setPrototypeOf(w,Uint8Array.prototype),Object.setPrototypeOf(L,w),L.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function l(L){if(L>s)throw new RangeError('The value "'+L+'" is invalid for option "size"');const w=new Uint8Array(L);return Object.setPrototypeOf(w,c.prototype),w}function c(L,w,E){if(typeof L=="number"){if(typeof w=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(L)}return g(L,w,E)}c.poolSize=8192;function g(L,w,E){if(typeof L=="string")return _(L,w);if(ArrayBuffer.isView(L))return S(L);if(L==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L);if(_e(L,ArrayBuffer)||L&&_e(L.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(_e(L,SharedArrayBuffer)||L&&_e(L.buffer,SharedArrayBuffer)))return I(L,w,E);if(typeof L=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const v=L.valueOf&&L.valueOf();if(v!=null&&v!==L)return c.from(v,w,E);const ae=F(L);if(ae)return ae;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof L[Symbol.toPrimitive]=="function")return c.from(L[Symbol.toPrimitive]("string"),w,E);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L)}c.from=function(L,w,E){return g(L,w,E)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function h(L){if(typeof L!="number")throw new TypeError('"size" argument must be of type number');if(L<0)throw new RangeError('The value "'+L+'" is invalid for option "size"')}function p(L,w,E){return h(L),L<=0?l(L):w!==void 0?typeof E=="string"?l(L).fill(w,E):l(L).fill(w):l(L)}c.alloc=function(L,w,E){return p(L,w,E)};function f(L){return h(L),l(L<0?0:b(L)|0)}c.allocUnsafe=function(L){return f(L)},c.allocUnsafeSlow=function(L){return f(L)};function _(L,w){if((typeof w!="string"||w==="")&&(w="utf8"),!c.isEncoding(w))throw new TypeError("Unknown encoding: "+w);const E=T(L,w)|0;let v=l(E);const ae=v.write(L,w);return ae!==E&&(v=v.slice(0,ae)),v}function x(L){const w=L.length<0?0:b(L.length)|0,E=l(w);for(let v=0;v<w;v+=1)E[v]=L[v]&255;return E}function S(L){if(_e(L,Uint8Array)){const w=new Uint8Array(L);return I(w.buffer,w.byteOffset,w.byteLength)}return x(L)}function I(L,w,E){if(w<0||L.byteLength<w)throw new RangeError('"offset" is outside of buffer bounds');if(L.byteLength<w+(E||0))throw new RangeError('"length" is outside of buffer bounds');let v;return w===void 0&&E===void 0?v=new Uint8Array(L):E===void 0?v=new Uint8Array(L,w):v=new Uint8Array(L,w,E),Object.setPrototypeOf(v,c.prototype),v}function F(L){if(c.isBuffer(L)){const w=b(L.length)|0,E=l(w);return E.length===0||L.copy(E,0,0,w),E}if(L.length!==void 0)return typeof L.length!="number"||Me(L.length)?l(0):x(L);if(L.type==="Buffer"&&Array.isArray(L.data))return x(L.data)}function b(L){if(L>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return L|0}function A(L){return+L!=L&&(L=0),c.alloc(+L)}c.isBuffer=function(w){return w!=null&&w._isBuffer===!0&&w!==c.prototype},c.compare=function(w,E){if(_e(w,Uint8Array)&&(w=c.from(w,w.offset,w.byteLength)),_e(E,Uint8Array)&&(E=c.from(E,E.offset,E.byteLength)),!c.isBuffer(w)||!c.isBuffer(E))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(w===E)return 0;let v=w.length,ae=E.length;for(let he=0,le=Math.min(v,ae);he<le;++he)if(w[he]!==E[he]){v=w[he],ae=E[he];break}return v<ae?-1:ae<v?1:0},c.isEncoding=function(w){switch(String(w).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(w,E){if(!Array.isArray(w))throw new TypeError('"list" argument must be an Array of Buffers');if(w.length===0)return c.alloc(0);let v;if(E===void 0)for(E=0,v=0;v<w.length;++v)E+=w[v].length;const ae=c.allocUnsafe(E);let he=0;for(v=0;v<w.length;++v){let le=w[v];if(_e(le,Uint8Array))he+le.length>ae.length?(c.isBuffer(le)||(le=c.from(le)),le.copy(ae,he)):Uint8Array.prototype.set.call(ae,le,he);else if(c.isBuffer(le))le.copy(ae,he);else throw new TypeError('"list" argument must be an Array of Buffers');he+=le.length}return ae};function T(L,w){if(c.isBuffer(L))return L.length;if(ArrayBuffer.isView(L)||_e(L,ArrayBuffer))return L.byteLength;if(typeof L!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof L);const E=L.length,v=arguments.length>2&&arguments[2]===!0;if(!v&&E===0)return 0;let ae=!1;for(;;)switch(w){case"ascii":case"latin1":case"binary":return E;case"utf8":case"utf-8":return ie(L).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E*2;case"hex":return E>>>1;case"base64":return ve(L).length;default:if(ae)return v?-1:ie(L).length;w=(""+w).toLowerCase(),ae=!0}}c.byteLength=T;function P(L,w,E){let v=!1;if((w===void 0||w<0)&&(w=0),w>this.length||((E===void 0||E>this.length)&&(E=this.length),E<=0)||(E>>>=0,w>>>=0,E<=w))return"";for(L||(L="utf8");;)switch(L){case"hex":return Ie(this,w,E);case"utf8":case"utf-8":return Re(this,w,E);case"ascii":return je(this,w,E);case"latin1":case"binary":return me(this,w,E);case"base64":return se(this,w,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,w,E);default:if(v)throw new TypeError("Unknown encoding: "+L);L=(L+"").toLowerCase(),v=!0}}c.prototype._isBuffer=!0;function D(L,w,E){const v=L[w];L[w]=L[E],L[E]=v}c.prototype.swap16=function(){const w=this.length;if(w%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let E=0;E<w;E+=2)D(this,E,E+1);return this},c.prototype.swap32=function(){const w=this.length;if(w%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let E=0;E<w;E+=4)D(this,E,E+3),D(this,E+1,E+2);return this},c.prototype.swap64=function(){const w=this.length;if(w%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let E=0;E<w;E+=8)D(this,E,E+7),D(this,E+1,E+6),D(this,E+2,E+5),D(this,E+3,E+4);return this},c.prototype.toString=function(){const w=this.length;return w===0?"":arguments.length===0?Re(this,0,w):P.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(w){if(!c.isBuffer(w))throw new TypeError("Argument must be a Buffer");return this===w?!0:c.compare(this,w)===0},c.prototype.inspect=function(){let w="";const E=t.INSPECT_MAX_BYTES;return w=this.toString("hex",0,E).replace(/(.{2})/g,"$1 ").trim(),this.length>E&&(w+=" ... "),"<Buffer "+w+">"},n&&(c.prototype[n]=c.prototype.inspect),c.prototype.compare=function(w,E,v,ae,he){if(_e(w,Uint8Array)&&(w=c.from(w,w.offset,w.byteLength)),!c.isBuffer(w))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof w);if(E===void 0&&(E=0),v===void 0&&(v=w?w.length:0),ae===void 0&&(ae=0),he===void 0&&(he=this.length),E<0||v>w.length||ae<0||he>this.length)throw new RangeError("out of range index");if(ae>=he&&E>=v)return 0;if(ae>=he)return-1;if(E>=v)return 1;if(E>>>=0,v>>>=0,ae>>>=0,he>>>=0,this===w)return 0;let le=he-ae,Ge=v-E;const at=Math.min(le,Ge),tt=this.slice(ae,he),Ze=w.slice(E,v);for(let Xe=0;Xe<at;++Xe)if(tt[Xe]!==Ze[Xe]){le=tt[Xe],Ge=Ze[Xe];break}return le<Ge?-1:Ge<le?1:0};function j(L,w,E,v,ae){if(L.length===0)return-1;if(typeof E=="string"?(v=E,E=0):E>2147483647?E=2147483647:E<-2147483648&&(E=-2147483648),E=+E,Me(E)&&(E=ae?0:L.length-1),E<0&&(E=L.length+E),E>=L.length){if(ae)return-1;E=L.length-1}else if(E<0)if(ae)E=0;else return-1;if(typeof w=="string"&&(w=c.from(w,v)),c.isBuffer(w))return w.length===0?-1:M(L,w,E,v,ae);if(typeof w=="number")return w=w&255,typeof Uint8Array.prototype.indexOf=="function"?ae?Uint8Array.prototype.indexOf.call(L,w,E):Uint8Array.prototype.lastIndexOf.call(L,w,E):M(L,[w],E,v,ae);throw new TypeError("val must be string, number or Buffer")}function M(L,w,E,v,ae){let he=1,le=L.length,Ge=w.length;if(v!==void 0&&(v=String(v).toLowerCase(),v==="ucs2"||v==="ucs-2"||v==="utf16le"||v==="utf-16le")){if(L.length<2||w.length<2)return-1;he=2,le/=2,Ge/=2,E/=2}function at(Ze,Xe){return he===1?Ze[Xe]:Ze.readUInt16BE(Xe*he)}let tt;if(ae){let Ze=-1;for(tt=E;tt<le;tt++)if(at(L,tt)===at(w,Ze===-1?0:tt-Ze)){if(Ze===-1&&(Ze=tt),tt-Ze+1===Ge)return Ze*he}else Ze!==-1&&(tt-=tt-Ze),Ze=-1}else for(E+Ge>le&&(E=le-Ge),tt=E;tt>=0;tt--){let Ze=!0;for(let Xe=0;Xe<Ge;Xe++)if(at(L,tt+Xe)!==at(w,Xe)){Ze=!1;break}if(Ze)return tt}return-1}c.prototype.includes=function(w,E,v){return this.indexOf(w,E,v)!==-1},c.prototype.indexOf=function(w,E,v){return j(this,w,E,v,!0)},c.prototype.lastIndexOf=function(w,E,v){return j(this,w,E,v,!1)};function ne(L,w,E,v){E=Number(E)||0;const ae=L.length-E;v?(v=Number(v),v>ae&&(v=ae)):v=ae;const he=w.length;v>he/2&&(v=he/2);let le;for(le=0;le<v;++le){const Ge=parseInt(w.substr(le*2,2),16);if(Me(Ge))return le;L[E+le]=Ge}return le}function ce(L,w,E,v){return Fe(ie(w,L.length-E),L,E,v)}function N(L,w,E,v){return Fe(ge(w),L,E,v)}function ee(L,w,E,v){return Fe(ve(w),L,E,v)}function we(L,w,E,v){return Fe(re(w,L.length-E),L,E,v)}c.prototype.write=function(w,E,v,ae){if(E===void 0)ae="utf8",v=this.length,E=0;else if(v===void 0&&typeof E=="string")ae=E,v=this.length,E=0;else if(isFinite(E))E=E>>>0,isFinite(v)?(v=v>>>0,ae===void 0&&(ae="utf8")):(ae=v,v=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const he=this.length-E;if((v===void 0||v>he)&&(v=he),w.length>0&&(v<0||E<0)||E>this.length)throw new RangeError("Attempt to write outside buffer bounds");ae||(ae="utf8");let le=!1;for(;;)switch(ae){case"hex":return ne(this,w,E,v);case"utf8":case"utf-8":return ce(this,w,E,v);case"ascii":case"latin1":case"binary":return N(this,w,E,v);case"base64":return ee(this,w,E,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return we(this,w,E,v);default:if(le)throw new TypeError("Unknown encoding: "+ae);ae=(""+ae).toLowerCase(),le=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function se(L,w,E){return w===0&&E===L.length?e.fromByteArray(L):e.fromByteArray(L.slice(w,E))}function Re(L,w,E){E=Math.min(L.length,E);const v=[];let ae=w;for(;ae<E;){const he=L[ae];let le=null,Ge=he>239?4:he>223?3:he>191?2:1;if(ae+Ge<=E){let at,tt,Ze,Xe;switch(Ge){case 1:he<128&&(le=he);break;case 2:at=L[ae+1],(at&192)===128&&(Xe=(he&31)<<6|at&63,Xe>127&&(le=Xe));break;case 3:at=L[ae+1],tt=L[ae+2],(at&192)===128&&(tt&192)===128&&(Xe=(he&15)<<12|(at&63)<<6|tt&63,Xe>2047&&(Xe<55296||Xe>57343)&&(le=Xe));break;case 4:at=L[ae+1],tt=L[ae+2],Ze=L[ae+3],(at&192)===128&&(tt&192)===128&&(Ze&192)===128&&(Xe=(he&15)<<18|(at&63)<<12|(tt&63)<<6|Ze&63,Xe>65535&&Xe<1114112&&(le=Xe))}}le===null?(le=65533,Ge=1):le>65535&&(le-=65536,v.push(le>>>10&1023|55296),le=56320|le&1023),v.push(le),ae+=Ge}return Ue(v)}const Ne=4096;function Ue(L){const w=L.length;if(w<=Ne)return String.fromCharCode.apply(String,L);let E="",v=0;for(;v<w;)E+=String.fromCharCode.apply(String,L.slice(v,v+=Ne));return E}function je(L,w,E){let v="";E=Math.min(L.length,E);for(let ae=w;ae<E;++ae)v+=String.fromCharCode(L[ae]&127);return v}function me(L,w,E){let v="";E=Math.min(L.length,E);for(let ae=w;ae<E;++ae)v+=String.fromCharCode(L[ae]);return v}function Ie(L,w,E){const v=L.length;(!w||w<0)&&(w=0),(!E||E<0||E>v)&&(E=v);let ae="";for(let he=w;he<E;++he)ae+=et[L[he]];return ae}function G(L,w,E){const v=L.slice(w,E);let ae="";for(let he=0;he<v.length-1;he+=2)ae+=String.fromCharCode(v[he]+v[he+1]*256);return ae}c.prototype.slice=function(w,E){const v=this.length;w=~~w,E=E===void 0?v:~~E,w<0?(w+=v,w<0&&(w=0)):w>v&&(w=v),E<0?(E+=v,E<0&&(E=0)):E>v&&(E=v),E<w&&(E=w);const ae=this.subarray(w,E);return Object.setPrototypeOf(ae,c.prototype),ae};function pe(L,w,E){if(L%1!==0||L<0)throw new RangeError("offset is not uint");if(L+w>E)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(w,E,v){w=w>>>0,E=E>>>0,v||pe(w,E,this.length);let ae=this[w],he=1,le=0;for(;++le<E&&(he*=256);)ae+=this[w+le]*he;return ae},c.prototype.readUintBE=c.prototype.readUIntBE=function(w,E,v){w=w>>>0,E=E>>>0,v||pe(w,E,this.length);let ae=this[w+--E],he=1;for(;E>0&&(he*=256);)ae+=this[w+--E]*he;return ae},c.prototype.readUint8=c.prototype.readUInt8=function(w,E){return w=w>>>0,E||pe(w,1,this.length),this[w]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(w,E){return w=w>>>0,E||pe(w,2,this.length),this[w]|this[w+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(w,E){return w=w>>>0,E||pe(w,2,this.length),this[w]<<8|this[w+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(w,E){return w=w>>>0,E||pe(w,4,this.length),(this[w]|this[w+1]<<8|this[w+2]<<16)+this[w+3]*16777216},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(w,E){return w=w>>>0,E||pe(w,4,this.length),this[w]*16777216+(this[w+1]<<16|this[w+2]<<8|this[w+3])},c.prototype.readBigUInt64LE=Oe(function(w){w=w>>>0,m(w,"offset");const E=this[w],v=this[w+7];(E===void 0||v===void 0)&&k(w,this.length-8);const ae=E+this[++w]*2**8+this[++w]*2**16+this[++w]*2**24,he=this[++w]+this[++w]*2**8+this[++w]*2**16+v*2**24;return BigInt(ae)+(BigInt(he)<<BigInt(32))}),c.prototype.readBigUInt64BE=Oe(function(w){w=w>>>0,m(w,"offset");const E=this[w],v=this[w+7];(E===void 0||v===void 0)&&k(w,this.length-8);const ae=E*2**24+this[++w]*2**16+this[++w]*2**8+this[++w],he=this[++w]*2**24+this[++w]*2**16+this[++w]*2**8+v;return(BigInt(ae)<<BigInt(32))+BigInt(he)}),c.prototype.readIntLE=function(w,E,v){w=w>>>0,E=E>>>0,v||pe(w,E,this.length);let ae=this[w],he=1,le=0;for(;++le<E&&(he*=256);)ae+=this[w+le]*he;return he*=128,ae>=he&&(ae-=Math.pow(2,8*E)),ae},c.prototype.readIntBE=function(w,E,v){w=w>>>0,E=E>>>0,v||pe(w,E,this.length);let ae=E,he=1,le=this[w+--ae];for(;ae>0&&(he*=256);)le+=this[w+--ae]*he;return he*=128,le>=he&&(le-=Math.pow(2,8*E)),le},c.prototype.readInt8=function(w,E){return w=w>>>0,E||pe(w,1,this.length),this[w]&128?(255-this[w]+1)*-1:this[w]},c.prototype.readInt16LE=function(w,E){w=w>>>0,E||pe(w,2,this.length);const v=this[w]|this[w+1]<<8;return v&32768?v|4294901760:v},c.prototype.readInt16BE=function(w,E){w=w>>>0,E||pe(w,2,this.length);const v=this[w+1]|this[w]<<8;return v&32768?v|4294901760:v},c.prototype.readInt32LE=function(w,E){return w=w>>>0,E||pe(w,4,this.length),this[w]|this[w+1]<<8|this[w+2]<<16|this[w+3]<<24},c.prototype.readInt32BE=function(w,E){return w=w>>>0,E||pe(w,4,this.length),this[w]<<24|this[w+1]<<16|this[w+2]<<8|this[w+3]},c.prototype.readBigInt64LE=Oe(function(w){w=w>>>0,m(w,"offset");const E=this[w],v=this[w+7];(E===void 0||v===void 0)&&k(w,this.length-8);const ae=this[w+4]+this[w+5]*2**8+this[w+6]*2**16+(v<<24);return(BigInt(ae)<<BigInt(32))+BigInt(E+this[++w]*2**8+this[++w]*2**16+this[++w]*2**24)}),c.prototype.readBigInt64BE=Oe(function(w){w=w>>>0,m(w,"offset");const E=this[w],v=this[w+7];(E===void 0||v===void 0)&&k(w,this.length-8);const ae=(E<<24)+this[++w]*2**16+this[++w]*2**8+this[++w];return(BigInt(ae)<<BigInt(32))+BigInt(this[++w]*2**24+this[++w]*2**16+this[++w]*2**8+v)}),c.prototype.readFloatLE=function(w,E){return w=w>>>0,E||pe(w,4,this.length),r.read(this,w,!0,23,4)},c.prototype.readFloatBE=function(w,E){return w=w>>>0,E||pe(w,4,this.length),r.read(this,w,!1,23,4)},c.prototype.readDoubleLE=function(w,E){return w=w>>>0,E||pe(w,8,this.length),r.read(this,w,!0,52,8)},c.prototype.readDoubleBE=function(w,E){return w=w>>>0,E||pe(w,8,this.length),r.read(this,w,!1,52,8)};function Ce(L,w,E,v,ae,he){if(!c.isBuffer(L))throw new TypeError('"buffer" argument must be a Buffer instance');if(w>ae||w<he)throw new RangeError('"value" argument is out of bounds');if(E+v>L.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(w,E,v,ae){if(w=+w,E=E>>>0,v=v>>>0,!ae){const Ge=Math.pow(2,8*v)-1;Ce(this,w,E,v,Ge,0)}let he=1,le=0;for(this[E]=w&255;++le<v&&(he*=256);)this[E+le]=w/he&255;return E+v},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(w,E,v,ae){if(w=+w,E=E>>>0,v=v>>>0,!ae){const Ge=Math.pow(2,8*v)-1;Ce(this,w,E,v,Ge,0)}let he=v-1,le=1;for(this[E+he]=w&255;--he>=0&&(le*=256);)this[E+he]=w/le&255;return E+v},c.prototype.writeUint8=c.prototype.writeUInt8=function(w,E,v){return w=+w,E=E>>>0,v||Ce(this,w,E,1,255,0),this[E]=w&255,E+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(w,E,v){return w=+w,E=E>>>0,v||Ce(this,w,E,2,65535,0),this[E]=w&255,this[E+1]=w>>>8,E+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(w,E,v){return w=+w,E=E>>>0,v||Ce(this,w,E,2,65535,0),this[E]=w>>>8,this[E+1]=w&255,E+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(w,E,v){return w=+w,E=E>>>0,v||Ce(this,w,E,4,4294967295,0),this[E+3]=w>>>24,this[E+2]=w>>>16,this[E+1]=w>>>8,this[E]=w&255,E+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(w,E,v){return w=+w,E=E>>>0,v||Ce(this,w,E,4,4294967295,0),this[E]=w>>>24,this[E+1]=w>>>16,this[E+2]=w>>>8,this[E+3]=w&255,E+4};function xe(L,w,E,v,ae){R(w,v,ae,L,E,7);let he=Number(w&BigInt(4294967295));L[E++]=he,he=he>>8,L[E++]=he,he=he>>8,L[E++]=he,he=he>>8,L[E++]=he;let le=Number(w>>BigInt(32)&BigInt(4294967295));return L[E++]=le,le=le>>8,L[E++]=le,le=le>>8,L[E++]=le,le=le>>8,L[E++]=le,E}function Be(L,w,E,v,ae){R(w,v,ae,L,E,7);let he=Number(w&BigInt(4294967295));L[E+7]=he,he=he>>8,L[E+6]=he,he=he>>8,L[E+5]=he,he=he>>8,L[E+4]=he;let le=Number(w>>BigInt(32)&BigInt(4294967295));return L[E+3]=le,le=le>>8,L[E+2]=le,le=le>>8,L[E+1]=le,le=le>>8,L[E]=le,E+8}c.prototype.writeBigUInt64LE=Oe(function(w,E=0){return xe(this,w,E,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=Oe(function(w,E=0){return Be(this,w,E,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(w,E,v,ae){if(w=+w,E=E>>>0,!ae){const at=Math.pow(2,8*v-1);Ce(this,w,E,v,at-1,-at)}let he=0,le=1,Ge=0;for(this[E]=w&255;++he<v&&(le*=256);)w<0&&Ge===0&&this[E+he-1]!==0&&(Ge=1),this[E+he]=(w/le>>0)-Ge&255;return E+v},c.prototype.writeIntBE=function(w,E,v,ae){if(w=+w,E=E>>>0,!ae){const at=Math.pow(2,8*v-1);Ce(this,w,E,v,at-1,-at)}let he=v-1,le=1,Ge=0;for(this[E+he]=w&255;--he>=0&&(le*=256);)w<0&&Ge===0&&this[E+he+1]!==0&&(Ge=1),this[E+he]=(w/le>>0)-Ge&255;return E+v},c.prototype.writeInt8=function(w,E,v){return w=+w,E=E>>>0,v||Ce(this,w,E,1,127,-128),w<0&&(w=255+w+1),this[E]=w&255,E+1},c.prototype.writeInt16LE=function(w,E,v){return w=+w,E=E>>>0,v||Ce(this,w,E,2,32767,-32768),this[E]=w&255,this[E+1]=w>>>8,E+2},c.prototype.writeInt16BE=function(w,E,v){return w=+w,E=E>>>0,v||Ce(this,w,E,2,32767,-32768),this[E]=w>>>8,this[E+1]=w&255,E+2},c.prototype.writeInt32LE=function(w,E,v){return w=+w,E=E>>>0,v||Ce(this,w,E,4,2147483647,-2147483648),this[E]=w&255,this[E+1]=w>>>8,this[E+2]=w>>>16,this[E+3]=w>>>24,E+4},c.prototype.writeInt32BE=function(w,E,v){return w=+w,E=E>>>0,v||Ce(this,w,E,4,2147483647,-2147483648),w<0&&(w=4294967295+w+1),this[E]=w>>>24,this[E+1]=w>>>16,this[E+2]=w>>>8,this[E+3]=w&255,E+4},c.prototype.writeBigInt64LE=Oe(function(w,E=0){return xe(this,w,E,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=Oe(function(w,E=0){return Be(this,w,E,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function He(L,w,E,v,ae,he){if(E+v>L.length)throw new RangeError("Index out of range");if(E<0)throw new RangeError("Index out of range")}function ze(L,w,E,v,ae){return w=+w,E=E>>>0,ae||He(L,w,E,4),r.write(L,w,E,v,23,4),E+4}c.prototype.writeFloatLE=function(w,E,v){return ze(this,w,E,!0,v)},c.prototype.writeFloatBE=function(w,E,v){return ze(this,w,E,!1,v)};function Ke(L,w,E,v,ae){return w=+w,E=E>>>0,ae||He(L,w,E,8),r.write(L,w,E,v,52,8),E+8}c.prototype.writeDoubleLE=function(w,E,v){return Ke(this,w,E,!0,v)},c.prototype.writeDoubleBE=function(w,E,v){return Ke(this,w,E,!1,v)},c.prototype.copy=function(w,E,v,ae){if(!c.isBuffer(w))throw new TypeError("argument should be a Buffer");if(v||(v=0),!ae&&ae!==0&&(ae=this.length),E>=w.length&&(E=w.length),E||(E=0),ae>0&&ae<v&&(ae=v),ae===v||w.length===0||this.length===0)return 0;if(E<0)throw new RangeError("targetStart out of bounds");if(v<0||v>=this.length)throw new RangeError("Index out of range");if(ae<0)throw new RangeError("sourceEnd out of bounds");ae>this.length&&(ae=this.length),w.length-E<ae-v&&(ae=w.length-E+v);const he=ae-v;return this===w&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(E,v,ae):Uint8Array.prototype.set.call(w,this.subarray(v,ae),E),he},c.prototype.fill=function(w,E,v,ae){if(typeof w=="string"){if(typeof E=="string"?(ae=E,E=0,v=this.length):typeof v=="string"&&(ae=v,v=this.length),ae!==void 0&&typeof ae!="string")throw new TypeError("encoding must be a string");if(typeof ae=="string"&&!c.isEncoding(ae))throw new TypeError("Unknown encoding: "+ae);if(w.length===1){const le=w.charCodeAt(0);(ae==="utf8"&&le<128||ae==="latin1")&&(w=le)}}else typeof w=="number"?w=w&255:typeof w=="boolean"&&(w=Number(w));if(E<0||this.length<E||this.length<v)throw new RangeError("Out of range index");if(v<=E)return this;E=E>>>0,v=v===void 0?this.length:v>>>0,w||(w=0);let he;if(typeof w=="number")for(he=E;he<v;++he)this[he]=w;else{const le=c.isBuffer(w)?w:c.from(w,ae),Ge=le.length;if(Ge===0)throw new TypeError('The value "'+w+'" is invalid for argument "value"');for(he=0;he<v-E;++he)this[he+E]=le[he%Ge]}return this};const Ee={};function Ae(L,w,E){Ee[L]=class extends E{constructor(){super(),Object.defineProperty(this,"message",{value:w.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${L}]`,this.stack,delete this.name}get code(){return L}set code(ae){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ae,writable:!0})}toString(){return`${this.name} [${L}]: ${this.message}`}}}Ae("ERR_BUFFER_OUT_OF_BOUNDS",function(L){return L?`${L} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ae("ERR_INVALID_ARG_TYPE",function(L,w){return`The "${L}" argument must be of type number. Received type ${typeof w}`},TypeError),Ae("ERR_OUT_OF_RANGE",function(L,w,E){let v=`The value of "${L}" is out of range.`,ae=E;return Number.isInteger(E)&&Math.abs(E)>2**32?ae=ke(String(E)):typeof E=="bigint"&&(ae=String(E),(E>BigInt(2)**BigInt(32)||E<-(BigInt(2)**BigInt(32)))&&(ae=ke(ae)),ae+="n"),v+=` It must be ${w}. Received ${ae}`,v},RangeError);function ke(L){let w="",E=L.length;const v=L[0]==="-"?1:0;for(;E>=v+4;E-=3)w=`_${L.slice(E-3,E)}${w}`;return`${L.slice(0,E)}${w}`}function q(L,w,E){m(w,"offset"),(L[w]===void 0||L[w+E]===void 0)&&k(w,L.length-(E+1))}function R(L,w,E,v,ae,he){if(L>E||L<w){const le=typeof w=="bigint"?"n":"";let Ge;throw w===0||w===BigInt(0)?Ge=`>= 0${le} and < 2${le} ** ${(he+1)*8}${le}`:Ge=`>= -(2${le} ** ${(he+1)*8-1}${le}) and < 2 ** ${(he+1)*8-1}${le}`,new Ee.ERR_OUT_OF_RANGE("value",Ge,L)}q(v,ae,he)}function m(L,w){if(typeof L!="number")throw new Ee.ERR_INVALID_ARG_TYPE(w,"number",L)}function k(L,w,E){throw Math.floor(L)!==L?(m(L,E),new Ee.ERR_OUT_OF_RANGE("offset","an integer",L)):w<0?new Ee.ERR_BUFFER_OUT_OF_BOUNDS:new Ee.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${w}`,L)}const B=/[^+/0-9A-Za-z-_]/g;function X(L){if(L=L.split("=")[0],L=L.trim().replace(B,""),L.length<2)return"";for(;L.length%4!==0;)L=L+"=";return L}function ie(L,w){w=w||1/0;let E;const v=L.length;let ae=null;const he=[];for(let le=0;le<v;++le){if(E=L.charCodeAt(le),E>55295&&E<57344){if(!ae){if(E>56319){(w-=3)>-1&&he.push(239,191,189);continue}else if(le+1===v){(w-=3)>-1&&he.push(239,191,189);continue}ae=E;continue}if(E<56320){(w-=3)>-1&&he.push(239,191,189),ae=E;continue}E=(ae-55296<<10|E-56320)+65536}else ae&&(w-=3)>-1&&he.push(239,191,189);if(ae=null,E<128){if((w-=1)<0)break;he.push(E)}else if(E<2048){if((w-=2)<0)break;he.push(E>>6|192,E&63|128)}else if(E<65536){if((w-=3)<0)break;he.push(E>>12|224,E>>6&63|128,E&63|128)}else if(E<1114112){if((w-=4)<0)break;he.push(E>>18|240,E>>12&63|128,E>>6&63|128,E&63|128)}else throw new Error("Invalid code point")}return he}function ge(L){const w=[];for(let E=0;E<L.length;++E)w.push(L.charCodeAt(E)&255);return w}function re(L,w){let E,v,ae;const he=[];for(let le=0;le<L.length&&!((w-=2)<0);++le)E=L.charCodeAt(le),v=E>>8,ae=E%256,he.push(ae),he.push(v);return he}function ve(L){return e.toByteArray(X(L))}function Fe(L,w,E,v){let ae;for(ae=0;ae<v&&!(ae+E>=w.length||ae>=L.length);++ae)w[ae+E]=L[ae];return ae}function _e(L,w){return L instanceof w||L!=null&&L.constructor!=null&&L.constructor.name!=null&&L.constructor.name===w.name}function Me(L){return L!==L}const et=(function(){const L="0123456789abcdef",w=new Array(256);for(let E=0;E<16;++E){const v=E*16;for(let ae=0;ae<16;++ae)w[v+ae]=L[E]+L[ae]}return w})();function Oe(L){return typeof BigInt>"u"?Je:L}function Je(){throw new Error("BigInt not supported")}})(Fo)),Fo}var wp=xr();const Wn="http://www.w3.org/1999/02/22-rdf-syntax-ns#",zn="http://www.w3.org/2001/XMLSchema#",Si="http://www.w3.org/2000/10/swap/",Tt={xsd:{decimal:`${zn}decimal`,boolean:`${zn}boolean`,double:`${zn}double`,integer:`${zn}integer`,string:`${zn}string`},rdf:{type:`${Wn}type`,nil:`${Wn}nil`,first:`${Wn}first`,rest:`${Wn}rest`,langString:`${Wn}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${Si}reify#forSome`,forAll:`${Si}reify#forAll`},log:{implies:`${Si}log#implies`,isImpliedBy:`${Si}log#isImpliedBy`}},{xsd:Ei}=Tt,vp=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,qa={"\\":"\\","'":"'",'"':'"',n:`
`,r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},bp=/[\x00-\x20<>\\"\{\}\|\^\`]/,_p={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},Sp=/$0^/;class Ep{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._isImpliedBy=e.isImpliedBy,this._lineMode=!!e.lineMode){this._n3Mode=!1;for(const r in this)!(r in _p)&&this[r]instanceof RegExp&&(this[r]=Sp)}else this._n3Mode=e.n3!==!1;this.comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,r){let n=this._input,s=n.length;for(;;){let c,g;for(;c=this._newline.exec(n);)this.comments&&(g=this._comment.exec(c[0]))&&a("comment",g[1],"",this._line,c[0].length),n=n.substr(c[0].length,n.length),s=n.length,this._line++;if(!c&&(c=this._whitespace.exec(n))&&(n=n.substr(c[0].length,n.length)),this._endOfFile.test(n))return r&&(this.comments&&(g=this._comment.exec(n))&&a("comment",g[1],"",this._line,n.length),n=null,a("eof","","",this._line,0)),this._input=n;const h=this._line,p=n[0];let f="",_="",x="",S=null,I=0,F=!1;switch(p){case"^":if(n.length<3)break;if(n[1]==="^"){if(this._previousMarker="^^",n=n.substr(2),n[0]!=="<"){F=!0;break}}else{this._n3Mode&&(I=1,f="^");break}case"<":if(S=this._unescapedIri.exec(n))f="IRI",_=S[1];else if(S=this._iri.exec(n)){if(_=this._unescape(S[1]),_===null||bp.test(_))return l(this);f="IRI"}else n.length>1&&n[1]==="<"?(f="<<",I=2):this._n3Mode&&n.length>1&&n[1]==="="&&(I=2,this._isImpliedBy?(f="abbreviation",_="<"):(f="inverse",_=">"));break;case">":n.length>1&&n[1]===">"&&(f=">>",I=2);break;case"_":((S=this._blank.exec(n))||r&&(S=this._blank.exec(`${n} `)))&&(f="blank",x="_",_=S[1]);break;case'"':if(S=this._simpleQuotedString.exec(n))_=S[1];else if({value:_,matchLength:I}=this._parseLiteral(n),_===null)return l(this);(S!==null||I!==0)&&(f="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(S=this._simpleApostropheString.exec(n))_=S[1];else if({value:_,matchLength:I}=this._parseLiteral(n),_===null)return l(this);(S!==null||I!==0)&&(f="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(S=this._variable.exec(n))&&(f="var",_=S[0]);break;case"@":this._previousMarker==="literal"&&(S=this._langcode.exec(n))?(f="langcode",_=S[1]):(S=this._keyword.exec(n))&&(f=S[0]);break;case".":if(n.length===1?r:n[1]<"0"||n[1]>"9"){f=".",I=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(S=this._number.exec(n)||r&&(S=this._number.exec(`${n} `)))&&(f="literal",_=S[0],x=typeof S[1]=="string"?Ei.double:typeof S[2]=="string"?Ei.decimal:Ei.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(S=this._sparqlKeyword.exec(n))?f=S[0].toUpperCase():F=!0;break;case"f":case"t":(S=this._boolean.exec(n))?(f="literal",_=S[0],x=Ei.boolean):F=!0;break;case"a":(S=this._shortPredicates.exec(n))?(f="abbreviation",_="a"):F=!0;break;case"=":this._n3Mode&&n.length>1&&(f="abbreviation",n[1]!==">"?(I=1,_="="):(I=2,_=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"}":this._lineMode||(I=1,f=p);break;case"{":!this._lineMode&&n.length>=2&&(n[1]==="|"?(f="{|",I=2):(f=p,I=1));break;case"|":n.length>=2&&n[1]==="}"&&(f="|}",I=2);break;default:F=!0}if(F&&((this._previousMarker==="@prefix"||this._previousMarker==="PREFIX")&&(S=this._prefix.exec(n))?(f="prefix",_=S[1]||""):((S=this._prefixed.exec(n))||r&&(S=this._prefixed.exec(`${n} `)))&&(f="prefixed",x=S[1]||"",_=this._unescape(S[2]))),this._previousMarker==="^^")switch(f){case"prefixed":f="type";break;case"IRI":f="typeIRI";break;default:f=""}if(!f)return r||!/^'''|^"""/.test(n)&&/\n|\r/.test(n)?l(this):this._input=n;const b=I||S[0].length,A=a(f,_,x,h,b);this.previousToken=A,this._previousMarker=f,n=n.substr(b,n.length)}function a(c,g,h,p,f){const _=n?s-n.length:s,x=_+f,S={type:c,value:g,prefix:h,line:p,start:_,end:x};return e(null,S),S}function l(c){e(c._syntaxError(/^\S*/.exec(n)[0]))}}_unescape(e){let r=!1;const n=e.replace(vp,(s,a,l,c)=>{if(typeof a=="string")return String.fromCharCode(Number.parseInt(a,16));if(typeof l=="string"){let g=Number.parseInt(l,16);return g<=65535?String.fromCharCode(Number.parseInt(l,16)):String.fromCharCode(55296+((g-=65536)>>10),56320+(g&1023))}return c in qa?qa[c]:(r=!0,"")});return r?null:n}_parseLiteral(e){if(e.length>=3){const r=e.match(/^(?:"""|"|'''|'|)/)[0],n=r.length;let s=Math.max(this._literalClosingPos,n);for(;(s=e.indexOf(r,s))>0;){let a=0;for(;e[s-a-1]==="\\";)a++;if(a%2===0){const l=e.substring(n,s),c=l.split(/\r\n|\r|\n/).length-1,g=s+n;if(n===1&&c!==0||n===3&&this._lineMode)break;return this._line+=c,{value:this._unescape(l),matchLength:g}}s++}this._literalClosingPos=e.length-n+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const r=new Error(`Unexpected "${e}" on line ${this._line}.`);return r.context={token:void 0,line:this._line,previousToken:this.previousToken},r}_readStartingBom(e){return e.startsWith("\uFEFF")?e.substr(1):e}tokenize(e,r){if(this._line=1,typeof e=="string")if(this._input=this._readStartingBom(e),typeof r=="function")queueMicrotask(()=>this._tokenizeToEnd(r,!0));else{const n=[];let s;if(this._tokenizeToEnd((a,l)=>a?s=a:n.push(l),!0),s)throw s;return n}else this._pendingBuffer=null,typeof e.setEncoding=="function"&&e.setEncoding("utf8"),e.on("data",n=>{this._input!==null&&n.length!==0&&(this._pendingBuffer&&(n=wp.Buffer.concat([this._pendingBuffer,n]),this._pendingBuffer=null),n[n.length-1]&128?this._pendingBuffer=n:(typeof this._input>"u"?this._input=this._readStartingBom(typeof n=="string"?n:n.toString()):this._input+=n,this._tokenizeToEnd(r,!1)))}),e.on("end",()=>{typeof this._input=="string"&&this._tokenizeToEnd(r,!0)}),e.on("error",r)}}const{rdf:xp,xsd:Jr}=Tt;let Rn,Ap=0;const Nr={namedNode:Hu,blankNode:Vu,variable:qu,literal:Ku,defaultGraph:Tp,quad:ws,triple:ws,fromTerm:ti,fromQuad:Wu};class sr{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof sr?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class kr extends sr{get termType(){return"NamedNode"}}let Di=class $u extends sr{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let r=e.lastIndexOf('"')+1;return r<e.length&&e[r++]==="@"?e.substr(r).toLowerCase():""}get datatype(){return new kr(this.datatypeString)}get datatypeString(){const e=this.id,r=e.lastIndexOf('"')+1,n=r<e.length?e[r]:"";return n==="^"?e.substr(r+2):n!=="@"?Jr.string:xp.langString}equals(e){return e instanceof $u?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}};class Fp extends sr{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class Rp extends sr{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}class Ip extends sr{constructor(){return super(""),Rn||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}}Rn=new Ip;function ei(t,e,r){if(e=e||Nr,!t)return e.defaultGraph();switch(t[0]){case"?":return e.variable(t.substr(1));case"_":return e.blankNode(t.substr(2));case'"':if(e===Nr)return new Di(t);if(t[t.length-1]==='"')return e.literal(t.substr(1,t.length-2));const n=t.lastIndexOf('"',t.length-1);return e.literal(t.substr(1,n-1),t[n+1]==="@"?t.substr(n+2):e.namedNode(t.substr(n+3)));case"[":t=JSON.parse(t);break;default:if(!r||!Array.isArray(t))return e.namedNode(t)}return e.quad(ei(t[0],e,!0),ei(t[1],e,!0),ei(t[2],e,!0),t[3]&&ei(t[3],e,!0))}function mn(t,e){if(typeof t=="string")return t;if(t instanceof sr&&t.termType!=="Quad")return t.id;if(!t)return Rn.id;switch(t.termType){case"NamedNode":return t.value;case"BlankNode":return`_:${t.value}`;case"Variable":return`?${t.value}`;case"DefaultGraph":return"";case"Literal":return`"${t.value}"${t.language?`@${t.language}`:t.datatype&&t.datatype.value!==Jr.string?`^^${t.datatype.value}`:""}`;case"Quad":const r=[mn(t.subject,!0),mn(t.predicate,!0),mn(t.object,!0)];return t.graph&&t.graph.termType!=="DefaultGraph"&&r.push(mn(t.graph,!0)),e?r:JSON.stringify(r);default:throw new Error(`Unexpected termType: ${t.termType}`)}}class Ws extends sr{constructor(e,r,n,s){super(""),this._subject=e,this._predicate=r,this._object=n,this._graph=s||Rn}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function Hu(t){return new kr(t)}function Vu(t){return new Fp(t||`n3-${Ap++}`)}function Ku(t,e){if(typeof e=="string")return new Di(`"${t}"@${e.toLowerCase()}`);let r=e?e.value:"";return r===""&&(typeof t=="boolean"?r=Jr.boolean:typeof t=="number"&&(Number.isFinite(t)?r=Number.isInteger(t)?Jr.integer:Jr.double:(r=Jr.double,Number.isNaN(t)||(t=t>0?"INF":"-INF")))),r===""||r===Jr.string?new Di(`"${t}"`):new Di(`"${t}"^^${r}`)}function qu(t){return new Rp(t)}function Tp(){return Rn}function ws(t,e,r,n){return new Ws(t,e,r,n)}function ti(t){if(t instanceof sr)return t;switch(t.termType){case"NamedNode":return Hu(t.value);case"BlankNode":return Vu(t.value);case"Variable":return qu(t.value);case"DefaultGraph":return Rn;case"Literal":return Ku(t.value,t.language||t.datatype);case"Quad":return Wu(t);default:throw new Error(`Unexpected termType: ${t.termType}`)}}function Wu(t){if(t instanceof Ws)return t;if(t.termType!=="Quad")throw new Error(`Unexpected termType: ${t.termType}`);return ws(ti(t.subject),ti(t.predicate),ti(t.object),ti(t.graph))}let Wa=0;class zu{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&Ju(this,e.factory);const r=typeof e.format=="string"?e.format.match(/\w*$/)[0].toLowerCase():"",n=/turtle/.test(r),s=/trig/.test(r),a=/triple/.test(r),l=/quad/.test(r),c=this._n3Mode=/n3/.test(r),g=a||l;(this._supportsNamedGraphs=!(n||c))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(n||s||a||c),this._isImpliedBy=e.isImpliedBy,this._supportsRDFStar=r===""||/star|\*$/.test(r),g&&(this._resolveRelativeIRI=h=>null),this._blankNodePrefix=typeof e.blankNodePrefix!="string"?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new Ep({lineMode:g,n3:c,isImpliedBy:this._isImpliedBy}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){Wa=0}_setBase(e){if(!e)this._base="",this._basePath="";else{const r=e.indexOf("#");r>=0&&(e=e.substr(0,r)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}}_saveContext(e,r,n,s,a){const l=this._n3Mode;this._contextStack.push({type:e,subject:n,predicate:s,object:a,graph:r,inverse:l?this._inversePredicate:!1,blankPrefix:l?this._prefixes._:"",quantified:l?this._quantified:null}),l&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.value}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,r){const n=this._contextStack.pop();if(!n||n.type!==e)return this._error(`Unexpected ${r.type}`,r);this._subject=n.subject,this._predicate=n.predicate,this._object=n.object,this._graph=n.graph,this._n3Mode&&(this._inversePredicate=n.inverse,this._prefixes._=n.blankPrefix,this._quantified=n.quantified)}_readInTopContext(e){switch(e.type){case"eof":return this._graph!==null?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,r){let n;switch(e.type){case"IRI":case"typeIRI":const s=this._resolveIRI(e.value);if(s===null)return this._error("Invalid IRI",e);n=this._factory.namedNode(s);break;case"type":case"prefixed":const a=this._prefixes[e.prefix];if(a===void 0)return this._error(`Undefined prefix "${e.prefix}:"`,e);n=this._factory.namedNode(a+e.value);break;case"blank":n=this._factory.blankNode(this._prefixes[e.prefix]+e.value);break;case"var":n=this._factory.variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!r&&this._n3Mode&&n.id in this._quantified&&(n=this._quantified[n.id]),n}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._factory.blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._factory.blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier="blankNode",this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier="variable",this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(e.prefix.length===0)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._factory.literal(e.value,this._factory.namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF-star syntax",e);default:if((this._subject=this._readEntity(e))===void 0)return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const r=e.type;switch(r){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return this._predicate===null?this._error(`Unexpected ${r}`,e):(this._subject=null,r==="]"?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return this._predicate!==null?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._factory.blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if((this._predicate=this._readEntity(e))===void 0)return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(e.prefix.length===0)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._factory.literal(e.value,this._factory.namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._factory.blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._factory.blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF-star syntax",e);default:if((this._object=this._readEntity(e))===void 0)return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return e.type==="{"?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return e.type!=="{"?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return e.type==="]"?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if(e.type!=="]")return this._readBlankNodePunctuation(e);this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph);const r=this._predicate===null;return this._restoreContext("blank",e),this._object!==null?this._getContextEndReader():this._predicate!==null?this._readObject:r?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let r=null,n=null,s=this._readListItem;const a=this._subject,l=this._contextStack,c=l[l.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,n=this._factory.blankNode(),this.RDF_FIRST,this._subject=r=this._factory.blankNode()),s=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,n=this._factory.blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),l.length!==0&&l[l.length-1].type==="list"&&this._emit(this._subject,this._predicate,this._object,this._graph),this._predicate===null){if(s=this._readPredicate,this._subject===this.RDF_NIL)return s}else if(s=this._getContextEndReader(),this._object===this.RDF_NIL)return s;n=this.RDF_NIL;break;case"literal":e.prefix.length===0?(this._literalValue=e.value,s=this._readListItemDataTypeOrLang):(r=this._factory.literal(e.value,this._factory.namedNode(e.prefix)),s=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._factory.blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if((r=this._readEntity(e))===void 0)return}if(n===null&&(this._subject=n=this._factory.blankNode()),a===null?c.predicate===null?c.subject=n:c.object=n:this._emit(a,this.RDF_REST,n,this._graph),r!==null){if(this._n3Mode&&(e.type==="IRI"||e.type==="prefixed"))return this._saveContext("item",this._graph,n,this.RDF_FIRST,r),this._subject=r,this._predicate=null,this._getPathReader(this._readListItem);this._emit(n,this.RDF_FIRST,r,this._graph)}return s}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let r=this._factory.literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const n=this._readEntity(e);if(n===void 0)return;r=this._factory.literal(this._literalValue,n),e=null;break;case"langcode":r=this._factory.literal(this._literalValue,e.value),e=null;break}return{token:e,literal:r}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,r){const n=this._completeLiteral(e);if(n)return this._object=n.literal,r&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),n.token===null?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(n.token))}_readFormulaTail(e){return e.type!=="}"?this._readPunctuation(e):(this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),this._object===null?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let r,n=this._graph;const s=this._subject,a=this._inversePredicate;switch(e.type){case"}":if(this._graph===null)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,r=this._contextStack.length?this._readSubject:this._readInTopContext,a&&(this._inversePredicate=!1);break;case";":r=this._readPredicate;break;case",":r=this._readObject;break;case"{|":if(!this._supportsRDFStar)return this._error("Unexpected RDF-star syntax",e);const l=this._predicate,c=this._object;this._subject=this._factory.quad(s,l,c,this.DEFAULTGRAPH),r=this._readPredicate;break;case"|}":if(this._subject.termType!=="Quad")return this._error("Unexpected asserted triple closing",e);this._subject=null,r=this._readPunctuation;break;default:if(this._supportsQuads&&this._graph===null&&(n=this._readEntity(e))!==void 0){r=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(s!==null){const l=this._predicate,c=this._object;a?this._emit(c,l,s,n):this._emit(s,l,c,n)}return r}_readBlankNodePunctuation(e){let r;switch(e.type){case";":r=this._readPredicate;break;case",":r=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),r}_readQuadPunctuation(e){return e.type!=="."?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return e.type!=="prefix"?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if(e.type!=="IRI")return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const r=this._readEntity(e);return this._prefixes[this._prefix]=r.value,this._prefixCallback(this._prefix,r),this._readDeclarationPunctuation}_readBaseIRI(e){const r=e.type==="IRI"&&this._resolveIRI(e.value);return r?(this._setBase(r),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return e.type!=="]"?this._error("Invalid graph label",e):(this._subject=this._factory.blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):e.type!=="."?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let r;switch(e.type){case"IRI":case"prefixed":if((r=this._readEntity(e,!0))!==void 0)break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(this._subject===null?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._factory.blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._factory.blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,r,this.QUANTIFIERS_GRAPH)):this._quantified[r.id]=this._factory[this._quantifier](this._factory.blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return e.type===","?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const r=this._contextStack,n=r.length&&r[r.length-1];if(n&&n.type==="item"){const s=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,s,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let r,n;const s=this._factory.blankNode();if((n=this._readEntity(e))!==void 0)return this._predicate===null?(r=this._subject,this._subject=s):(r=this._object,this._object=s),this._emit(r,n,s,this._graph),this._readPath}_readBackwardPath(e){const r=this._factory.blankNode();let n,s;if((n=this._readEntity(e))!==void 0)return this._predicate===null?(s=this._subject,this._subject=r):(s=this._object,this._object=r),this._emit(r,n,s,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return e.type!==">>"?this._supportsQuads&&this._graph===null&&(this._graph=this._readEntity(e))!==void 0?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(e.type!==">>")return this._error(`Expected >> but got ${e.type}`,e);const r=this._factory.quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),this._subject===null?(this._subject=r,this._readPredicate):(this._object=r,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,r,n,s){this._callback(null,this._factory.quad(e,r,n,s||this.DEFAULTGRAPH))}_error(e,r){const n=new Error(`${e} on line ${r.line}.`);n.context={token:r,line:r.line,previousToken:this._lexer.previousToken},this._callback(n),this._callback=xi}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return(e[1]==="/"?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const r=e.length;let n="",s=-1,a=-1,l=0,c="/";for(;s<r;){switch(c){case":":if(a<0&&e[++s]==="/"&&e[++s]==="/")for(;(a=s+1)<r&&e[a]!=="/";)s=a;break;case"?":case"#":s=r;break;case"/":if(e[s+1]===".")switch(c=e[++s+1],c){case"/":n+=e.substring(l,s-1),l=s+1;break;case void 0:case"?":case"#":return n+e.substring(l,s)+e.substr(s+1);case".":if(c=e[++s+1],c===void 0||c==="/"||c==="?"||c==="#"){if(n+=e.substring(l,s-2),(l=n.lastIndexOf("/"))>=a&&(n=n.substr(0,l)),c!=="/")return`${n}/${e.substr(s+1)}`;l=s+1}}}c=e[++s]}return n+e.substring(l)}parse(e,r,n){let s,a,l;if(r&&(r.onQuad||r.onPrefix||r.onComment)?(s=r.onQuad,a=r.onPrefix,l=r.onComment):(s=r,a=n),this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${Wa++}_`,this._prefixCallback=a||xi,this._inversePredicate=!1,this._quantified=Object.create(null),!s){const g=[];let h;if(this._callback=(p,f)=>{p?h=p:f&&g.push(f)},this._lexer.tokenize(e).every(p=>this._readCallback=this._readCallback(p)),h)throw h;return g}let c=(g,h)=>{g!==null?(this._callback(g),this._callback=xi):this._readCallback&&(this._readCallback=this._readCallback(h))};l&&(this._lexer.comments=!0,c=(g,h)=>{g!==null?(this._callback(g),this._callback=xi):this._readCallback&&(h.type==="comment"?l(h.value):this._readCallback=this._readCallback(h))}),this._callback=s,this._lexer.tokenize(e,c)}}function xi(){}function Ju(t,e){t._factory=e,t.DEFAULTGRAPH=e.defaultGraph(),t.RDF_FIRST=e.namedNode(Tt.rdf.first),t.RDF_REST=e.namedNode(Tt.rdf.rest),t.RDF_NIL=e.namedNode(Tt.rdf.nil),t.N3_FORALL=e.namedNode(Tt.r.forAll),t.N3_FORSOME=e.namedNode(Tt.r.forSome),t.ABBREVIATIONS={a:e.namedNode(Tt.rdf.type),"=":e.namedNode(Tt.owl.sameAs),">":e.namedNode(Tt.log.implies),"<":e.namedNode(Tt.log.isImpliedBy)},t.QUANTIFIERS_GRAPH=e.namedNode("urn:n3:quantifiers")}Ju(zu.prototype,Nr);function vs(t){return!!t&&t.termType==="DefaultGraph"}function Oi(t){return t.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}const Cp=/^:?[^:?#]*(?:[?#]|$)|^file:|^[^:]*:\/*[^?#]+?\/(?:\.\.?(?:\/|$)|\/)/i,kp=/^(?:(?:[^/?#]{3,}|\.?[^/?#.]\.?)(?:\/[^/?#]{3,}|\.?[^/?#.]\.?)*\/?)?(?:[?#]|$)/,za="./",Pp="../",Ro="?",Ja="#";class zs{constructor(e){this.base=e,this._baseLength=0,this._baseMatcher=null,this._pathReplacements=new Array(e.length+1)}static supports(e){return!Cp.test(e)}_getBaseMatcher(){if(this._baseMatcher)return this._baseMatcher;if(!zs.supports(this.base))return this._baseMatcher=/.^/;const e=/^[^:]*:\/*/.exec(this.base)[0],r=["^",Oi(e)],n=[],s=[],a=/[^/?#]*([/?#])/y;let l,c=0,g=0,h=a.lastIndex=e.length;for(;!c&&!g&&(l=a.exec(this.base));)l[1]===Ja?g=a.lastIndex-1:(r.push(Oi(l[0]),"(?:"),n.push(")?"),l[1]!==Ro?s.push(h=a.lastIndex):(c=h=a.lastIndex,g=this.base.indexOf(Ja,c),this._pathReplacements[c]=Ro));for(let p=0;p<s.length;p++)this._pathReplacements[s[p]]=Pp.repeat(s.length-p-1);return this._pathReplacements[s[s.length-1]]=za,this._baseLength=g>0?g:this.base.length,r.push(Oi(this.base.substring(h,this._baseLength)),c?"(?:#|$)":"(?:[?#]|$)"),this._baseMatcher=new RegExp([...r,...n].join(""))}toRelative(e){const r=this._getBaseMatcher().exec(e);if(!r)return e;const n=r[0].length;if(n===this._baseLength&&n===e.length)return"";const s=this._pathReplacements[n];if(s){const a=e.substring(n);return s!==Ro&&!kp.test(a)?e:s===za&&/^[^?#]/.test(a)?a:s+a}return e.substring(n-1)}}const Jn=Nr.defaultGraph(),{rdf:Np,xsd:hn}=Tt,Ga=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,Ya=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,Lp={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class Gn extends sr{equals(e){return e===this}}class Gu{constructor(e,r){if(this._prefixRegex=/$0^/,e&&typeof e.write!="function"&&(r=e,e=null),r=r||{},this._lists=r.lists,e)this._outputStream=e,this._endStream=r.end===void 0?!0:!!r.end;else{let n="";this._outputStream={write(s,a,l){n+=s,l&&l()},end:s=>{s&&s(null,n)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(r.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=Jn,this._prefixIRIs=Object.create(null),r.prefixes&&this.addPrefixes(r.prefixes),r.baseIRI&&(this._baseIri=new zs(r.baseIRI)))}get _inDefaultGraph(){return Jn.equals(this._graph)}_write(e,r){this._outputStream.write(e,"utf8",r)}_writeQuad(e,r,n,s,a){try{s.equals(this._graph)||(this._write((this._subject===null?"":this._inDefaultGraph?`.
`:`
}
`)+(Jn.equals(s)?"":`${this._encodeIriOrBlank(s)} {
`)),this._graph=s,this._subject=null),e.equals(this._subject)?r.equals(this._predicate)?this._write(`, ${this._encodeObject(n)}`,a):this._write(`;
    ${this._encodePredicate(this._predicate=r)} ${this._encodeObject(n)}`,a):this._write(`${(this._subject===null?"":`.
`)+this._encodeSubject(this._subject=e)} ${this._encodePredicate(this._predicate=r)} ${this._encodeObject(n)}`,a)}catch(l){a&&a(l)}}_writeQuadLine(e,r,n,s,a){delete this._prefixMatch,this._write(this.quadToString(e,r,n,s),a)}quadToString(e,r,n,s){return`${this._encodeSubject(e)} ${this._encodeIriOrBlank(r)} ${this._encodeObject(n)}${s&&s.value?` ${this._encodeIriOrBlank(s)} .
`:` .
`}`}quadsToString(e){let r="";for(const n of e)r+=this.quadToString(n.subject,n.predicate,n.object,n.graph);return r}_encodeSubject(e){return e.termType==="Quad"?this._encodeQuad(e):this._encodeIriOrBlank(e)}_encodeIriOrBlank(e){if(e.termType!=="NamedNode")return this._lists&&e.value in this._lists&&(e=this.list(this._lists[e.value])),"id"in e?e.id:`_:${e.value}`;let r=e.value;this._baseIri&&(r=this._baseIri.toRelative(r)),Ga.test(r)&&(r=r.replace(Ya,Qa));const n=this._prefixRegex.exec(r);return n?n[1]?this._prefixIRIs[n[1]]+n[2]:r:`<${r}>`}_encodeLiteral(e){let r=e.value;if(Ga.test(r)&&(r=r.replace(Ya,Qa)),e.language)return`"${r}"@${e.language}`;if(this._lineMode){if(e.datatype.value===hn.string)return`"${r}"`}else switch(e.datatype.value){case hn.string:return`"${r}"`;case hn.boolean:if(r==="true"||r==="false")return r;break;case hn.integer:if(/^[+-]?\d+$/.test(r))return r;break;case hn.decimal:if(/^[+-]?\d*\.\d+$/.test(r))return r;break;case hn.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(r))return r;break}return`"${r}"^^${this._encodeIriOrBlank(e.datatype)}`}_encodePredicate(e){return e.value===Np.type?"a":this._encodeIriOrBlank(e)}_encodeObject(e){switch(e.termType){case"Quad":return this._encodeQuad(e);case"Literal":return this._encodeLiteral(e);default:return this._encodeIriOrBlank(e)}}_encodeQuad({subject:e,predicate:r,object:n,graph:s}){return`<<${this._encodeSubject(e)} ${this._encodePredicate(r)} ${this._encodeObject(n)}${vs(s)?"":` ${this._encodeIriOrBlank(s)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(e,r,n,s,a){n===void 0?this._writeQuad(e.subject,e.predicate,e.object,e.graph,r):typeof s=="function"?this._writeQuad(e,r,n,Jn,s):this._writeQuad(e,r,n,s||Jn,a)}addQuads(e){for(let r=0;r<e.length;r++)this.addQuad(e[r])}addPrefix(e,r,n){const s={};s[e]=r,this.addPrefixes(s,n)}addPrefixes(e,r){if(!this._prefixIRIs)return r&&r();let n=!1;for(let s in e){let a=e[s];typeof a!="string"&&(a=a.value),n=!0,this._subject!==null&&(this._write(this._inDefaultGraph?`.
`:`
}
`),this._subject=null,this._graph=""),this._prefixIRIs[a]=s+=":",this._write(`@prefix ${s} <${a}>.
`)}if(n){let s="",a="";for(const l in this._prefixIRIs)s+=s?`|${l}`:l,a+=(a?"|":"")+this._prefixIRIs[l];s=Oi(s),this._prefixRegex=new RegExp(`^(?:${a})[^/]*$|^(${s})([_a-zA-Z0-9][\\-_a-zA-Z0-9]*)$`)}this._write(n?`
`:"",r)}blank(e,r){let n=e,s,a;switch(e===void 0?n=[]:e.termType?n=[{predicate:e,object:r}]:"length"in e||(n=[e]),a=n.length){case 0:return new Gn("[]");case 1:if(s=n[0],!(s.object instanceof Gn))return new Gn(`[ ${this._encodePredicate(s.predicate)} ${this._encodeObject(s.object)} ]`);default:let l="[";for(let c=0;c<a;c++)s=n[c],s.predicate.equals(e)?l+=`, ${this._encodeObject(s.object)}`:(l+=`${(c?`;
  `:`
  `)+this._encodePredicate(s.predicate)} ${this._encodeObject(s.object)}`,e=s.predicate);return new Gn(`${l}
]`)}}list(e){const r=e&&e.length||0,n=new Array(r);for(let s=0;s<r;s++)n[s]=this._encodeObject(e[s]);return new Gn(`(${n.join(" ")})`)}end(e){this._subject!==null&&(this._write(this._inDefaultGraph?`.
`:`
}
`),this._subject=null),this._write=this._blockedWrite;let r=e&&((n,s)=>{r=null,e(n,s)});if(this._endStream)try{return this._outputStream.end(r)}catch{}r&&r()}}function Qa(t){let e=Lp[t];return e===void 0&&(t.length===1?(e=t.charCodeAt(0).toString(16),e="\\u0000".substr(0,6-e.length)+e):(e=((t.charCodeAt(0)-55296)*1024+t.charCodeAt(1)+9216).toString(16),e="\\U00000000".substr(0,10-e.length)+e)),e}var Io={exports:{}},To={exports:{}},Co,Xa;function gt(){if(Xa)return Co;Xa=1;class t extends Error{constructor(r){if(!Array.isArray(r))throw new TypeError(`Expected input to be an Array, got ${typeof r}`);let n="";for(let s=0;s<r.length;s++)n+=`    ${r[s].stack}
`;super(n),this.name="AggregateError",this.errors=r}}return Co={AggregateError:t,ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,r){return e.includes(r)},ArrayPrototypeIndexOf(e,r){return e.indexOf(r)},ArrayPrototypeJoin(e,r){return e.join(r)},ArrayPrototypeMap(e,r){return e.map(r)},ArrayPrototypePop(e,r){return e.pop(r)},ArrayPrototypePush(e,r){return e.push(r)},ArrayPrototypeSlice(e,r,n){return e.slice(r,n)},Error,FunctionPrototypeCall(e,r,...n){return e.call(r,...n)},FunctionPrototypeSymbolHasInstance(e,r){return Function.prototype[Symbol.hasInstance].call(e,r)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,r){return Object.defineProperties(e,r)},ObjectDefineProperty(e,r,n){return Object.defineProperty(e,r,n)},ObjectGetOwnPropertyDescriptor(e,r){return Object.getOwnPropertyDescriptor(e,r)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,r){return Object.setPrototypeOf(e,r)},Promise,PromisePrototypeCatch(e,r){return e.catch(r)},PromisePrototypeThen(e,r,n){return e.then(r,n)},PromiseReject(e){return Promise.reject(e)},PromiseResolve(e){return Promise.resolve(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,r){return e.test(r)},SafeSet:Set,String,StringPrototypeSlice(e,r,n){return e.slice(r,n)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(e,r,n){return e.set(r,n)},Boolean,Uint8Array},Co}var ko={exports:{}},Po,Za;function Yu(){return Za||(Za=1,Po={format(t,...e){return t.replace(/%([sdifj])/g,function(...[r,n]){const s=e.shift();return n==="f"?s.toFixed(6):n==="j"?JSON.stringify(s):n==="s"&&typeof s=="object"?`${s.constructor!==Object?s.constructor.name:""} {}`.trim():s.toString()})},inspect(t){switch(typeof t){case"string":if(t.includes("'"))if(t.includes('"')){if(!t.includes("`")&&!t.includes("${"))return`\`${t}\``}else return`"${t}"`;return`'${t}'`;case"number":return isNaN(t)?"NaN":Object.is(t,-0)?String(t):t;case"bigint":return`${String(t)}n`;case"boolean":case"undefined":return String(t);case"object":return"{}"}}}),Po}var No,el;function jt(){if(el)return No;el=1;const{format:t,inspect:e}=Yu(),{AggregateError:r}=gt(),n=globalThis.AggregateError||r,s=Symbol("kIsNodeError"),a=["string","function","number","object","Function","Object","boolean","bigint","symbol"],l=/^([A-Z][a-z0-9]*)+$/,c="__node_internal_",g={};function h(F,b){if(!F)throw new g.ERR_INTERNAL_ASSERTION(b)}function p(F){let b="",A=F.length;const T=F[0]==="-"?1:0;for(;A>=T+4;A-=3)b=`_${F.slice(A-3,A)}${b}`;return`${F.slice(0,A)}${b}`}function f(F,b,A){if(typeof b=="function")return h(b.length<=A.length,`Code: ${F}; The provided arguments length (${A.length}) does not match the required ones (${b.length}).`),b(...A);const T=(b.match(/%[dfijoOs]/g)||[]).length;return h(T===A.length,`Code: ${F}; The provided arguments length (${A.length}) does not match the required ones (${T}).`),A.length===0?b:t(b,...A)}function _(F,b,A){A||(A=Error);class T extends A{constructor(...D){super(f(F,b,D))}toString(){return`${this.name} [${F}]: ${this.message}`}}Object.defineProperties(T.prototype,{name:{value:A.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${F}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),T.prototype.code=F,T.prototype[s]=!0,g[F]=T}function x(F){const b=c+F.name;return Object.defineProperty(F,"name",{value:b}),F}function S(F,b){if(F&&b&&F!==b){if(Array.isArray(b.errors))return b.errors.push(F),b;const A=new n([b,F],b.message);return A.code=b.code,A}return F||b}class I extends Error{constructor(b="The operation was aborted",A=void 0){if(A!==void 0&&typeof A!="object")throw new g.ERR_INVALID_ARG_TYPE("options","Object",A);super(b,A),this.code="ABORT_ERR",this.name="AbortError"}}return _("ERR_ASSERTION","%s",Error),_("ERR_INVALID_ARG_TYPE",(F,b,A)=>{h(typeof F=="string","'name' must be a string"),Array.isArray(b)||(b=[b]);let T="The ";F.endsWith(" argument")?T+=`${F} `:T+=`"${F}" ${F.includes(".")?"property":"argument"} `,T+="must be ";const P=[],D=[],j=[];for(const ne of b)h(typeof ne=="string","All expected entries have to be of type string"),a.includes(ne)?P.push(ne.toLowerCase()):l.test(ne)?D.push(ne):(h(ne!=="object",'The value "object" should be written as "Object"'),j.push(ne));if(D.length>0){const ne=P.indexOf("object");ne!==-1&&(P.splice(P,ne,1),D.push("Object"))}if(P.length>0){switch(P.length){case 1:T+=`of type ${P[0]}`;break;case 2:T+=`one of type ${P[0]} or ${P[1]}`;break;default:{const ne=P.pop();T+=`one of type ${P.join(", ")}, or ${ne}`}}(D.length>0||j.length>0)&&(T+=" or ")}if(D.length>0){switch(D.length){case 1:T+=`an instance of ${D[0]}`;break;case 2:T+=`an instance of ${D[0]} or ${D[1]}`;break;default:{const ne=D.pop();T+=`an instance of ${D.join(", ")}, or ${ne}`}}j.length>0&&(T+=" or ")}switch(j.length){case 0:break;case 1:j[0].toLowerCase()!==j[0]&&(T+="an "),T+=`${j[0]}`;break;case 2:T+=`one of ${j[0]} or ${j[1]}`;break;default:{const ne=j.pop();T+=`one of ${j.join(", ")}, or ${ne}`}}if(A==null)T+=`. Received ${A}`;else if(typeof A=="function"&&A.name)T+=`. Received function ${A.name}`;else if(typeof A=="object"){var M;if((M=A.constructor)!==null&&M!==void 0&&M.name)T+=`. Received an instance of ${A.constructor.name}`;else{const ne=e(A,{depth:-1});T+=`. Received ${ne}`}}else{let ne=e(A,{colors:!1});ne.length>25&&(ne=`${ne.slice(0,25)}...`),T+=`. Received type ${typeof A} (${ne})`}return T},TypeError),_("ERR_INVALID_ARG_VALUE",(F,b,A="is invalid")=>{let T=e(b);return T.length>128&&(T=T.slice(0,128)+"..."),`The ${F.includes(".")?"property":"argument"} '${F}' ${A}. Received ${T}`},TypeError),_("ERR_INVALID_RETURN_VALUE",(F,b,A)=>{var T;const P=A!=null&&(T=A.constructor)!==null&&T!==void 0&&T.name?`instance of ${A.constructor.name}`:`type ${typeof A}`;return`Expected ${F} to be returned from the "${b}" function but got ${P}.`},TypeError),_("ERR_MISSING_ARGS",(...F)=>{h(F.length>0,"At least one arg needs to be specified");let b;const A=F.length;switch(F=(Array.isArray(F)?F:[F]).map(T=>`"${T}"`).join(" or "),A){case 1:b+=`The ${F[0]} argument`;break;case 2:b+=`The ${F[0]} and ${F[1]} arguments`;break;default:{const T=F.pop();b+=`The ${F.join(", ")}, and ${T} arguments`}break}return`${b} must be specified`},TypeError),_("ERR_OUT_OF_RANGE",(F,b,A)=>{h(b,'Missing "range" argument');let T;if(Number.isInteger(A)&&Math.abs(A)>2**32)T=p(String(A));else if(typeof A=="bigint"){T=String(A);const P=BigInt(2)**BigInt(32);(A>P||A<-P)&&(T=p(T)),T+="n"}else T=e(A);return`The value of "${F}" is out of range. It must be ${b}. Received ${T}`},RangeError),_("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),_("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),_("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),_("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),_("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),_("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),_("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),_("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),_("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),_("ERR_STREAM_WRITE_AFTER_END","write after end",Error),_("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),No={AbortError:I,aggregateTwoErrors:x(S),hideStackFrames:x,codes:g},No}var Yn={exports:{}},tl;function ci(){if(tl)return Yn.exports;tl=1;const{AbortController:t,AbortSignal:e}=typeof self<"u"?self:typeof window<"u"?window:void 0;return Yn.exports=t,Yn.exports.AbortSignal=e,Yn.exports.default=t,Yn.exports}var rl;function Wt(){return rl||(rl=1,(function(t){const e=xr(),{format:r,inspect:n}=Yu(),{codes:{ERR_INVALID_ARG_TYPE:s}}=jt(),{kResistStopPropagation:a,AggregateError:l,SymbolDispose:c}=gt(),g=globalThis.AbortSignal||ci().AbortSignal,h=globalThis.AbortController||ci().AbortController,p=Object.getPrototypeOf(async function(){}).constructor,f=globalThis.Blob||e.Blob,_=typeof f<"u"?function(F){return F instanceof f}:function(F){return!1},x=(I,F)=>{if(I!==void 0&&(I===null||typeof I!="object"||!("aborted"in I)))throw new s(F,"AbortSignal",I)},S=(I,F)=>{if(typeof I!="function")throw new s(F,"Function",I)};t.exports={AggregateError:l,kEmptyObject:Object.freeze({}),once(I){let F=!1;return function(...b){F||(F=!0,I.apply(this,b))}},createDeferredPromise:function(){let I,F;return{promise:new Promise((A,T)=>{I=A,F=T}),resolve:I,reject:F}},promisify(I){return new Promise((F,b)=>{I((A,...T)=>A?b(A):F(...T))})},debuglog(){return function(){}},format:r,inspect:n,types:{isAsyncFunction(I){return I instanceof p},isArrayBufferView(I){return ArrayBuffer.isView(I)}},isBlob:_,deprecate(I,F){return I},addAbortListener:pi().addAbortListener||function(F,b){if(F===void 0)throw new s("signal","AbortSignal",F);x(F,"signal"),S(b,"listener");let A;return F.aborted?queueMicrotask(()=>b()):(F.addEventListener("abort",b,{__proto__:null,once:!0,[a]:!0}),A=()=>{F.removeEventListener("abort",b)}),{__proto__:null,[c](){var T;(T=A)===null||T===void 0||T()}}},AbortSignalAny:g.any||function(F){if(F.length===1)return F[0];const b=new h,A=()=>b.abort();return F.forEach(T=>{x(T,"signals"),T.addEventListener("abort",A,{once:!0})}),b.signal.addEventListener("abort",()=>{F.forEach(T=>T.removeEventListener("abort",A))},{once:!0}),b.signal}},t.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(ko)),ko.exports}var Ai={},Lo,nl;function gi(){if(nl)return Lo;nl=1;const{ArrayIsArray:t,ArrayPrototypeIncludes:e,ArrayPrototypeJoin:r,ArrayPrototypeMap:n,NumberIsInteger:s,NumberIsNaN:a,NumberMAX_SAFE_INTEGER:l,NumberMIN_SAFE_INTEGER:c,NumberParseInt:g,ObjectPrototypeHasOwnProperty:h,RegExpPrototypeExec:p,String:f,StringPrototypeToUpperCase:_,StringPrototypeTrim:x}=gt(),{hideStackFrames:S,codes:{ERR_SOCKET_BAD_PORT:I,ERR_INVALID_ARG_TYPE:F,ERR_INVALID_ARG_VALUE:b,ERR_OUT_OF_RANGE:A,ERR_UNKNOWN_SIGNAL:T}}=jt(),{normalizeEncoding:P}=Wt(),{isAsyncFunction:D,isArrayBufferView:j}=Wt().types,M={};function ne(re){return re===(re|0)}function ce(re){return re===re>>>0}const N=/^[0-7]+$/,ee="must be a 32-bit unsigned integer or an octal string";function we(re,ve,Fe){if(typeof re>"u"&&(re=Fe),typeof re=="string"){if(p(N,re)===null)throw new b(ve,re,ee);re=g(re,8)}return Ne(re,ve),re}const se=S((re,ve,Fe=c,_e=l)=>{if(typeof re!="number")throw new F(ve,"number",re);if(!s(re))throw new A(ve,"an integer",re);if(re<Fe||re>_e)throw new A(ve,`>= ${Fe} && <= ${_e}`,re)}),Re=S((re,ve,Fe=-2147483648,_e=2147483647)=>{if(typeof re!="number")throw new F(ve,"number",re);if(!s(re))throw new A(ve,"an integer",re);if(re<Fe||re>_e)throw new A(ve,`>= ${Fe} && <= ${_e}`,re)}),Ne=S((re,ve,Fe=!1)=>{if(typeof re!="number")throw new F(ve,"number",re);if(!s(re))throw new A(ve,"an integer",re);const _e=Fe?1:0,Me=4294967295;if(re<_e||re>Me)throw new A(ve,`>= ${_e} && <= ${Me}`,re)});function Ue(re,ve){if(typeof re!="string")throw new F(ve,"string",re)}function je(re,ve,Fe=void 0,_e){if(typeof re!="number")throw new F(ve,"number",re);if(Fe!=null&&re<Fe||_e!=null&&re>_e||(Fe!=null||_e!=null)&&a(re))throw new A(ve,`${Fe!=null?`>= ${Fe}`:""}${Fe!=null&&_e!=null?" && ":""}${_e!=null?`<= ${_e}`:""}`,re)}const me=S((re,ve,Fe)=>{if(!e(Fe,re)){const Me="must be one of: "+r(n(Fe,et=>typeof et=="string"?`'${et}'`:f(et)),", ");throw new b(ve,re,Me)}});function Ie(re,ve){if(typeof re!="boolean")throw new F(ve,"boolean",re)}function G(re,ve,Fe){return re==null||!h(re,ve)?Fe:re[ve]}const pe=S((re,ve,Fe=null)=>{const _e=G(Fe,"allowArray",!1),Me=G(Fe,"allowFunction",!1);if(!G(Fe,"nullable",!1)&&re===null||!_e&&t(re)||typeof re!="object"&&(!Me||typeof re!="function"))throw new F(ve,"Object",re)}),Ce=S((re,ve)=>{if(re!=null&&typeof re!="object"&&typeof re!="function")throw new F(ve,"a dictionary",re)}),xe=S((re,ve,Fe=0)=>{if(!t(re))throw new F(ve,"Array",re);if(re.length<Fe){const _e=`must be longer than ${Fe}`;throw new b(ve,re,_e)}});function Be(re,ve){xe(re,ve);for(let Fe=0;Fe<re.length;Fe++)Ue(re[Fe],`${ve}[${Fe}]`)}function He(re,ve){xe(re,ve);for(let Fe=0;Fe<re.length;Fe++)Ie(re[Fe],`${ve}[${Fe}]`)}function ze(re,ve){xe(re,ve);for(let Fe=0;Fe<re.length;Fe++){const _e=re[Fe],Me=`${ve}[${Fe}]`;if(_e==null)throw new F(Me,"AbortSignal",_e);q(_e,Me)}}function Ke(re,ve="signal"){if(Ue(re,ve),M[re]===void 0)throw M[_(re)]!==void 0?new T(re+" (signals must use all capital letters)"):new T(re)}const Ee=S((re,ve="buffer")=>{if(!j(re))throw new F(ve,["Buffer","TypedArray","DataView"],re)});function Ae(re,ve){const Fe=P(ve),_e=re.length;if(Fe==="hex"&&_e%2!==0)throw new b("encoding",ve,`is invalid for data of length ${_e}`)}function ke(re,ve="Port",Fe=!0){if(typeof re!="number"&&typeof re!="string"||typeof re=="string"&&x(re).length===0||+re!==+re>>>0||re>65535||re===0&&!Fe)throw new I(ve,re,Fe);return re|0}const q=S((re,ve)=>{if(re!==void 0&&(re===null||typeof re!="object"||!("aborted"in re)))throw new F(ve,"AbortSignal",re)}),R=S((re,ve)=>{if(typeof re!="function")throw new F(ve,"Function",re)}),m=S((re,ve)=>{if(typeof re!="function"||D(re))throw new F(ve,"Function",re)}),k=S((re,ve)=>{if(re!==void 0)throw new F(ve,"undefined",re)});function B(re,ve,Fe){if(!e(Fe,re))throw new F(ve,`('${r(Fe,"|")}')`,re)}const X=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function ie(re,ve){if(typeof re>"u"||!p(X,re))throw new b(ve,re,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function ge(re){if(typeof re=="string")return ie(re,"hints"),re;if(t(re)){const ve=re.length;let Fe="";if(ve===0)return Fe;for(let _e=0;_e<ve;_e++){const Me=re[_e];ie(Me,"hints"),Fe+=Me,_e!==ve-1&&(Fe+=", ")}return Fe}throw new b("hints",re,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return Lo={isInt32:ne,isUint32:ce,parseFileMode:we,validateArray:xe,validateStringArray:Be,validateBooleanArray:He,validateAbortSignalArray:ze,validateBoolean:Ie,validateBuffer:Ee,validateDictionary:Ce,validateEncoding:Ae,validateFunction:R,validateInt32:Re,validateInteger:se,validateNumber:je,validateObject:pe,validateOneOf:me,validatePlainFunction:m,validatePort:ke,validateSignalName:Ke,validateString:Ue,validateUint32:Ne,validateUndefined:k,validateUnion:B,validateAbortSignal:q,validateLinkHeaderValue:ge},Lo}var Fi={exports:{}},Do={exports:{}},il;function tn(){if(il)return Do.exports;il=1;var t=Do.exports={},e,r;function n(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?e=setTimeout:e=n}catch{e=n}try{typeof clearTimeout=="function"?r=clearTimeout:r=s}catch{r=s}})();function a(I){if(e===setTimeout)return setTimeout(I,0);if((e===n||!e)&&setTimeout)return e=setTimeout,setTimeout(I,0);try{return e(I,0)}catch{try{return e.call(null,I,0)}catch{return e.call(this,I,0)}}}function l(I){if(r===clearTimeout)return clearTimeout(I);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(I);try{return r(I)}catch{try{return r.call(null,I)}catch{return r.call(this,I)}}}var c=[],g=!1,h,p=-1;function f(){!g||!h||(g=!1,h.length?c=h.concat(c):p=-1,c.length&&_())}function _(){if(!g){var I=a(f);g=!0;for(var F=c.length;F;){for(h=c,c=[];++p<F;)h&&h[p].run();p=-1,F=c.length}h=null,g=!1,l(I)}}t.nextTick=function(I){var F=new Array(arguments.length-1);if(arguments.length>1)for(var b=1;b<arguments.length;b++)F[b-1]=arguments[b];c.push(new x(I,F)),c.length===1&&!g&&a(_)};function x(I,F){this.fun=I,this.array=F}x.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={};function S(){}return t.on=S,t.addListener=S,t.once=S,t.off=S,t.removeListener=S,t.removeAllListeners=S,t.emit=S,t.prependListener=S,t.prependOnceListener=S,t.listeners=function(I){return[]},t.binding=function(I){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(I){throw new Error("process.chdir is not supported")},t.umask=function(){return 0},Do.exports}var Oo,ol;function Ar(){if(ol)return Oo;ol=1;const{SymbolAsyncIterator:t,SymbolIterator:e,SymbolFor:r}=gt(),n=r("nodejs.stream.destroyed"),s=r("nodejs.stream.errored"),a=r("nodejs.stream.readable"),l=r("nodejs.stream.writable"),c=r("nodejs.stream.disturbed"),g=r("nodejs.webstream.isClosedPromise"),h=r("nodejs.webstream.controllerErrorFunction");function p(G,pe=!1){var Ce;return!!(G&&typeof G.pipe=="function"&&typeof G.on=="function"&&(!pe||typeof G.pause=="function"&&typeof G.resume=="function")&&(!G._writableState||((Ce=G._readableState)===null||Ce===void 0?void 0:Ce.readable)!==!1)&&(!G._writableState||G._readableState))}function f(G){var pe;return!!(G&&typeof G.write=="function"&&typeof G.on=="function"&&(!G._readableState||((pe=G._writableState)===null||pe===void 0?void 0:pe.writable)!==!1))}function _(G){return!!(G&&typeof G.pipe=="function"&&G._readableState&&typeof G.on=="function"&&typeof G.write=="function")}function x(G){return G&&(G._readableState||G._writableState||typeof G.write=="function"&&typeof G.on=="function"||typeof G.pipe=="function"&&typeof G.on=="function")}function S(G){return!!(G&&!x(G)&&typeof G.pipeThrough=="function"&&typeof G.getReader=="function"&&typeof G.cancel=="function")}function I(G){return!!(G&&!x(G)&&typeof G.getWriter=="function"&&typeof G.abort=="function")}function F(G){return!!(G&&!x(G)&&typeof G.readable=="object"&&typeof G.writable=="object")}function b(G){return S(G)||I(G)||F(G)}function A(G,pe){return G==null?!1:pe===!0?typeof G[t]=="function":pe===!1?typeof G[e]=="function":typeof G[t]=="function"||typeof G[e]=="function"}function T(G){if(!x(G))return null;const pe=G._writableState,Ce=G._readableState,xe=pe||Ce;return!!(G.destroyed||G[n]||xe!=null&&xe.destroyed)}function P(G){if(!f(G))return null;if(G.writableEnded===!0)return!0;const pe=G._writableState;return pe!=null&&pe.errored?!1:typeof pe?.ended!="boolean"?null:pe.ended}function D(G,pe){if(!f(G))return null;if(G.writableFinished===!0)return!0;const Ce=G._writableState;return Ce!=null&&Ce.errored?!1:typeof Ce?.finished!="boolean"?null:!!(Ce.finished||pe===!1&&Ce.ended===!0&&Ce.length===0)}function j(G){if(!p(G))return null;if(G.readableEnded===!0)return!0;const pe=G._readableState;return!pe||pe.errored?!1:typeof pe?.ended!="boolean"?null:pe.ended}function M(G,pe){if(!p(G))return null;const Ce=G._readableState;return Ce!=null&&Ce.errored?!1:typeof Ce?.endEmitted!="boolean"?null:!!(Ce.endEmitted||pe===!1&&Ce.ended===!0&&Ce.length===0)}function ne(G){return G&&G[a]!=null?G[a]:typeof G?.readable!="boolean"?null:T(G)?!1:p(G)&&G.readable&&!M(G)}function ce(G){return G&&G[l]!=null?G[l]:typeof G?.writable!="boolean"?null:T(G)?!1:f(G)&&G.writable&&!P(G)}function N(G,pe){return x(G)?T(G)?!0:!(pe?.readable!==!1&&ne(G)||pe?.writable!==!1&&ce(G)):null}function ee(G){var pe,Ce;return x(G)?G.writableErrored?G.writableErrored:(pe=(Ce=G._writableState)===null||Ce===void 0?void 0:Ce.errored)!==null&&pe!==void 0?pe:null:null}function we(G){var pe,Ce;return x(G)?G.readableErrored?G.readableErrored:(pe=(Ce=G._readableState)===null||Ce===void 0?void 0:Ce.errored)!==null&&pe!==void 0?pe:null:null}function se(G){if(!x(G))return null;if(typeof G.closed=="boolean")return G.closed;const pe=G._writableState,Ce=G._readableState;return typeof pe?.closed=="boolean"||typeof Ce?.closed=="boolean"?pe?.closed||Ce?.closed:typeof G._closed=="boolean"&&Re(G)?G._closed:null}function Re(G){return typeof G._closed=="boolean"&&typeof G._defaultKeepAlive=="boolean"&&typeof G._removedConnection=="boolean"&&typeof G._removedContLen=="boolean"}function Ne(G){return typeof G._sent100=="boolean"&&Re(G)}function Ue(G){var pe;return typeof G._consuming=="boolean"&&typeof G._dumped=="boolean"&&((pe=G.req)===null||pe===void 0?void 0:pe.upgradeOrConnect)===void 0}function je(G){if(!x(G))return null;const pe=G._writableState,Ce=G._readableState,xe=pe||Ce;return!xe&&Ne(G)||!!(xe&&xe.autoDestroy&&xe.emitClose&&xe.closed===!1)}function me(G){var pe;return!!(G&&((pe=G[c])!==null&&pe!==void 0?pe:G.readableDidRead||G.readableAborted))}function Ie(G){var pe,Ce,xe,Be,He,ze,Ke,Ee,Ae,ke;return!!(G&&((pe=(Ce=(xe=(Be=(He=(ze=G[s])!==null&&ze!==void 0?ze:G.readableErrored)!==null&&He!==void 0?He:G.writableErrored)!==null&&Be!==void 0?Be:(Ke=G._readableState)===null||Ke===void 0?void 0:Ke.errorEmitted)!==null&&xe!==void 0?xe:(Ee=G._writableState)===null||Ee===void 0?void 0:Ee.errorEmitted)!==null&&Ce!==void 0?Ce:(Ae=G._readableState)===null||Ae===void 0?void 0:Ae.errored)!==null&&pe!==void 0?pe:!((ke=G._writableState)===null||ke===void 0)&&ke.errored))}return Oo={isDestroyed:T,kIsDestroyed:n,isDisturbed:me,kIsDisturbed:c,isErrored:Ie,kIsErrored:s,isReadable:ne,kIsReadable:a,kIsClosedPromise:g,kControllerErrorFunction:h,kIsWritable:l,isClosed:se,isDuplexNodeStream:_,isFinished:N,isIterable:A,isReadableNodeStream:p,isReadableStream:S,isReadableEnded:j,isReadableFinished:M,isReadableErrored:we,isNodeStream:x,isWebStream:b,isWritable:ce,isWritableNodeStream:f,isWritableStream:I,isWritableEnded:P,isWritableFinished:D,isWritableErrored:ee,isServerRequest:Ue,isServerResponse:Ne,willEmitClose:je,isTransformStream:F},Oo}var sl;function Ur(){if(sl)return Fi.exports;sl=1;const t=tn(),{AbortError:e,codes:r}=jt(),{ERR_INVALID_ARG_TYPE:n,ERR_STREAM_PREMATURE_CLOSE:s}=r,{kEmptyObject:a,once:l}=Wt(),{validateAbortSignal:c,validateFunction:g,validateObject:h,validateBoolean:p}=gi(),{Promise:f,PromisePrototypeThen:_,SymbolDispose:x}=gt(),{isClosed:S,isReadable:I,isReadableNodeStream:F,isReadableStream:b,isReadableFinished:A,isReadableErrored:T,isWritable:P,isWritableNodeStream:D,isWritableStream:j,isWritableFinished:M,isWritableErrored:ne,isNodeStream:ce,willEmitClose:N,kIsClosedPromise:ee}=Ar();let we;function se(me){return me.setHeader&&typeof me.abort=="function"}const Re=()=>{};function Ne(me,Ie,G){var pe,Ce;if(arguments.length===2?(G=Ie,Ie=a):Ie==null?Ie=a:h(Ie,"options"),g(G,"callback"),c(Ie.signal,"options.signal"),G=l(G),b(me)||j(me))return Ue(me,Ie,G);if(!ce(me))throw new n("stream",["ReadableStream","WritableStream","Stream"],me);const xe=(pe=Ie.readable)!==null&&pe!==void 0?pe:F(me),Be=(Ce=Ie.writable)!==null&&Ce!==void 0?Ce:D(me),He=me._writableState,ze=me._readableState,Ke=()=>{me.writable||ke()};let Ee=N(me)&&F(me)===xe&&D(me)===Be,Ae=M(me,!1);const ke=()=>{Ae=!0,me.destroyed&&(Ee=!1),!(Ee&&(!me.readable||xe))&&(!xe||q)&&G.call(me)};let q=A(me,!1);const R=()=>{q=!0,me.destroyed&&(Ee=!1),!(Ee&&(!me.writable||Be))&&(!Be||Ae)&&G.call(me)},m=re=>{G.call(me,re)};let k=S(me);const B=()=>{k=!0;const re=ne(me)||T(me);if(re&&typeof re!="boolean")return G.call(me,re);if(xe&&!q&&F(me,!0)&&!A(me,!1))return G.call(me,new s);if(Be&&!Ae&&!M(me,!1))return G.call(me,new s);G.call(me)},X=()=>{k=!0;const re=ne(me)||T(me);if(re&&typeof re!="boolean")return G.call(me,re);G.call(me)},ie=()=>{me.req.on("finish",ke)};se(me)?(me.on("complete",ke),Ee||me.on("abort",B),me.req?ie():me.on("request",ie)):Be&&!He&&(me.on("end",Ke),me.on("close",Ke)),!Ee&&typeof me.aborted=="boolean"&&me.on("aborted",B),me.on("end",R),me.on("finish",ke),Ie.error!==!1&&me.on("error",m),me.on("close",B),k?t.nextTick(B):He!=null&&He.errorEmitted||ze!=null&&ze.errorEmitted?Ee||t.nextTick(X):(!xe&&(!Ee||I(me))&&(Ae||P(me)===!1)||!Be&&(!Ee||P(me))&&(q||I(me)===!1)||ze&&me.req&&me.aborted)&&t.nextTick(X);const ge=()=>{G=Re,me.removeListener("aborted",B),me.removeListener("complete",ke),me.removeListener("abort",B),me.removeListener("request",ie),me.req&&me.req.removeListener("finish",ke),me.removeListener("end",Ke),me.removeListener("close",Ke),me.removeListener("finish",ke),me.removeListener("end",R),me.removeListener("error",m),me.removeListener("close",B)};if(Ie.signal&&!k){const re=()=>{const ve=G;ge(),ve.call(me,new e(void 0,{cause:Ie.signal.reason}))};if(Ie.signal.aborted)t.nextTick(re);else{we=we||Wt().addAbortListener;const ve=we(Ie.signal,re),Fe=G;G=l((..._e)=>{ve[x](),Fe.apply(me,_e)})}}return ge}function Ue(me,Ie,G){let pe=!1,Ce=Re;if(Ie.signal)if(Ce=()=>{pe=!0,G.call(me,new e(void 0,{cause:Ie.signal.reason}))},Ie.signal.aborted)t.nextTick(Ce);else{we=we||Wt().addAbortListener;const Be=we(Ie.signal,Ce),He=G;G=l((...ze)=>{Be[x](),He.apply(me,ze)})}const xe=(...Be)=>{pe||t.nextTick(()=>G.apply(me,Be))};return _(me[ee].promise,xe,xe),Re}function je(me,Ie){var G;let pe=!1;return Ie===null&&(Ie=a),(G=Ie)!==null&&G!==void 0&&G.cleanup&&(p(Ie.cleanup,"cleanup"),pe=Ie.cleanup),new f((Ce,xe)=>{const Be=Ne(me,Ie,He=>{pe&&Be(),He?xe(He):Ce()})})}return Fi.exports=Ne,Fi.exports.finished=je,Fi.exports}var Uo,al;function In(){if(al)return Uo;al=1;const t=tn(),{aggregateTwoErrors:e,codes:{ERR_MULTIPLE_CALLBACK:r},AbortError:n}=jt(),{Symbol:s}=gt(),{kIsDestroyed:a,isDestroyed:l,isFinished:c,isServerRequest:g}=Ar(),h=s("kDestroy"),p=s("kConstruct");function f(N,ee,we){N&&(N.stack,ee&&!ee.errored&&(ee.errored=N),we&&!we.errored&&(we.errored=N))}function _(N,ee){const we=this._readableState,se=this._writableState,Re=se||we;return se!=null&&se.destroyed||we!=null&&we.destroyed?(typeof ee=="function"&&ee(),this):(f(N,se,we),se&&(se.destroyed=!0),we&&(we.destroyed=!0),Re.constructed?x(this,N,ee):this.once(h,function(Ne){x(this,e(Ne,N),ee)}),this)}function x(N,ee,we){let se=!1;function Re(Ne){if(se)return;se=!0;const Ue=N._readableState,je=N._writableState;f(Ne,je,Ue),je&&(je.closed=!0),Ue&&(Ue.closed=!0),typeof we=="function"&&we(Ne),Ne?t.nextTick(S,N,Ne):t.nextTick(I,N)}try{N._destroy(ee||null,Re)}catch(Ne){Re(Ne)}}function S(N,ee){F(N,ee),I(N)}function I(N){const ee=N._readableState,we=N._writableState;we&&(we.closeEmitted=!0),ee&&(ee.closeEmitted=!0),(we!=null&&we.emitClose||ee!=null&&ee.emitClose)&&N.emit("close")}function F(N,ee){const we=N._readableState,se=N._writableState;se!=null&&se.errorEmitted||we!=null&&we.errorEmitted||(se&&(se.errorEmitted=!0),we&&(we.errorEmitted=!0),N.emit("error",ee))}function b(){const N=this._readableState,ee=this._writableState;N&&(N.constructed=!0,N.closed=!1,N.closeEmitted=!1,N.destroyed=!1,N.errored=null,N.errorEmitted=!1,N.reading=!1,N.ended=N.readable===!1,N.endEmitted=N.readable===!1),ee&&(ee.constructed=!0,ee.destroyed=!1,ee.closed=!1,ee.closeEmitted=!1,ee.errored=null,ee.errorEmitted=!1,ee.finalCalled=!1,ee.prefinished=!1,ee.ended=ee.writable===!1,ee.ending=ee.writable===!1,ee.finished=ee.writable===!1)}function A(N,ee,we){const se=N._readableState,Re=N._writableState;if(Re!=null&&Re.destroyed||se!=null&&se.destroyed)return this;se!=null&&se.autoDestroy||Re!=null&&Re.autoDestroy?N.destroy(ee):ee&&(ee.stack,Re&&!Re.errored&&(Re.errored=ee),se&&!se.errored&&(se.errored=ee),we?t.nextTick(F,N,ee):F(N,ee))}function T(N,ee){if(typeof N._construct!="function")return;const we=N._readableState,se=N._writableState;we&&(we.constructed=!1),se&&(se.constructed=!1),N.once(p,ee),!(N.listenerCount(p)>1)&&t.nextTick(P,N)}function P(N){let ee=!1;function we(se){if(ee){A(N,se??new r);return}ee=!0;const Re=N._readableState,Ne=N._writableState,Ue=Ne||Re;Re&&(Re.constructed=!0),Ne&&(Ne.constructed=!0),Ue.destroyed?N.emit(h,se):se?A(N,se,!0):t.nextTick(D,N)}try{N._construct(se=>{t.nextTick(we,se)})}catch(se){t.nextTick(we,se)}}function D(N){N.emit(p)}function j(N){return N?.setHeader&&typeof N.abort=="function"}function M(N){N.emit("close")}function ne(N,ee){N.emit("error",ee),t.nextTick(M,N)}function ce(N,ee){!N||l(N)||(!ee&&!c(N)&&(ee=new n),g(N)?(N.socket=null,N.destroy(ee)):j(N)?N.abort():j(N.req)?N.req.abort():typeof N.destroy=="function"?N.destroy(ee):typeof N.close=="function"?N.close():ee?t.nextTick(ne,N,ee):t.nextTick(M,N),N.destroyed||(N[a]=!0))}return Uo={construct:T,destroyer:ce,destroy:_,undestroy:b,errorOrDestroy:A},Uo}var Bo,ll;function Js(){if(ll)return Bo;ll=1;const{ArrayIsArray:t,ObjectSetPrototypeOf:e}=gt(),{EventEmitter:r}=pi();function n(a){r.call(this,a)}e(n.prototype,r.prototype),e(n,r),n.prototype.pipe=function(a,l){const c=this;function g(I){a.writable&&a.write(I)===!1&&c.pause&&c.pause()}c.on("data",g);function h(){c.readable&&c.resume&&c.resume()}a.on("drain",h),!a._isStdio&&(!l||l.end!==!1)&&(c.on("end",f),c.on("close",_));let p=!1;function f(){p||(p=!0,a.end())}function _(){p||(p=!0,typeof a.destroy=="function"&&a.destroy())}function x(I){S(),r.listenerCount(this,"error")===0&&this.emit("error",I)}s(c,"error",x),s(a,"error",x);function S(){c.removeListener("data",g),a.removeListener("drain",h),c.removeListener("end",f),c.removeListener("close",_),c.removeListener("error",x),a.removeListener("error",x),c.removeListener("end",S),c.removeListener("close",S),a.removeListener("close",S)}return c.on("end",S),c.on("close",S),a.on("close",S),a.emit("pipe",c),a};function s(a,l,c){if(typeof a.prependListener=="function")return a.prependListener(l,c);!a._events||!a._events[l]?a.on(l,c):t(a._events[l])?a._events[l].unshift(c):a._events[l]=[c,a._events[l]]}return Bo={Stream:n,prependListener:s},Bo}var Mo={exports:{}},ul;function Zi(){return ul||(ul=1,(function(t){const{SymbolDispose:e}=gt(),{AbortError:r,codes:n}=jt(),{isNodeStream:s,isWebStream:a,kControllerErrorFunction:l}=Ar(),c=Ur(),{ERR_INVALID_ARG_TYPE:g}=n;let h;const p=(f,_)=>{if(typeof f!="object"||!("aborted"in f))throw new g(_,"AbortSignal",f)};t.exports.addAbortSignal=function(_,x){if(p(_,"signal"),!s(x)&&!a(x))throw new g("stream",["ReadableStream","WritableStream","Stream"],x);return t.exports.addAbortSignalNoValidate(_,x)},t.exports.addAbortSignalNoValidate=function(f,_){if(typeof f!="object"||!("aborted"in f))return _;const x=s(_)?()=>{_.destroy(new r(void 0,{cause:f.reason}))}:()=>{_[l](new r(void 0,{cause:f.reason}))};if(f.aborted)x();else{h=h||Wt().addAbortListener;const S=h(f,x);c(_,S[e])}return _}})(Mo)),Mo.exports}var jo,cl;function Dp(){if(cl)return jo;cl=1;const{StringPrototypeSlice:t,SymbolIterator:e,TypedArrayPrototypeSet:r,Uint8Array:n}=gt(),{Buffer:s}=xr(),{inspect:a}=Wt();return jo=class{constructor(){this.head=null,this.tail=null,this.length=0}push(c){const g={data:c,next:null};this.length>0?this.tail.next=g:this.head=g,this.tail=g,++this.length}unshift(c){const g={data:c,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length}shift(){if(this.length===0)return;const c=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,c}clear(){this.head=this.tail=null,this.length=0}join(c){if(this.length===0)return"";let g=this.head,h=""+g.data;for(;(g=g.next)!==null;)h+=c+g.data;return h}concat(c){if(this.length===0)return s.alloc(0);const g=s.allocUnsafe(c>>>0);let h=this.head,p=0;for(;h;)r(g,h.data,p),p+=h.data.length,h=h.next;return g}consume(c,g){const h=this.head.data;if(c<h.length){const p=h.slice(0,c);return this.head.data=h.slice(c),p}return c===h.length?this.shift():g?this._getString(c):this._getBuffer(c)}first(){return this.head.data}*[e](){for(let c=this.head;c;c=c.next)yield c.data}_getString(c){let g="",h=this.head,p=0;do{const f=h.data;if(c>f.length)g+=f,c-=f.length;else{c===f.length?(g+=f,++p,h.next?this.head=h.next:this.head=this.tail=null):(g+=t(f,0,c),this.head=h,h.data=t(f,c));break}++p}while((h=h.next)!==null);return this.length-=p,g}_getBuffer(c){const g=s.allocUnsafe(c),h=c;let p=this.head,f=0;do{const _=p.data;if(c>_.length)r(g,_,h-c),c-=_.length;else{c===_.length?(r(g,_,h-c),++f,p.next?this.head=p.next:this.head=this.tail=null):(r(g,new n(_.buffer,_.byteOffset,c),h-c),this.head=p,p.data=_.slice(c));break}++f}while((p=p.next)!==null);return this.length-=f,g}[Symbol.for("nodejs.util.inspect.custom")](c,g){return a(this,{...g,depth:0,customInspect:!1})}},jo}var $o,hl;function eo(){if(hl)return $o;hl=1;const{MathFloor:t,NumberIsInteger:e}=gt(),{validateInteger:r}=gi(),{ERR_INVALID_ARG_VALUE:n}=jt().codes;let s=16*1024,a=16;function l(p,f,_){return p.highWaterMark!=null?p.highWaterMark:f?p[_]:null}function c(p){return p?a:s}function g(p,f){r(f,"value",0),p?a=f:s=f}function h(p,f,_,x){const S=l(f,x,_);if(S!=null){if(!e(S)||S<0){const I=x?`options.${_}`:"options.highWaterMark";throw new n(I,S)}return t(S)}return c(p.objectMode)}return $o={getHighWaterMark:h,getDefaultHighWaterMark:c,setDefaultHighWaterMark:g},$o}var Ho={},Ri={exports:{}};var dl;function Op(){return dl||(dl=1,(function(t,e){var r=xr(),n=r.Buffer;function s(l,c){for(var g in l)c[g]=l[g]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(s(r,e),e.Buffer=a);function a(l,c,g){return n(l,c,g)}a.prototype=Object.create(n.prototype),s(n,a),a.from=function(l,c,g){if(typeof l=="number")throw new TypeError("Argument must not be a number");return n(l,c,g)},a.alloc=function(l,c,g){if(typeof l!="number")throw new TypeError("Argument must be a number");var h=n(l);return c!==void 0?typeof g=="string"?h.fill(c,g):h.fill(c):h.fill(0),h},a.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return n(l)},a.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(l)}})(Ri,Ri.exports)),Ri.exports}var fl;function Up(){if(fl)return Ho;fl=1;var t=Op().Buffer,e=t.isEncoding||function(b){switch(b=""+b,b&&b.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(b){if(!b)return"utf8";for(var A;;)switch(b){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return b;default:if(A)return;b=(""+b).toLowerCase(),A=!0}}function n(b){var A=r(b);if(typeof A!="string"&&(t.isEncoding===e||!e(b)))throw new Error("Unknown encoding: "+b);return A||b}Ho.StringDecoder=s;function s(b){this.encoding=n(b);var A;switch(this.encoding){case"utf16le":this.text=f,this.end=_,A=4;break;case"utf8":this.fillLast=g,A=4;break;case"base64":this.text=x,this.end=S,A=3;break;default:this.write=I,this.end=F;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(A)}s.prototype.write=function(b){if(b.length===0)return"";var A,T;if(this.lastNeed){if(A=this.fillLast(b),A===void 0)return"";T=this.lastNeed,this.lastNeed=0}else T=0;return T<b.length?A?A+this.text(b,T):this.text(b,T):A||""},s.prototype.end=p,s.prototype.text=h,s.prototype.fillLast=function(b){if(this.lastNeed<=b.length)return b.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);b.copy(this.lastChar,this.lastTotal-this.lastNeed,0,b.length),this.lastNeed-=b.length};function a(b){return b<=127?0:b>>5===6?2:b>>4===14?3:b>>3===30?4:b>>6===2?-1:-2}function l(b,A,T){var P=A.length-1;if(P<T)return 0;var D=a(A[P]);return D>=0?(D>0&&(b.lastNeed=D-1),D):--P<T||D===-2?0:(D=a(A[P]),D>=0?(D>0&&(b.lastNeed=D-2),D):--P<T||D===-2?0:(D=a(A[P]),D>=0?(D>0&&(D===2?D=0:b.lastNeed=D-3),D):0))}function c(b,A,T){if((A[0]&192)!==128)return b.lastNeed=0,"";if(b.lastNeed>1&&A.length>1){if((A[1]&192)!==128)return b.lastNeed=1,"";if(b.lastNeed>2&&A.length>2&&(A[2]&192)!==128)return b.lastNeed=2,""}}function g(b){var A=this.lastTotal-this.lastNeed,T=c(this,b);if(T!==void 0)return T;if(this.lastNeed<=b.length)return b.copy(this.lastChar,A,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);b.copy(this.lastChar,A,0,b.length),this.lastNeed-=b.length}function h(b,A){var T=l(this,b,A);if(!this.lastNeed)return b.toString("utf8",A);this.lastTotal=T;var P=b.length-(T-this.lastNeed);return b.copy(this.lastChar,0,P),b.toString("utf8",A,P)}function p(b){var A=b&&b.length?this.write(b):"";return this.lastNeed?A+"":A}function f(b,A){if((b.length-A)%2===0){var T=b.toString("utf16le",A);if(T){var P=T.charCodeAt(T.length-1);if(P>=55296&&P<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=b[b.length-2],this.lastChar[1]=b[b.length-1],T.slice(0,-1)}return T}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=b[b.length-1],b.toString("utf16le",A,b.length-1)}function _(b){var A=b&&b.length?this.write(b):"";if(this.lastNeed){var T=this.lastTotal-this.lastNeed;return A+this.lastChar.toString("utf16le",0,T)}return A}function x(b,A){var T=(b.length-A)%3;return T===0?b.toString("base64",A):(this.lastNeed=3-T,this.lastTotal=3,T===1?this.lastChar[0]=b[b.length-1]:(this.lastChar[0]=b[b.length-2],this.lastChar[1]=b[b.length-1]),b.toString("base64",A,b.length-T))}function S(b){var A=b&&b.length?this.write(b):"";return this.lastNeed?A+this.lastChar.toString("base64",0,3-this.lastNeed):A}function I(b){return b.toString(this.encoding)}function F(b){return b&&b.length?this.write(b):""}return Ho}var Vo,pl;function Qu(){if(pl)return Vo;pl=1;const t=tn(),{PromisePrototypeThen:e,SymbolAsyncIterator:r,SymbolIterator:n}=gt(),{Buffer:s}=xr(),{ERR_INVALID_ARG_TYPE:a,ERR_STREAM_NULL_VALUES:l}=jt().codes;function c(g,h,p){let f;if(typeof h=="string"||h instanceof s)return new g({objectMode:!0,...p,read(){this.push(h),this.push(null)}});let _;if(h&&h[r])_=!0,f=h[r]();else if(h&&h[n])_=!1,f=h[n]();else throw new a("iterable",["Iterable"],h);const x=new g({objectMode:!0,highWaterMark:1,...p});let S=!1;x._read=function(){S||(S=!0,F())},x._destroy=function(b,A){e(I(b),()=>t.nextTick(A,b),T=>t.nextTick(A,T||b))};async function I(b){const A=b!=null,T=typeof f.throw=="function";if(A&&T){const{value:P,done:D}=await f.throw(b);if(await P,D)return}if(typeof f.return=="function"){const{value:P}=await f.return();await P}}async function F(){for(;;){try{const{value:b,done:A}=_?await f.next():f.next();if(A)x.push(null);else{const T=b&&typeof b.then=="function"?await b:b;if(T===null)throw S=!1,new l;if(x.push(T))continue;S=!1}}catch(b){x.destroy(b)}break}}return x}return Vo=c,Vo}var Ko,gl;function to(){if(gl)return Ko;gl=1;const t=tn(),{ArrayPrototypeIndexOf:e,NumberIsInteger:r,NumberIsNaN:n,NumberParseInt:s,ObjectDefineProperties:a,ObjectKeys:l,ObjectSetPrototypeOf:c,Promise:g,SafeSet:h,SymbolAsyncDispose:p,SymbolAsyncIterator:f,Symbol:_}=gt();Ko=_e,_e.ReadableState=Fe;const{EventEmitter:x}=pi(),{Stream:S,prependListener:I}=Js(),{Buffer:F}=xr(),{addAbortSignal:b}=Zi(),A=Ur();let T=Wt().debuglog("stream",V=>{T=V});const P=Dp(),D=In(),{getHighWaterMark:j,getDefaultHighWaterMark:M}=eo(),{aggregateTwoErrors:ne,codes:{ERR_INVALID_ARG_TYPE:ce,ERR_METHOD_NOT_IMPLEMENTED:N,ERR_OUT_OF_RANGE:ee,ERR_STREAM_PUSH_AFTER_EOF:we,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:se},AbortError:Re}=jt(),{validateObject:Ne}=gi(),Ue=_("kPaused"),{StringDecoder:je}=Up(),me=Qu();c(_e.prototype,S.prototype),c(_e,S);const Ie=()=>{},{errorOrDestroy:G}=D,pe=1,Ce=2,xe=4,Be=8,He=16,ze=32,Ke=64,Ee=128,Ae=256,ke=512,q=1024,R=2048,m=4096,k=8192,B=16384,X=32768,ie=65536,ge=1<<17,re=1<<18;function ve(V){return{enumerable:!1,get(){return(this.state&V)!==0},set(Q){Q?this.state|=V:this.state&=~V}}}a(Fe.prototype,{objectMode:ve(pe),ended:ve(Ce),endEmitted:ve(xe),reading:ve(Be),constructed:ve(He),sync:ve(ze),needReadable:ve(Ke),emittedReadable:ve(Ee),readableListening:ve(Ae),resumeScheduled:ve(ke),errorEmitted:ve(q),emitClose:ve(R),autoDestroy:ve(m),destroyed:ve(k),closed:ve(B),closeEmitted:ve(X),multiAwaitDrain:ve(ie),readingMore:ve(ge),dataEmitted:ve(re)});function Fe(V,Q,Le){typeof Le!="boolean"&&(Le=Q instanceof _r()),this.state=R|m|He|ze,V&&V.objectMode&&(this.state|=pe),Le&&V&&V.readableObjectMode&&(this.state|=pe),this.highWaterMark=V?j(this,V,"readableHighWaterMark",Le):M(!1),this.buffer=new P,this.length=0,this.pipes=[],this.flowing=null,this[Ue]=null,V&&V.emitClose===!1&&(this.state&=~R),V&&V.autoDestroy===!1&&(this.state&=~m),this.errored=null,this.defaultEncoding=V&&V.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,V&&V.encoding&&(this.decoder=new je(V.encoding),this.encoding=V.encoding)}function _e(V){if(!(this instanceof _e))return new _e(V);const Q=this instanceof _r();this._readableState=new Fe(V,this,Q),V&&(typeof V.read=="function"&&(this._read=V.read),typeof V.destroy=="function"&&(this._destroy=V.destroy),typeof V.construct=="function"&&(this._construct=V.construct),V.signal&&!Q&&b(V.signal,this)),S.call(this,V),D.construct(this,()=>{this._readableState.needReadable&&ae(this,this._readableState)})}_e.prototype.destroy=D.destroy,_e.prototype._undestroy=D.undestroy,_e.prototype._destroy=function(V,Q){Q(V)},_e.prototype[x.captureRejectionSymbol]=function(V){this.destroy(V)},_e.prototype[p]=function(){let V;return this.destroyed||(V=this.readableEnded?null:new Re,this.destroy(V)),new g((Q,Le)=>A(this,De=>De&&De!==V?Le(De):Q(null)))},_e.prototype.push=function(V,Q){return Me(this,V,Q,!1)},_e.prototype.unshift=function(V,Q){return Me(this,V,Q,!0)};function Me(V,Q,Le,De){T("readableAddChunk",Q);const qe=V._readableState;let St;if((qe.state&pe)===0&&(typeof Q=="string"?(Le=Le||qe.defaultEncoding,qe.encoding!==Le&&(De&&qe.encoding?Q=F.from(Q,Le).toString(qe.encoding):(Q=F.from(Q,Le),Le=""))):Q instanceof F?Le="":S._isUint8Array(Q)?(Q=S._uint8ArrayToBuffer(Q),Le=""):Q!=null&&(St=new ce("chunk",["string","Buffer","Uint8Array"],Q))),St)G(V,St);else if(Q===null)qe.state&=~Be,w(V,qe);else if((qe.state&pe)!==0||Q&&Q.length>0)if(De)if((qe.state&xe)!==0)G(V,new se);else{if(qe.destroyed||qe.errored)return!1;et(V,qe,Q,!0)}else if(qe.ended)G(V,new we);else{if(qe.destroyed||qe.errored)return!1;qe.state&=~Be,qe.decoder&&!Le?(Q=qe.decoder.write(Q),qe.objectMode||Q.length!==0?et(V,qe,Q,!1):ae(V,qe)):et(V,qe,Q,!1)}else De||(qe.state&=~Be,ae(V,qe));return!qe.ended&&(qe.length<qe.highWaterMark||qe.length===0)}function et(V,Q,Le,De){Q.flowing&&Q.length===0&&!Q.sync&&V.listenerCount("data")>0?((Q.state&ie)!==0?Q.awaitDrainWriters.clear():Q.awaitDrainWriters=null,Q.dataEmitted=!0,V.emit("data",Le)):(Q.length+=Q.objectMode?1:Le.length,De?Q.buffer.unshift(Le):Q.buffer.push(Le),(Q.state&Ke)!==0&&E(V)),ae(V,Q)}_e.prototype.isPaused=function(){const V=this._readableState;return V[Ue]===!0||V.flowing===!1},_e.prototype.setEncoding=function(V){const Q=new je(V);this._readableState.decoder=Q,this._readableState.encoding=this._readableState.decoder.encoding;const Le=this._readableState.buffer;let De="";for(const qe of Le)De+=Q.write(qe);return Le.clear(),De!==""&&Le.push(De),this._readableState.length=De.length,this};const Oe=1073741824;function Je(V){if(V>Oe)throw new ee("size","<= 1GiB",V);return V--,V|=V>>>1,V|=V>>>2,V|=V>>>4,V|=V>>>8,V|=V>>>16,V++,V}function L(V,Q){return V<=0||Q.length===0&&Q.ended?0:(Q.state&pe)!==0?1:n(V)?Q.flowing&&Q.length?Q.buffer.first().length:Q.length:V<=Q.length?V:Q.ended?Q.length:0}_e.prototype.read=function(V){T("read",V),V===void 0?V=NaN:r(V)||(V=s(V,10));const Q=this._readableState,Le=V;if(V>Q.highWaterMark&&(Q.highWaterMark=Je(V)),V!==0&&(Q.state&=~Ee),V===0&&Q.needReadable&&((Q.highWaterMark!==0?Q.length>=Q.highWaterMark:Q.length>0)||Q.ended))return T("read: emitReadable",Q.length,Q.ended),Q.length===0&&Q.ended?Br(this):E(this),null;if(V=L(V,Q),V===0&&Q.ended)return Q.length===0&&Br(this),null;let De=(Q.state&Ke)!==0;if(T("need readable",De),(Q.length===0||Q.length-V<Q.highWaterMark)&&(De=!0,T("length less than watermark",De)),Q.ended||Q.reading||Q.destroyed||Q.errored||!Q.constructed)De=!1,T("reading, ended or constructing",De);else if(De){T("do read"),Q.state|=Be|ze,Q.length===0&&(Q.state|=Ke);try{this._read(Q.highWaterMark)}catch(St){G(this,St)}Q.state&=~ze,Q.reading||(V=L(Le,Q))}let qe;return V>0?qe=it(V,Q):qe=null,qe===null?(Q.needReadable=Q.length<=Q.highWaterMark,V=0):(Q.length-=V,Q.multiAwaitDrain?Q.awaitDrainWriters.clear():Q.awaitDrainWriters=null),Q.length===0&&(Q.ended||(Q.needReadable=!0),Le!==V&&Q.ended&&Br(this)),qe!==null&&!Q.errorEmitted&&!Q.closeEmitted&&(Q.dataEmitted=!0,this.emit("data",qe)),qe};function w(V,Q){if(T("onEofChunk"),!Q.ended){if(Q.decoder){const Le=Q.decoder.end();Le&&Le.length&&(Q.buffer.push(Le),Q.length+=Q.objectMode?1:Le.length)}Q.ended=!0,Q.sync?E(V):(Q.needReadable=!1,Q.emittedReadable=!0,v(V))}}function E(V){const Q=V._readableState;T("emitReadable",Q.needReadable,Q.emittedReadable),Q.needReadable=!1,Q.emittedReadable||(T("emitReadable",Q.flowing),Q.emittedReadable=!0,t.nextTick(v,V))}function v(V){const Q=V._readableState;T("emitReadable_",Q.destroyed,Q.length,Q.ended),!Q.destroyed&&!Q.errored&&(Q.length||Q.ended)&&(V.emit("readable"),Q.emittedReadable=!1),Q.needReadable=!Q.flowing&&!Q.ended&&Q.length<=Q.highWaterMark,Xe(V)}function ae(V,Q){!Q.readingMore&&Q.constructed&&(Q.readingMore=!0,t.nextTick(he,V,Q))}function he(V,Q){for(;!Q.reading&&!Q.ended&&(Q.length<Q.highWaterMark||Q.flowing&&Q.length===0);){const Le=Q.length;if(T("maybeReadMore read 0"),V.read(0),Le===Q.length)break}Q.readingMore=!1}_e.prototype._read=function(V){throw new N("_read()")},_e.prototype.pipe=function(V,Q){const Le=this,De=this._readableState;De.pipes.length===1&&(De.multiAwaitDrain||(De.multiAwaitDrain=!0,De.awaitDrainWriters=new h(De.awaitDrainWriters?[De.awaitDrainWriters]:[]))),De.pipes.push(V),T("pipe count=%d opts=%j",De.pipes.length,Q);const St=(!Q||Q.end!==!1)&&V!==t.stdout&&V!==t.stderr?Mr:ot;De.endEmitted?t.nextTick(St):Le.once("end",St),V.on("unpipe",Ft);function Ft(st,Yt){T("onunpipe"),st===Le&&Yt&&Yt.hasUnpiped===!1&&(Yt.hasUnpiped=!0,Ln())}function Mr(){T("onend"),V.end()}let ar,Nn=!1;function Ln(){T("cleanup"),V.removeListener("close",$r),V.removeListener("finish",on),ar&&V.removeListener("drain",ar),V.removeListener("error",nn),V.removeListener("unpipe",Ft),Le.removeListener("end",Mr),Le.removeListener("end",ot),Le.removeListener("data",jr),Nn=!0,ar&&De.awaitDrainWriters&&(!V._writableState||V._writableState.needDrain)&&ar()}function Dn(){Nn||(De.pipes.length===1&&De.pipes[0]===V?(T("false write response, pause",0),De.awaitDrainWriters=V,De.multiAwaitDrain=!1):De.pipes.length>1&&De.pipes.includes(V)&&(T("false write response, pause",De.awaitDrainWriters.size),De.awaitDrainWriters.add(V)),Le.pause()),ar||(ar=le(Le,V),V.on("drain",ar))}Le.on("data",jr);function jr(st){T("ondata");const Yt=V.write(st);T("dest.write",Yt),Yt===!1&&Dn()}function nn(st){if(T("onerror",st),ot(),V.removeListener("error",nn),V.listenerCount("error")===0){const Yt=V._writableState||V._readableState;Yt&&!Yt.errorEmitted?G(V,st):V.emit("error",st)}}I(V,"error",nn);function $r(){V.removeListener("finish",on),ot()}V.once("close",$r);function on(){T("onfinish"),V.removeListener("close",$r),ot()}V.once("finish",on);function ot(){T("unpipe"),Le.unpipe(V)}return V.emit("pipe",Le),V.writableNeedDrain===!0?Dn():De.flowing||(T("pipe resume"),Le.resume()),V};function le(V,Q){return function(){const De=V._readableState;De.awaitDrainWriters===Q?(T("pipeOnDrain",1),De.awaitDrainWriters=null):De.multiAwaitDrain&&(T("pipeOnDrain",De.awaitDrainWriters.size),De.awaitDrainWriters.delete(Q)),(!De.awaitDrainWriters||De.awaitDrainWriters.size===0)&&V.listenerCount("data")&&V.resume()}}_e.prototype.unpipe=function(V){const Q=this._readableState,Le={hasUnpiped:!1};if(Q.pipes.length===0)return this;if(!V){const qe=Q.pipes;Q.pipes=[],this.pause();for(let St=0;St<qe.length;St++)qe[St].emit("unpipe",this,{hasUnpiped:!1});return this}const De=e(Q.pipes,V);return De===-1?this:(Q.pipes.splice(De,1),Q.pipes.length===0&&this.pause(),V.emit("unpipe",this,Le),this)},_e.prototype.on=function(V,Q){const Le=S.prototype.on.call(this,V,Q),De=this._readableState;return V==="data"?(De.readableListening=this.listenerCount("readable")>0,De.flowing!==!1&&this.resume()):V==="readable"&&!De.endEmitted&&!De.readableListening&&(De.readableListening=De.needReadable=!0,De.flowing=!1,De.emittedReadable=!1,T("on readable",De.length,De.reading),De.length?E(this):De.reading||t.nextTick(at,this)),Le},_e.prototype.addListener=_e.prototype.on,_e.prototype.removeListener=function(V,Q){const Le=S.prototype.removeListener.call(this,V,Q);return V==="readable"&&t.nextTick(Ge,this),Le},_e.prototype.off=_e.prototype.removeListener,_e.prototype.removeAllListeners=function(V){const Q=S.prototype.removeAllListeners.apply(this,arguments);return(V==="readable"||V===void 0)&&t.nextTick(Ge,this),Q};function Ge(V){const Q=V._readableState;Q.readableListening=V.listenerCount("readable")>0,Q.resumeScheduled&&Q[Ue]===!1?Q.flowing=!0:V.listenerCount("data")>0?V.resume():Q.readableListening||(Q.flowing=null)}function at(V){T("readable nexttick read 0"),V.read(0)}_e.prototype.resume=function(){const V=this._readableState;return V.flowing||(T("resume"),V.flowing=!V.readableListening,tt(this,V)),V[Ue]=!1,this};function tt(V,Q){Q.resumeScheduled||(Q.resumeScheduled=!0,t.nextTick(Ze,V,Q))}function Ze(V,Q){T("resume",Q.reading),Q.reading||V.read(0),Q.resumeScheduled=!1,V.emit("resume"),Xe(V),Q.flowing&&!Q.reading&&V.read(0)}_e.prototype.pause=function(){return T("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(T("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[Ue]=!0,this};function Xe(V){const Q=V._readableState;for(T("flow",Q.flowing);Q.flowing&&V.read()!==null;);}_e.prototype.wrap=function(V){let Q=!1;V.on("data",De=>{!this.push(De)&&V.pause&&(Q=!0,V.pause())}),V.on("end",()=>{this.push(null)}),V.on("error",De=>{G(this,De)}),V.on("close",()=>{this.destroy()}),V.on("destroy",()=>{this.destroy()}),this._read=()=>{Q&&V.resume&&(Q=!1,V.resume())};const Le=l(V);for(let De=1;De<Le.length;De++){const qe=Le[De];this[qe]===void 0&&typeof V[qe]=="function"&&(this[qe]=V[qe].bind(V))}return this},_e.prototype[f]=function(){return Rr(this)},_e.prototype.iterator=function(V){return V!==void 0&&Ne(V,"options"),Rr(this,V)};function Rr(V,Q){typeof V.read!="function"&&(V=_e.wrap(V,{objectMode:!0}));const Le=wt(V,Q);return Le.stream=V,Le}async function*wt(V,Q){let Le=Ie;function De(Ft){this===V?(Le(),Le=Ie):Le=Ft}V.on("readable",De);let qe;const St=A(V,{writable:!1},Ft=>{qe=Ft?ne(qe,Ft):null,Le(),Le=Ie});try{for(;;){const Ft=V.destroyed?null:V.read();if(Ft!==null)yield Ft;else{if(qe)throw qe;if(qe===null)return;await new g(De)}}}catch(Ft){throw qe=ne(qe,Ft),qe}finally{(qe||Q?.destroyOnReturn!==!1)&&(qe===void 0||V._readableState.autoDestroy)?D.destroyer(V,null):(V.off("readable",De),St())}}a(_e.prototype,{readable:{__proto__:null,get(){const V=this._readableState;return!!V&&V.readable!==!1&&!V.destroyed&&!V.errorEmitted&&!V.endEmitted},set(V){this._readableState&&(this._readableState.readable=!!V)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(V){this._readableState&&(this._readableState.flowing=V)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(V){this._readableState&&(this._readableState.destroyed=V)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),a(Fe.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[Ue]!==!1},set(V){this[Ue]=!!V}}}),_e._fromList=it;function it(V,Q){if(Q.length===0)return null;let Le;return Q.objectMode?Le=Q.buffer.shift():!V||V>=Q.length?(Q.decoder?Le=Q.buffer.join(""):Q.buffer.length===1?Le=Q.buffer.first():Le=Q.buffer.concat(Q.length),Q.buffer.clear()):Le=Q.buffer.consume(V,Q.decoder),Le}function Br(V){const Q=V._readableState;T("endReadable",Q.endEmitted),Q.endEmitted||(Q.ended=!0,t.nextTick(vt,Q,V))}function vt(V,Q){if(T("endReadableNT",V.endEmitted,V.length),!V.errored&&!V.closeEmitted&&!V.endEmitted&&V.length===0){if(V.endEmitted=!0,Q.emit("end"),Q.writable&&Q.allowHalfOpen===!1)t.nextTick($t,Q);else if(V.autoDestroy){const Le=Q._writableState;(!Le||Le.autoDestroy&&(Le.finished||Le.writable===!1))&&Q.destroy()}}}function $t(V){V.writable&&!V.writableEnded&&!V.destroyed&&V.end()}_e.from=function(V,Q){return me(_e,V,Q)};let Ht;function Pn(){return Ht===void 0&&(Ht={}),Ht}return _e.fromWeb=function(V,Q){return Pn().newStreamReadableFromReadableStream(V,Q)},_e.toWeb=function(V,Q){return Pn().newReadableStreamFromStreamReadable(V,Q)},_e.wrap=function(V,Q){var Le,De;return new _e({objectMode:(Le=(De=V.readableObjectMode)!==null&&De!==void 0?De:V.objectMode)!==null&&Le!==void 0?Le:!0,...Q,destroy(qe,St){D.destroyer(V,qe),St(qe)}}).wrap(V)},Ko}var qo,ml;function Gs(){if(ml)return qo;ml=1;const t=tn(),{ArrayPrototypeSlice:e,Error:r,FunctionPrototypeSymbolHasInstance:n,ObjectDefineProperty:s,ObjectDefineProperties:a,ObjectSetPrototypeOf:l,StringPrototypeToLowerCase:c,Symbol:g,SymbolHasInstance:h}=gt();qo=Ne,Ne.WritableState=se;const{EventEmitter:p}=pi(),f=Js().Stream,{Buffer:_}=xr(),x=In(),{addAbortSignal:S}=Zi(),{getHighWaterMark:I,getDefaultHighWaterMark:F}=eo(),{ERR_INVALID_ARG_TYPE:b,ERR_METHOD_NOT_IMPLEMENTED:A,ERR_MULTIPLE_CALLBACK:T,ERR_STREAM_CANNOT_PIPE:P,ERR_STREAM_DESTROYED:D,ERR_STREAM_ALREADY_FINISHED:j,ERR_STREAM_NULL_VALUES:M,ERR_STREAM_WRITE_AFTER_END:ne,ERR_UNKNOWN_ENCODING:ce}=jt().codes,{errorOrDestroy:N}=x;l(Ne.prototype,f.prototype),l(Ne,f);function ee(){}const we=g("kOnFinished");function se(m,k,B){typeof B!="boolean"&&(B=k instanceof _r()),this.objectMode=!!(m&&m.objectMode),B&&(this.objectMode=this.objectMode||!!(m&&m.writableObjectMode)),this.highWaterMark=m?I(this,m,"writableHighWaterMark",B):F(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const X=!!(m&&m.decodeStrings===!1);this.decodeStrings=!X,this.defaultEncoding=m&&m.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=G.bind(void 0,k),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,Re(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!m||m.emitClose!==!1,this.autoDestroy=!m||m.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[we]=[]}function Re(m){m.buffered=[],m.bufferedIndex=0,m.allBuffers=!0,m.allNoop=!0}se.prototype.getBuffer=function(){return e(this.buffered,this.bufferedIndex)},s(se.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function Ne(m){const k=this instanceof _r();if(!k&&!n(Ne,this))return new Ne(m);this._writableState=new se(m,this,k),m&&(typeof m.write=="function"&&(this._write=m.write),typeof m.writev=="function"&&(this._writev=m.writev),typeof m.destroy=="function"&&(this._destroy=m.destroy),typeof m.final=="function"&&(this._final=m.final),typeof m.construct=="function"&&(this._construct=m.construct),m.signal&&S(m.signal,this)),f.call(this,m),x.construct(this,()=>{const B=this._writableState;B.writing||Be(this,B),Ee(this,B)})}s(Ne,h,{__proto__:null,value:function(m){return n(this,m)?!0:this!==Ne?!1:m&&m._writableState instanceof se}}),Ne.prototype.pipe=function(){N(this,new P)};function Ue(m,k,B,X){const ie=m._writableState;if(typeof B=="function")X=B,B=ie.defaultEncoding;else{if(!B)B=ie.defaultEncoding;else if(B!=="buffer"&&!_.isEncoding(B))throw new ce(B);typeof X!="function"&&(X=ee)}if(k===null)throw new M;if(!ie.objectMode)if(typeof k=="string")ie.decodeStrings!==!1&&(k=_.from(k,B),B="buffer");else if(k instanceof _)B="buffer";else if(f._isUint8Array(k))k=f._uint8ArrayToBuffer(k),B="buffer";else throw new b("chunk",["string","Buffer","Uint8Array"],k);let ge;return ie.ending?ge=new ne:ie.destroyed&&(ge=new D("write")),ge?(t.nextTick(X,ge),N(m,ge,!0),ge):(ie.pendingcb++,je(m,ie,k,B,X))}Ne.prototype.write=function(m,k,B){return Ue(this,m,k,B)===!0},Ne.prototype.cork=function(){this._writableState.corked++},Ne.prototype.uncork=function(){const m=this._writableState;m.corked&&(m.corked--,m.writing||Be(this,m))},Ne.prototype.setDefaultEncoding=function(k){if(typeof k=="string"&&(k=c(k)),!_.isEncoding(k))throw new ce(k);return this._writableState.defaultEncoding=k,this};function je(m,k,B,X,ie){const ge=k.objectMode?1:B.length;k.length+=ge;const re=k.length<k.highWaterMark;return re||(k.needDrain=!0),k.writing||k.corked||k.errored||!k.constructed?(k.buffered.push({chunk:B,encoding:X,callback:ie}),k.allBuffers&&X!=="buffer"&&(k.allBuffers=!1),k.allNoop&&ie!==ee&&(k.allNoop=!1)):(k.writelen=ge,k.writecb=ie,k.writing=!0,k.sync=!0,m._write(B,X,k.onwrite),k.sync=!1),re&&!k.errored&&!k.destroyed}function me(m,k,B,X,ie,ge,re){k.writelen=X,k.writecb=re,k.writing=!0,k.sync=!0,k.destroyed?k.onwrite(new D("write")):B?m._writev(ie,k.onwrite):m._write(ie,ge,k.onwrite),k.sync=!1}function Ie(m,k,B,X){--k.pendingcb,X(B),xe(k),N(m,B)}function G(m,k){const B=m._writableState,X=B.sync,ie=B.writecb;if(typeof ie!="function"){N(m,new T);return}B.writing=!1,B.writecb=null,B.length-=B.writelen,B.writelen=0,k?(k.stack,B.errored||(B.errored=k),m._readableState&&!m._readableState.errored&&(m._readableState.errored=k),X?t.nextTick(Ie,m,B,k,ie):Ie(m,B,k,ie)):(B.buffered.length>B.bufferedIndex&&Be(m,B),X?B.afterWriteTickInfo!==null&&B.afterWriteTickInfo.cb===ie?B.afterWriteTickInfo.count++:(B.afterWriteTickInfo={count:1,cb:ie,stream:m,state:B},t.nextTick(pe,B.afterWriteTickInfo)):Ce(m,B,1,ie))}function pe({stream:m,state:k,count:B,cb:X}){return k.afterWriteTickInfo=null,Ce(m,k,B,X)}function Ce(m,k,B,X){for(!k.ending&&!m.destroyed&&k.length===0&&k.needDrain&&(k.needDrain=!1,m.emit("drain"));B-- >0;)k.pendingcb--,X();k.destroyed&&xe(k),Ee(m,k)}function xe(m){if(m.writing)return;for(let ie=m.bufferedIndex;ie<m.buffered.length;++ie){var k;const{chunk:ge,callback:re}=m.buffered[ie],ve=m.objectMode?1:ge.length;m.length-=ve,re((k=m.errored)!==null&&k!==void 0?k:new D("write"))}const B=m[we].splice(0);for(let ie=0;ie<B.length;ie++){var X;B[ie]((X=m.errored)!==null&&X!==void 0?X:new D("end"))}Re(m)}function Be(m,k){if(k.corked||k.bufferProcessing||k.destroyed||!k.constructed)return;const{buffered:B,bufferedIndex:X,objectMode:ie}=k,ge=B.length-X;if(!ge)return;let re=X;if(k.bufferProcessing=!0,ge>1&&m._writev){k.pendingcb-=ge-1;const ve=k.allNoop?ee:_e=>{for(let Me=re;Me<B.length;++Me)B[Me].callback(_e)},Fe=k.allNoop&&re===0?B:e(B,re);Fe.allBuffers=k.allBuffers,me(m,k,!0,k.length,Fe,"",ve),Re(k)}else{do{const{chunk:ve,encoding:Fe,callback:_e}=B[re];B[re++]=null;const Me=ie?1:ve.length;me(m,k,!1,Me,ve,Fe,_e)}while(re<B.length&&!k.writing);re===B.length?Re(k):re>256?(B.splice(0,re),k.bufferedIndex=0):k.bufferedIndex=re}k.bufferProcessing=!1}Ne.prototype._write=function(m,k,B){if(this._writev)this._writev([{chunk:m,encoding:k}],B);else throw new A("_write()")},Ne.prototype._writev=null,Ne.prototype.end=function(m,k,B){const X=this._writableState;typeof m=="function"?(B=m,m=null,k=null):typeof k=="function"&&(B=k,k=null);let ie;if(m!=null){const ge=Ue(this,m,k);ge instanceof r&&(ie=ge)}return X.corked&&(X.corked=1,this.uncork()),ie||(!X.errored&&!X.ending?(X.ending=!0,Ee(this,X,!0),X.ended=!0):X.finished?ie=new j("end"):X.destroyed&&(ie=new D("end"))),typeof B=="function"&&(ie||X.finished?t.nextTick(B,ie):X[we].push(B)),this};function He(m){return m.ending&&!m.destroyed&&m.constructed&&m.length===0&&!m.errored&&m.buffered.length===0&&!m.finished&&!m.writing&&!m.errorEmitted&&!m.closeEmitted}function ze(m,k){let B=!1;function X(ie){if(B){N(m,ie??T());return}if(B=!0,k.pendingcb--,ie){const ge=k[we].splice(0);for(let re=0;re<ge.length;re++)ge[re](ie);N(m,ie,k.sync)}else He(k)&&(k.prefinished=!0,m.emit("prefinish"),k.pendingcb++,t.nextTick(Ae,m,k))}k.sync=!0,k.pendingcb++;try{m._final(X)}catch(ie){X(ie)}k.sync=!1}function Ke(m,k){!k.prefinished&&!k.finalCalled&&(typeof m._final=="function"&&!k.destroyed?(k.finalCalled=!0,ze(m,k)):(k.prefinished=!0,m.emit("prefinish")))}function Ee(m,k,B){He(k)&&(Ke(m,k),k.pendingcb===0&&(B?(k.pendingcb++,t.nextTick((X,ie)=>{He(ie)?Ae(X,ie):ie.pendingcb--},m,k)):He(k)&&(k.pendingcb++,Ae(m,k))))}function Ae(m,k){k.pendingcb--,k.finished=!0;const B=k[we].splice(0);for(let X=0;X<B.length;X++)B[X]();if(m.emit("finish"),k.autoDestroy){const X=m._readableState;(!X||X.autoDestroy&&(X.endEmitted||X.readable===!1))&&m.destroy()}}a(Ne.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(m){this._writableState&&(this._writableState.destroyed=m)}},writable:{__proto__:null,get(){const m=this._writableState;return!!m&&m.writable!==!1&&!m.destroyed&&!m.errored&&!m.ending&&!m.ended},set(m){this._writableState&&(this._writableState.writable=!!m)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const m=this._writableState;return m?!m.destroyed&&!m.ending&&m.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const ke=x.destroy;Ne.prototype.destroy=function(m,k){const B=this._writableState;return!B.destroyed&&(B.bufferedIndex<B.buffered.length||B[we].length)&&t.nextTick(xe,B),ke.call(this,m,k),this},Ne.prototype._undestroy=x.undestroy,Ne.prototype._destroy=function(m,k){k(m)},Ne.prototype[p.captureRejectionSymbol]=function(m){this.destroy(m)};let q;function R(){return q===void 0&&(q={}),q}return Ne.fromWeb=function(m,k){return R().newStreamWritableFromWritableStream(m,k)},Ne.toWeb=function(m){return R().newWritableStreamFromStreamWritable(m)},qo}var Wo,yl;function Bp(){if(yl)return Wo;yl=1;const t=tn(),e=xr(),{isReadable:r,isWritable:n,isIterable:s,isNodeStream:a,isReadableNodeStream:l,isWritableNodeStream:c,isDuplexNodeStream:g,isReadableStream:h,isWritableStream:p}=Ar(),f=Ur(),{AbortError:_,codes:{ERR_INVALID_ARG_TYPE:x,ERR_INVALID_RETURN_VALUE:S}}=jt(),{destroyer:I}=In(),F=_r(),b=to(),A=Gs(),{createDeferredPromise:T}=Wt(),P=Qu(),D=globalThis.Blob||e.Blob,j=typeof D<"u"?function(se){return se instanceof D}:function(se){return!1},M=globalThis.AbortController||ci().AbortController,{FunctionPrototypeCall:ne}=gt();class ce extends F{constructor(se){super(se),se?.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),se?.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}Wo=function we(se,Re){if(g(se))return se;if(l(se))return ee({readable:se});if(c(se))return ee({writable:se});if(a(se))return ee({writable:!1,readable:!1});if(h(se))return ee({readable:b.fromWeb(se)});if(p(se))return ee({writable:A.fromWeb(se)});if(typeof se=="function"){const{value:Ue,write:je,final:me,destroy:Ie}=N(se);if(s(Ue))return P(ce,Ue,{objectMode:!0,write:je,final:me,destroy:Ie});const G=Ue?.then;if(typeof G=="function"){let pe;const Ce=ne(G,Ue,xe=>{if(xe!=null)throw new S("nully","body",xe)},xe=>{I(pe,xe)});return pe=new ce({objectMode:!0,readable:!1,write:je,final(xe){me(async()=>{try{await Ce,t.nextTick(xe,null)}catch(Be){t.nextTick(xe,Be)}})},destroy:Ie})}throw new S("Iterable, AsyncIterable or AsyncFunction",Re,Ue)}if(j(se))return we(se.arrayBuffer());if(s(se))return P(ce,se,{objectMode:!0,writable:!1});if(h(se?.readable)&&p(se?.writable))return ce.fromWeb(se);if(typeof se?.writable=="object"||typeof se?.readable=="object"){const Ue=se!=null&&se.readable?l(se?.readable)?se?.readable:we(se.readable):void 0,je=se!=null&&se.writable?c(se?.writable)?se?.writable:we(se.writable):void 0;return ee({readable:Ue,writable:je})}const Ne=se?.then;if(typeof Ne=="function"){let Ue;return ne(Ne,se,je=>{je!=null&&Ue.push(je),Ue.push(null)},je=>{I(Ue,je)}),Ue=new ce({objectMode:!0,writable:!1,read(){}})}throw new x(Re,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],se)};function N(we){let{promise:se,resolve:Re}=T();const Ne=new M,Ue=Ne.signal;return{value:we((async function*(){for(;;){const me=se;se=null;const{chunk:Ie,done:G,cb:pe}=await me;if(t.nextTick(pe),G)return;if(Ue.aborted)throw new _(void 0,{cause:Ue.reason});({promise:se,resolve:Re}=T()),yield Ie}})(),{signal:Ue}),write(me,Ie,G){const pe=Re;Re=null,pe({chunk:me,done:!1,cb:G})},final(me){const Ie=Re;Re=null,Ie({done:!0,cb:me})},destroy(me,Ie){Ne.abort(),Ie(me)}}}function ee(we){const se=we.readable&&typeof we.readable.read!="function"?b.wrap(we.readable):we.readable,Re=we.writable;let Ne=!!r(se),Ue=!!n(Re),je,me,Ie,G,pe;function Ce(xe){const Be=G;G=null,Be?Be(xe):xe&&pe.destroy(xe)}return pe=new ce({readableObjectMode:!!(se!=null&&se.readableObjectMode),writableObjectMode:!!(Re!=null&&Re.writableObjectMode),readable:Ne,writable:Ue}),Ue&&(f(Re,xe=>{Ue=!1,xe&&I(se,xe),Ce(xe)}),pe._write=function(xe,Be,He){Re.write(xe,Be)?He():je=He},pe._final=function(xe){Re.end(),me=xe},Re.on("drain",function(){if(je){const xe=je;je=null,xe()}}),Re.on("finish",function(){if(me){const xe=me;me=null,xe()}})),Ne&&(f(se,xe=>{Ne=!1,xe&&I(se,xe),Ce(xe)}),se.on("readable",function(){if(Ie){const xe=Ie;Ie=null,xe()}}),se.on("end",function(){pe.push(null)}),pe._read=function(){for(;;){const xe=se.read();if(xe===null){Ie=pe._read;return}if(!pe.push(xe))return}}),pe._destroy=function(xe,Be){!xe&&G!==null&&(xe=new _),Ie=null,je=null,me=null,G===null?Be(xe):(G=Be,I(Re,xe),I(se,xe))},pe}return Wo}var zo,wl;function _r(){if(wl)return zo;wl=1;const{ObjectDefineProperties:t,ObjectGetOwnPropertyDescriptor:e,ObjectKeys:r,ObjectSetPrototypeOf:n}=gt();zo=l;const s=to(),a=Gs();n(l.prototype,s.prototype),n(l,s);{const p=r(a.prototype);for(let f=0;f<p.length;f++){const _=p[f];l.prototype[_]||(l.prototype[_]=a.prototype[_])}}function l(p){if(!(this instanceof l))return new l(p);s.call(this,p),a.call(this,p),p?(this.allowHalfOpen=p.allowHalfOpen!==!1,p.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),p.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}t(l.prototype,{writable:{__proto__:null,...e(a.prototype,"writable")},writableHighWaterMark:{__proto__:null,...e(a.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...e(a.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...e(a.prototype,"writableBuffer")},writableLength:{__proto__:null,...e(a.prototype,"writableLength")},writableFinished:{__proto__:null,...e(a.prototype,"writableFinished")},writableCorked:{__proto__:null,...e(a.prototype,"writableCorked")},writableEnded:{__proto__:null,...e(a.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...e(a.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(p){this._readableState&&this._writableState&&(this._readableState.destroyed=p,this._writableState.destroyed=p)}}});let c;function g(){return c===void 0&&(c={}),c}l.fromWeb=function(p,f){return g().newStreamDuplexFromReadableWritablePair(p,f)},l.toWeb=function(p){return g().newReadableWritablePairFromDuplex(p)};let h;return l.from=function(p){return h||(h=Bp()),h(p,"body")},zo}var Jo,vl;function Xu(){if(vl)return Jo;vl=1;const{ObjectSetPrototypeOf:t,Symbol:e}=gt();Jo=l;const{ERR_METHOD_NOT_IMPLEMENTED:r}=jt().codes,n=_r(),{getHighWaterMark:s}=eo();t(l.prototype,n.prototype),t(l,n);const a=e("kCallback");function l(h){if(!(this instanceof l))return new l(h);const p=h?s(this,h,"readableHighWaterMark",!0):null;p===0&&(h={...h,highWaterMark:null,readableHighWaterMark:p,writableHighWaterMark:h.writableHighWaterMark||0}),n.call(this,h),this._readableState.sync=!1,this[a]=null,h&&(typeof h.transform=="function"&&(this._transform=h.transform),typeof h.flush=="function"&&(this._flush=h.flush)),this.on("prefinish",g)}function c(h){typeof this._flush=="function"&&!this.destroyed?this._flush((p,f)=>{if(p){h?h(p):this.destroy(p);return}f!=null&&this.push(f),this.push(null),h&&h()}):(this.push(null),h&&h())}function g(){this._final!==c&&c.call(this)}return l.prototype._final=c,l.prototype._transform=function(h,p,f){throw new r("_transform()")},l.prototype._write=function(h,p,f){const _=this._readableState,x=this._writableState,S=_.length;this._transform(h,p,(I,F)=>{if(I){f(I);return}F!=null&&this.push(F),x.ended||S===_.length||_.length<_.highWaterMark?f():this[a]=f})},l.prototype._read=function(){if(this[a]){const h=this[a];this[a]=null,h()}},Jo}var Go,bl;function Zu(){if(bl)return Go;bl=1;const{ObjectSetPrototypeOf:t}=gt();Go=r;const e=Xu();t(r.prototype,e.prototype),t(r,e);function r(n){if(!(this instanceof r))return new r(n);e.call(this,n)}return r.prototype._transform=function(n,s,a){a(null,n)},Go}var Yo,_l;function Ys(){if(_l)return Yo;_l=1;const t=tn(),{ArrayIsArray:e,Promise:r,SymbolAsyncIterator:n,SymbolDispose:s}=gt(),a=Ur(),{once:l}=Wt(),c=In(),g=_r(),{aggregateTwoErrors:h,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:f,ERR_MISSING_ARGS:_,ERR_STREAM_DESTROYED:x,ERR_STREAM_PREMATURE_CLOSE:S},AbortError:I}=jt(),{validateFunction:F,validateAbortSignal:b}=gi(),{isIterable:A,isReadable:T,isReadableNodeStream:P,isNodeStream:D,isTransformStream:j,isWebStream:M,isReadableStream:ne,isReadableFinished:ce}=Ar(),N=globalThis.AbortController||ci().AbortController;let ee,we,se;function Re(xe,Be,He){let ze=!1;xe.on("close",()=>{ze=!0});const Ke=a(xe,{readable:Be,writable:He},Ee=>{ze=!Ee});return{destroy:Ee=>{ze||(ze=!0,c.destroyer(xe,Ee||new x("pipe")))},cleanup:Ke}}function Ne(xe){return F(xe[xe.length-1],"streams[stream.length - 1]"),xe.pop()}function Ue(xe){if(A(xe))return xe;if(P(xe))return je(xe);throw new p("val",["Readable","Iterable","AsyncIterable"],xe)}async function*je(xe){we||(we=to()),yield*we.prototype[n].call(xe)}async function me(xe,Be,He,{end:ze}){let Ke,Ee=null;const Ae=R=>{if(R&&(Ke=R),Ee){const m=Ee;Ee=null,m()}},ke=()=>new r((R,m)=>{Ke?m(Ke):Ee=()=>{Ke?m(Ke):R()}});Be.on("drain",Ae);const q=a(Be,{readable:!1},Ae);try{Be.writableNeedDrain&&await ke();for await(const R of xe)Be.write(R)||await ke();ze&&(Be.end(),await ke()),He()}catch(R){He(Ke!==R?h(Ke,R):R)}finally{q(),Be.off("drain",Ae)}}async function Ie(xe,Be,He,{end:ze}){j(Be)&&(Be=Be.writable);const Ke=Be.getWriter();try{for await(const Ee of xe)await Ke.ready,Ke.write(Ee).catch(()=>{});await Ke.ready,ze&&await Ke.close(),He()}catch(Ee){try{await Ke.abort(Ee),He(Ee)}catch(Ae){He(Ae)}}}function G(...xe){return pe(xe,l(Ne(xe)))}function pe(xe,Be,He){if(xe.length===1&&e(xe[0])&&(xe=xe[0]),xe.length<2)throw new _("streams");const ze=new N,Ke=ze.signal,Ee=He?.signal,Ae=[];b(Ee,"options.signal");function ke(){ie(new I)}se=se||Wt().addAbortListener;let q;Ee&&(q=se(Ee,ke));let R,m;const k=[];let B=0;function X(_e){ie(_e,--B===0)}function ie(_e,Me){var et;if(_e&&(!R||R.code==="ERR_STREAM_PREMATURE_CLOSE")&&(R=_e),!(!R&&!Me)){for(;k.length;)k.shift()(R);(et=q)===null||et===void 0||et[s](),ze.abort(),Me&&(R||Ae.forEach(Oe=>Oe()),t.nextTick(Be,R,m))}}let ge;for(let _e=0;_e<xe.length;_e++){const Me=xe[_e],et=_e<xe.length-1,Oe=_e>0,Je=et||He?.end!==!1,L=_e===xe.length-1;if(D(Me)){let w=function(E){E&&E.name!=="AbortError"&&E.code!=="ERR_STREAM_PREMATURE_CLOSE"&&X(E)};var Fe=w;if(Je){const{destroy:E,cleanup:v}=Re(Me,et,Oe);k.push(E),T(Me)&&L&&Ae.push(v)}Me.on("error",w),T(Me)&&L&&Ae.push(()=>{Me.removeListener("error",w)})}if(_e===0)if(typeof Me=="function"){if(ge=Me({signal:Ke}),!A(ge))throw new f("Iterable, AsyncIterable or Stream","source",ge)}else A(Me)||P(Me)||j(Me)?ge=Me:ge=g.from(Me);else if(typeof Me=="function"){if(j(ge)){var re;ge=Ue((re=ge)===null||re===void 0?void 0:re.readable)}else ge=Ue(ge);if(ge=Me(ge,{signal:Ke}),et){if(!A(ge,!0))throw new f("AsyncIterable",`transform[${_e-1}]`,ge)}else{var ve;ee||(ee=Zu());const w=new ee({objectMode:!0}),E=(ve=ge)===null||ve===void 0?void 0:ve.then;if(typeof E=="function")B++,E.call(ge,he=>{m=he,he!=null&&w.write(he),Je&&w.end(),t.nextTick(X)},he=>{w.destroy(he),t.nextTick(X,he)});else if(A(ge,!0))B++,me(ge,w,X,{end:Je});else if(ne(ge)||j(ge)){const he=ge.readable||ge;B++,me(he,w,X,{end:Je})}else throw new f("AsyncIterable or Promise","destination",ge);ge=w;const{destroy:v,cleanup:ae}=Re(ge,!1,!0);k.push(v),L&&Ae.push(ae)}}else if(D(Me)){if(P(ge)){B+=2;const w=Ce(ge,Me,X,{end:Je});T(Me)&&L&&Ae.push(w)}else if(j(ge)||ne(ge)){const w=ge.readable||ge;B++,me(w,Me,X,{end:Je})}else if(A(ge))B++,me(ge,Me,X,{end:Je});else throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ge);ge=Me}else if(M(Me)){if(P(ge))B++,Ie(Ue(ge),Me,X,{end:Je});else if(ne(ge)||A(ge))B++,Ie(ge,Me,X,{end:Je});else if(j(ge))B++,Ie(ge.readable,Me,X,{end:Je});else throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ge);ge=Me}else ge=g.from(Me)}return(Ke!=null&&Ke.aborted||Ee!=null&&Ee.aborted)&&t.nextTick(ke),ge}function Ce(xe,Be,He,{end:ze}){let Ke=!1;if(Be.on("close",()=>{Ke||He(new S)}),xe.pipe(Be,{end:!1}),ze){let Ae=function(){Ke=!0,Be.end()};var Ee=Ae;ce(xe)?t.nextTick(Ae):xe.once("end",Ae)}else He();return a(xe,{readable:!0,writable:!1},Ae=>{const ke=xe._readableState;Ae&&Ae.code==="ERR_STREAM_PREMATURE_CLOSE"&&ke&&ke.ended&&!ke.errored&&!ke.errorEmitted?xe.once("end",He).once("error",He):He(Ae)}),a(Be,{readable:!1,writable:!0},He)}return Yo={pipelineImpl:pe,pipeline:G},Yo}var Qo,Sl;function ec(){if(Sl)return Qo;Sl=1;const{pipeline:t}=Ys(),e=_r(),{destroyer:r}=In(),{isNodeStream:n,isReadable:s,isWritable:a,isWebStream:l,isTransformStream:c,isWritableStream:g,isReadableStream:h}=Ar(),{AbortError:p,codes:{ERR_INVALID_ARG_VALUE:f,ERR_MISSING_ARGS:_}}=jt(),x=Ur();return Qo=function(...I){if(I.length===0)throw new _("streams");if(I.length===1)return e.from(I[0]);const F=[...I];if(typeof I[0]=="function"&&(I[0]=e.from(I[0])),typeof I[I.length-1]=="function"){const ee=I.length-1;I[ee]=e.from(I[ee])}for(let ee=0;ee<I.length;++ee)if(!(!n(I[ee])&&!l(I[ee]))){if(ee<I.length-1&&!(s(I[ee])||h(I[ee])||c(I[ee])))throw new f(`streams[${ee}]`,F[ee],"must be readable");if(ee>0&&!(a(I[ee])||g(I[ee])||c(I[ee])))throw new f(`streams[${ee}]`,F[ee],"must be writable")}let b,A,T,P,D;function j(ee){const we=P;P=null,we?we(ee):ee?D.destroy(ee):!N&&!ce&&D.destroy()}const M=I[0],ne=t(I,j),ce=!!(a(M)||g(M)||c(M)),N=!!(s(ne)||h(ne)||c(ne));if(D=new e({writableObjectMode:!!(M!=null&&M.writableObjectMode),readableObjectMode:!!(ne!=null&&ne.readableObjectMode),writable:ce,readable:N}),ce){if(n(M))D._write=function(we,se,Re){M.write(we,se)?Re():b=Re},D._final=function(we){M.end(),A=we},M.on("drain",function(){if(b){const we=b;b=null,we()}});else if(l(M)){const se=(c(M)?M.writable:M).getWriter();D._write=async function(Re,Ne,Ue){try{await se.ready,se.write(Re).catch(()=>{}),Ue()}catch(je){Ue(je)}},D._final=async function(Re){try{await se.ready,se.close().catch(()=>{}),A=Re}catch(Ne){Re(Ne)}}}const ee=c(ne)?ne.readable:ne;x(ee,()=>{if(A){const we=A;A=null,we()}})}if(N){if(n(ne))ne.on("readable",function(){if(T){const ee=T;T=null,ee()}}),ne.on("end",function(){D.push(null)}),D._read=function(){for(;;){const ee=ne.read();if(ee===null){T=D._read;return}if(!D.push(ee))return}};else if(l(ne)){const we=(c(ne)?ne.readable:ne).getReader();D._read=async function(){for(;;)try{const{value:se,done:Re}=await we.read();if(!D.push(se))return;if(Re){D.push(null);return}}catch{return}}}}return D._destroy=function(ee,we){!ee&&P!==null&&(ee=new p),T=null,b=null,A=null,P===null?we(ee):(P=we,n(ne)&&r(ne,ee))},D},Qo}var El;function Mp(){if(El)return Ai;El=1;const t=globalThis.AbortController||ci().AbortController,{codes:{ERR_INVALID_ARG_VALUE:e,ERR_INVALID_ARG_TYPE:r,ERR_MISSING_ARGS:n,ERR_OUT_OF_RANGE:s},AbortError:a}=jt(),{validateAbortSignal:l,validateInteger:c,validateObject:g}=gi(),h=gt().Symbol("kWeak"),p=gt().Symbol("kResistStopPropagation"),{finished:f}=Ur(),_=ec(),{addAbortSignalNoValidate:x}=Zi(),{isWritable:S,isNodeStream:I}=Ar(),{deprecate:F}=Wt(),{ArrayPrototypePush:b,Boolean:A,MathFloor:T,Number:P,NumberIsNaN:D,Promise:j,PromiseReject:M,PromiseResolve:ne,PromisePrototypeThen:ce,Symbol:N}=gt(),ee=N("kEmpty"),we=N("kEof");function se(Ee,Ae){if(Ae!=null&&g(Ae,"options"),Ae?.signal!=null&&l(Ae.signal,"options.signal"),I(Ee)&&!S(Ee))throw new e("stream",Ee,"must be writable");const ke=_(this,Ee);return Ae!=null&&Ae.signal&&x(Ae.signal,ke),ke}function Re(Ee,Ae){if(typeof Ee!="function")throw new r("fn",["Function","AsyncFunction"],Ee);Ae!=null&&g(Ae,"options"),Ae?.signal!=null&&l(Ae.signal,"options.signal");let ke=1;Ae?.concurrency!=null&&(ke=T(Ae.concurrency));let q=ke-1;return Ae?.highWaterMark!=null&&(q=T(Ae.highWaterMark)),c(ke,"options.concurrency",1),c(q,"options.highWaterMark",0),q+=ke,(async function*(){const m=Wt().AbortSignalAny([Ae?.signal].filter(A)),k=this,B=[],X={signal:m};let ie,ge,re=!1,ve=0;function Fe(){re=!0,_e()}function _e(){ve-=1,Me()}function Me(){ge&&!re&&ve<ke&&B.length<q&&(ge(),ge=null)}async function et(){try{for await(let Oe of k){if(re)return;if(m.aborted)throw new a;try{if(Oe=Ee(Oe,X),Oe===ee)continue;Oe=ne(Oe)}catch(Je){Oe=M(Je)}ve+=1,ce(Oe,_e,Fe),B.push(Oe),ie&&(ie(),ie=null),!re&&(B.length>=q||ve>=ke)&&await new j(Je=>{ge=Je})}B.push(we)}catch(Oe){const Je=M(Oe);ce(Je,_e,Fe),B.push(Je)}finally{re=!0,ie&&(ie(),ie=null)}}et();try{for(;;){for(;B.length>0;){const Oe=await B[0];if(Oe===we)return;if(m.aborted)throw new a;Oe!==ee&&(yield Oe),B.shift(),Me()}await new j(Oe=>{ie=Oe})}}finally{re=!0,ge&&(ge(),ge=null)}}).call(this)}function Ne(Ee=void 0){return Ee!=null&&g(Ee,"options"),Ee?.signal!=null&&l(Ee.signal,"options.signal"),(async function*(){let ke=0;for await(const R of this){var q;if(Ee!=null&&(q=Ee.signal)!==null&&q!==void 0&&q.aborted)throw new a({cause:Ee.signal.reason});yield[ke++,R]}}).call(this)}async function Ue(Ee,Ae=void 0){for await(const ke of G.call(this,Ee,Ae))return!0;return!1}async function je(Ee,Ae=void 0){if(typeof Ee!="function")throw new r("fn",["Function","AsyncFunction"],Ee);return!await Ue.call(this,async(...ke)=>!await Ee(...ke),Ae)}async function me(Ee,Ae){for await(const ke of G.call(this,Ee,Ae))return ke}async function Ie(Ee,Ae){if(typeof Ee!="function")throw new r("fn",["Function","AsyncFunction"],Ee);async function ke(q,R){return await Ee(q,R),ee}for await(const q of Re.call(this,ke,Ae));}function G(Ee,Ae){if(typeof Ee!="function")throw new r("fn",["Function","AsyncFunction"],Ee);async function ke(q,R){return await Ee(q,R)?q:ee}return Re.call(this,ke,Ae)}class pe extends n{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function Ce(Ee,Ae,ke){var q;if(typeof Ee!="function")throw new r("reducer",["Function","AsyncFunction"],Ee);ke!=null&&g(ke,"options"),ke?.signal!=null&&l(ke.signal,"options.signal");let R=arguments.length>1;if(ke!=null&&(q=ke.signal)!==null&&q!==void 0&&q.aborted){const ie=new a(void 0,{cause:ke.signal.reason});throw this.once("error",()=>{}),await f(this.destroy(ie)),ie}const m=new t,k=m.signal;if(ke!=null&&ke.signal){const ie={once:!0,[h]:this,[p]:!0};ke.signal.addEventListener("abort",()=>m.abort(),ie)}let B=!1;try{for await(const ie of this){var X;if(B=!0,ke!=null&&(X=ke.signal)!==null&&X!==void 0&&X.aborted)throw new a;R?Ae=await Ee(Ae,ie,{signal:k}):(Ae=ie,R=!0)}if(!B&&!R)throw new pe}finally{m.abort()}return Ae}async function xe(Ee){Ee!=null&&g(Ee,"options"),Ee?.signal!=null&&l(Ee.signal,"options.signal");const Ae=[];for await(const q of this){var ke;if(Ee!=null&&(ke=Ee.signal)!==null&&ke!==void 0&&ke.aborted)throw new a(void 0,{cause:Ee.signal.reason});b(Ae,q)}return Ae}function Be(Ee,Ae){const ke=Re.call(this,Ee,Ae);return(async function*(){for await(const R of ke)yield*R}).call(this)}function He(Ee){if(Ee=P(Ee),D(Ee))return 0;if(Ee<0)throw new s("number",">= 0",Ee);return Ee}function ze(Ee,Ae=void 0){return Ae!=null&&g(Ae,"options"),Ae?.signal!=null&&l(Ae.signal,"options.signal"),Ee=He(Ee),(async function*(){var q;if(Ae!=null&&(q=Ae.signal)!==null&&q!==void 0&&q.aborted)throw new a;for await(const m of this){var R;if(Ae!=null&&(R=Ae.signal)!==null&&R!==void 0&&R.aborted)throw new a;Ee--<=0&&(yield m)}}).call(this)}function Ke(Ee,Ae=void 0){return Ae!=null&&g(Ae,"options"),Ae?.signal!=null&&l(Ae.signal,"options.signal"),Ee=He(Ee),(async function*(){var q;if(Ae!=null&&(q=Ae.signal)!==null&&q!==void 0&&q.aborted)throw new a;for await(const m of this){var R;if(Ae!=null&&(R=Ae.signal)!==null&&R!==void 0&&R.aborted)throw new a;if(Ee-- >0&&(yield m),Ee<=0)return}}).call(this)}return Ai.streamReturningOperators={asIndexedPairs:F(Ne,"readable.asIndexedPairs will be removed in a future version."),drop:ze,filter:G,flatMap:Be,map:Re,take:Ke,compose:se},Ai.promiseReturningOperators={every:je,forEach:Ie,reduce:Ce,toArray:xe,some:Ue,find:me},Ai}var Xo,xl;function tc(){if(xl)return Xo;xl=1;const{ArrayPrototypePop:t,Promise:e}=gt(),{isIterable:r,isNodeStream:n,isWebStream:s}=Ar(),{pipelineImpl:a}=Ys(),{finished:l}=Ur();rc();function c(...g){return new e((h,p)=>{let f,_;const x=g[g.length-1];if(x&&typeof x=="object"&&!n(x)&&!r(x)&&!s(x)){const S=t(g);f=S.signal,_=S.end}a(g,(S,I)=>{S?p(S):h(I)},{signal:f,end:_})})}return Xo={finished:l,pipeline:c},Xo}var Al;function rc(){if(Al)return To.exports;Al=1;const{Buffer:t}=xr(),{ObjectDefineProperty:e,ObjectKeys:r,ReflectApply:n}=gt(),{promisify:{custom:s}}=Wt(),{streamReturningOperators:a,promiseReturningOperators:l}=Mp(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:c}}=jt(),g=ec(),{setDefaultHighWaterMark:h,getDefaultHighWaterMark:p}=eo(),{pipeline:f}=Ys(),{destroyer:_}=In(),x=Ur(),S=tc(),I=Ar(),F=To.exports=Js().Stream;F.isDestroyed=I.isDestroyed,F.isDisturbed=I.isDisturbed,F.isErrored=I.isErrored,F.isReadable=I.isReadable,F.isWritable=I.isWritable,F.Readable=to();for(const T of r(a)){let D=function(...j){if(new.target)throw c();return F.Readable.from(n(P,this,j))};var A=D;const P=a[T];e(D,"name",{__proto__:null,value:P.name}),e(D,"length",{__proto__:null,value:P.length}),e(F.Readable.prototype,T,{__proto__:null,value:D,enumerable:!1,configurable:!0,writable:!0})}for(const T of r(l)){let D=function(...M){if(new.target)throw c();return n(P,this,M)};var A=D;const P=l[T];e(D,"name",{__proto__:null,value:P.name}),e(D,"length",{__proto__:null,value:P.length}),e(F.Readable.prototype,T,{__proto__:null,value:D,enumerable:!1,configurable:!0,writable:!0})}F.Writable=Gs(),F.Duplex=_r(),F.Transform=Xu(),F.PassThrough=Zu(),F.pipeline=f;const{addAbortSignal:b}=Zi();return F.addAbortSignal=b,F.finished=x,F.destroy=_,F.compose=g,F.setDefaultHighWaterMark=h,F.getDefaultHighWaterMark=p,e(F,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return S}}),e(f,s,{__proto__:null,enumerable:!0,get(){return S.pipeline}}),e(x,s,{__proto__:null,enumerable:!0,get(){return S.finished}}),F.Stream=F,F._isUint8Array=function(P){return P instanceof Uint8Array},F._uint8ArrayToBuffer=function(P){return t.from(P.buffer,P.byteOffset,P.byteLength)},To.exports}var Fl;function jp(){return Fl||(Fl=1,(function(t){const e=rc(),r=tc(),n=e.Readable.destroy;t.exports=e.Readable,t.exports._uint8ArrayToBuffer=e._uint8ArrayToBuffer,t.exports._isUint8Array=e._isUint8Array,t.exports.isDisturbed=e.isDisturbed,t.exports.isErrored=e.isErrored,t.exports.isReadable=e.isReadable,t.exports.Readable=e.Readable,t.exports.Writable=e.Writable,t.exports.Duplex=e.Duplex,t.exports.Transform=e.Transform,t.exports.PassThrough=e.PassThrough,t.exports.addAbortSignal=e.addAbortSignal,t.exports.finished=e.finished,t.exports.destroy=e.destroy,t.exports.destroy=n,t.exports.pipeline=e.pipeline,t.exports.compose=e.compose,Object.defineProperty(e,"promises",{configurable:!0,enumerable:!0,get(){return r}}),t.exports.Stream=e.Stream,t.exports.default=t.exports})(Io)),Io.exports}var nc=jp();const Zo=Symbol("iter");function oi(t,e,r=4){if(r===0)return Object.assign(t,e);for(const n in e)t[n]=oi(t[n]||Object.create(null),e[n],r-1);return t}function ic(t,e,r=4){let n=!1;for(const s in t)if(s in e){const a=r===0?null:ic(t[s],e[s],r-1);if(a!==!1)n=n||Object.create(null),n[s]=a;else if(r===3)return!1}return n}function oc(t,e,r=4){let n=!1;for(const s in t)if(!(s in e))n=n||Object.create(null),n[s]=r===0?null:oi({},t[s],r-1);else if(r!==0){const a=oc(t[s],e[s],r-1);if(a!==!1)n=n||Object.create(null),n[s]=a;else if(r===3)return!1}return n}class $p{constructor(e={}){this._id=1,this._ids=Object.create(null),this._ids[""]=1,this._entities=Object.create(null),this._entities[1]="",this._blankNodeIndex=0,this._factory=e.factory||Nr}_termFromId(e){if(e[0]==="."){const r=this._entities,n=e.split(".");return this._factory.quad(this._termFromId(r[n[1]]),this._termFromId(r[n[2]]),this._termFromId(r[n[3]]),n[4]&&this._termFromId(r[n[4]]))}return ei(e,this._factory)}_termToNumericId(e){if(e.termType==="Quad"){const r=this._termToNumericId(e.subject),n=this._termToNumericId(e.predicate),s=this._termToNumericId(e.object);let a;return r&&n&&s&&(vs(e.graph)||(a=this._termToNumericId(e.graph)))&&this._ids[a?`.${r}.${n}.${s}.${a}`:`.${r}.${n}.${s}`]}return this._ids[mn(e)]}_termToNewNumericId(e){const r=e&&e.termType==="Quad"?`.${this._termToNewNumericId(e.subject)}.${this._termToNewNumericId(e.predicate)}.${this._termToNewNumericId(e.object)}${vs(e.graph)?"":`.${this._termToNewNumericId(e.graph)}`}`:mn(e);return this._ids[r]||(this._ids[this._entities[++this._id]=r]=this._id)}createBlankNode(e){let r,n;if(e)for(r=e=`_:${e}`,n=1;this._ids[r];)r=e+n++;else do r=`_:b${this._blankNodeIndex++}`;while(this._ids[r]);return this._ids[r]=++this._id,this._entities[this._id]=r,this._factory.blankNode(r.substr(2))}}class Kt{constructor(e,r){this._size=0,this._graphs=Object.create(null),!r&&e&&!e[0]&&typeof e.match!="function"&&(r=e,e=null),r=r||{},this._factory=r.factory||Nr,this._entityIndex=r.entityIndex||new $p({factory:this._factory}),this._entities=this._entityIndex._entities,this._termFromId=this._entityIndex._termFromId.bind(this._entityIndex),this._termToNumericId=this._entityIndex._termToNumericId.bind(this._entityIndex),this._termToNewNumericId=this._entityIndex._termToNewNumericId.bind(this._entityIndex),e&&this.addAll(e)}get size(){let e=this._size;if(e!==null)return e;e=0;const r=this._graphs;let n,s;for(const a in r)for(const l in n=r[a].subjects)for(const c in s=n[l])e+=Object.keys(s[c]).length;return this._size=e}_addToIndex(e,r,n,s){const a=e[r]||(e[r]={}),l=a[n]||(a[n]={}),c=s in l;return c||(l[s]=null),!c}_removeFromIndex(e,r,n,s){const a=e[r],l=a[n];delete l[s];for(const c in l)return;delete a[n];for(const c in a)return;delete e[r]}*_findInIndex(e,r,n,s,a,l,c,g){let h,p,f;const _=this._entities,x=this._termFromId(_[g]),S={subject:null,predicate:null,object:null};r&&((h=e,e={})[r]=h[r]);for(const I in e)if(p=e[I]){S[a]=this._termFromId(_[I]),n&&((h=p,p={})[n]=h[n]);for(const F in p)if(f=p[F]){S[l]=this._termFromId(_[F]);const b=s?s in f?[s]:[]:Object.keys(f);for(let A=0;A<b.length;A++)S[c]=this._termFromId(_[b[A]]),yield this._factory.quad(S.subject,S.predicate,S.object,x)}}}_loop(e,r){for(const n in e)r(n)}_loopByKey0(e,r,n){let s,a;if(s=e[r])for(a in s)n(a)}_loopByKey1(e,r,n){let s,a;for(s in e)a=e[s],a[r]&&n(s)}_loopBy2Keys(e,r,n,s){let a,l,c;if((a=e[r])&&(l=a[n]))for(c in l)s(c)}_countInIndex(e,r,n,s){let a=0,l,c,g;r&&((l=e,e={})[r]=l[r]);for(const h in e)if(c=e[h]){n&&((l=c,c={})[n]=l[n]);for(const p in c)(g=c[p])&&(s?s in g&&a++:a+=Object.keys(g).length)}return a}_getGraphs(e){return e=e===""?1:e&&(this._termToNumericId(e)||-1),typeof e!="number"?this._graphs:{[e]:this._graphs[e]}}_uniqueEntities(e){const r=Object.create(null);return n=>{n in r||(r[n]=!0,e(this._termFromId(this._entities[n],this._factory)))}}add(e){return this.addQuad(e),this}addQuad(e,r,n,s){r||(s=e.graph,n=e.object,r=e.predicate,e=e.subject),s=s?this._termToNewNumericId(s):1;let a=this._graphs[s];return a||(a=this._graphs[s]={subjects:{},predicates:{},objects:{}},Object.freeze(a)),e=this._termToNewNumericId(e),r=this._termToNewNumericId(r),n=this._termToNewNumericId(n),this._addToIndex(a.subjects,e,r,n)?(this._addToIndex(a.predicates,r,n,e),this._addToIndex(a.objects,n,e,r),this._size=null,!0):!1}addQuads(e){for(let r=0;r<e.length;r++)this.addQuad(e[r])}delete(e){return this.removeQuad(e),this}has(e,r,n,s){return e&&e.subject&&({subject:e,predicate:r,object:n,graph:s}=e),!this.readQuads(e,r,n,s).next().done}import(e){return e.on("data",r=>{this.addQuad(r)}),e}removeQuad(e,r,n,s){r||({subject:e,predicate:r,object:n,graph:s}=e),s=s?this._termToNumericId(s):1;const a=this._graphs;let l,c,g;if(!(e=e&&this._termToNumericId(e))||!(r=r&&this._termToNumericId(r))||!(n=n&&this._termToNumericId(n))||!(l=a[s])||!(c=l.subjects[e])||!(g=c[r])||!(n in g))return!1;this._removeFromIndex(l.subjects,e,r,n),this._removeFromIndex(l.predicates,r,n,e),this._removeFromIndex(l.objects,n,e,r),this._size!==null&&this._size--;for(e in l.subjects)return!0;return delete a[s],!0}removeQuads(e){for(let r=0;r<e.length;r++)this.removeQuad(e[r])}remove(e){return e.on("data",r=>{this.removeQuad(r)}),e}removeMatches(e,r,n,s){const a=new nc.Readable({objectMode:!0}),l=this.readQuads(e,r,n,s);return a._read=c=>{for(;--c>=0;){const{done:g,value:h}=l.next();if(g){a.push(null);return}a.push(h)}},this.remove(a)}deleteGraph(e){return this.removeMatches(null,null,null,e)}getQuads(e,r,n,s){return[...this.readQuads(e,r,n,s)]}*readQuads(e,r,n,s){const a=this._getGraphs(s);let l,c,g,h;if(!(e&&!(c=this._termToNumericId(e))||r&&!(g=this._termToNumericId(r))||n&&!(h=this._termToNumericId(n))))for(const p in a)(l=a[p])&&(c?h?yield*this._findInIndex(l.objects,h,c,g,"object","subject","predicate",p):yield*this._findInIndex(l.subjects,c,g,null,"subject","predicate","object",p):g?yield*this._findInIndex(l.predicates,g,h,null,"predicate","object","subject",p):h?yield*this._findInIndex(l.objects,h,null,null,"object","subject","predicate",p):yield*this._findInIndex(l.subjects,null,null,null,"subject","predicate","object",p))}match(e,r,n,s){return new Tr(this,e,r,n,s,{entityIndex:this._entityIndex})}countQuads(e,r,n,s){const a=this._getGraphs(s);let l=0,c,g,h,p;if(e&&!(g=this._termToNumericId(e))||r&&!(h=this._termToNumericId(r))||n&&!(p=this._termToNumericId(n)))return 0;for(const f in a)(c=a[f])&&(e?n?l+=this._countInIndex(c.objects,p,g,h):l+=this._countInIndex(c.subjects,g,h,p):r?l+=this._countInIndex(c.predicates,h,p,g):l+=this._countInIndex(c.objects,p,g,h));return l}forEach(e,r,n,s,a){this.some(l=>(e(l,this),!1),r,n,s,a)}every(e,r,n,s,a){return!this.some(l=>!e(l,this),r,n,s,a)}some(e,r,n,s,a){for(const l of this.readQuads(r,n,s,a))if(e(l,this))return!0;return!1}getSubjects(e,r,n){const s=[];return this.forSubjects(a=>{s.push(a)},e,r,n),s}forSubjects(e,r,n,s){const a=this._getGraphs(s);let l,c,g;if(e=this._uniqueEntities(e),!(r&&!(c=this._termToNumericId(r))||n&&!(g=this._termToNumericId(n))))for(s in a)(l=a[s])&&(c?g?this._loopBy2Keys(l.predicates,c,g,e):this._loopByKey1(l.subjects,c,e):g?this._loopByKey0(l.objects,g,e):this._loop(l.subjects,e))}getPredicates(e,r,n){const s=[];return this.forPredicates(a=>{s.push(a)},e,r,n),s}forPredicates(e,r,n,s){const a=this._getGraphs(s);let l,c,g;if(e=this._uniqueEntities(e),!(r&&!(c=this._termToNumericId(r))||n&&!(g=this._termToNumericId(n))))for(s in a)(l=a[s])&&(c?g?this._loopBy2Keys(l.objects,g,c,e):this._loopByKey0(l.subjects,c,e):g?this._loopByKey1(l.predicates,g,e):this._loop(l.predicates,e))}getObjects(e,r,n){const s=[];return this.forObjects(a=>{s.push(a)},e,r,n),s}forObjects(e,r,n,s){const a=this._getGraphs(s);let l,c,g;if(e=this._uniqueEntities(e),!(r&&!(c=this._termToNumericId(r))||n&&!(g=this._termToNumericId(n))))for(s in a)(l=a[s])&&(c?g?this._loopBy2Keys(l.subjects,c,g,e):this._loopByKey1(l.objects,c,e):g?this._loopByKey0(l.predicates,g,e):this._loop(l.objects,e))}getGraphs(e,r,n){const s=[];return this.forGraphs(a=>{s.push(a)},e,r,n),s}forGraphs(e,r,n,s){for(const a in this._graphs)this.some(l=>(e(l.graph),!0),r,n,s,this._termFromId(this._entities[a]))}createBlankNode(e){return this._entityIndex.createBlankNode(e)}extractLists({remove:e=!1,ignoreErrors:r=!1}={}){const n={},s=r?(()=>!0):((c,g)=>{throw new Error(`${c.value} ${g}`)}),a=this.getQuads(null,Tt.rdf.rest,Tt.rdf.nil,null),l=e?[...a]:[];return a.forEach(c=>{const g=[];let h=!1,p,f;const _=c.graph;let x=c.subject;for(;x&&!h;){const S=this.getQuads(null,null,x,null),I=this.getQuads(x,null,null,null);let F,b=null,A=null,T=null;for(let P=0;P<I.length&&!h;P++)F=I[P],F.graph.equals(_)?p?h=s(x,"has non-list arcs out"):F.predicate.value===Tt.rdf.first?b?h=s(x,"has multiple rdf:first arcs"):l.push(b=F):F.predicate.value===Tt.rdf.rest?A?h=s(x,"has multiple rdf:rest arcs"):l.push(A=F):S.length?h=s(x,"can't be subject and object"):(p=F,f="subject"):h=s(x,"not confined to single graph");for(let P=0;P<S.length&&!h;++P)F=S[P],p?h=s(x,"can't have coreferences"):F.predicate.value===Tt.rdf.rest?T?h=s(x,"has incoming rdf:rest arcs"):T=F:(p=F,f="object");b?g.unshift(b.object):h=s(x,"has no list head"),x=T&&T.subject}h?e=!1:p&&(n[p[f].value]=g)}),e&&this.removeQuads(l),n}addAll(e){if(e instanceof Tr&&(e=e.filtered),Array.isArray(e))this.addQuads(e);else if(e instanceof Kt&&e._entityIndex===this._entityIndex)e._size!==0&&(this._graphs=oi(this._graphs,e._graphs),this._size=null);else for(const r of e)this.add(r);return this}contains(e){if(e instanceof Tr&&(e=e.filtered),e===this)return!0;if(!(e instanceof Kt)||this._entityIndex!==e._entityIndex)return e.every(h=>this.has(h));const r=this._graphs,n=e._graphs;let s,a,l,c,g;for(const h in n){if(!(s=r[h]))return!1;s=s.subjects;for(const p in a=n[h].subjects){if(!(l=s[p]))return!1;for(const f in c=a[p]){if(!(g=l[f]))return!1;for(const _ in c[f])if(!(_ in g))return!1}}}return!0}deleteMatches(e,r,n,s){for(const a of this.match(e,r,n,s))this.removeQuad(a);return this}difference(e){if(e&&e instanceof Tr&&(e=e.filtered),e===this)return new Kt({entityIndex:this._entityIndex});if(e instanceof Kt&&e._entityIndex===this._entityIndex){const r=new Kt({entityIndex:this._entityIndex}),n=oc(this._graphs,e._graphs);return n&&(r._graphs=n,r._size=null),r}return this.filter(r=>!e.has(r))}equals(e){return e instanceof Tr&&(e=e.filtered),e===this||this.size===e.size&&this.contains(e)}filter(e){const r=new Kt({entityIndex:this._entityIndex});for(const n of this)e(n,this)&&r.add(n);return r}intersection(e){if(e instanceof Tr&&(e=e.filtered),e===this){const r=new Kt({entityIndex:this._entityIndex});return r._graphs=oi(Object.create(null),this._graphs),r._size=this._size,r}else if(e instanceof Kt&&this._entityIndex===e._entityIndex){const r=new Kt({entityIndex:this._entityIndex}),n=ic(e._graphs,this._graphs);return n&&(r._graphs=n,r._size=null),r}return this.filter(r=>e.has(r))}map(e){const r=new Kt({entityIndex:this._entityIndex});for(const n of this)r.add(e(n,this));return r}reduce(e,r){const n=this.readQuads();let s=r===void 0?n.next().value:r;for(const a of n)s=e(s,a,this);return s}toArray(){return this.getQuads()}toCanonical(){throw new Error("not implemented")}toStream(){return this.match()}toString(){return new Gu().quadsToString(this)}union(e){const r=new Kt({entityIndex:this._entityIndex});return r._graphs=oi(Object.create(null),this._graphs),r._size=this._size,r.addAll(e),r}*[Symbol.iterator](){yield*this.readQuads()}}function ur(t,e,r=0){const n=e[r];if(n&&!(n in t))return!1;let s=!1;for(const a in n?{[n]:t[n]}:t){const l=r===2?null:ur(t[a],e,r+1);l!==!1&&(s=s||Object.create(null),s[a]=l)}return s}class Tr extends nc.Readable{constructor(e,r,n,s,a,l){super({objectMode:!0}),Object.assign(this,{n3Store:e,subject:r,predicate:n,object:s,graph:a,options:l})}get filtered(){if(!this._filtered){const{n3Store:e,graph:r,object:n,predicate:s,subject:a}=this,l=this._filtered=new Kt({factory:e._factory,entityIndex:this.options.entityIndex});let c,g,h;if(a&&!(c=l._termToNumericId(a))||s&&!(g=l._termToNumericId(s))||n&&!(h=l._termToNumericId(n)))return l;const p=e._getGraphs(r);for(const f in p){let _,x,S,I;(I=p[f])&&(!c&&g?(x=ur(I.predicates,[g,h,c]))&&(_=ur(I.subjects,[c,g,h]),S=ur(I.objects,[h,c,g])):h?(S=ur(I.objects,[h,c,g]))&&(_=ur(I.subjects,[c,g,h]),x=ur(I.predicates,[g,h,c])):(_=ur(I.subjects,[c,g,h]))&&(x=ur(I.predicates,[g,h,c]),S=ur(I.objects,[h,c,g])),_&&(l._graphs[f]={subjects:_,predicates:x,objects:S}))}l._size=null}return this._filtered}get size(){return this.filtered.size}_read(e){e>0&&!this[Zo]&&(this[Zo]=this[Symbol.iterator]());const r=this[Zo];for(;--e>=0;){const{done:n,value:s}=r.next();if(n){this.push(null);return}this.push(s)}}addAll(e){return this.filtered.addAll(e)}contains(e){return this.filtered.contains(e)}deleteMatches(e,r,n,s){return this.filtered.deleteMatches(e,r,n,s)}difference(e){return this.filtered.difference(e)}equals(e){return this.filtered.equals(e)}every(e,r,n,s,a){return this.filtered.every(e,r,n,s,a)}filter(e){return this.filtered.filter(e)}forEach(e,r,n,s,a){return this.filtered.forEach(e,r,n,s,a)}import(e){return this.filtered.import(e)}intersection(e){return this.filtered.intersection(e)}map(e){return this.filtered.map(e)}some(e,r,n,s,a){return this.filtered.some(e,r,n,s,a)}toCanonical(){return this.filtered.toCanonical()}toStream(){return this._filtered?this._filtered.toStream():this.n3Store.match(this.subject,this.predicate,this.object,this.graph)}union(e){return this._filtered?this._filtered.union(e):this.n3Store.match(this.subject,this.predicate,this.object,this.graph).addAll(e)}toArray(){return this._filtered?this._filtered.toArray():this.n3Store.getQuads(this.subject,this.predicate,this.object,this.graph)}reduce(e,r){return this.filtered.reduce(e,r)}toString(){return new Gu().quadsToString(this)}add(e){return this.filtered.add(e)}delete(e){return this.filtered.delete(e)}has(e){return this.filtered.has(e)}match(e,r,n,s){return new Tr(this.filtered,e,r,n,s,this.options)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}const Qn=t=>{const e=new URL(t);return e.hash="",e.toString()},Hp=(t,e)=>{const r=new zu(e),n=Nr.namedNode(e.baseIRI);return r.parse(t).map(({subject:a,predicate:l,object:c})=>Nr.quad(a,l,c,n))},Ui=t=>JSON.stringify(t.toJSON());var bs;(function(t){t.subject="subject",t.predicate="predicate",t.object="object",t.graph="graph"})(bs||(bs={}));const dn=Object.values(bs);class Vp{constructor(){this.list=new Set,this.providedByVariable=new Map,this.provideVariable=new Map,this.byQuad={}}add(e){var r,n,s,a,l;this.list.add(e);for(const[c,g]of e.from)for(const[h]of g)this.providedByVariable.has(c)||this.providedByVariable.set(c,new Map),this.providedByVariable.get(c).has(h)||(r=this.providedByVariable.get(c))===null||r===void 0||r.set(h,new Set),this.providedByVariable.get(c).get(h).add(e);for(const[c,g]of e.to)for(const[h]of g)this.provideVariable.has(c)||this.provideVariable.set(c,new Map),this.provideVariable.get(c).has(h)||(n=this.provideVariable.get(c))===null||n===void 0||n.set(h,new Set),this.provideVariable.get(c).get(h).add(e);e.quad&&((s=(a=this.byQuad)[l=Ui(e.quad)])!==null&&s!==void 0||(a[l]=new Set),this.byQuad[Ui(e.quad)].add(e))}remove(e){this.list.delete(e),e.from.forEach((r,n)=>{r.forEach((s,a)=>{var l,c;(c=(l=this.providedByVariable.get(n))===null||l===void 0?void 0:l.get(a))===null||c===void 0||c.delete(e)})}),e.to.forEach((r,n)=>{r.forEach((s,a)=>{var l,c;(c=(l=this.provideVariable.get(n))===null||l===void 0?void 0:l.get(a))===null||c===void 0||c.delete(e)})}),e.quad&&this.byQuad[Ui(e.quad)].delete(e)}print(){const e=[];for(const r of this.list){const n=this.formatVariableMap(r.from),s=this.formatVariableMap(r.to);e.push(`${n} ==> ${s}`)}return e.join(`
`)}formatVariableMap(e){const r=[];for(const[n,s]of e)for(const[,a]of s)r.push(`${n}:${a.id}`);return r.join(", ")}}class Kp{constructor(e,r,n=new Kt,s={}){this.moves=new Vp,this.variables=new Map,this.graphs=new Map,this.coloredVariables=new Map,this.onNeedResource=s.onNeedResource,this.onDropResource=s.onDropResource,this.onQueryComplete=s.onQueryComplete,this.onVariableAdded=s.onVariableAdded,this.onVariableRemoved=s.onVariableRemoved,this.store=n,this.query=e;for(const a in r)if(Xn(a)&&r[a])for(const l of r[a]){const c=new kr(l);this.moves.add({step:-1,from:new Map,to:new Map([[a,new Map([[Dt(c),c]])]])}),this.addVariable(a,c)}}getMissingResources(){return this.getGraphs(!1)}addGraph(e,r,n){var s,a;const l=Qn(e),c=n&&Qn(n),g=(s=this.graphs.get(l))!==null&&s!==void 0?s:{uri:l,term:new kr(l),added:!1,sourceVariables:new Map,redirectsFrom:new Set};if(c&&c!==l){const S=this.graphs.get(c);S&&(S.added=!0,S.redirectTo=l),g.redirectsFrom.add(c)}const h=this.store.getQuads(null,null,null,g.term),p=r.map(S=>new Ws(S.subject,S.predicate,S.object,g.term)),f=p.filter(S=>!h.some(I=>S.equals(I))),_=h.filter(S=>!p.some(I=>S.equals(I)));f.forEach(S=>this.addQuad(S)),_.forEach(S=>this.removeQuad(S)),g.added=!0,this.graphs.set(l,g);const x=this.getMissingResources();return x.size===0&&((a=this.onQueryComplete)===null||a===void 0||a.call(this)),{missing:x,notNeeded:"TODO"}}isVariablePresent(e,r){var n;return!!(!((n=this.variables.get(e))===null||n===void 0)&&n.has(Dt(r)))}addQuad(e){this.store.addQuad(e);const r=(n,s,a)=>{const l=s[a],c=n[a];return!!(!l||Xn(l)&&this.isVariablePresent(l,c)||l===c.value)};this.query.forEach((n,s)=>{if(n.type!=="match"||!dn.every(c=>r(e,n,c)))return;const a=new Map;for(const c of dn){const g=n[c];Xn(g)&&(a.has(g)||a.set(g,new Map),a.get(g).set(Dt(e[c]),e[c]))}const l=new Map([[n.target,new Map([[Dt(e[n.pick]),e[n.pick]]])]]);this.moves.add({step:s,from:a,to:l,quad:e}),this.addVariable(n.target,e[n.pick])})}removeQuad(e){var r;this.store.removeQuad(e),((r=this.moves.byQuad[Ui(e)])!==null&&r!==void 0?r:new Set).forEach(s=>this.removeMove(s))}removeMove(e){this.moves.remove(e),e.to.forEach((r,n)=>{r.forEach((s,a)=>{var l;const c=(l=this.moves.provideVariable.get(n))===null||l===void 0?void 0:l.get(a);!c||c.size===0?this.removeVariable(n,s):this.detectAndRemoveOrphans(n,s)})})}colorDependents(e,r){var n,s,a;if(!((n=this.coloredVariables.get(e))===null||n===void 0)&&n.has(Dt(r)))return;this.coloredVariables.has(e)||this.coloredVariables.set(e,new Map),(s=this.coloredVariables.get(e))===null||s===void 0||s.set(Dt(r),r);const l=(a=this.moves.providedByVariable.get(e))===null||a===void 0?void 0:a.get(Dt(r));if(l)for(const c of l)c.to.forEach((g,h)=>{g.forEach(p=>{this.colorDependents(h,p)})})}detectAndRemoveOrphans(e,r){var n,s;this.coloredVariables=new Map,this.colorDependents(e,r);let a=!1;for(const[l,c]of this.coloredVariables){for(const[g]of c){const h=(n=this.moves.provideVariable.get(l))===null||n===void 0?void 0:n.get(g);if(h){for(const p of h){let f=!0;for(const[_,x]of p.from){for(const[S]of x)if(!((s=this.coloredVariables.get(_))===null||s===void 0)&&s.has(S)){f=!1;break}if(!f)break}if(f){a=!0;break}}if(a)break}}if(a)break}if(!a)for(const[l,c]of this.coloredVariables)for(const[,g]of c)this.removeVariable(l,g)}removeVariable(e,r){var n,s,a,l,c;if((n=this.variables.get(e))===null||n===void 0||n.delete(Dt(r)),(s=this.onVariableRemoved)===null||s===void 0||s.call(this,e,r,this.getVariable(e)),((a=this.variables.get(e))===null||a===void 0?void 0:a.size)===0&&this.variables.delete(e),r.termType==="NamedNode"){const h=new kr(Qn(r.value)),p=this.graphs.get(h.value);(l=p?.sourceVariables.get(e))===null||l===void 0||l.delete(Dt(r)),new Set(p?.sourceVariables.values().flatMap(_=>_.values())).size===0&&this.removeGraph(h.value)}const g=(c=this.moves.providedByVariable.get(e))===null||c===void 0?void 0:c.get(Dt(r));if(g)for(const h of g)this.removeMove(h)}removeGraph(e){var r,n,s,a;const l=Qn(e),c=this.graphs.get(l),g=(r=c?.redirectsFrom)!==null&&r!==void 0?r:new Set,h=c?.redirectTo;(n=this.onDropResource)===null||n===void 0||n.call(this,l),this.graphs.delete(l);for(const f of g)(s=this.onDropResource)===null||s===void 0||s.call(this,f),this.graphs.delete(f);h&&((a=this.onDropResource)===null||a===void 0||a.call(this,h),this.graphs.delete(h)),this.store.getQuads(null,null,null,new kr(e)).forEach(f=>this.removeQuad(f))}hopFromVariable(e,r){this.query.forEach((n,s)=>{if(n.type==="transform variable"){if(n.source!==e)return;const a=n.transform(r);a&&(this.moves.add({from:new Map([[n.source,new Map([[Dt(r),r]])]]),to:new Map([[n.target,new Map([[Dt(a),a]])]]),step:s}),this.addVariable(n.target,a))}else if(n.type==="match"){if(dn.every(c=>n[c]!==e))return;const a=(c,g)=>{var h;let p=new Set;const f=c[g];if(!f)p.add(null);else if(!Xn(f))p.add(new kr(f));else if(f===e)p.add(r);else{const _=(h=this.getVariable(f))===null||h===void 0?void 0:h.values();p=new Set(_)}return p},l=Object.fromEntries(dn.map(c=>[c,a(n,c)]));for(const c of l.subject)for(const g of l.predicate)for(const h of l.object)for(const p of l.graph){const f=this.store.getQuads(c,g,h,p);for(const _ of f){const x=n.target,S=_[n.pick],I=new Map;for(const b of dn)Xn(n[b])&&(I.has(n[b])||I.set(n[b],new Map),I.get(n[b]).set(Dt(_[b]),_[b]));const F=new Map([[x,new Map([[Dt(S),S]])]]);this.moves.add({from:I,to:F,step:s,quad:_}),this.addVariable(x,S)}}}})}addVariable(e,r){var n,s;if(this.isVariablePresent(e,r))return;this.variables.has(e)||this.variables.set(e,new Map),this.variables.get(e).set(Dt(r),r);const a=this.query.some(g=>g.type==="add resources"&&g.variable===e),l=this.query.some(g=>g.type==="match"&&dn.some(h=>g[h]===e));if((a||l)&&r.termType==="NamedNode"){const g=Qn(r.value);this.graphs.has(g)||(this.graphs.set(g,{added:!1,uri:g,term:r,sourceVariables:new Map,redirectsFrom:new Set}),(n=this.onNeedResource)===null||n===void 0||n.call(this,g));const h=this.graphs.get(g);h.sourceVariables.has(e)||h.sourceVariables.set(e,new Map),h.sourceVariables.get(e).set(Dt(r),r)}(s=this.onVariableAdded)===null||s===void 0||s.call(this,e,r,this.getVariable(e)),this.hopFromVariable(e,r)}getVariable(e){var r;return new Set((r=this.variables.get(e))===null||r===void 0?void 0:r.values())}getVariableAsStringSet(e){return Rl(this.getVariable(e))}getAllVariables(){return Object.fromEntries(this.variables.entries().map(([e,r])=>[e,new Set(r.values())]))}getAllVariablesAsStringSets(){return Object.fromEntries(this.variables.entries().map(([e,r])=>[e,Rl(new Set(r.values()))]))}getGraphs(e){if(typeof e!="boolean")return new Set(this.graphs.keys());const r=new Set;return this.graphs.forEach((n,s)=>{n.added===e&&r.add(s)}),r}}function Xn(t){return typeof t=="string"&&t.startsWith("?")}const Rl=t=>new Set([...t].map(e=>e.value)),Dt=t=>`${t.termType}:${t.id}`,qp={meta:"https://ldhop.example/meta",status:"https://ldhop.example/status",missing:"https://ldhop.example/status/missing",added:"https://ldhop.example/status/added",failed:"https://ldhop.example/status/failed",resource:"https://ldhop.example/resource",variable:"https://ldhop.example/variable"};Object.fromEntries(Object.entries(qp).map(([t,e])=>[t,new kr(e)]));var Wp="http://xmlns.com/foaf/0.1/Agent",zp="http://xmlns.com/foaf/0.1/Document",Jp="http://xmlns.com/foaf/0.1/Group",Gp="http://xmlns.com/foaf/0.1/Image",Yp="http://xmlns.com/foaf/0.1/LabelProperty",Qp="http://xmlns.com/foaf/0.1/OnlineAccount",Xp="http://xmlns.com/foaf/0.1/OnlineChatAccount",Zp="http://xmlns.com/foaf/0.1/OnlineEcommerceAccount",eg="http://xmlns.com/foaf/0.1/OnlineGamingAccount",tg="http://xmlns.com/foaf/0.1/Organization",rg="http://xmlns.com/foaf/0.1/Person",ng="http://xmlns.com/foaf/0.1/PersonalProfileDocument",ig="http://xmlns.com/foaf/0.1/Project",og="http://xmlns.com/foaf/0.1/account",sg="http://xmlns.com/foaf/0.1/accountName",ag="http://xmlns.com/foaf/0.1/accountServiceHomepage",lg="http://xmlns.com/foaf/0.1/age",ug="http://xmlns.com/foaf/0.1/aimChatID",cg="http://xmlns.com/foaf/0.1/based_near",hg="http://xmlns.com/foaf/0.1/birthday",dg="http://xmlns.com/foaf/0.1/currentProject",fg="http://xmlns.com/foaf/0.1/depiction",pg="http://xmlns.com/foaf/0.1/depicts",gg="http://xmlns.com/foaf/0.1/dnaChecksum",mg="http://xmlns.com/foaf/0.1/familyName",yg="http://xmlns.com/foaf/0.1/family_name",wg="http://xmlns.com/foaf/0.1/firstName",vg="http://xmlns.com/foaf/0.1/focus",bg="http://xmlns.com/foaf/0.1/fundedBy",_g="http://xmlns.com/foaf/0.1/geekcode",Sg="http://xmlns.com/foaf/0.1/gender",Eg="http://xmlns.com/foaf/0.1/givenName",xg="http://xmlns.com/foaf/0.1/givenname",Ag="http://xmlns.com/foaf/0.1/holdsAccount",Fg="http://xmlns.com/foaf/0.1/homepage",Rg="http://xmlns.com/foaf/0.1/icqChatID",Ig="http://xmlns.com/foaf/0.1/img",Tg="http://xmlns.com/foaf/0.1/interest",Cg="http://xmlns.com/foaf/0.1/isPrimaryTopicOf",kg="http://xmlns.com/foaf/0.1/jabberID",Pg="http://xmlns.com/foaf/0.1/knows",Ng="http://xmlns.com/foaf/0.1/lastName",Lg="http://xmlns.com/foaf/0.1/logo",Dg="http://xmlns.com/foaf/0.1/made",Og="http://xmlns.com/foaf/0.1/maker",Ug="http://xmlns.com/foaf/0.1/mbox",Bg="http://xmlns.com/foaf/0.1/mbox_sha1sum",Mg="http://xmlns.com/foaf/0.1/member",jg="http://xmlns.com/foaf/0.1/membershipClass",$g="http://xmlns.com/foaf/0.1/msnChatID",Hg="http://xmlns.com/foaf/0.1/myersBriggs",Vg="http://xmlns.com/foaf/0.1/name",Kg="http://xmlns.com/foaf/0.1/nick",qg="http://xmlns.com/foaf/0.1/openid",Wg="http://xmlns.com/foaf/0.1/page",zg="http://xmlns.com/foaf/0.1/pastProject",Jg="http://xmlns.com/foaf/0.1/phone",Gg="http://xmlns.com/foaf/0.1/plan",Yg="http://xmlns.com/foaf/0.1/primaryTopic",Qg="http://xmlns.com/foaf/0.1/publications",Xg="http://xmlns.com/foaf/0.1/schoolHomepage",Zg="http://xmlns.com/foaf/0.1/sha1",e0="http://xmlns.com/foaf/0.1/skypeID",t0="http://xmlns.com/foaf/0.1/status",r0="http://xmlns.com/foaf/0.1/surname",n0="http://xmlns.com/foaf/0.1/theme",i0="http://xmlns.com/foaf/0.1/thumbnail",o0="http://xmlns.com/foaf/0.1/tipjar",s0="http://xmlns.com/foaf/0.1/title",a0="http://xmlns.com/foaf/0.1/topic",l0="http://xmlns.com/foaf/0.1/topic_interest",u0="http://xmlns.com/foaf/0.1/weblog",c0="http://xmlns.com/foaf/0.1/workInfoHomepage",h0="http://xmlns.com/foaf/0.1/workplaceHomepage",d0="http://xmlns.com/foaf/0.1/yahooChatID",f0=Object.freeze({Agent:Wp,Document:zp,Group:Jp,Image:Gp,LabelProperty:Yp,OnlineAccount:Qp,OnlineChatAccount:Xp,OnlineEcommerceAccount:Zp,OnlineGamingAccount:eg,Organization:tg,Person:rg,PersonalProfileDocument:ng,Project:ig,account:og,accountName:sg,accountServiceHomepage:ag,age:lg,aimChatID:ug,based_near:cg,birthday:hg,currentProject:dg,depiction:fg,depicts:pg,dnaChecksum:gg,familyName:mg,family_name:yg,firstName:wg,focus:vg,fundedBy:bg,geekcode:_g,gender:Sg,givenName:Eg,givenname:xg,holdsAccount:Ag,homepage:Fg,icqChatID:Rg,img:Ig,interest:Tg,isPrimaryTopicOf:Cg,jabberID:kg,knows:Pg,lastName:Ng,logo:Lg,made:Dg,maker:Og,mbox:Ug,mbox_sha1sum:Bg,member:Mg,membershipClass:jg,msnChatID:$g,myersBriggs:Hg,name:Vg,nick:Kg,openid:qg,page:Wg,pastProject:zg,phone:Jg,plan:Gg,primaryTopic:Yg,publications:Qg,schoolHomepage:Xg,sha1:Zg,skypeID:e0,status:t0,surname:r0,theme:n0,thumbnail:i0,tipjar:o0,title:s0,topic:a0,topic_interest:l0,weblog:u0,workInfoHomepage:c0,workplaceHomepage:h0,yahooChatID:d0}),p0="http://www.w3.org/2000/01/rdf-schema#Resource",g0="http://www.w3.org/2000/01/rdf-schema#Class",m0="http://www.w3.org/2000/01/rdf-schema#subClassOf",y0="http://www.w3.org/2000/01/rdf-schema#subPropertyOf",w0="http://www.w3.org/2000/01/rdf-schema#comment",v0="http://www.w3.org/2000/01/rdf-schema#label",b0="http://www.w3.org/2000/01/rdf-schema#domain",_0="http://www.w3.org/2000/01/rdf-schema#range",S0="http://www.w3.org/2000/01/rdf-schema#seeAlso",E0="http://www.w3.org/2000/01/rdf-schema#isDefinedBy",x0="http://www.w3.org/2000/01/rdf-schema#Literal",A0="http://www.w3.org/2000/01/rdf-schema#Container",F0="http://www.w3.org/2000/01/rdf-schema#ContainerMembershipProperty",R0="http://www.w3.org/2000/01/rdf-schema#member",I0="http://www.w3.org/2000/01/rdf-schema#Datatype",T0=Object.freeze({Resource:p0,Class:g0,subClassOf:m0,subPropertyOf:y0,comment:w0,label:v0,domain:b0,range:_0,seeAlso:S0,isDefinedBy:E0,Literal:x0,Container:A0,ContainerMembershipProperty:F0,member:R0,Datatype:I0}),C0="http://www.w3.org/ns/pim/space#ControlledStorage",k0="http://www.w3.org/ns/pim/space#PersonalStorage",P0="http://www.w3.org/ns/pim/space#PublicStorage",N0="http://www.w3.org/ns/pim/space#Storage",L0="http://www.w3.org/ns/pim/space#Workspace",D0="http://www.w3.org/ns/pim/space#masterWorkspace",O0="http://www.w3.org/ns/pim/space#preferencesFile",U0="http://www.w3.org/ns/pim/space#storage",B0="http://www.w3.org/ns/pim/space#uriPrefix",M0="http://www.w3.org/ns/pim/space#workspace",j0=Object.freeze({ControlledStorage:C0,PersonalStorage:k0,PublicStorage:P0,Storage:N0,Workspace:L0,masterWorkspace:D0,preferencesFile:O0,storage:U0,uriPrefix:B0,workspace:M0}),$0="http://www.w3.org/2006/vcard/ns#Acquaintance",H0="http://www.w3.org/2006/vcard/ns#Address",V0="http://www.w3.org/2006/vcard/ns#Agent",K0="http://www.w3.org/2006/vcard/ns#BBS",q0="http://www.w3.org/2006/vcard/ns#Car",W0="http://www.w3.org/2006/vcard/ns#Cell",z0="http://www.w3.org/2006/vcard/ns#Child",J0="http://www.w3.org/2006/vcard/ns#Colleague",G0="http://www.w3.org/2006/vcard/ns#Contact",Y0="http://www.w3.org/2006/vcard/ns#Coresident",Q0="http://www.w3.org/2006/vcard/ns#Coworker",X0="http://www.w3.org/2006/vcard/ns#Crush",Z0="http://www.w3.org/2006/vcard/ns#Date",em="http://www.w3.org/2006/vcard/ns#Dom",tm="http://www.w3.org/2006/vcard/ns#Email",rm="http://www.w3.org/2006/vcard/ns#Emergency",nm="http://www.w3.org/2006/vcard/ns#Fax",im="http://www.w3.org/2006/vcard/ns#Female",om="http://www.w3.org/2006/vcard/ns#Friend",sm="http://www.w3.org/2006/vcard/ns#Gender",am="http://www.w3.org/2006/vcard/ns#Group",lm="http://www.w3.org/2006/vcard/ns#Home",um="http://www.w3.org/2006/vcard/ns#ISDN",cm="http://www.w3.org/2006/vcard/ns#Individual",hm="http://www.w3.org/2006/vcard/ns#Internet",dm="http://www.w3.org/2006/vcard/ns#Intl",fm="http://www.w3.org/2006/vcard/ns#Kin",pm="http://www.w3.org/2006/vcard/ns#Kind",gm="http://www.w3.org/2006/vcard/ns#Label",mm="http://www.w3.org/2006/vcard/ns#Location",ym="http://www.w3.org/2006/vcard/ns#Male",wm="http://www.w3.org/2006/vcard/ns#Me",vm="http://www.w3.org/2006/vcard/ns#Met",bm="http://www.w3.org/2006/vcard/ns#Modem",_m="http://www.w3.org/2006/vcard/ns#Msg",Sm="http://www.w3.org/2006/vcard/ns#Muse",Em="http://www.w3.org/2006/vcard/ns#Name",xm="http://www.w3.org/2006/vcard/ns#Neighbor",Am="http://www.w3.org/2006/vcard/ns#None",Fm="http://www.w3.org/2006/vcard/ns#Organization",Rm="http://www.w3.org/2006/vcard/ns#Other",Im="http://www.w3.org/2006/vcard/ns#PCS",Tm="http://www.w3.org/2006/vcard/ns#Pager",Cm="http://www.w3.org/2006/vcard/ns#Parcel",km="http://www.w3.org/2006/vcard/ns#Parent",Pm="http://www.w3.org/2006/vcard/ns#Postal",Nm="http://www.w3.org/2006/vcard/ns#Pref",Lm="http://www.w3.org/2006/vcard/ns#RelatedType",Dm="http://www.w3.org/2006/vcard/ns#Sibling",Om="http://www.w3.org/2006/vcard/ns#Spouse",Um="http://www.w3.org/2006/vcard/ns#Sweetheart",Bm="http://www.w3.org/2006/vcard/ns#Tel",Mm="http://www.w3.org/2006/vcard/ns#TelephoneType",jm="http://www.w3.org/2006/vcard/ns#Text",$m="http://www.w3.org/2006/vcard/ns#TextPhone",Hm="http://www.w3.org/2006/vcard/ns#Type",Vm="http://www.w3.org/2006/vcard/ns#Unknown",Km="http://www.w3.org/2006/vcard/ns#VCard",qm="http://www.w3.org/2006/vcard/ns#Video",Wm="http://www.w3.org/2006/vcard/ns#Voice",zm="http://www.w3.org/2006/vcard/ns#Work",Jm="http://www.w3.org/2006/vcard/ns#X400",Gm="http://www.w3.org/2006/vcard/ns#adr",Ym="http://www.w3.org/2006/vcard/ns#agent",Qm="http://www.w3.org/2006/vcard/ns#anniversary",Xm="http://www.w3.org/2006/vcard/ns#bday",Zm="http://www.w3.org/2006/vcard/ns#category",ey="http://www.w3.org/2006/vcard/ns#class",ty="http://www.w3.org/2006/vcard/ns#email",ry="http://www.w3.org/2006/vcard/ns#fn",ny="http://www.w3.org/2006/vcard/ns#geo",iy="http://www.w3.org/2006/vcard/ns#hasAdditionalName",oy="http://www.w3.org/2006/vcard/ns#hasAddress",sy="http://www.w3.org/2006/vcard/ns#hasCalendarBusy",ay="http://www.w3.org/2006/vcard/ns#hasCalendarLink",ly="http://www.w3.org/2006/vcard/ns#hasCalendarRequest",uy="http://www.w3.org/2006/vcard/ns#hasCategory",cy="http://www.w3.org/2006/vcard/ns#hasCountryName",hy="http://www.w3.org/2006/vcard/ns#hasEmail",dy="http://www.w3.org/2006/vcard/ns#hasFN",fy="http://www.w3.org/2006/vcard/ns#hasFamilyName",py="http://www.w3.org/2006/vcard/ns#hasGender",gy="http://www.w3.org/2006/vcard/ns#hasGeo",my="http://www.w3.org/2006/vcard/ns#hasGivenName",yy="http://www.w3.org/2006/vcard/ns#hasHonorificPrefix",wy="http://www.w3.org/2006/vcard/ns#hasHonorificSuffix",vy="http://www.w3.org/2006/vcard/ns#hasInstantMessage",by="http://www.w3.org/2006/vcard/ns#hasKey",_y="http://www.w3.org/2006/vcard/ns#hasLanguage",Sy="http://www.w3.org/2006/vcard/ns#hasLocality",Ey="http://www.w3.org/2006/vcard/ns#hasLogo",xy="http://www.w3.org/2006/vcard/ns#hasMember",Ay="http://www.w3.org/2006/vcard/ns#hasName",Fy="http://www.w3.org/2006/vcard/ns#hasNickname",Ry="http://www.w3.org/2006/vcard/ns#hasNote",Iy="http://www.w3.org/2006/vcard/ns#hasOrganizationName",Ty="http://www.w3.org/2006/vcard/ns#hasOrganizationUnit",Cy="http://www.w3.org/2006/vcard/ns#hasPhoto",ky="http://www.w3.org/2006/vcard/ns#hasPostalCode",Py="http://www.w3.org/2006/vcard/ns#hasRegion",Ny="http://www.w3.org/2006/vcard/ns#hasRelated",Ly="http://www.w3.org/2006/vcard/ns#hasRole",Dy="http://www.w3.org/2006/vcard/ns#hasSound",Oy="http://www.w3.org/2006/vcard/ns#hasSource",Uy="http://www.w3.org/2006/vcard/ns#hasStreetAddress",By="http://www.w3.org/2006/vcard/ns#hasTelephone",My="http://www.w3.org/2006/vcard/ns#hasTitle",jy="http://www.w3.org/2006/vcard/ns#hasUID",$y="http://www.w3.org/2006/vcard/ns#hasURL",Hy="http://www.w3.org/2006/vcard/ns#hasValue",Vy="http://www.w3.org/2006/vcard/ns#key",Ky="http://www.w3.org/2006/vcard/ns#label",qy="http://www.w3.org/2006/vcard/ns#language",Wy="http://www.w3.org/2006/vcard/ns#latitude",zy="http://www.w3.org/2006/vcard/ns#locality",Jy="http://www.w3.org/2006/vcard/ns#logo",Gy="http://www.w3.org/2006/vcard/ns#longitude",Yy="http://www.w3.org/2006/vcard/ns#mailer",Qy="http://www.w3.org/2006/vcard/ns#n",Xy="http://www.w3.org/2006/vcard/ns#nickname",Zy="http://www.w3.org/2006/vcard/ns#note",ew="http://www.w3.org/2006/vcard/ns#org",tw="http://www.w3.org/2006/vcard/ns#photo",rw="http://www.w3.org/2006/vcard/ns#prodid",nw="http://www.w3.org/2006/vcard/ns#region",iw="http://www.w3.org/2006/vcard/ns#rev",ow="http://www.w3.org/2006/vcard/ns#role",sw="http://www.w3.org/2006/vcard/ns#sound",aw="http://www.w3.org/2006/vcard/ns#tel",lw="http://www.w3.org/2006/vcard/ns#title",uw="http://www.w3.org/2006/vcard/ns#tz",cw="http://www.w3.org/2006/vcard/ns#url",hw="http://www.w3.org/2006/vcard/ns#value",dw=Object.freeze({Acquaintance:$0,Address:H0,Agent:V0,BBS:K0,Car:q0,Cell:W0,Child:z0,Colleague:J0,Contact:G0,Coresident:Y0,Coworker:Q0,Crush:X0,Date__workaround:Z0,Dom:em,Email:tm,Emergency:rm,Fax:nm,Female:im,Friend:om,Gender:sm,Group:am,Home:lm,ISDN:um,Individual:cm,Internet:hm,Intl__workaround:dm,Kin:fm,Kind:pm,Label:gm,Location:mm,Male:ym,Me:wm,Met:vm,Modem:bm,Msg:_m,Muse:Sm,Name:Em,Neighbor:xm,None:Am,Organization:Fm,Other:Rm,PCS:Im,Pager:Tm,Parcel:Cm,Parent:km,Postal:Pm,Pref:Nm,RelatedType:Lm,Sibling:Dm,Spouse:Om,Sweetheart:Um,Tel:Bm,TelephoneType:Mm,Text:jm,TextPhone:$m,Type:Hm,Unknown:Vm,VCard:Km,Video:qm,Voice:Wm,Work:zm,X400:Jm,adr:Gm,agent:Ym,anniversary:Qm,bday:Xm,category:Zm,class__workaround:ey,email:ty,fn:ry,geo:ny,hasAdditionalName:iy,hasAddress:oy,hasCalendarBusy:sy,hasCalendarLink:ay,hasCalendarRequest:ly,hasCategory:uy,hasCountryName:cy,hasEmail:hy,hasFN:dy,hasFamilyName:fy,hasGender:py,hasGeo:gy,hasGivenName:my,hasHonorificPrefix:yy,hasHonorificSuffix:wy,hasInstantMessage:vy,hasKey:by,hasLanguage:_y,hasLocality:Sy,hasLogo:Ey,hasMember:xy,hasName:Ay,hasNickname:Fy,hasNote:Ry,hasOrganizationName:Iy,hasOrganizationUnit:Ty,hasPhoto:Cy,hasPostalCode:ky,hasRegion:Py,hasRelated:Ny,hasRole:Ly,hasSound:Dy,hasSource:Oy,hasStreetAddress:Uy,hasTelephone:By,hasTitle:My,hasUID:jy,hasURL:$y,hasValue:Hy,key:Vy,label:Ky,language:qy,latitude:Wy,locality:zy,logo:Jy,longitude:Gy,mailer:Yy,n:Qy,nickname:Xy,note:Zy,org:ew,photo:tw,prodid:rw,region:nw,rev:iw,role:ow,sound:sw,tel:aw,title:lw,tz:uw,url:cw,value:hw}),Qs=f0,Xs=T0,Zs=j0,_s=dw;class ea{constructor(e,r,n={}){this.subscriptions=new Map,this.getStore=e,this.query=r,this.callbacks=n}get engine(){return this._engine}run(e){this.destroy(),this._engine=new Kp(this.query,e,void 0,{onNeedResource:r=>this.subscribeToResource(r),onDropResource:r=>this.unsubscribeFromResource(r),onVariableAdded:this.callbacks.onVariableAdded,onVariableRemoved:this.callbacks.onVariableRemoved,onQueryComplete:this.callbacks.onQueryComplete})}destroy(){for(const e of this.subscriptions.values())e();this.subscriptions.clear(),this._engine=void 0}async subscribeToResource(e){await new Promise(n=>setTimeout(n,0)),this.subscriptions.has(e)&&this.subscriptions.get(e)?.();const r=this.getStore().subscribe(e,{accept:"text/turtle"},n=>{if(!n.loading)if(n.error)this._engine?.addGraph(e,[]);else{const s=Hp(n.data,{baseIRI:n.finalUrl,format:n.headers.get("content-type")??void 0});this._engine?.addGraph(n.finalUrl,s,e)}});this.subscriptions.set(e,r)}unsubscribeFromResource(e){this.subscriptions.get(e)?.(),this.subscriptions.delete(e)}}function sc(t){for(const e of t)if(e.termType==="Literal")return e.value}function fw(t){for(const e of t)if(e.termType==="NamedNode")return e.value}var pw=Object.defineProperty,gw=Object.getOwnPropertyDescriptor,rn=(t,e,r,n)=>{for(var s=n>1?void 0:n?gw(e,r):e,a=t.length-1,l;a>=0;a--)(l=t[a])&&(s=(n?l(e,r,s):l(s))||s);return n&&s&&pw(e,r,s),s};const mw=[{type:"match",subject:"?webid",predicate:Xs.seeAlso,pick:"object",target:"?profileDocument"},{type:"add resources",variable:"?profileDocument"},{type:"match",subject:"?webid",predicate:Zs.preferencesFile,pick:"object",target:"?preferencesFile"},{type:"add resources",variable:"?preferencesFile"},{type:"match",subject:"?webid",predicate:_s.hasPhoto,pick:"object",target:"?photo"},{type:"match",subject:"?webid",predicate:_s.fn,pick:"object",target:"?name"},{type:"match",subject:"?webid",predicate:Qs.name,pick:"object",target:"?name"}];let Sr=class extends Ct{constructor(){super(...arguments),this.shape="circle",this.runner=new ea(()=>this.store,mw,{onVariableAdded:(t,e,r)=>this.handleVariable(t,r),onVariableRemoved:(t,e,r)=>this.handleVariable(t,r)})}handleVariable(t,e){t==="?name"&&(this._name=sc(e)),t==="?photo"&&(this._photo=fw(e))}updated(t){if((t.has("webid")||t.has("store"))&&(this._name=void 0,this._photo=void 0,this.webid?this.runner.run({"?webid":new Set([this.webid])}):this.runner.destroy()),t.has("_photo")&&this.updatePhoto(),t.has("_photoBlobUrl")){const e=t.get("_photoBlobUrl");e&&URL.revokeObjectURL(e)}}updatePhoto(){this.photoUnsub?.(),this.photoUnsub=void 0,this._photo?this.photoUnsub=this.store.subscribe(this._photo,{accept:"image/*"},t=>{!t.loading&&!t.error&&(this._photoBlobUrl=URL.createObjectURL(t.data))}):this._photoBlobUrl=void 0}disconnectedCallback(){super.disconnectedCallback(),this.runner.destroy(),this.photoUnsub?.(),this._photoBlobUrl&&URL.revokeObjectURL(this._photoBlobUrl)}render(){const t=this._name?.split(/\s+/).map(e=>e[0]).join("");return Qe`<wa-avatar
      initials=${mt(t)}
      image=${mt(this._photoBlobUrl)}
      label="Avatar of ${mt(this._name)}"
      shape=${this.shape}
    ></wa-avatar>`}};Sr.styles=en`
    :host {
      --avatar-size: var(--size);
    }

    wa-avatar {
      --size: var(--avatar-size, 3rem);
    }
  `;rn([Te()],Sr.prototype,"webid",2);rn([Te()],Sr.prototype,"shape",2);rn([Te({attribute:!1})],Sr.prototype,"store",2);rn([Ot()],Sr.prototype,"_name",2);rn([Ot()],Sr.prototype,"_photo",2);rn([Ot()],Sr.prototype,"_photoBlobUrl",2);Sr=rn([_t("dtp-avatar")],Sr);var yw=Object.defineProperty,ww=Object.getOwnPropertyDescriptor,ac=(t,e,r,n)=>{for(var s=n>1?void 0:n?ww(e,r):e,a=t.length-1,l;a>=0;a--)(l=t[a])&&(s=(n?l(e,r,s):l(s))||s);return n&&s&&yw(e,r,s),s};let Ki=class extends Ct{constructor(){super(...arguments),this.webid=""}render(){return Qe`<header class="header">
        <a href="/"><dtp-logo class="logo"></dtp-logo></a>
        <a href="/profile/${fp(this.webid)}">
          <dtp-avatar webid=${this.webid} .store=${Li}></dtp-avatar>
        </a>
        <button @click=${this._signout}>sign out</button>
      </header>
      <main>
        <slot></slot>
      </main>`}_signout(){If()}};Ki.styles=en`
    .logo {
      --size: 2rem;
      justify-self: flex-start;
    }

    dtp-avatar {
      --size: 2rem;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 1rem;
      padding: 1rem;
    }

    .header > :first-child {
      margin-right: auto;
    }
  `;ac([Te()],Ki.prototype,"webid",2);Ki=ac([_t("dtp-layout")],Ki);const Il=new WeakMap,Tl=t=>{if((r=>r.pattern!==void 0)(t))return t.pattern;let e=Il.get(t);return e===void 0&&Il.set(t,e=new URLPattern({pathname:t.path})),e};let vw=class{constructor(e,r,n){this.routes=[],this.o=[],this.t={},this.i=s=>{if(s.routes===this)return;const a=s.routes;this.o.push(a),a.h=this,s.stopImmediatePropagation(),s.onDisconnect=()=>{this.o?.splice(this.o.indexOf(a)>>>0,1)};const l=Cl(this.t);l!==void 0&&a.goto(l)},(this.l=e).addController(this),this.routes=[...r],this.fallback=n?.fallback}link(e){if(e?.startsWith("/"))return e;if(e?.startsWith("."))throw Error("Not implemented");return e??=this.u,(this.h?.link()??"")+e}async goto(e){let r;if(this.routes.length===0&&this.fallback===void 0)r=e,this.u="",this.t={0:r};else{const n=this.p(e);if(n===void 0)throw Error("No route found for "+e);const s=Tl(n).exec({pathname:e}),a=s?.pathname.groups??{};if(r=Cl(a),typeof n.enter=="function"&&await n.enter(a)===!1)return;this.v=n,this.t=a,this.u=r===void 0?e:e.substring(0,e.length-r.length)}if(r!==void 0)for(const n of this.o)n.goto(r);this.l.requestUpdate()}outlet(){return this.v?.render?.(this.t)}get params(){return this.t}p(e){const r=this.routes.find((n=>Tl(n).test({pathname:e})));return r||this.fallback===void 0?r:this.fallback?{...this.fallback,path:"/*"}:void 0}hostConnected(){this.l.addEventListener(Ss.eventName,this.i);const e=new Ss(this);this.l.dispatchEvent(e),this._=e.onDisconnect}hostDisconnected(){this._?.(),this.h=void 0}};const Cl=t=>{let e;for(const r of Object.keys(t))/\d+/.test(r)&&(e===void 0||r>e)&&(e=r);return e&&t[e]};let Ss=class lc extends Event{constructor(e){super(lc.eventName,{bubbles:!0,composed:!0,cancelable:!1}),this.routes=e}};Ss.eventName="lit-routes-connected";const bw=location.origin||location.protocol+"//"+location.host;let _w=class extends vw{constructor(){super(...arguments),this.m=e=>{const r=e.button!==0||e.metaKey||e.ctrlKey||e.shiftKey;if(e.defaultPrevented||r)return;const n=e.composedPath().find((l=>l.tagName==="A"));if(n===void 0||n.target!==""||n.hasAttribute("download")||n.getAttribute("rel")==="external")return;const s=n.href;if(s===""||s.startsWith("mailto:"))return;const a=window.location;n.origin===bw&&(e.preventDefault(),s!==a.href&&(window.history.pushState({},"",s),this.goto(n.pathname)))},this.R=e=>{this.goto(window.location.pathname)}}hostConnected(){super.hostConnected(),window.addEventListener("click",this.m),window.addEventListener("popstate",this.R),this.goto(window.location.pathname)}hostDisconnected(){super.hostDisconnected(),window.removeEventListener("click",this.m),window.removeEventListener("popstate",this.R)}};var Sw=`@layer wa-utilities {
  .wa-visually-hidden:not(:focus-within),
  .wa-visually-hidden-force,
  .wa-visually-hidden-hint::part(hint),
  .wa-visually-hidden-label::part(label) {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    clip: rect(0 0 0 0) !important;
    clip-path: inset(50%) !important;
    border: none !important;
    overflow: hidden !important;
    white-space: nowrap !important;
    padding: 0 !important;
  }
}
`;var Ew=class extends Event{constructor(t){super("wa-copy",{bubbles:!0,cancelable:!1,composed:!0}),this.detail=t}},xw=`:host {
  display: inline-block;
  color: var(--wa-color-neutral-on-quiet);
}

.button {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  background-color: transparent;
  border: none;
  border-radius: var(--wa-form-control-border-radius);
  color: inherit;
  font-size: inherit;
  padding: 0.5em;
  cursor: pointer;
  transition: color var(--wa-transition-fast) var(--wa-transition-easing);
}

@media (hover: hover) {
  .button:hover:not([disabled]) {
    background-color: var(--wa-color-neutral-fill-quiet);
    color: color-mix(in oklab, currentColor, var(--wa-color-mix-hover));
  }
}

.button:focus-visible:not([disabled]) {
  background-color: var(--wa-color-neutral-fill-quiet);
  color: color-mix(in oklab, currentColor, var(--wa-color-mix-hover));
}

.button:active:not([disabled]) {
  color: color-mix(in oklab, currentColor, var(--wa-color-mix-active));
}

slot[name='success-icon'] {
  color: var(--wa-color-success-on-quiet);
}

slot[name='error-icon'] {
  color: var(--wa-color-danger-on-quiet);
}

.button:focus-visible {
  outline: var(--wa-focus-ring);
  outline-offset: var(--wa-focus-ring-offset);
}

.button[disabled] {
  opacity: 0.5;
  cursor: not-allowed !important;
}

slot {
  display: inline-flex;
}

.show {
  animation: show 100ms ease;
}

.hide {
  animation: show 100ms ease reverse;
}

@keyframes show {
  from {
    scale: 0.25;
    opacity: 0.25;
  }
  to {
    scale: 1;
    opacity: 1;
  }
}
`,Pt=class extends Zt{constructor(){super(...arguments),this.localize=new di(this),this.isCopying=!1,this.status="rest",this.value="",this.from="",this.disabled=!1,this.copyLabel="",this.successLabel="",this.errorLabel="",this.feedbackDuration=1e3,this.tooltipPlacement="top"}get currentLabel(){return this.status==="success"?this.successLabel||this.localize.term("copied"):this.status==="error"?this.errorLabel||this.localize.term("error"):this.copyLabel||this.localize.term("copy")}async handleCopy(){if(this.disabled||this.isCopying)return;this.isCopying=!0;let t=this.value;if(this.from){const e=this.getRootNode(),r=this.from.includes("."),n=this.from.includes("[")&&this.from.includes("]");let s=this.from,a="";r?[s,a]=this.from.trim().split("."):n&&([s,a]=this.from.trim().replace(/\]$/,"").split("["));const l="getElementById"in e?e.getElementById(s):null;l?n?t=l.getAttribute(a)||"":r?t=l[a]||"":t=l.textContent||"":(this.showStatus("error"),this.dispatchEvent(new ii))}if(!t)this.showStatus("error"),this.dispatchEvent(new ii);else try{await navigator.clipboard.writeText(t),this.showStatus("success"),this.dispatchEvent(new Ew({value:t}))}catch{this.showStatus("error"),this.dispatchEvent(new ii)}}async showStatus(t){const e=t==="success"?this.successIcon:this.errorIcon;await Xt(this.copyIcon,"hide"),this.copyIcon.hidden=!0,this.status=t,e.hidden=!1,await Xt(e,"show"),setTimeout(async()=>{await Xt(e,"hide"),e.hidden=!0,this.status="rest",this.copyIcon.hidden=!1,await Xt(this.copyIcon,"show"),this.isCopying=!1},this.feedbackDuration)}render(){return Qe`
      <button
        class="button"
        part="button"
        type="button"
        id="copy-button"
        ?disabled=${this.disabled}
        @click=${this.handleCopy}
      >
        <!-- Render a visually hidden label to appease the accessibility checking gods -->
        <span class="wa-visually-hidden">${this.currentLabel}</span>
        <slot part="copy-icon" name="copy-icon">
          <wa-icon library="system" name="copy" variant="regular"></wa-icon>
        </slot>
        <slot part="success-icon" name="success-icon" variant="solid" hidden>
          <wa-icon library="system" name="check"></wa-icon>
        </slot>
        <slot part="error-icon" name="error-icon" variant="solid" hidden>
          <wa-icon library="system" name="xmark"></wa-icon>
        </slot>
        <wa-tooltip
          class=${Xr({"copy-button":!0,"copy-button-success":this.status==="success","copy-button-error":this.status==="error"})}
          for="copy-button"
          placement=${this.tooltipPlacement}
          ?disabled=${this.disabled}
          exportparts="
            base:tooltip__base,
            base__popup:tooltip__base__popup,
            base__arrow:tooltip__base__arrow,
            body:tooltip__body
          "
          >${this.currentLabel}</wa-tooltip
        >
      </button>
    `}};Pt.css=[Sw,xw];Se([Ut('slot[name="copy-icon"]')],Pt.prototype,"copyIcon",2);Se([Ut('slot[name="success-icon"]')],Pt.prototype,"successIcon",2);Se([Ut('slot[name="error-icon"]')],Pt.prototype,"errorIcon",2);Se([Ut("wa-tooltip")],Pt.prototype,"tooltip",2);Se([Ot()],Pt.prototype,"isCopying",2);Se([Ot()],Pt.prototype,"status",2);Se([Te()],Pt.prototype,"value",2);Se([Te()],Pt.prototype,"from",2);Se([Te({type:Boolean,reflect:!0})],Pt.prototype,"disabled",2);Se([Te({attribute:"copy-label"})],Pt.prototype,"copyLabel",2);Se([Te({attribute:"success-label"})],Pt.prototype,"successLabel",2);Se([Te({attribute:"error-label"})],Pt.prototype,"errorLabel",2);Se([Te({attribute:"feedback-duration",type:Number})],Pt.prototype,"feedbackDuration",2);Se([Te({attribute:"tooltip-placement"})],Pt.prototype,"tooltipPlacement",2);Pt=Se([_t("wa-copy-button")],Pt);var Aw=class extends Event{constructor(){super("wa-reposition",{bubbles:!0,cancelable:!1,composed:!0})}};const Lr=Math.min,Jt=Math.max,qi=Math.round,Ii=Math.floor,hr=t=>({x:t,y:t}),Fw={left:"right",right:"left",bottom:"top",top:"bottom"},Rw={start:"end",end:"start"};function Es(t,e,r){return Jt(t,Lr(e,r))}function Tn(t,e){return typeof t=="function"?t(e):t}function Dr(t){return t.split("-")[0]}function Cn(t){return t.split("-")[1]}function uc(t){return t==="x"?"y":"x"}function ta(t){return t==="y"?"height":"width"}const Iw=new Set(["top","bottom"]);function wr(t){return Iw.has(Dr(t))?"y":"x"}function ra(t){return uc(wr(t))}function Tw(t,e,r){r===void 0&&(r=!1);const n=Cn(t),s=ra(t),a=ta(s);let l=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[a]>e.floating[a]&&(l=Wi(l)),[l,Wi(l)]}function Cw(t){const e=Wi(t);return[xs(t),e,xs(e)]}function xs(t){return t.replace(/start|end/g,e=>Rw[e])}const kl=["left","right"],Pl=["right","left"],kw=["top","bottom"],Pw=["bottom","top"];function Nw(t,e,r){switch(t){case"top":case"bottom":return r?e?Pl:kl:e?kl:Pl;case"left":case"right":return e?kw:Pw;default:return[]}}function Lw(t,e,r,n){const s=Cn(t);let a=Nw(Dr(t),r==="start",n);return s&&(a=a.map(l=>l+"-"+s),e&&(a=a.concat(a.map(xs)))),a}function Wi(t){return t.replace(/left|right|bottom|top/g,e=>Fw[e])}function Dw(t){return{top:0,right:0,bottom:0,left:0,...t}}function cc(t){return typeof t!="number"?Dw(t):{top:t,right:t,bottom:t,left:t}}function zi(t){const{x:e,y:r,width:n,height:s}=t;return{width:n,height:s,top:r,left:e,right:e+n,bottom:r+s,x:e,y:r}}function Nl(t,e,r){let{reference:n,floating:s}=t;const a=wr(e),l=ra(e),c=ta(l),g=Dr(e),h=a==="y",p=n.x+n.width/2-s.width/2,f=n.y+n.height/2-s.height/2,_=n[c]/2-s[c]/2;let x;switch(g){case"top":x={x:p,y:n.y-s.height};break;case"bottom":x={x:p,y:n.y+n.height};break;case"right":x={x:n.x+n.width,y:f};break;case"left":x={x:n.x-s.width,y:f};break;default:x={x:n.x,y:n.y}}switch(Cn(e)){case"start":x[l]-=_*(r&&h?-1:1);break;case"end":x[l]+=_*(r&&h?-1:1);break}return x}const Ow=async(t,e,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:a=[],platform:l}=r,c=a.filter(Boolean),g=await(l.isRTL==null?void 0:l.isRTL(e));let h=await l.getElementRects({reference:t,floating:e,strategy:s}),{x:p,y:f}=Nl(h,n,g),_=n,x={},S=0;for(let I=0;I<c.length;I++){const{name:F,fn:b}=c[I],{x:A,y:T,data:P,reset:D}=await b({x:p,y:f,initialPlacement:n,placement:_,strategy:s,middlewareData:x,rects:h,platform:l,elements:{reference:t,floating:e}});p=A??p,f=T??f,x={...x,[F]:{...x[F],...P}},D&&S<=50&&(S++,typeof D=="object"&&(D.placement&&(_=D.placement),D.rects&&(h=D.rects===!0?await l.getElementRects({reference:t,floating:e,strategy:s}):D.rects),{x:p,y:f}=Nl(h,_,g)),I=-1)}return{x:p,y:f,placement:_,strategy:s,middlewareData:x}};async function na(t,e){var r;e===void 0&&(e={});const{x:n,y:s,platform:a,rects:l,elements:c,strategy:g}=t,{boundary:h="clippingAncestors",rootBoundary:p="viewport",elementContext:f="floating",altBoundary:_=!1,padding:x=0}=Tn(e,t),S=cc(x),F=c[_?f==="floating"?"reference":"floating":f],b=zi(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(F)))==null||r?F:F.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(c.floating)),boundary:h,rootBoundary:p,strategy:g})),A=f==="floating"?{x:n,y:s,width:l.floating.width,height:l.floating.height}:l.reference,T=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c.floating)),P=await(a.isElement==null?void 0:a.isElement(T))?await(a.getScale==null?void 0:a.getScale(T))||{x:1,y:1}:{x:1,y:1},D=zi(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:A,offsetParent:T,strategy:g}):A);return{top:(b.top-D.top+S.top)/P.y,bottom:(D.bottom-b.bottom+S.bottom)/P.y,left:(b.left-D.left+S.left)/P.x,right:(D.right-b.right+S.right)/P.x}}const Uw=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:s,rects:a,platform:l,elements:c,middlewareData:g}=e,{element:h,padding:p=0}=Tn(t,e)||{};if(h==null)return{};const f=cc(p),_={x:r,y:n},x=ra(s),S=ta(x),I=await l.getDimensions(h),F=x==="y",b=F?"top":"left",A=F?"bottom":"right",T=F?"clientHeight":"clientWidth",P=a.reference[S]+a.reference[x]-_[x]-a.floating[S],D=_[x]-a.reference[x],j=await(l.getOffsetParent==null?void 0:l.getOffsetParent(h));let M=j?j[T]:0;(!M||!await(l.isElement==null?void 0:l.isElement(j)))&&(M=c.floating[T]||a.floating[S]);const ne=P/2-D/2,ce=M/2-I[S]/2-1,N=Lr(f[b],ce),ee=Lr(f[A],ce),we=N,se=M-I[S]-ee,Re=M/2-I[S]/2+ne,Ne=Es(we,Re,se),Ue=!g.arrow&&Cn(s)!=null&&Re!==Ne&&a.reference[S]/2-(Re<we?N:ee)-I[S]/2<0,je=Ue?Re<we?Re-we:Re-se:0;return{[x]:_[x]+je,data:{[x]:Ne,centerOffset:Re-Ne-je,...Ue&&{alignmentOffset:je}},reset:Ue}}}),Bw=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:s,middlewareData:a,rects:l,initialPlacement:c,platform:g,elements:h}=e,{mainAxis:p=!0,crossAxis:f=!0,fallbackPlacements:_,fallbackStrategy:x="bestFit",fallbackAxisSideDirection:S="none",flipAlignment:I=!0,...F}=Tn(t,e);if((r=a.arrow)!=null&&r.alignmentOffset)return{};const b=Dr(s),A=wr(c),T=Dr(c)===c,P=await(g.isRTL==null?void 0:g.isRTL(h.floating)),D=_||(T||!I?[Wi(c)]:Cw(c)),j=S!=="none";!_&&j&&D.push(...Lw(c,I,S,P));const M=[c,...D],ne=await na(e,F),ce=[];let N=((n=a.flip)==null?void 0:n.overflows)||[];if(p&&ce.push(ne[b]),f){const Re=Tw(s,l,P);ce.push(ne[Re[0]],ne[Re[1]])}if(N=[...N,{placement:s,overflows:ce}],!ce.every(Re=>Re<=0)){var ee,we;const Re=(((ee=a.flip)==null?void 0:ee.index)||0)+1,Ne=M[Re];if(Ne&&(!(f==="alignment"?A!==wr(Ne):!1)||N.every(me=>wr(me.placement)===A?me.overflows[0]>0:!0)))return{data:{index:Re,overflows:N},reset:{placement:Ne}};let Ue=(we=N.filter(je=>je.overflows[0]<=0).sort((je,me)=>je.overflows[1]-me.overflows[1])[0])==null?void 0:we.placement;if(!Ue)switch(x){case"bestFit":{var se;const je=(se=N.filter(me=>{if(j){const Ie=wr(me.placement);return Ie===A||Ie==="y"}return!0}).map(me=>[me.placement,me.overflows.filter(Ie=>Ie>0).reduce((Ie,G)=>Ie+G,0)]).sort((me,Ie)=>me[1]-Ie[1])[0])==null?void 0:se[0];je&&(Ue=je);break}case"initialPlacement":Ue=c;break}if(s!==Ue)return{reset:{placement:Ue}}}return{}}}},Mw=new Set(["left","top"]);async function jw(t,e){const{placement:r,platform:n,elements:s}=t,a=await(n.isRTL==null?void 0:n.isRTL(s.floating)),l=Dr(r),c=Cn(r),g=wr(r)==="y",h=Mw.has(l)?-1:1,p=a&&g?-1:1,f=Tn(e,t);let{mainAxis:_,crossAxis:x,alignmentAxis:S}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return c&&typeof S=="number"&&(x=c==="end"?S*-1:S),g?{x:x*p,y:_*h}:{x:_*h,y:x*p}}const $w=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:s,y:a,placement:l,middlewareData:c}=e,g=await jw(e,t);return l===((r=c.offset)==null?void 0:r.placement)&&(n=c.arrow)!=null&&n.alignmentOffset?{}:{x:s+g.x,y:a+g.y,data:{...g,placement:l}}}}},Hw=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:s}=e,{mainAxis:a=!0,crossAxis:l=!1,limiter:c={fn:F=>{let{x:b,y:A}=F;return{x:b,y:A}}},...g}=Tn(t,e),h={x:r,y:n},p=await na(e,g),f=wr(Dr(s)),_=uc(f);let x=h[_],S=h[f];if(a){const F=_==="y"?"top":"left",b=_==="y"?"bottom":"right",A=x+p[F],T=x-p[b];x=Es(A,x,T)}if(l){const F=f==="y"?"top":"left",b=f==="y"?"bottom":"right",A=S+p[F],T=S-p[b];S=Es(A,S,T)}const I=c.fn({...e,[_]:x,[f]:S});return{...I,data:{x:I.x-r,y:I.y-n,enabled:{[_]:a,[f]:l}}}}}},Vw=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:s,rects:a,platform:l,elements:c}=e,{apply:g=()=>{},...h}=Tn(t,e),p=await na(e,h),f=Dr(s),_=Cn(s),x=wr(s)==="y",{width:S,height:I}=a.floating;let F,b;f==="top"||f==="bottom"?(F=f,b=_===(await(l.isRTL==null?void 0:l.isRTL(c.floating))?"start":"end")?"left":"right"):(b=f,F=_==="end"?"top":"bottom");const A=I-p.top-p.bottom,T=S-p.left-p.right,P=Lr(I-p[F],A),D=Lr(S-p[b],T),j=!e.middlewareData.shift;let M=P,ne=D;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(ne=T),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(M=A),j&&!_){const N=Jt(p.left,0),ee=Jt(p.right,0),we=Jt(p.top,0),se=Jt(p.bottom,0);x?ne=S-2*(N!==0||ee!==0?N+ee:Jt(p.left,p.right)):M=I-2*(we!==0||se!==0?we+se:Jt(p.top,p.bottom))}await g({...e,availableWidth:ne,availableHeight:M});const ce=await l.getDimensions(c.floating);return S!==ce.width||I!==ce.height?{reset:{rects:!0}}:{}}}};function ro(){return typeof window<"u"}function kn(t){return hc(t)?(t.nodeName||"").toLowerCase():"#document"}function Gt(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function pr(t){var e;return(e=(hc(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function hc(t){return ro()?t instanceof Node||t instanceof Gt(t).Node:!1}function ir(t){return ro()?t instanceof Element||t instanceof Gt(t).Element:!1}function fr(t){return ro()?t instanceof HTMLElement||t instanceof Gt(t).HTMLElement:!1}function Ll(t){return!ro()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Gt(t).ShadowRoot}const Kw=new Set(["inline","contents"]);function mi(t){const{overflow:e,overflowX:r,overflowY:n,display:s}=or(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!Kw.has(s)}const qw=new Set(["table","td","th"]);function Ww(t){return qw.has(kn(t))}const zw=[":popover-open",":modal"];function no(t){return zw.some(e=>{try{return t.matches(e)}catch{return!1}})}const Jw=["transform","translate","scale","rotate","perspective"],Gw=["transform","translate","scale","rotate","perspective","filter"],Yw=["paint","layout","strict","content"];function io(t){const e=ia(),r=ir(t)?or(t):t;return Jw.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||Gw.some(n=>(r.willChange||"").includes(n))||Yw.some(n=>(r.contain||"").includes(n))}function Qw(t){let e=Or(t);for(;fr(e)&&!_n(e);){if(io(e))return e;if(no(e))return null;e=Or(e)}return null}function ia(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Xw=new Set(["html","body","#document"]);function _n(t){return Xw.has(kn(t))}function or(t){return Gt(t).getComputedStyle(t)}function oo(t){return ir(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Or(t){if(kn(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Ll(t)&&t.host||pr(t);return Ll(e)?e.host:e}function dc(t){const e=Or(t);return _n(e)?t.ownerDocument?t.ownerDocument.body:t.body:fr(e)&&mi(e)?e:dc(e)}function Sn(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const s=dc(t),a=s===((n=t.ownerDocument)==null?void 0:n.body),l=Gt(s);if(a){const c=As(l);return e.concat(l,l.visualViewport||[],mi(s)?s:[],c&&r?Sn(c):[])}return e.concat(s,Sn(s,[],r))}function As(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function fc(t){const e=or(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=fr(t),a=s?t.offsetWidth:r,l=s?t.offsetHeight:n,c=qi(r)!==a||qi(n)!==l;return c&&(r=a,n=l),{width:r,height:n,$:c}}function oa(t){return ir(t)?t:t.contextElement}function yn(t){const e=oa(t);if(!fr(e))return hr(1);const r=e.getBoundingClientRect(),{width:n,height:s,$:a}=fc(e);let l=(a?qi(r.width):r.width)/n,c=(a?qi(r.height):r.height)/s;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const Zw=hr(0);function pc(t){const e=Gt(t);return!ia()||!e.visualViewport?Zw:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function ev(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Gt(t)?!1:e}function Zr(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const s=t.getBoundingClientRect(),a=oa(t);let l=hr(1);e&&(n?ir(n)&&(l=yn(n)):l=yn(t));const c=ev(a,r,n)?pc(a):hr(0);let g=(s.left+c.x)/l.x,h=(s.top+c.y)/l.y,p=s.width/l.x,f=s.height/l.y;if(a){const _=Gt(a),x=n&&ir(n)?Gt(n):n;let S=_,I=As(S);for(;I&&n&&x!==S;){const F=yn(I),b=I.getBoundingClientRect(),A=or(I),T=b.left+(I.clientLeft+parseFloat(A.paddingLeft))*F.x,P=b.top+(I.clientTop+parseFloat(A.paddingTop))*F.y;g*=F.x,h*=F.y,p*=F.x,f*=F.y,g+=T,h+=P,S=Gt(I),I=As(S)}}return zi({width:p,height:f,x:g,y:h})}function so(t,e){const r=oo(t).scrollLeft;return e?e.left+r:Zr(pr(t)).left+r}function gc(t,e){const r=t.getBoundingClientRect(),n=r.left+e.scrollLeft-so(t,r),s=r.top+e.scrollTop;return{x:n,y:s}}function tv(t){let{elements:e,rect:r,offsetParent:n,strategy:s}=t;const a=s==="fixed",l=pr(n),c=e?no(e.floating):!1;if(n===l||c&&a)return r;let g={scrollLeft:0,scrollTop:0},h=hr(1);const p=hr(0),f=fr(n);if((f||!f&&!a)&&((kn(n)!=="body"||mi(l))&&(g=oo(n)),fr(n))){const x=Zr(n);h=yn(n),p.x=x.x+n.clientLeft,p.y=x.y+n.clientTop}const _=l&&!f&&!a?gc(l,g):hr(0);return{width:r.width*h.x,height:r.height*h.y,x:r.x*h.x-g.scrollLeft*h.x+p.x+_.x,y:r.y*h.y-g.scrollTop*h.y+p.y+_.y}}function rv(t){return Array.from(t.getClientRects())}function nv(t){const e=pr(t),r=oo(t),n=t.ownerDocument.body,s=Jt(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),a=Jt(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let l=-r.scrollLeft+so(t);const c=-r.scrollTop;return or(n).direction==="rtl"&&(l+=Jt(e.clientWidth,n.clientWidth)-s),{width:s,height:a,x:l,y:c}}const Dl=25;function iv(t,e){const r=Gt(t),n=pr(t),s=r.visualViewport;let a=n.clientWidth,l=n.clientHeight,c=0,g=0;if(s){a=s.width,l=s.height;const p=ia();(!p||p&&e==="fixed")&&(c=s.offsetLeft,g=s.offsetTop)}const h=so(n);if(h<=0){const p=n.ownerDocument,f=p.body,_=getComputedStyle(f),x=p.compatMode==="CSS1Compat"&&parseFloat(_.marginLeft)+parseFloat(_.marginRight)||0,S=Math.abs(n.clientWidth-f.clientWidth-x);S<=Dl&&(a-=S)}else h<=Dl&&(a+=h);return{width:a,height:l,x:c,y:g}}const ov=new Set(["absolute","fixed"]);function sv(t,e){const r=Zr(t,!0,e==="fixed"),n=r.top+t.clientTop,s=r.left+t.clientLeft,a=fr(t)?yn(t):hr(1),l=t.clientWidth*a.x,c=t.clientHeight*a.y,g=s*a.x,h=n*a.y;return{width:l,height:c,x:g,y:h}}function Ol(t,e,r){let n;if(e==="viewport")n=iv(t,r);else if(e==="document")n=nv(pr(t));else if(ir(e))n=sv(e,r);else{const s=pc(t);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return zi(n)}function mc(t,e){const r=Or(t);return r===e||!ir(r)||_n(r)?!1:or(r).position==="fixed"||mc(r,e)}function av(t,e){const r=e.get(t);if(r)return r;let n=Sn(t,[],!1).filter(c=>ir(c)&&kn(c)!=="body"),s=null;const a=or(t).position==="fixed";let l=a?Or(t):t;for(;ir(l)&&!_n(l);){const c=or(l),g=io(l);!g&&c.position==="fixed"&&(s=null),(a?!g&&!s:!g&&c.position==="static"&&!!s&&ov.has(s.position)||mi(l)&&!g&&mc(t,l))?n=n.filter(p=>p!==l):s=c,l=Or(l)}return e.set(t,n),n}function lv(t){let{element:e,boundary:r,rootBoundary:n,strategy:s}=t;const l=[...r==="clippingAncestors"?no(e)?[]:av(e,this._c):[].concat(r),n],c=l[0],g=l.reduce((h,p)=>{const f=Ol(e,p,s);return h.top=Jt(f.top,h.top),h.right=Lr(f.right,h.right),h.bottom=Lr(f.bottom,h.bottom),h.left=Jt(f.left,h.left),h},Ol(e,c,s));return{width:g.right-g.left,height:g.bottom-g.top,x:g.left,y:g.top}}function uv(t){const{width:e,height:r}=fc(t);return{width:e,height:r}}function cv(t,e,r){const n=fr(e),s=pr(e),a=r==="fixed",l=Zr(t,!0,a,e);let c={scrollLeft:0,scrollTop:0};const g=hr(0);function h(){g.x=so(s)}if(n||!n&&!a)if((kn(e)!=="body"||mi(s))&&(c=oo(e)),n){const x=Zr(e,!0,a,e);g.x=x.x+e.clientLeft,g.y=x.y+e.clientTop}else s&&h();a&&!n&&s&&h();const p=s&&!n&&!a?gc(s,c):hr(0),f=l.left+c.scrollLeft-g.x-p.x,_=l.top+c.scrollTop-g.y-p.y;return{x:f,y:_,width:l.width,height:l.height}}function es(t){return or(t).position==="static"}function Ul(t,e){if(!fr(t)||or(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return pr(t)===r&&(r=r.ownerDocument.body),r}function yc(t,e){const r=Gt(t);if(no(t))return r;if(!fr(t)){let s=Or(t);for(;s&&!_n(s);){if(ir(s)&&!es(s))return s;s=Or(s)}return r}let n=Ul(t,e);for(;n&&Ww(n)&&es(n);)n=Ul(n,e);return n&&_n(n)&&es(n)&&!io(n)?r:n||Qw(t)||r}const hv=async function(t){const e=this.getOffsetParent||yc,r=this.getDimensions,n=await r(t.floating);return{reference:cv(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function dv(t){return or(t).direction==="rtl"}const Bi={convertOffsetParentRelativeRectToViewportRelativeRect:tv,getDocumentElement:pr,getClippingRect:lv,getOffsetParent:yc,getElementRects:hv,getClientRects:rv,getDimensions:uv,getScale:yn,isElement:ir,isRTL:dv};function wc(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function fv(t,e){let r=null,n;const s=pr(t);function a(){var c;clearTimeout(n),(c=r)==null||c.disconnect(),r=null}function l(c,g){c===void 0&&(c=!1),g===void 0&&(g=1),a();const h=t.getBoundingClientRect(),{left:p,top:f,width:_,height:x}=h;if(c||e(),!_||!x)return;const S=Ii(f),I=Ii(s.clientWidth-(p+_)),F=Ii(s.clientHeight-(f+x)),b=Ii(p),T={rootMargin:-S+"px "+-I+"px "+-F+"px "+-b+"px",threshold:Jt(0,Lr(1,g))||1};let P=!0;function D(j){const M=j[0].intersectionRatio;if(M!==g){if(!P)return l();M?l(!1,M):n=setTimeout(()=>{l(!1,1e-7)},1e3)}M===1&&!wc(h,t.getBoundingClientRect())&&l(),P=!1}try{r=new IntersectionObserver(D,{...T,root:s.ownerDocument})}catch{r=new IntersectionObserver(D,T)}r.observe(t)}return l(!0),a}function pv(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:g=!1}=n,h=oa(t),p=s||a?[...h?Sn(h):[],...Sn(e)]:[];p.forEach(b=>{s&&b.addEventListener("scroll",r,{passive:!0}),a&&b.addEventListener("resize",r)});const f=h&&c?fv(h,r):null;let _=-1,x=null;l&&(x=new ResizeObserver(b=>{let[A]=b;A&&A.target===h&&x&&(x.unobserve(e),cancelAnimationFrame(_),_=requestAnimationFrame(()=>{var T;(T=x)==null||T.observe(e)})),r()}),h&&!g&&x.observe(h),x.observe(e));let S,I=g?Zr(t):null;g&&F();function F(){const b=Zr(t);I&&!wc(I,b)&&r(),I=b,S=requestAnimationFrame(F)}return r(),()=>{var b;p.forEach(A=>{s&&A.removeEventListener("scroll",r),a&&A.removeEventListener("resize",r)}),f?.(),(b=x)==null||b.disconnect(),x=null,g&&cancelAnimationFrame(S)}}const gv=$w,mv=Hw,yv=Bw,Bl=Vw,wv=Uw,vv=(t,e,r)=>{const n=new Map,s={platform:Bi,...r},a={...s.platform,_c:n};return Ow(t,e,{...s,platform:a})};function bv(t){return _v(t)}function ts(t){return t.assignedSlot?t.assignedSlot:t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}function _v(t){for(let e=t;e;e=ts(e))if(e instanceof Element&&getComputedStyle(e).display==="none")return null;for(let e=ts(t);e;e=ts(e)){if(!(e instanceof Element))continue;const r=getComputedStyle(e);if(r.display!=="contents"&&(r.position!=="static"||io(r)||e.tagName==="BODY"))return e}return null}var Sv=`:host {
  --arrow-color: black;
  --arrow-size: var(--wa-tooltip-arrow-size);
  --show-duration: 100ms;
  --hide-duration: 100ms;

  /*
     * These properties are computed to account for the arrow's dimensions after being rotated 45. The constant
     * 0.7071 is derived from sin(45), which is the diagonal size of the arrow's container after rotating.
     */
  --arrow-size-diagonal: calc(var(--arrow-size) * 0.7071);
  --arrow-padding-offset: calc(var(--arrow-size-diagonal) - var(--arrow-size));

  display: contents;
}

.popup {
  position: absolute;
  isolation: isolate;
  max-width: var(--auto-size-available-width, none);
  max-height: var(--auto-size-available-height, none);

  /* Clear UA styles for [popover] */
  :where(&) {
    inset: unset;
    padding: unset;
    margin: unset;
    width: unset;
    height: unset;
    color: unset;
    background: unset;
    border: unset;
    overflow: unset;
  }
}

.popup-fixed {
  position: fixed;
}

.popup:not(.popup-active) {
  display: none;
}

.arrow {
  position: absolute;
  width: calc(var(--arrow-size-diagonal) * 2);
  height: calc(var(--arrow-size-diagonal) * 2);
  rotate: 45deg;
  background: var(--arrow-color);
  z-index: 3;
}

:host([data-current-placement~='left']) .arrow {
  rotate: -45deg;
}

:host([data-current-placement~='right']) .arrow {
  rotate: 135deg;
}

:host([data-current-placement~='bottom']) .arrow {
  rotate: 225deg;
}

/* Hover bridge */
.popup-hover-bridge:not(.popup-hover-bridge-visible) {
  display: none;
}

.popup-hover-bridge {
  position: fixed;
  z-index: 899;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  clip-path: polygon(
    var(--hover-bridge-top-left-x, 0) var(--hover-bridge-top-left-y, 0),
    var(--hover-bridge-top-right-x, 0) var(--hover-bridge-top-right-y, 0),
    var(--hover-bridge-bottom-right-x, 0) var(--hover-bridge-bottom-right-y, 0),
    var(--hover-bridge-bottom-left-x, 0) var(--hover-bridge-bottom-left-y, 0)
  );
}

/* Built-in animations */
.show {
  animation: show var(--show-duration) ease;
}

.hide {
  animation: show var(--hide-duration) ease reverse;
}

@keyframes show {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.show-with-scale {
  animation: show-with-scale var(--show-duration) ease;
}

.hide-with-scale {
  animation: show-with-scale var(--hide-duration) ease reverse;
}

@keyframes show-with-scale {
  from {
    opacity: 0;
    scale: 0.8;
  }
  to {
    opacity: 1;
    scale: 1;
  }
}
`;function Ml(t){return t!==null&&typeof t=="object"&&"getBoundingClientRect"in t&&("contextElement"in t?t instanceof Element:!0)}var Ti=globalThis?.HTMLElement?.prototype.hasOwnProperty("popover"),nt=class extends Zt{constructor(){super(...arguments),this.localize=new di(this),this.active=!1,this.placement="top",this.boundary="viewport",this.distance=0,this.skidding=0,this.arrow=!1,this.arrowPlacement="anchor",this.arrowPadding=10,this.flip=!1,this.flipFallbackPlacements="",this.flipFallbackStrategy="best-fit",this.flipPadding=0,this.shift=!1,this.shiftPadding=0,this.autoSizePadding=0,this.hoverBridge=!1,this.updateHoverBridge=()=>{if(this.hoverBridge&&this.anchorEl){const t=this.anchorEl.getBoundingClientRect(),e=this.popup.getBoundingClientRect(),r=this.placement.includes("top")||this.placement.includes("bottom");let n=0,s=0,a=0,l=0,c=0,g=0,h=0,p=0;r?t.top<e.top?(n=t.left,s=t.bottom,a=t.right,l=t.bottom,c=e.left,g=e.top,h=e.right,p=e.top):(n=e.left,s=e.bottom,a=e.right,l=e.bottom,c=t.left,g=t.top,h=t.right,p=t.top):t.left<e.left?(n=t.right,s=t.top,a=e.left,l=e.top,c=t.right,g=t.bottom,h=e.left,p=e.bottom):(n=e.right,s=e.top,a=t.left,l=t.top,c=e.right,g=e.bottom,h=t.left,p=t.bottom),this.style.setProperty("--hover-bridge-top-left-x",`${n}px`),this.style.setProperty("--hover-bridge-top-left-y",`${s}px`),this.style.setProperty("--hover-bridge-top-right-x",`${a}px`),this.style.setProperty("--hover-bridge-top-right-y",`${l}px`),this.style.setProperty("--hover-bridge-bottom-left-x",`${c}px`),this.style.setProperty("--hover-bridge-bottom-left-y",`${g}px`),this.style.setProperty("--hover-bridge-bottom-right-x",`${h}px`),this.style.setProperty("--hover-bridge-bottom-right-y",`${p}px`)}}}async connectedCallback(){super.connectedCallback(),await this.updateComplete,this.start()}disconnectedCallback(){super.disconnectedCallback(),this.stop()}async updated(t){super.updated(t),t.has("active")&&(this.active?this.start():this.stop()),t.has("anchor")&&this.handleAnchorChange(),this.active&&(await this.updateComplete,this.reposition())}async handleAnchorChange(){if(await this.stop(),this.anchor&&typeof this.anchor=="string"){const t=this.getRootNode();this.anchorEl=t.getElementById(this.anchor)}else this.anchor instanceof Element||Ml(this.anchor)?this.anchorEl=this.anchor:this.anchorEl=this.querySelector('[slot="anchor"]');this.anchorEl instanceof HTMLSlotElement&&(this.anchorEl=this.anchorEl.assignedElements({flatten:!0})[0]),this.anchorEl&&this.start()}start(){!this.anchorEl||!this.active||(this.popup.showPopover?.(),this.cleanup=pv(this.anchorEl,this.popup,()=>{this.reposition()}))}async stop(){return new Promise(t=>{this.popup.hidePopover?.(),this.cleanup?(this.cleanup(),this.cleanup=void 0,this.removeAttribute("data-current-placement"),this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height"),requestAnimationFrame(()=>t())):t()})}reposition(){if(!this.active||!this.anchorEl)return;const t=[gv({mainAxis:this.distance,crossAxis:this.skidding})];this.sync?t.push(Bl({apply:({rects:n})=>{const s=this.sync==="width"||this.sync==="both",a=this.sync==="height"||this.sync==="both";this.popup.style.width=s?`${n.reference.width}px`:"",this.popup.style.height=a?`${n.reference.height}px`:""}})):(this.popup.style.width="",this.popup.style.height="");let e;Ti&&!Ml(this.anchor)&&this.boundary==="scroll"&&(e=Sn(this.anchorEl).filter(n=>n instanceof Element)),this.flip&&t.push(yv({boundary:this.flipBoundary||e,fallbackPlacements:this.flipFallbackPlacements,fallbackStrategy:this.flipFallbackStrategy==="best-fit"?"bestFit":"initialPlacement",padding:this.flipPadding})),this.shift&&t.push(mv({boundary:this.shiftBoundary||e,padding:this.shiftPadding})),this.autoSize?t.push(Bl({boundary:this.autoSizeBoundary||e,padding:this.autoSizePadding,apply:({availableWidth:n,availableHeight:s})=>{this.autoSize==="vertical"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-height",`${s}px`):this.style.removeProperty("--auto-size-available-height"),this.autoSize==="horizontal"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-width",`${n}px`):this.style.removeProperty("--auto-size-available-width")}})):(this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height")),this.arrow&&t.push(wv({element:this.arrowEl,padding:this.arrowPadding}));const r=Ti?n=>Bi.getOffsetParent(n,bv):Bi.getOffsetParent;vv(this.anchorEl,this.popup,{placement:this.placement,middleware:t,strategy:Ti?"absolute":"fixed",platform:{...Bi,getOffsetParent:r}}).then(({x:n,y:s,middlewareData:a,placement:l})=>{const c=this.localize.dir()==="rtl",g={top:"bottom",right:"left",bottom:"top",left:"right"}[l.split("-")[0]];if(this.setAttribute("data-current-placement",l),Object.assign(this.popup.style,{left:`${n}px`,top:`${s}px`}),this.arrow){const h=a.arrow.x,p=a.arrow.y;let f="",_="",x="",S="";if(this.arrowPlacement==="start"){const I=typeof h=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";f=typeof p=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"",_=c?I:"",S=c?"":I}else if(this.arrowPlacement==="end"){const I=typeof h=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";_=c?"":I,S=c?I:"",x=typeof p=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:""}else this.arrowPlacement==="center"?(S=typeof h=="number"?"calc(50% - var(--arrow-size-diagonal))":"",f=typeof p=="number"?"calc(50% - var(--arrow-size-diagonal))":""):(S=typeof h=="number"?`${h}px`:"",f=typeof p=="number"?`${p}px`:"");Object.assign(this.arrowEl.style,{top:f,right:_,bottom:x,left:S,[g]:"calc(var(--arrow-size-diagonal) * -1)"})}}),requestAnimationFrame(()=>this.updateHoverBridge()),this.dispatchEvent(new Aw)}render(){return Qe`
      <slot name="anchor" @slotchange=${this.handleAnchorChange}></slot>

      <span
        part="hover-bridge"
        class=${Xr({"popup-hover-bridge":!0,"popup-hover-bridge-visible":this.hoverBridge&&this.active})}
      ></span>

      <div
        popover="manual"
        part="popup"
        class=${Xr({popup:!0,"popup-active":this.active,"popup-fixed":!Ti,"popup-has-arrow":this.arrow})}
      >
        <slot></slot>
        ${this.arrow?Qe`<div part="arrow" class="arrow" role="presentation"></div>`:""}
      </div>
    `}};nt.css=Sv;Se([Ut(".popup")],nt.prototype,"popup",2);Se([Ut(".arrow")],nt.prototype,"arrowEl",2);Se([Te()],nt.prototype,"anchor",2);Se([Te({type:Boolean,reflect:!0})],nt.prototype,"active",2);Se([Te({reflect:!0})],nt.prototype,"placement",2);Se([Te()],nt.prototype,"boundary",2);Se([Te({type:Number})],nt.prototype,"distance",2);Se([Te({type:Number})],nt.prototype,"skidding",2);Se([Te({type:Boolean})],nt.prototype,"arrow",2);Se([Te({attribute:"arrow-placement"})],nt.prototype,"arrowPlacement",2);Se([Te({attribute:"arrow-padding",type:Number})],nt.prototype,"arrowPadding",2);Se([Te({type:Boolean})],nt.prototype,"flip",2);Se([Te({attribute:"flip-fallback-placements",converter:{fromAttribute:t=>t.split(" ").map(e=>e.trim()).filter(e=>e!==""),toAttribute:t=>t.join(" ")}})],nt.prototype,"flipFallbackPlacements",2);Se([Te({attribute:"flip-fallback-strategy"})],nt.prototype,"flipFallbackStrategy",2);Se([Te({type:Object})],nt.prototype,"flipBoundary",2);Se([Te({attribute:"flip-padding",type:Number})],nt.prototype,"flipPadding",2);Se([Te({type:Boolean})],nt.prototype,"shift",2);Se([Te({type:Object})],nt.prototype,"shiftBoundary",2);Se([Te({attribute:"shift-padding",type:Number})],nt.prototype,"shiftPadding",2);Se([Te({attribute:"auto-size"})],nt.prototype,"autoSize",2);Se([Te()],nt.prototype,"sync",2);Se([Te({type:Object})],nt.prototype,"autoSizeBoundary",2);Se([Te({attribute:"auto-size-padding",type:Number})],nt.prototype,"autoSizePadding",2);Se([Te({attribute:"hover-bridge",type:Boolean})],nt.prototype,"hoverBridge",2);nt=Se([_t("wa-popup")],nt);const Ev="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let xv=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=Ev[r[t]&63];return e};function vc(t=""){return`${t}${xv()}`}function Ji(t,e){return new Promise(r=>{function n(s){s.target===t&&(t.removeEventListener(e,n),r())}t.addEventListener(e,n)})}var Av=`:host {
  --max-width: 30ch;

  /** These styles are added so we don't interfere in the DOM. */
  display: inline-block;
  position: absolute;

  /** Defaults for inherited CSS properties */
  color: var(--wa-tooltip-content-color);
  font-size: var(--wa-tooltip-font-size);
  line-height: var(--wa-tooltip-line-height);
  text-align: start;
  white-space: normal;
}

.tooltip {
  --arrow-size: var(--wa-tooltip-arrow-size);
  --arrow-color: var(--wa-tooltip-background-color);
}

.tooltip::part(popup) {
  z-index: 1000;
}

.tooltip[placement^='top']::part(popup) {
  transform-origin: bottom;
}

.tooltip[placement^='bottom']::part(popup) {
  transform-origin: top;
}

.tooltip[placement^='left']::part(popup) {
  transform-origin: right;
}

.tooltip[placement^='right']::part(popup) {
  transform-origin: left;
}

.body {
  display: block;
  width: max-content;
  max-width: var(--max-width);
  border-radius: var(--wa-tooltip-border-radius);
  background-color: var(--wa-tooltip-background-color);
  border: var(--wa-tooltip-border-width) var(--wa-tooltip-border-style) var(--wa-tooltip-border-color);
  padding: 0.25em 0.5em;
  user-select: none;
  -webkit-user-select: none;
}

.tooltip::part(arrow) {
  border-bottom: var(--wa-tooltip-border-width) var(--wa-tooltip-border-style) var(--wa-tooltip-border-color);
  border-right: var(--wa-tooltip-border-width) var(--wa-tooltip-border-style) var(--wa-tooltip-border-color);
}
`,yt=class extends Zt{constructor(){super(...arguments),this.placement="top",this.disabled=!1,this.distance=8,this.open=!1,this.skidding=0,this.showDelay=150,this.hideDelay=0,this.trigger="hover focus",this.withoutArrow=!1,this.for=null,this.anchor=null,this.eventController=new AbortController,this.handleBlur=()=>{this.hasTrigger("focus")&&this.hide()},this.handleClick=()=>{this.hasTrigger("click")&&(this.open?this.hide():this.show())},this.handleFocus=()=>{this.hasTrigger("focus")&&this.show()},this.handleDocumentKeyDown=t=>{t.key==="Escape"&&(t.stopPropagation(),this.hide())},this.handleMouseOver=()=>{this.hasTrigger("hover")&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.show(),this.showDelay))},this.handleMouseOut=()=>{this.hasTrigger("hover")&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.hide(),this.hideDelay))}}connectedCallback(){super.connectedCallback(),this.eventController.signal.aborted&&(this.eventController=new AbortController),this.open&&(this.open=!1,this.updateComplete.then(()=>{this.open=!0})),this.id||(this.id=vc("wa-tooltip-")),this.for&&this.anchor?(this.anchor=null,this.handleForChange()):this.for&&this.handleForChange()}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keydown",this.handleDocumentKeyDown),this.eventController.abort(),this.anchor&&this.removeFromAriaLabelledBy(this.anchor,this.id)}firstUpdated(){this.body.hidden=!this.open,this.open&&(this.popup.active=!0,this.popup.reposition())}hasTrigger(t){return this.trigger.split(" ").includes(t)}addToAriaLabelledBy(t,e){const n=(t.getAttribute("aria-labelledby")||"").split(/\s+/).filter(Boolean);n.includes(e)||(n.push(e),t.setAttribute("aria-labelledby",n.join(" ")))}removeFromAriaLabelledBy(t,e){const s=(t.getAttribute("aria-labelledby")||"").split(/\s+/).filter(Boolean).filter(a=>a!==e);s.length>0?t.setAttribute("aria-labelledby",s.join(" ")):t.removeAttribute("aria-labelledby")}async handleOpenChange(){if(this.open){if(this.disabled)return;const t=new qs;if(this.dispatchEvent(t),t.defaultPrevented){this.open=!1;return}document.addEventListener("keydown",this.handleDocumentKeyDown,{signal:this.eventController.signal}),this.body.hidden=!1,this.popup.active=!0,await Xt(this.popup.popup,"show-with-scale"),this.popup.reposition(),this.dispatchEvent(new Vs)}else{const t=new Ks;if(this.dispatchEvent(t),t.defaultPrevented){this.open=!1;return}document.removeEventListener("keydown",this.handleDocumentKeyDown),await Xt(this.popup.popup,"hide-with-scale"),this.popup.active=!1,this.body.hidden=!0,this.dispatchEvent(new Hs)}}handleForChange(){const t=this.getRootNode();if(!t)return;const e=this.for?t.getElementById(this.for):null,r=this.anchor;if(e===r)return;const{signal:n}=this.eventController;e&&(this.addToAriaLabelledBy(e,this.id),e.addEventListener("blur",this.handleBlur,{capture:!0,signal:n}),e.addEventListener("focus",this.handleFocus,{capture:!0,signal:n}),e.addEventListener("click",this.handleClick,{signal:n}),e.addEventListener("mouseover",this.handleMouseOver,{signal:n}),e.addEventListener("mouseout",this.handleMouseOut,{signal:n})),r&&(this.removeFromAriaLabelledBy(r,this.id),r.removeEventListener("blur",this.handleBlur,{capture:!0}),r.removeEventListener("focus",this.handleFocus,{capture:!0}),r.removeEventListener("click",this.handleClick),r.removeEventListener("mouseover",this.handleMouseOver),r.removeEventListener("mouseout",this.handleMouseOut)),this.anchor=e}async handleOptionsChange(){this.hasUpdated&&(await this.updateComplete,this.popup.reposition())}handleDisabledChange(){this.disabled&&this.open&&this.hide()}async show(){if(!this.open)return this.open=!0,Ji(this,"wa-after-show")}async hide(){if(this.open)return this.open=!1,Ji(this,"wa-after-hide")}render(){return Qe`
      <wa-popup
        part="base"
        exportparts="
          popup:base__popup,
          arrow:base__arrow
        "
        class=${Xr({tooltip:!0,"tooltip-open":this.open})}
        placement=${this.placement}
        distance=${this.distance}
        skidding=${this.skidding}
        flip
        shift
        ?arrow=${!this.withoutArrow}
        hover-bridge
        .anchor=${this.anchor}
      >
        <div part="body" class="body">
          <slot></slot>
        </div>
      </wa-popup>
    `}};yt.css=Av;yt.dependencies={"wa-popup":nt};Se([Ut("slot:not([name])")],yt.prototype,"defaultSlot",2);Se([Ut(".body")],yt.prototype,"body",2);Se([Ut("wa-popup")],yt.prototype,"popup",2);Se([Te()],yt.prototype,"placement",2);Se([Te({type:Boolean,reflect:!0})],yt.prototype,"disabled",2);Se([Te({type:Number})],yt.prototype,"distance",2);Se([Te({type:Boolean,reflect:!0})],yt.prototype,"open",2);Se([Te({type:Number})],yt.prototype,"skidding",2);Se([Te({attribute:"show-delay",type:Number})],yt.prototype,"showDelay",2);Se([Te({attribute:"hide-delay",type:Number})],yt.prototype,"hideDelay",2);Se([Te()],yt.prototype,"trigger",2);Se([Te({attribute:"without-arrow",type:Boolean,reflect:!0})],yt.prototype,"withoutArrow",2);Se([Te()],yt.prototype,"for",2);Se([Ot()],yt.prototype,"anchor",2);Se([er("open",{waitUntilFirstUpdate:!0})],yt.prototype,"handleOpenChange",1);Se([er("for")],yt.prototype,"handleForChange",1);Se([er(["distance","placement","skidding"])],yt.prototype,"handleOptionsChange",1);Se([er("disabled")],yt.prototype,"handleDisabledChange",1);yt=Se([_t("wa-tooltip")],yt);var Fv=`:host {
  --arrow-size: 0.375rem;
  --max-width: 25rem;
  --show-duration: 100ms;
  --hide-duration: 100ms;

  /* Internal calculated properties */
  --arrow-diagonal-size: calc((var(--arrow-size) * sin(45deg)));

  display: contents;

  /** Defaults for inherited CSS properties */
  font-size: var(--wa-font-size-m);
  line-height: var(--wa-line-height-normal);
  text-align: start;
  white-space: normal;
}

/* The native dialog element */
.dialog {
  display: none;
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  border: none;
  background: transparent;
  overflow: visible;
  pointer-events: none;

  &:focus {
    outline: none;
  }

  &[open] {
    display: block;
  }
}

/* The <wa-popup> element */
.popover {
  --arrow-size: inherit;
  --show-duration: inherit;
  --hide-duration: inherit;

  pointer-events: auto;

  &::part(arrow) {
    background-color: var(--wa-color-surface-default);
    border-top: none;
    border-left: none;
    border-bottom: solid var(--wa-panel-border-width) var(--wa-color-surface-border);
    border-right: solid var(--wa-panel-border-width) var(--wa-color-surface-border);
    box-shadow: none;
  }
}

.popover[placement^='top']::part(popup) {
  transform-origin: bottom;
}

.popover[placement^='bottom']::part(popup) {
  transform-origin: top;
}

.popover[placement^='left']::part(popup) {
  transform-origin: right;
}

.popover[placement^='right']::part(popup) {
  transform-origin: left;
}

/* Body */
.body {
  display: flex;
  flex-direction: column;
  width: max-content;
  max-width: var(--max-width);
  padding: var(--wa-space-l);
  background-color: var(--wa-color-surface-default);
  border: var(--wa-panel-border-width) solid var(--wa-color-surface-border);
  border-radius: var(--wa-panel-border-radius);
  border-style: var(--wa-panel-border-style);
  box-shadow: var(--wa-shadow-l);
  color: var(--wa-color-text-normal);
  user-select: none;
  -webkit-user-select: none;
}
`,rs=new Set,Nt=class extends Zt{constructor(){super(...arguments),this.anchor=null,this.placement="top",this.open=!1,this.distance=8,this.skidding=0,this.for=null,this.withoutArrow=!1,this.eventController=new AbortController,this.handleAnchorClick=()=>{this.open=!this.open},this.handleBodyClick=t=>{t.target.closest('[data-popover="close"]')&&(t.stopPropagation(),this.open=!1)},this.handleDocumentKeyDown=t=>{t.key==="Escape"&&(t.preventDefault(),this.open=!1,this.anchor&&typeof this.anchor.focus=="function"&&this.anchor.focus())},this.handleDocumentClick=t=>{const e=t.target;this.anchor&&t.composedPath().includes(this.anchor)||e.closest("wa-popover")!==this&&(this.open=!1)}}connectedCallback(){super.connectedCallback(),this.id||(this.id=vc("wa-popover-"))}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keydown",this.handleDocumentKeyDown),this.eventController.abort()}firstUpdated(){this.open&&(this.dialog.show(),this.popup.active=!0,this.popup.reposition())}updated(t){t.has("open")&&this.customStates.set("open",this.open)}async handleOpenChange(){if(this.open){const t=new qs;if(this.dispatchEvent(t),t.defaultPrevented){this.open=!1;return}rs.forEach(e=>e.open=!1),document.addEventListener("keydown",this.handleDocumentKeyDown,{signal:this.eventController.signal}),document.addEventListener("click",this.handleDocumentClick,{signal:this.eventController.signal}),this.dialog.show(),this.popup.active=!0,rs.add(this),requestAnimationFrame(()=>{const e=this.querySelector("[autofocus]");e&&typeof e.focus=="function"?e.focus():this.dialog.focus()}),await Xt(this.popup.popup,"show-with-scale"),this.popup.reposition(),this.dispatchEvent(new Vs)}else{const t=new Ks;if(this.dispatchEvent(t),t.defaultPrevented){this.open=!0;return}document.removeEventListener("keydown",this.handleDocumentKeyDown),document.removeEventListener("click",this.handleDocumentClick),rs.delete(this),await Xt(this.popup.popup,"hide-with-scale"),this.popup.active=!1,this.dialog.close(),this.dispatchEvent(new Hs)}}handleForChange(){const t=this.getRootNode();if(!t)return;const e=this.for?t.getElementById(this.for):null,r=this.anchor;if(e===r)return;const{signal:n}=this.eventController;e&&e.addEventListener("click",this.handleAnchorClick,{signal:n}),r&&r.removeEventListener("click",this.handleAnchorClick),this.anchor=e,this.for&&!e&&console.warn(`A popover was assigned to an element with an ID of "${this.for}" but the element could not be found.`,this)}async handleOptionsChange(){this.hasUpdated&&(await this.updateComplete,this.popup.reposition())}async show(){if(!this.open)return this.open=!0,Ji(this,"wa-after-show")}async hide(){if(this.open)return this.open=!1,Ji(this,"wa-after-hide")}render(){return Qe`
      <dialog part="dialog" class="dialog">
        <wa-popup
          part="popup"
          exportparts="
            popup:popup__popup,
            arrow:popup__arrow
          "
          class=${Xr({popover:!0,"popover-open":this.open})}
          placement=${this.placement}
          distance=${this.distance}
          skidding=${this.skidding}
          flip
          shift
          ?arrow=${!this.withoutArrow}
          .anchor=${this.anchor}
        >
          <div part="body" class="body" @click=${this.handleBodyClick}>
            <slot></slot>
          </div>
        </wa-popup>
      </dialog>
    `}};Nt.css=Fv;Nt.dependencies={"wa-popup":nt};Se([Ut("dialog")],Nt.prototype,"dialog",2);Se([Ut(".body")],Nt.prototype,"body",2);Se([Ut("wa-popup")],Nt.prototype,"popup",2);Se([Ot()],Nt.prototype,"anchor",2);Se([Te()],Nt.prototype,"placement",2);Se([Te({type:Boolean,reflect:!0})],Nt.prototype,"open",2);Se([Te({type:Number})],Nt.prototype,"distance",2);Se([Te({type:Number})],Nt.prototype,"skidding",2);Se([Te()],Nt.prototype,"for",2);Se([Te({attribute:"without-arrow",type:Boolean,reflect:!0})],Nt.prototype,"withoutArrow",2);Se([er("open",{waitUntilFirstUpdate:!0})],Nt.prototype,"handleOpenChange",1);Se([er("for")],Nt.prototype,"handleForChange",1);Se([er(["distance","placement","skidding"])],Nt.prototype,"handleOptionsChange",1);Nt=Se([_t("wa-popover")],Nt);function Rv(t){return"uri"in t}function Iv({id:t,uri:e,data:r,language:n}){if(!r||!r.entities)return{};const s=r.entities[t];if(!s)return{};const a=s.labels[n]?.value,l=s.descriptions[n]?.value,c=(s.claims.P18??[]).map(x=>x.mainsnak.datavalue?.value)[0],g=(s.claims.P154??[]).map(x=>x.mainsnak.datavalue?.value)[0],h=c&&`https://commons.wikimedia.org/wiki/Special:FilePath/${encodeURIComponent(c)}?width=300`,p=g&&`https://commons.wikimedia.org/wiki/Special:FilePath/${encodeURIComponent(g)}?width=300`,f=(s.claims.P856??[]).map(x=>x.mainsnak.datavalue?.value)[0],_=(s.aliases[n]??[]).map(({value:x})=>x);return{id:t,uri:e,label:a,aliases:_,description:l,officialWebsite:f,image:p||h}}const Tv=/^https?:\/\/(w{3}\.)?wikidata\.org\/entity\/([A-Z0-9]*)\/?$/;var Cv=Object.defineProperty,kv=Object.getOwnPropertyDescriptor,Fr=(t,e,r,n)=>{for(var s=n>1?void 0:n?kv(e,r):e,a=t.length-1,l;a>=0;a--)(l=t[a])&&(s=(n?l(e,r,s):l(s))||s);return n&&s&&Cv(e,r,s),s};const Pv=[{type:"match",subject:"?webid",predicate:Xs.seeAlso,pick:"object",target:"?profileDocument"},{type:"add resources",variable:"?profileDocument"},{type:"match",subject:"?webid",predicate:Zs.preferencesFile,pick:"object",target:"?preferencesFile"},{type:"add resources",variable:"?preferencesFile"},{type:"match",subject:"?webid",predicate:Qs.topic_interest,pick:"object",target:"?interest"}];let En=class extends Ct{constructor(){super(...arguments),this.handleVariable=(t,e,r)=>{t==="?interest"&&(this._interests=Array.from(r))},this._runner=new ea(()=>this.store,Pv,{onVariableAdded:this.handleVariable,onVariableRemoved:this.handleVariable})}async updated(t){(t.has("webid")||t.has("store"))&&(this._interests=[],this.webid?this._runner.run({"?webid":new Set([this.webid])}):this._runner.destroy())}disconnectedCallback(){super.disconnectedCallback(),this._runner.destroy()}render(){return Qe`${Array.from(this._interests??new Set).map(t=>t.termType==="NamedNode"?Qe`<dtp-topic
              uri=${t.id}
              .store=${pp}
            ></dtp-topic>`:void 0)}`}};En.styles=en`
    :host {
      display: flex;
      flex-wrap: wrap;
      gap: 0.25rem 1rem;
    }
  `;Fr([Te()],En.prototype,"webid",2);Fr([Ot()],En.prototype,"_interests",2);Fr([Te({attribute:!1})],En.prototype,"store",2);En=Fr([_t("dtp-interests")],En);let xn=class extends Ct{constructor(){super(...arguments),this.language="en",this._data={uri:this.uri,aliases:[]},this._unsubscribes=new Map}async updated(t){if(t.has("uri")||t.has("store")||t.has("language")){if(!this.store)return;this._data={uri:this.uri,aliases:[]};const e=this.uri.match(Tv)?.[2]??"";if(!e)return;const r=`https://www.wikidata.org/w/api.php?action=wbgetentities&ids=${e}&languages=${this.language}&format=json&origin=*`,n=this.store?.subscribe(r,{},s=>{if(!s.loading&&!s.error){const a=Iv({id:e,uri:this.uri,data:s.data,language:this.language});Rv(a)&&(this._data=a)}});this._unsubscribes.get(r)?.(),this._unsubscribes.set(r,n)}}disconnectedCallback(){super.disconnectedCallback();const t=this._unsubscribes.values();for(const e of t)e()}render(){return Qe`
      <button id="interest">
        ${this._data.label??this.uri.split("/").pop()}
      </button>
      <wa-popover for="interest">
        <div>
          <img src=${mt(this._data.image)} alt="" />
          <header>
            <h3>
              ${this._data.label}
              <a href=${mt(this._data?.uri)}>link</a>
            </h3>
            ${this._data.aliases.length>0?Qe`<div>${this._data.aliases.join(", ")}</div>`:pt}
            ${this._data.officialWebsite?Qe`<a
                  href=${mt(this._data.officialWebsite)}
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  ${this._data.officialWebsite}
                </a>`:pt}
          </header>
          <section>${this._data.description}</section>
        </div>
      </wa-popover>
    `}};Fr([Te()],xn.prototype,"uri",2);Fr([Te()],xn.prototype,"language",2);Fr([Ot()],xn.prototype,"_data",2);Fr([Ot()],xn.prototype,"store",2);xn=Fr([_t("dtp-topic")],xn);var Nv=Object.defineProperty,Lv=Object.getOwnPropertyDescriptor,ao=(t,e,r,n)=>{for(var s=n>1?void 0:n?Lv(e,r):e,a=t.length-1,l;a>=0;a--)(l=t[a])&&(s=(n?l(e,r,s):l(s))||s);return n&&s&&Nv(e,r,s),s};const Dv=[{type:"match",subject:"?webid",predicate:Xs.seeAlso,pick:"object",target:"?profileDocument"},{type:"add resources",variable:"?profileDocument"},{type:"match",subject:"?webid",predicate:Zs.preferencesFile,pick:"object",target:"?preferencesFile"},{type:"add resources",variable:"?preferencesFile"},{type:"match",subject:"?webid",predicate:_s.fn,pick:"object",target:"?name"},{type:"match",subject:"?webid",predicate:Qs.name,pick:"object",target:"?name"}];let hi=class extends Ct{constructor(){super(...arguments),this.runner=new ea(()=>this.store,Dv,{onVariableAdded:(t,e,r)=>this.handleVariable(t,r),onVariableRemoved:(t,e,r)=>this.handleVariable(t,r)})}handleVariable(t,e){t==="?name"&&(this._name=sc(e))}updated(t){(t.has("webid")||t.has("store"))&&(this._name=void 0,this.webid?this.runner.run({"?webid":new Set([this.webid])}):this.runner.destroy())}disconnectedCallback(){super.disconnectedCallback(),this.runner.destroy()}render(){return Qe`${mt(this._name)}`}};ao([Te()],hi.prototype,"webid",2);ao([Ot()],hi.prototype,"_name",2);ao([Te({attribute:!1})],hi.prototype,"store",2);hi=ao([_t("dtp-name")],hi);var Ov=Object.defineProperty,Uv=Object.getOwnPropertyDescriptor,bc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Uv(e,r):e,a=t.length-1,l;a>=0;a--)(l=t[a])&&(s=(n?l(e,r,s):l(s))||s);return n&&s&&Ov(e,r,s),s};let Gi=class extends Ct{render(){return Qe`
      <dtp-name webid=${mt(this.webid)} .store=${Li}></dtp-name>
      <div>
        ${this.webid}
        <wa-copy-button value=${mt(this.webid)}></wa-copy-button>
      </div>
      <!-- <wa-qr-code value=${mt(this.webid)}></wa-qr-code> -->
      <dtp-avatar
        webid=${mt(this.webid)}
        shape="square"
        .store=${Li}
      ></dtp-avatar>
      <dtp-interests
        webid=${mt(this.webid)}
        .store=${Li}
      ></dtp-interests>
    `}};Gi.styles=en`
    dtp-avatar {
      --size: 200px;
    }

    :host {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      align-items: center;
    }
  `;bc([Te()],Gi.prototype,"webid",2);Gi=bc([_t("dtp-profile")],Gi);var Bv=Object.getOwnPropertyDescriptor,Mv=(t,e,r,n)=>{for(var s=n>1?void 0:n?Bv(e,r):e,a=t.length-1,l;a>=0;a--)(l=t[a])&&(s=l(s)||s);return s};let jl=class extends Ct{constructor(){super(...arguments),this._routes=new _w(this,[{path:"/",render:()=>Qe`<div>home</div>`},{path:"/profile",render:()=>Qe`/profile`},{path:"/profile/:webid",render:({webid:t})=>Qe`<dtp-profile webid=${decodeURIComponent(t)}></dtp-profile>`},{path:"/*",render:()=>Qe`404`}])}render(){return Qe`${this._routes.outlet()}`}};jl=Mv([_t("dtp-router")],jl);var jv=Object.defineProperty,$v=Object.getOwnPropertyDescriptor,_c=(t,e,r,n)=>{for(var s=n>1?void 0:n?$v(e,r):e,a=t.length-1,l;a>=0;a--)(l=t[a])&&(s=(n?l(e,r,s):l(s))||s);return n&&s&&jv(e,r,s),s};let Fs=class extends Ct{constructor(){super(...arguments),this._updateSessionInfo=()=>{this._info={...bn().info}},this._redirectFromSessionStorage=()=>{const t=globalThis.sessionStorage.getItem("previousUrl");globalThis.sessionStorage.removeItem("previousUrl"),this._redirect(t)}}connectedCallback(){super.connectedCallback(),Tf({restorePreviousSession:!0}).then(t=>{this._info=t}),this._session=bn(),this._session.events.addListener(ut.LOGOUT,this._updateSessionInfo),this._session.events.addListener(ut.SESSION_RESTORED,this._redirect),this._session.events.addListener(ut.LOGIN,this._redirectFromSessionStorage),this._session.events.addListener(ut.ERROR,this._clearPreviousUrl)}_redirect(t){t&&new URL(t).hostname===globalThis.location.hostname&&globalThis.history.replaceState(null,"",t)}_clearPreviousUrl(){globalThis.sessionStorage.removeItem("previousUrl")}disconnectedCallback(){super.disconnectedCallback(),this._session?.events.removeListener(ut.LOGOUT,this._updateSessionInfo),this._session?.events.removeListener(ut.SESSION_RESTORED,this._redirect),this._session?.events.removeListener(ut.LOGIN,this._redirectFromSessionStorage),this._session?.events.removeListener(ut.ERROR,this._clearPreviousUrl)}render(){if(!this._info)return Qe`<wa-spinner></wa-spinner>`;if(!this._info.isLoggedIn)return Qe`<dtp-landing></dtp-landing>`;if(this._info.isLoggedIn)return Qe`<dtp-layout webid=${mt(this._info.webId)}
        ><dtp-router></dtp-router
      ></dtp-layout>`;throw new Error("Unexpected session state")}};_c([Ot()],Fs.prototype,"_info",2);Fs=_c([_t("dtp-main")],Fs);
